const po=window.Vue,{BaseTransition:zp,BaseTransitionPropsValidators:jp,Comment:qp,DeprecationTypes:Hp,EffectScope:Vp,ErrorCodes:Wp,ErrorTypeStrings:Gp,Fragment:bn,KeepAlive:Kp,ReactiveEffect:Xp,Static:Yp,Suspense:Qp,Teleport:Zp,Text:Jp,TrackOpTypes:ef,Transition:tf,TransitionGroup:nf,TriggerOpTypes:rf,VueElement:sf,__esModule:of,assertNumber:af,callWithAsyncErrorHandling:lf,callWithErrorHandling:uf,camelize:cf,capitalize:df,cloneVNode:hf,compatUtils:pf,compile:ff,computed:fo,createApp:mf,createBlock:Gr,createCommentVNode:mo,createElementBlock:H,createElementVNode:A,createHydrationRenderer:gf,createPropsRestProxy:yf,createRenderer:bf,createSSRApp:vf,createSlots:_f,createStaticVNode:wf,createTextVNode:be,createVNode:Q,customRef:Sf,defineAsyncComponent:Ff,defineComponent:Pf,defineCustomElement:Tf,defineEmits:Cf,defineExpose:Ef,defineModel:xf,defineOptions:kf,defineProps:Uf,defineSSRCustomElement:Of,defineSlots:Af,devtools:Rf,effect:If,effectScope:Df,getCurrentInstance:Nf,getCurrentScope:Bf,getCurrentWatcher:Lf,getTransitionRawChildren:Mf,guardReactiveProps:$f,h:zf,handleError:jf,hasInjectionContext:qf,hydrate:Hf,hydrateOnIdle:Vf,hydrateOnInteraction:Wf,hydrateOnMediaQuery:Gf,hydrateOnVisible:Kf,initCustomFormatter:Xf,initDirectivesForSSR:Yf,inject:Qf,isMemoSame:Zf,isProxy:Jf,isReactive:em,isReadonly:tm,isRef:nm,isRuntimeOnly:im,isShallow:rm,isVNode:sm,markRaw:go,mergeDefaults:om,mergeModels:am,mergeProps:lm,nextTick:um,nodeOps:cm,normalizeClass:dm,normalizeProps:hm,normalizeStyle:pm,onActivated:fm,onBeforeMount:mm,onBeforeUnmount:gm,onBeforeUpdate:ym,onDeactivated:bm,onErrorCaptured:vm,onMounted:yo,onRenderTracked:_m,onRenderTriggered:wm,onScopeDispose:Sm,onServerPrefetch:Fm,onUnmounted:Pm,onUpdated:Tm,onWatcherCleanup:Cm,openBlock:q,patchProp:Em,popScopeId:xm,provide:At,proxyRefs:km,pushScopeId:Um,queuePostFlushCb:Om,reactive:Am,readonly:Rm,ref:st,registerRuntimeCompiler:Im,render:Dm,renderList:bo,renderSlot:Nm,resolveComponent:re,resolveDirective:Bm,resolveDynamicComponent:Lm,resolveFilter:Mm,resolveTransitionHooks:$m,setBlockTracking:zm,setDevtoolsHook:jm,setTransitionHooks:qm,shallowReactive:Hm,shallowReadonly:Vm,shallowRef:Wm,ssrContextKey:Gm,ssrUtils:Km,stop:Xm,toDisplayString:L,toHandlerKey:Ym,toHandlers:Qm,toRaw:Zm,toRef:Jm,toRefs:eg,toValue:tg,transformVNodeArgs:ng,triggerRef:ig,unref:vn,useAttrs:rg,useCssModule:sg,useCssVars:og,useHost:ag,useId:lg,useModel:ug,useSSRContext:cg,useShadowRoot:dg,useSlots:hg,useTemplateRef:pg,useTransitionState:fg,vModelCheckbox:mg,vModelDynamic:gg,vModelRadio:yg,vModelSelect:bg,vModelText:Kr,vShow:vg,version:_g,warn:wg,watch:Sg,watchEffect:Fg,watchPostEffect:Pg,watchSyncEffect:Tg,withAsyncContext:Cg,withCtx:we,withDefaults:Eg,withDirectives:Xr,withKeys:xg,withMemo:kg,withModifiers:Ug,withScopeId:Og}=po,{Fieldtype:Rt,IndexFieldtype:Ag,FieldtypeMixin:Rg,HasActionsMixin:Ig,HasInputOptionsMixin:Dg,HasPreferencesMixin:Ng,IndexFieldtypeMixin:Bg,InlineEditForm:Lg,DateFormatter:Mg,ItemActions:$g,RelatedItem:zg,RestoreRevision:jg,RevisionHistory:qg,RevisionPreview:Hg,SaveButtonOptions:Vg,SortableList:Wg,requireElevatedSession:Gg,requireElevatedSessionIf:Kg,clone:Xg,deepClone:Yg,resetValuesFromResponse:Qg}=__STATAMIC__.core,{Alert:Zg,AuthCard:Jg,Avatar:ey,Badge:ty,Button:ny,ButtonGroup:iy,Calendar:ry,Card:sy,CardList:oy,CardListItem:ay,CardPanel:ly,CharacterCounter:uy,Checkbox:cy,CheckboxGroup:dy,CodeEditor:hy,Combobox:Yr,CommandPaletteItem:py,ConfirmationModal:fy,Context:my,ContextFooter:gy,ContextHeader:yy,ContextItem:by,ContextLabel:vy,ContextMenu:_y,ContextSeparator:wy,CreateForm:Sy,DatePicker:Fy,DateRangePicker:Py,Description:Ty,DocsCallout:vo,DragHandle:Cy,Dropdown:Ey,DropdownItem:xy,DropdownLabel:ky,DropdownMenu:Uy,DropdownSeparator:Oy,DropdownFooter:Ay,DropdownHeader:Ry,Editable:Iy,ErrorMessage:Dy,EmptyStateItem:Ny,EmptyStateMenu:By,Field:Ly,Header:My,Heading:$y,HoverCard:zy,Icon:jy,Input:qy,InputGroup:Hy,InputGroupAppend:Vy,InputGroupPrepend:Wy,Label:Gy,Listing:Ky,ListingCustomizeColumns:Xy,ListingFilters:Yy,ListingHeaderCell:Qy,ListingPagination:Zy,ListingPresets:Jy,ListingPresetTrigger:e0,ListingRowActions:t0,ListingSearch:n0,ListingTable:i0,ListingTableBody:r0,ListingTableHead:s0,ListingToggleAll:o0,LivePreview:a0,LivePreviewPopout:l0,Modal:u0,ModalClose:c0,ModalTitle:d0,Pagination:h0,Panel:p0,PanelFooter:f0,PanelHeader:m0,Popover:g0,PublishComponents:y0,PublishContainer:b0,publishContextKey:v0,injectPublishContext:_0,PublishField:w0,PublishFields:S0,PublishFieldsProvider:F0,PublishForm:P0,PublishLocalizations:T0,PublishSections:C0,PublishTabs:E0,Radio:x0,RadioGroup:k0,Select:U0,Separator:O0,Slider:A0,Skeleton:R0,SplitterGroup:I0,SplitterPanel:D0,SplitterResizeHandle:N0,StatusIndicator:B0,Subheading:L0,Switch:M0,TabContent:$0,Stack:z0,StackClose:j0,StackHeader:q0,StackFooter:H0,StackContent:V0,Table:W0,TableCell:G0,TableColumn:K0,TableColumns:X0,TableRow:Y0,TableRows:Q0,TabList:Z0,TabProvider:J0,Tabs:e1,TabTrigger:t1,Textarea:n1,TimePicker:i1,ToggleGroup:r1,ToggleItem:s1,Widget:o1,registerIconSet:a1,registerIconSetFromStrings:l1}=__STATAMIC__.ui,_o=["textContent"],wo={__name:"Bunny",props:Rt.props,emits:Rt.emits,setup(n,{expose:e,emit:t}){const i=t,r=n,{expose:s,update:o}=Rt.use(i,r);e(s);const a=st(null),u=st(!0),l=st([]),d=st([]),h=fo(()=>{let T=r.value||[];return(typeof T=="string"||typeof T=="number")&&(T=[T]),T.map(k=>d.value.find(S=>S.value===k)||{value:k,label:k})});function b(){fetch(`https://video.bunnycdn.com/library/${r.meta.library}/videos?page=1&itemsPerPage=100&orderBy=date`,{headers:{Accept:"application/json",AccessKey:r.meta.api}}).then(T=>T.json()).then(T=>{l.value=T,u.value=!1,v()}).catch(T=>{console.error(T)})}function v(){l.value.items.forEach(T=>{d.value.push({value:T.guid,label:`${T.title} (${new Date(T.dateUploaded).toLocaleString()})`})})}function E(T){o(T?T.value:null)}return yo(()=>{b()}),(T,k)=>(q(),H("div",null,[Q(vn(Yr),{ref_key:"input",ref:a,class:"flex-1",clearable:!1,disabled:!1,options:d.value,placeholder:T.__("Select Video..."),searchable:!0,multiple:!1,"close-on-select":!0,"model-value":h.value,"onUpdate:modelValue":E,onFocus:k[0]||(k[0]=S=>T.$emit("focus")),onBlur:k[1]||(k[1]=S=>T.$emit("blur"))},{option:we(({label:S})=>[be(L(S),1)]),"selected-option":we(({label:S})=>[be(L(S),1)]),"no-options":we(()=>[A("div",{class:"text-sm text-gray-700 text-left py-2 px-4",textContent:L(T.__("No options to choose from."))},null,8,_o)]),_:1},8,["options","placeholder","model-value"])]))}},{Form:u1,Head:So,Link:c1,router:d1,toggleArchitecturalBackground:h1,useArchitecturalBackground:p1,useForm:f1,usePoll:m1}=__STATAMIC__.inertia,oe=(n,e)=>{const t=n.__vccOpts||n;for(const[i,r]of e)t[i]=r;return t},Fo={},Po={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"};function To(n,e){return q(),H("svg",Po,[...e[0]||(e[0]=[A("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v6m3-3H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])])}const Co=oe(Fo,[["render",To]]),Eo={},xo={"aria-hidden":"true",viewBox:"0 0 100 101",style:{color:"#eef2f6"},fill:"#2D9EFC",xmlns:"http://www.w3.org/2000/svg"};function ko(n,e){return q(),H("svg",xo,[...e[0]||(e[0]=[A("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"currentColor"},null,-1),A("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentFill"},null,-1)])])}const Qr=oe(Eo,[["render",ko]]),Uo={},Oo={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"};function Ao(n,e){return q(),H("svg",Oo,[...e[0]||(e[0]=[A("path",{"fill-rule":"evenodd",d:"M10.5 3.75a6 6 0 00-5.98 6.496A5.25 5.25 0 006.75 20.25H18a4.5 4.5 0 002.206-8.423 3.75 3.75 0 00-4.133-4.303A6.001 6.001 0 0010.5 3.75zm2.03 5.47a.75.75 0 00-1.06 0l-3 3a.75.75 0 101.06 1.06l1.72-1.72v4.94a.75.75 0 001.5 0v-4.94l1.72 1.72a.75.75 0 101.06-1.06l-3-3z","clip-rule":"evenodd"},null,-1)])])}const Ro=oe(Uo,[["render",Ao]]),Io={},Do={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"};function No(n,e){return q(),H("svg",Do,[...e[0]||(e[0]=[A("path",{d:"M12 15a3 3 0 100-6 3 3 0 000 6z"},null,-1),A("path",{"fill-rule":"evenodd",d:"M1.323 11.447C2.811 6.976 7.028 3.75 12.001 3.75c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113-1.487 4.471-5.705 7.697-10.677 7.697-4.97 0-9.186-3.223-10.675-7.69a1.762 1.762 0 010-1.113zM17.25 12a5.25 5.25 0 11-10.5 0 5.25 5.25 0 0110.5 0z","clip-rule":"evenodd"},null,-1)])])}const Bo=oe(Io,[["render",No]]),Lo={},Mo={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"};function $o(n,e){return q(),H("svg",Mo,[...e[0]||(e[0]=[A("path",{"fill-rule":"evenodd",d:"M4.25 5.5a.75.75 0 00-.75.75v8.5c0 .414.336.75.75.75h8.5a.75.75 0 00.75-.75v-4a.75.75 0 011.5 0v4A2.25 2.25 0 0112.75 17h-8.5A2.25 2.25 0 012 14.75v-8.5A2.25 2.25 0 014.25 4h5a.75.75 0 010 1.5h-5z","clip-rule":"evenodd"},null,-1),A("path",{"fill-rule":"evenodd",d:"M6.194 12.753a.75.75 0 001.06.053L16.5 4.44v2.81a.75.75 0 001.5 0v-4.5a.75.75 0 00-.75-.75h-4.5a.75.75 0 000 1.5h2.553l-9.056 8.194a.75.75 0 00-.053 1.06z","clip-rule":"evenodd"},null,-1)])])}const zo=oe(Lo,[["render",$o]]),jo={},qo={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"};function Ho(n,e){return q(),H("svg",qo,[...e[0]||(e[0]=[A("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"},null,-1)])])}const Vo=oe(jo,[["render",Ho]]),Wo={},Go={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"};function Ko(n,e){return q(),H("svg",Go,[...e[0]||(e[0]=[A("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"},null,-1),A("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1)])])}const Xo=oe(Wo,[["render",Ko]]);function Yo(n){return{all:n=n||new Map,on:function(e,t){var i=n.get(e);i?i.push(t):n.set(e,[t])},off:function(e,t){var i=n.get(e);i&&(t?i.splice(i.indexOf(t)>>>0,1):n.set(e,[]))},emit:function(e,t){var i=n.get(e);i&&i.slice().map(function(r){r(t)}),(i=n.get("*"))&&i.slice().map(function(r){r(e,t)})}}}const ge=Yo(),Qo={components:{CogIcon:Xo,Combobox:Yr},inject:["bunnyApiKey","bunnyHostname","bunnyLibrary"],props:{id:String,title:String,assetOptions:[]},data(){return{isOpen:!1,videoTitle:this.title,selectedThumbnails:[]}},methods:{save(){this.title!==this.videoTitle&&(this.$progress.start("title"),this.changeTitle()),this.selectedThumbnails.length>0&&(this.$progress.start("thumbnail"),this.changeThumbnail()),this.isOpen=!1},changeTitle(){fetch(`https://video.bunnycdn.com/library/${this.bunnyLibrary}/videos/${this.id}`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/*+json",AccessKey:this.bunnyApiKey},body:JSON.stringify({title:this.videoTitle})}).then(n=>{if(!n.ok)throw new Error(`Failed to update title: ${n.status}`);this.$toast.success(__("Video title has been updated!")),this.$progress.complete("title"),ge.emit("load")}).catch(n=>{this.$toast.error(__("An error occured while trying to update the video title.")),this.$progress.complete("title"),console.error(n)})},changeThumbnail(){fetch(`https://video.bunnycdn.com/library/${this.bunnyLibrary}/videos/${this.id}/thumbnail?thumbnailUrl=${this.selectedThumbnails[0].url}`,{method:"POST",headers:{Accept:"application/json",AccessKey:this.bunnyApiKey}}).then(n=>{if(!n.ok)throw new Error(`Failed to update thumbnail: ${n.status}`);this.$toast.success(__("Thumbnail has been updated!")),this.thumbnailUrl=null,this.$progress.complete("thumbnail"),ge.emit("load")}).catch(n=>{this.$toast.error(__("An error occured while trying to update the thumbnail.")),this.$progress.complete("thumbnail"),console.error(n)})},selectThumbnail(n){this.selectedThumbnails=[n]}}},Zo={class:"flex flex-col h-full"},Jo={class:"text-lg font-semibold px-5 py-3 bg-gray-200 rounded-t-lg flex items-center justify-between border-b"},ea={class:"flex-1 px-5 py-6 text-gray"},ta={class:"px-2 m-0 @container form-group publish-field text-fieldtype w-full"},na={for:"title",class:"block"},ia={class:"input-group"},ra={class:"px-2 m-0 @container form-group publish-field text-fieldtype w-full"},sa={for:"thumbnail",class:"block"},oa={class:"input-group"},aa=["textContent"],la={class:"px-5 py-3 bg-gray-200 rounded-b-lg border-t flex items-center justify-end text-sm"},ua=["textContent"],ca=["textContent"];function da(n,e,t,i,r,s){const o=re("CogIcon"),a=re("Combobox"),u=re("modal");return q(),H("div",null,[A("button",{onClick:e[0]||(e[0]=l=>r.isOpen=!0)},[Q(o,{class:"size-5"})]),Q(u,{open:r.isOpen,"onUpdate:open":e[4]||(e[4]=l=>r.isOpen=l),name:"settings"},{default:we(()=>[A("div",Zo,[A("header",Jo,L(n.__("Video Settings")),1),A("div",ea,[A("div",ta,[A("label",na,L(n.__("Title")),1),A("div",ia,[Xr(A("input",{type:"text",id:"title",name:"title","onUpdate:modelValue":e[1]||(e[1]=l=>r.videoTitle=l),class:"input-text"},null,512),[[Kr,r.videoTitle]])])]),A("div",ra,[A("label",sa,L(n.__("Thumbnail")),1),A("div",oa,[Q(a,{ref:"input",class:"flex-1",clearable:!1,disabled:!1,options:t.assetOptions,placeholder:n.__("Select new thumbnail"),searchable:!0,multiple:!1,"close-on-select":!0,"model-value":r.selectedThumbnails,"onUpdate:modelValue":s.selectThumbnail},{option:we(({label:l})=>[be(L(l),1)]),"selected-option":we(({label:l})=>[be(L(l),1)]),"no-options":we(()=>[A("div",{class:"text-sm text-gray-700 text-left py-2 px-4",textContent:L(n.__("No options to choose from."))},null,8,aa)]),_:1},8,["options","placeholder","model-value","onUpdate:modelValue"])])])]),A("div",la,[A("button",{class:"text-gray hover:text-gray-900",onClick:e[2]||(e[2]=l=>r.isOpen=!1),textContent:L(n.__("Cancel"))},null,8,ua),A("button",{class:"ml-4 btn-primary",textContent:L(n.__("Save")),onClick:e[3]||(e[3]=(...l)=>s.save&&s.save(...l))},null,8,ca)])])]),_:1},8,["open"])])}const ha=oe(Qo,[["render",da]]),pa={components:{VideoSettings:ha,CloudIcon:Ro,LinkIcon:zo,TrashIcon:Vo,SpinnerIcon:Qr,EyeIcon:Bo},inject:["bunnyApiKey","bunnyHostname","bunnyLibrary"],props:{video:Object,assetOptions:Array},data(){return{currentVideo:this.video,isLoading:!1,thumbnailUrl:`https://${this.bunnyHostname}/${this.video.guid}/${this.video.thumbnailFileName}`,videoUrl:`https://iframe.mediadelivery.net/play/${this.video.videoLibraryId}/${this.video.guid}`,triggerDeletion:!1}},mounted(){this.currentVideo.status<4&&(this.polling=setInterval(()=>{this.loadVideo()},5e3))},methods:{confirmDeletion(){this.triggerDeletion=!0},loadVideo(){this.isLoading=!0,fetch(`https://video.bunnycdn.com/library/${this.bunnyLibrary}/videos/${this.currentVideo.guid}`,{headers:{Accept:"application/json",AccessKey:this.bunnyApiKey}}).then(n=>n.json()).then(n=>{this.currentVideo=n,this.currentVideo.status>=4&&(clearInterval(this.polling),ge.emit("load"))}).catch(n=>{console.error(n)}).finally(()=>{this.isLoading=!1})},deleteVideo(){this.isLoading=!0,fetch(`https://video.bunnycdn.com/library/${this.bunnyLibrary}/videos/${this.currentVideo.guid}`,{method:"DELETE",headers:{Accept:"application/json",AccessKey:this.bunnyApiKey}}).then(()=>{this.cancelDeletion(),clearInterval(this.polling),ge.emit("load")}).catch(n=>{console.error(n)}).finally(()=>{this.isLoading=!1})},cancelDeletion(){this.triggerDeletion=!1}}},fa={key:0,class:"sm:grid sm:grid-cols-3 overflow-hidden bg-white rounded shadow-xl w-full mb-4"},ma=["href"],ga=["src"],ya={class:"sm:col-span-2 py-2 sm:py-4 px-2 sm:px-6 text-gray-800 flex flex-col justify-between gap-1"},ba={class:"flex sm:flex-grow items-start justify-between gap-4 w-full"},va=["href"],_a={class:"flex gap-1"},wa={class:"flex gap-2 md:gap-4 items-center justify-start text-xs md:text-sm whitespace-nowrap"},Sa=["href"],Fa={class:"text-xs md:text-sm text-gray-600 flex justify-between"},Pa={class:"flex gap-2 items-center"},Ta={class:"flex gap-2 items-center"},Ca={key:1,class:"flex flex-col overflow-hidden bg-white rounded shadow-xl w-full mb-4 p-6 items-center justify-center"},Ea={class:"text-lg"},xa={class:"text-xs text-gray-600"},ka={role:"status",class:"mt-4 mx-auto"},Ua={class:"sr-only"};function Oa(n,e,t,i,r,s){const o=re("VideoSettings"),a=re("TrashIcon"),u=re("LinkIcon"),l=re("CloudIcon"),d=re("EyeIcon"),h=re("SpinnerIcon"),b=re("ui-confirmation-modal");return q(),H("div",null,[r.currentVideo.status>=4?(q(),H("div",fa,[A("a",{href:r.videoUrl,target:"_blank",class:""},[A("img",{src:r.thumbnailUrl,class:"aspect-video inset-0 h-full object-cover w-full"},null,8,ga)],8,ma),A("div",ya,[A("div",ba,[A("a",{href:r.videoUrl,target:"_blank",class:"flex-grow min-w-0 font-semibold text-base sm:text-lg leading-tight truncate"},L(r.currentVideo.title),9,va),A("div",_a,[Q(o,{id:r.currentVideo.guid,title:r.currentVideo.title,assetOptions:t.assetOptions},null,8,["id","title","assetOptions"]),A("button",{class:"size-5",onClick:e[0]||(e[0]=v=>s.confirmDeletion())},[Q(a,{class:"size-5"})])])]),A("p",wa,[A("a",{href:r.thumbnailUrl,target:"_blank",class:"flex gap-1 items-center"},[be(L(n.__("Thumbnail"))+" ",1),Q(u,{class:"size-4"})],8,Sa)]),A("div",Fa,[A("div",Pa,[Q(l,{class:"text-gray-500 size-4"}),be(" "+L(new Date(r.currentVideo.dateUploaded).toLocaleString()),1)]),A("div",Ta,[Q(d,{class:"text-gray-500 size-4"}),be(" "+L(r.currentVideo.views),1)])])])])):(q(),H("div",Ca,[A("h2",Ea,L(n.__("Video is being processed"))+" – "+L(r.currentVideo.encodeProgress*2)+"% ",1),A("p",xa,L(n.__("This may take some time.")),1),A("button",{class:"text-xs text-red-500",onClick:e[1]||(e[1]=v=>s.confirmDeletion())},L(n.__("Cancel and delete video")),1),A("div",ka,[Q(h,{class:"w-8 h-8 mr-2 animate-spin"}),A("span",Ua,L(n.__("Loading...")),1)])])),Q(b,{open:r.triggerDeletion,"onUpdate:open":e[2]||(e[2]=v=>r.triggerDeletion=v),title:n.__("Delete video :title",{title:r.currentVideo.title}),onConfirm:s.deleteVideo,onCancel:s.cancelDeletion,danger:"true"},null,8,["open","title","onConfirm","onCancel"])])}const Aa=oe(pa,[["render",Oa]]);var ke=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ve(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var ot={exports:{}},ai;function Ra(){if(ai)return ot.exports;ai=1;function n(e,t=100,i={}){if(typeof e!="function")throw new TypeError(`Expected the first parameter to be a function, got \`${typeof e}\`.`);if(t<0)throw new RangeError("`wait` must not be negative.");const{immediate:r}=typeof i=="boolean"?{immediate:i}:i;let s,o,a,u,l;function d(){const v=s,E=o;return s=void 0,o=void 0,l=e.apply(v,E),l}function h(){const v=Date.now()-u;v<t&&v>=0?a=setTimeout(h,t-v):(a=void 0,r||(l=d()))}const b=function(...v){if(s&&this!==s&&Object.getPrototypeOf(this)===Object.getPrototypeOf(s))throw new Error("Debounced method called with different contexts of the same prototype.");s=this,o=v,u=Date.now();const E=r&&!a;return a||(a=setTimeout(h,t)),E&&(l=d()),l};return Object.defineProperty(b,"isPending",{get(){return a!==void 0}}),b.clear=()=>{a&&(clearTimeout(a),a=void 0)},b.flush=()=>{a&&b.trigger()},b.trigger=()=>{l=d(),b.clear()},b}return ot.exports.debounce=n,ot.exports=n,ot.exports}var Ia=Ra();const Da=ve(Ia),Na={components:{PlusCircleIcon:Co,SpinnerIcon:Qr,VideoCard:Aa},inject:["bunnyApiKey","bunnyLibrary"],data(){return{search:"",loading:!0,polling:null,result:null,page:1,maxPage:1,itemsPerPage:10,assetOptions:[]}},created(){this.getVideos(),this.getAssets(),ge.on("load",n=>{n&&n.page&&(this.page=n.page),this.getVideos()})},methods:{getAssets(){fetch("/cp/bunny/assets/",{headers:{Accept:"application/json"}}).then(n=>n.json()).then(n=>{this.assetOptions=n.items}).catch(n=>{console.error(n)})},getVideos(){let n=`https://video.bunnycdn.com/library/${this.bunnyLibrary}/videos?page=${this.page}&itemsPerPage=${this.itemsPerPage}&orderBy=date`;this.search!==""&&(n+=`&search=${this.search}`),fetch(n,{headers:{Accept:"application/json",AccessKey:this.bunnyApiKey}}).then(e=>e.json()).then(e=>{this.maxPage=Math.ceil(e.totalItems/this.itemsPerPage),this.result=e,this.loading=!1}).catch(e=>{console.error(e)})},openUpload(){ge.emit("upload")},debouncedSearch:Da(()=>{ge.emit("load",{page:1})},500),nextPage(){this.page++,this.page>this.maxPage&&(this.page=1),this.getVideos()},prevPage(){this.page--,this.page<=0&&(this.page=this.maxPage),this.getVideos()}}},Ba={class:"container w-full lg:w-4/5 mx-auto input-group mb-4"},La=["placeholder"],Ma={key:0,class:"flex items-center"},$a={role:"status",class:"mt-4 mx-auto"},za={class:"sr-only"},ja={key:1},qa={id:"card"},Ha={class:"container w-full lg:w-4/5 mx-auto"},Va={class:"flex flex-col"},Wa={key:0,class:"flex items-center justify-between"},Ga={key:2,class:"text-center text-sm"},Ka={class:"text-xl"};function Xa(n,e,t,i,r,s){const o=re("SpinnerIcon"),a=re("VideoCard"),u=re("PlusCircleIcon");return q(),H("div",null,[A("div",Ba,[Xr(A("input",{type:"text",placeholder:n.__("Search videos"),onInput:e[0]||(e[0]=(...l)=>s.debouncedSearch&&s.debouncedSearch(...l)),"onUpdate:modelValue":e[1]||(e[1]=l=>r.search=l),class:"input-text"},null,40,La),[[Kr,r.search]])]),r.loading?(q(),H("div",Ma,[A("div",$a,[Q(o,{class:"w-8 h-8 mr-2 animate-spin"}),A("span",za,L(n.__("Loading...")),1)])])):!r.loading&&r.result.totalItems>=1?(q(),H("div",ja,[A("div",qa,[A("div",Ha,[A("div",Va,[(q(!0),H(bn,null,bo(r.result.items,l=>(q(),Gr(a,{key:l.guid,video:l,assetOptions:r.assetOptions},null,8,["video","assetOptions"]))),128))]),r.result.totalItems>r.result.items.length?(q(),H("div",Wa,[A("button",{class:"btn-primary",onClick:e[2]||(e[2]=(...l)=>s.prevPage&&s.prevPage(...l))}," « "),A("div",null,L(r.page)+" / "+L(r.maxPage),1),A("button",{class:"btn-primary",onClick:e[3]||(e[3]=(...l)=>s.nextPage&&s.nextPage(...l))}," » ")])):mo("",!0)])])])):r.search.length>0?(q(),H("div",Ga,L(n.__("No videos found.")),1)):(q(),H("button",{key:3,onClick:e[4]||(e[4]=l=>s.openUpload()),class:"flex flex-col overflow-hidden border-gray-600 border-dashed border-2 rounded shadow-xl w-full mb-4 p-6 items-center justify-center"},[A("h2",Ka,L(n.__("Upload Video")),1),Q(u,{class:"h-10 w-10"})]))])}const Ya=oe(Na,[["render",Xa]]),Qa={},Za={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor"};function Ja(n,e){return q(),H("svg",Za,[...e[0]||(e[0]=[A("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v12m6-6H6"},null,-1)])])}const el=oe(Qa,[["render",Ja]]);function tl(n,e,t){const i=[];return n.forEach(r=>typeof r!="string"?i.push(r):e[Symbol.split](r).forEach((s,o,a)=>{s!==""&&i.push(s),o<a.length-1&&i.push(t)})),i}/**
 * Takes a string with placeholder variables like `%{smart_count} file selected`
 * and replaces it with values from options `{smart_count: 5}`
 *
 * @license https://github.com/airbnb/polyglot.js/blob/master/LICENSE
 * taken from https://github.com/airbnb/polyglot.js/blob/master/lib/polyglot.js#L299
 *
 * @param phrase that needs interpolation, with placeholders
 * @param options with values that will be used to replace placeholders
 */function li(n,e){const t=/\$/g,i="$$$$";let r=[n];if(e==null)return r;for(const s of Object.keys(e))if(s!=="_"){let o=e[s];typeof o=="string"&&(o=t[Symbol.replace](o,i)),r=tl(r,new RegExp(`%\\{${s}\\}`,"g"),o)}return r}const nl=n=>{throw new Error(`missing string: ${n}`)};class Zr{locale;constructor(e,{onMissingKey:t=nl}={}){this.locale={strings:{},pluralize(i){return i===1?0:1}},Array.isArray(e)?e.forEach(this.#t,this):this.#t(e),this.#e=t}#e;#t(e){if(!e?.strings)return;const t=this.locale;Object.assign(this.locale,{strings:{...t.strings,...e.strings},pluralize:e.pluralize||t.pluralize})}translate(e,t){return this.translateArray(e,t).join("")}translateArray(e,t){let i=this.locale.strings[e];if(i==null&&(this.#e(e),i=e),typeof i=="object"){if(t&&typeof t.smart_count<"u"){const s=this.locale.pluralize(t.smart_count);return li(i[s],t)}throw new Error("Attempted to use a string with plural forms, but no value was given for %{smart_count}")}if(typeof i!="string")throw new Error("string was not a string");return li(i,t)}}class $n{uppy;opts;id;defaultLocale;i18n;i18nArray;type;VERSION;constructor(e,t){this.uppy=e,this.opts=t??{}}getPluginState(){const{plugins:e}=this.uppy.getState();return e?.[this.id]||{}}setPluginState(e){const{plugins:t}=this.uppy.getState();this.uppy.setState({plugins:{...t,[this.id]:{...t[this.id],...e}}})}setOptions(e){this.opts={...this.opts,...e},this.setPluginState(void 0),this.i18nInit()}i18nInit(){const e=new Zr([this.defaultLocale,this.uppy.locale,this.opts.locale]);this.i18n=e.translate.bind(e),this.i18nArray=e.translateArray.bind(e),this.setPluginState(void 0)}addTarget(e){throw new Error("Extend the addTarget method to add your plugin to another plugin's target")}install(){}uninstall(){}update(e){}afterUpdate(){}}function It(n){return n<10?`0${n}`:n.toString()}function wt(){const n=new Date,e=It(n.getHours()),t=It(n.getMinutes()),i=It(n.getSeconds());return`${e}:${t}:${i}`}const il={debug:()=>{},warn:()=>{},error:(...n)=>console.error(`[Uppy] [${wt()}]`,...n)},rl={debug:(...n)=>console.debug(`[Uppy] [${wt()}]`,...n),warn:(...n)=>console.warn(`[Uppy] [${wt()}]`,...n),error:(...n)=>console.error(`[Uppy] [${wt()}]`,...n)};function Jr(n){return typeof n!="object"||n===null||!("nodeType"in n)?!1:n.nodeType===Node.ELEMENT_NODE}function sl(n,e=document){return typeof n=="string"?e.querySelector(n):Jr(n)?n:null}function es(n){for(;n&&!n.dir;)n=n.parentNode;return n?.dir}var nt,N,ts,_e,ui,ns,is,rs,zn,_n,wn,He={},ss=[],ol=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,it=Array.isArray;function me(n,e){for(var t in e)n[t]=e[t];return n}function jn(n){n&&n.parentNode&&n.parentNode.removeChild(n)}function Ve(n,e,t){var i,r,s,o={};for(s in e)s=="key"?i=e[s]:s=="ref"?r=e[s]:o[s]=e[s];if(arguments.length>2&&(o.children=arguments.length>3?nt.call(arguments,2):t),typeof n=="function"&&n.defaultProps!=null)for(s in n.defaultProps)o[s]===void 0&&(o[s]=n.defaultProps[s]);return je(n,o,i,r,null)}function je(n,e,t,i,r){var s={type:n,props:e,key:t,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:r??++ts,__i:-1,__u:0};return r==null&&N.vnode!=null&&N.vnode(s),s}function al(){return{current:null}}function de(n){return n.children}function se(n,e){this.props=n,this.context=e}function Re(n,e){if(e==null)return n.__?Re(n.__,n.__i+1):null;for(var t;e<n.__k.length;e++)if((t=n.__k[e])!=null&&t.__e!=null)return t.__e;return typeof n.type=="function"?Re(n):null}function os(n){var e,t;if((n=n.__)!=null&&n.__c!=null){for(n.__e=n.__c.base=null,e=0;e<n.__k.length;e++)if((t=n.__k[e])!=null&&t.__e!=null){n.__e=n.__c.base=t.__e;break}return os(n)}}function ci(n){(!n.__d&&(n.__d=!0)&&_e.push(n)&&!Et.__r++||ui!=N.debounceRendering)&&((ui=N.debounceRendering)||ns)(Et)}function Et(){for(var n,e,t,i,r,s,o,a=1;_e.length;)_e.length>a&&_e.sort(is),n=_e.shift(),a=_e.length,n.__d&&(t=void 0,i=void 0,r=(i=(e=n).__v).__e,s=[],o=[],e.__P&&((t=me({},i)).__v=i.__v+1,N.vnode&&N.vnode(t),qn(e.__P,t,i,e.__n,e.__P.namespaceURI,32&i.__u?[r]:null,s,r??Re(i),!!(32&i.__u),o),t.__v=i.__v,t.__.__k[t.__i]=t,us(s,t,o),i.__e=i.__=null,t.__e!=r&&os(t)));Et.__r=0}function as(n,e,t,i,r,s,o,a,u,l,d){var h,b,v,E,T,k,S,m=i&&i.__k||ss,y=e.length;for(u=ll(t,e,m,u,y),h=0;h<y;h++)(v=t.__k[h])!=null&&(b=v.__i==-1?He:m[v.__i]||He,v.__i=h,k=qn(n,v,b,r,s,o,a,u,l,d),E=v.__e,v.ref&&b.ref!=v.ref&&(b.ref&&Hn(b.ref,null,v),d.push(v.ref,v.__c||E,v)),T==null&&E!=null&&(T=E),(S=!!(4&v.__u))||b.__k===v.__k?u=ls(v,u,n,S):typeof v.type=="function"&&k!==void 0?u=k:E&&(u=E.nextSibling),v.__u&=-7);return t.__e=T,u}function ll(n,e,t,i,r){var s,o,a,u,l,d=t.length,h=d,b=0;for(n.__k=new Array(r),s=0;s<r;s++)(o=e[s])!=null&&typeof o!="boolean"&&typeof o!="function"?(typeof o=="string"||typeof o=="number"||typeof o=="bigint"||o.constructor==String?o=n.__k[s]=je(null,o,null,null,null):it(o)?o=n.__k[s]=je(de,{children:o},null,null,null):o.constructor===void 0&&o.__b>0?o=n.__k[s]=je(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):n.__k[s]=o,u=s+b,o.__=n,o.__b=n.__b+1,a=null,(l=o.__i=ul(o,t,u,h))!=-1&&(h--,(a=t[l])&&(a.__u|=2)),a==null||a.__v==null?(l==-1&&(r>d?b--:r<d&&b++),typeof o.type!="function"&&(o.__u|=4)):l!=u&&(l==u-1?b--:l==u+1?b++:(l>u?b--:b++,o.__u|=4))):n.__k[s]=null;if(h)for(s=0;s<d;s++)(a=t[s])!=null&&(2&a.__u)==0&&(a.__e==i&&(i=Re(a)),ds(a,a));return i}function ls(n,e,t,i){var r,s;if(typeof n.type=="function"){for(r=n.__k,s=0;r&&s<r.length;s++)r[s]&&(r[s].__=n,e=ls(r[s],e,t,i));return e}n.__e!=e&&(i&&(e&&n.type&&!e.parentNode&&(e=Re(n)),t.insertBefore(n.__e,e||null)),e=n.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function ue(n,e){return e=e||[],n==null||typeof n=="boolean"||(it(n)?n.some(function(t){ue(t,e)}):e.push(n)),e}function ul(n,e,t,i){var r,s,o,a=n.key,u=n.type,l=e[t],d=l!=null&&(2&l.__u)==0;if(l===null&&a==null||d&&a==l.key&&u==l.type)return t;if(i>(d?1:0)){for(r=t-1,s=t+1;r>=0||s<e.length;)if((l=e[o=r>=0?r--:s++])!=null&&(2&l.__u)==0&&a==l.key&&u==l.type)return o}return-1}function di(n,e,t){e[0]=="-"?n.setProperty(e,t??""):n[e]=t==null?"":typeof t!="number"||ol.test(e)?t:t+"px"}function at(n,e,t,i,r){var s,o;e:if(e=="style")if(typeof t=="string")n.style.cssText=t;else{if(typeof i=="string"&&(n.style.cssText=i=""),i)for(e in i)t&&e in t||di(n.style,e,"");if(t)for(e in t)i&&t[e]==i[e]||di(n.style,e,t[e])}else if(e[0]=="o"&&e[1]=="n")s=e!=(e=e.replace(rs,"$1")),o=e.toLowerCase(),e=o in n||e=="onFocusOut"||e=="onFocusIn"?o.slice(2):e.slice(2),n.l||(n.l={}),n.l[e+s]=t,t?i?t.u=i.u:(t.u=zn,n.addEventListener(e,s?wn:_n,s)):n.removeEventListener(e,s?wn:_n,s);else{if(r=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in n)try{n[e]=t??"";break e}catch{}typeof t=="function"||(t==null||t===!1&&e[4]!="-"?n.removeAttribute(e):n.setAttribute(e,e=="popover"&&t==1?"":t))}}function hi(n){return function(e){if(this.l){var t=this.l[e.type+n];if(e.t==null)e.t=zn++;else if(e.t<t.u)return;return t(N.event?N.event(e):e)}}}function qn(n,e,t,i,r,s,o,a,u,l){var d,h,b,v,E,T,k,S,m,y,_,w,U,O,I,R,j,$=e.type;if(e.constructor!==void 0)return null;128&t.__u&&(u=!!(32&t.__u),s=[a=e.__e=t.__e]),(d=N.__b)&&d(e);e:if(typeof $=="function")try{if(S=e.props,m="prototype"in $&&$.prototype.render,y=(d=$.contextType)&&i[d.__c],_=d?y?y.props.value:d.__:i,t.__c?k=(h=e.__c=t.__c).__=h.__E:(m?e.__c=h=new $(S,_):(e.__c=h=new se(S,_),h.constructor=$,h.render=dl),y&&y.sub(h),h.state||(h.state={}),h.__n=i,b=h.__d=!0,h.__h=[],h._sb=[]),m&&h.__s==null&&(h.__s=h.state),m&&$.getDerivedStateFromProps!=null&&(h.__s==h.state&&(h.__s=me({},h.__s)),me(h.__s,$.getDerivedStateFromProps(S,h.__s))),v=h.props,E=h.state,h.__v=e,b)m&&$.getDerivedStateFromProps==null&&h.componentWillMount!=null&&h.componentWillMount(),m&&h.componentDidMount!=null&&h.__h.push(h.componentDidMount);else{if(m&&$.getDerivedStateFromProps==null&&S!==v&&h.componentWillReceiveProps!=null&&h.componentWillReceiveProps(S,_),e.__v==t.__v||!h.__e&&h.shouldComponentUpdate!=null&&h.shouldComponentUpdate(S,h.__s,_)===!1){for(e.__v!=t.__v&&(h.props=S,h.state=h.__s,h.__d=!1),e.__e=t.__e,e.__k=t.__k,e.__k.some(function(W){W&&(W.__=e)}),w=0;w<h._sb.length;w++)h.__h.push(h._sb[w]);h._sb=[],h.__h.length&&o.push(h);break e}h.componentWillUpdate!=null&&h.componentWillUpdate(S,h.__s,_),m&&h.componentDidUpdate!=null&&h.__h.push(function(){h.componentDidUpdate(v,E,T)})}if(h.context=_,h.props=S,h.__P=n,h.__e=!1,U=N.__r,O=0,m){for(h.state=h.__s,h.__d=!1,U&&U(e),d=h.render(h.props,h.state,h.context),I=0;I<h._sb.length;I++)h.__h.push(h._sb[I]);h._sb=[]}else do h.__d=!1,U&&U(e),d=h.render(h.props,h.state,h.context),h.state=h.__s;while(h.__d&&++O<25);h.state=h.__s,h.getChildContext!=null&&(i=me(me({},i),h.getChildContext())),m&&!b&&h.getSnapshotBeforeUpdate!=null&&(T=h.getSnapshotBeforeUpdate(v,E)),R=d,d!=null&&d.type===de&&d.key==null&&(R=cs(d.props.children)),a=as(n,it(R)?R:[R],e,t,i,r,s,o,a,u,l),h.base=e.__e,e.__u&=-161,h.__h.length&&o.push(h),k&&(h.__E=h.__=null)}catch(W){if(e.__v=null,u||s!=null)if(W.then){for(e.__u|=u?160:128;a&&a.nodeType==8&&a.nextSibling;)a=a.nextSibling;s[s.indexOf(a)]=null,e.__e=a}else{for(j=s.length;j--;)jn(s[j]);Sn(e)}else e.__e=t.__e,e.__k=t.__k,W.then||Sn(e);N.__e(W,e,t)}else s==null&&e.__v==t.__v?(e.__k=t.__k,e.__e=t.__e):a=e.__e=cl(t.__e,e,t,i,r,s,o,u,l);return(d=N.diffed)&&d(e),128&e.__u?void 0:a}function Sn(n){n&&n.__c&&(n.__c.__e=!0),n&&n.__k&&n.__k.forEach(Sn)}function us(n,e,t){for(var i=0;i<t.length;i++)Hn(t[i],t[++i],t[++i]);N.__c&&N.__c(e,n),n.some(function(r){try{n=r.__h,r.__h=[],n.some(function(s){s.call(r)})}catch(s){N.__e(s,r.__v)}})}function cs(n){return typeof n!="object"||n==null||n.__b&&n.__b>0?n:it(n)?n.map(cs):me({},n)}function cl(n,e,t,i,r,s,o,a,u){var l,d,h,b,v,E,T,k=t.props||He,S=e.props,m=e.type;if(m=="svg"?r="http://www.w3.org/2000/svg":m=="math"?r="http://www.w3.org/1998/Math/MathML":r||(r="http://www.w3.org/1999/xhtml"),s!=null){for(l=0;l<s.length;l++)if((v=s[l])&&"setAttribute"in v==!!m&&(m?v.localName==m:v.nodeType==3)){n=v,s[l]=null;break}}if(n==null){if(m==null)return document.createTextNode(S);n=document.createElementNS(r,m,S.is&&S),a&&(N.__m&&N.__m(e,s),a=!1),s=null}if(m==null)k===S||a&&n.data==S||(n.data=S);else{if(s=s&&nt.call(n.childNodes),!a&&s!=null)for(k={},l=0;l<n.attributes.length;l++)k[(v=n.attributes[l]).name]=v.value;for(l in k)if(v=k[l],l!="children"){if(l=="dangerouslySetInnerHTML")h=v;else if(!(l in S)){if(l=="value"&&"defaultValue"in S||l=="checked"&&"defaultChecked"in S)continue;at(n,l,null,v,r)}}for(l in S)v=S[l],l=="children"?b=v:l=="dangerouslySetInnerHTML"?d=v:l=="value"?E=v:l=="checked"?T=v:a&&typeof v!="function"||k[l]===v||at(n,l,v,k[l],r);if(d)a||h&&(d.__html==h.__html||d.__html==n.innerHTML)||(n.innerHTML=d.__html),e.__k=[];else if(h&&(n.innerHTML=""),as(e.type=="template"?n.content:n,it(b)?b:[b],e,t,i,m=="foreignObject"?"http://www.w3.org/1999/xhtml":r,s,o,s?s[0]:t.__k&&Re(t,0),a,u),s!=null)for(l=s.length;l--;)jn(s[l]);a||(l="value",m=="progress"&&E==null?n.removeAttribute("value"):E!=null&&(E!==n[l]||m=="progress"&&!E||m=="option"&&E!=k[l])&&at(n,l,E,k[l],r),l="checked",T!=null&&T!=n[l]&&at(n,l,T,k[l],r))}return n}function Hn(n,e,t){try{if(typeof n=="function"){var i=typeof n.__u=="function";i&&n.__u(),i&&e==null||(n.__u=n(e))}else n.current=e}catch(r){N.__e(r,t)}}function ds(n,e,t){var i,r;if(N.unmount&&N.unmount(n),(i=n.ref)&&(i.current&&i.current!=n.__e||Hn(i,null,e)),(i=n.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(s){N.__e(s,e)}i.base=i.__P=null}if(i=n.__k)for(r=0;r<i.length;r++)i[r]&&ds(i[r],e,t||typeof n.type!="function");t||jn(n.__e),n.__c=n.__=n.__e=void 0}function dl(n,e,t){return this.constructor(n,t)}function hl(n,e,t){var i,r,s,o;e==document&&(e=document.documentElement),N.__&&N.__(n,e),r=(i=!1)?null:e.__k,s=[],o=[],qn(e,n=e.__k=Ve(de,null,[n]),r||He,He,e.namespaceURI,r?null:e.firstChild?nt.call(e.childNodes):null,s,r?r.__e:e.firstChild,i,o),us(s,n,o)}function hs(n,e,t){var i,r,s,o,a=me({},n.props);for(s in n.type&&n.type.defaultProps&&(o=n.type.defaultProps),e)s=="key"?i=e[s]:s=="ref"?r=e[s]:a[s]=e[s]===void 0&&o!=null?o[s]:e[s];return arguments.length>2&&(a.children=arguments.length>3?nt.call(arguments,2):t),je(n.type,a,i||n.key,r||n.ref,null)}nt=ss.slice,N={__e:function(n,e,t,i){for(var r,s,o;e=e.__;)if((r=e.__c)&&!r.__)try{if((s=r.constructor)&&s.getDerivedStateFromError!=null&&(r.setState(s.getDerivedStateFromError(n)),o=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(n,i||{}),o=r.__d),o)return r.__E=r}catch(a){n=a}throw n}},ts=0,se.prototype.setState=function(n,e){var t;t=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=me({},this.state),typeof n=="function"&&(n=n(me({},t),this.props)),n&&me(t,n),n!=null&&this.__v&&(e&&this._sb.push(e),ci(this))},se.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),ci(this))},se.prototype.render=de,_e=[],ns=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,is=function(n,e){return n.__v.__b-e.__v.__b},Et.__r=0,rs=/(PointerCapture)$|Capture$/i,zn=0,_n=hi(!1),wn=hi(!0);var We,G,Dt,pi,Ge=0,ps=[],K=N,fi=K.__b,mi=K.__r,gi=K.diffed,yi=K.__c,bi=K.unmount,vi=K.__;function Vn(n,e){K.__h&&K.__h(G,n,Ge||e),Ge=0;var t=G.__H||(G.__H={__:[],__h:[]});return n>=t.__.length&&t.__.push({}),t.__[n]}function xt(n){return Ge=1,pl(ms,n)}function pl(n,e,t){var i=Vn(We++,2);if(i.t=n,!i.__c&&(i.__=[t?t(e):ms(void 0,e),function(a){var u=i.__N?i.__N[0]:i.__[0],l=i.t(u,a);u!==l&&(i.__N=[l,i.__[1]],i.__c.setState({}))}],i.__c=G,!G.__f)){var r=function(a,u,l){if(!i.__c.__H)return!0;var d=i.__c.__H.__.filter(function(b){return!!b.__c});if(d.every(function(b){return!b.__N}))return!s||s.call(this,a,u,l);var h=i.__c.props!==a;return d.forEach(function(b){if(b.__N){var v=b.__[0];b.__=b.__N,b.__N=void 0,v!==b.__[0]&&(h=!0)}}),s&&s.call(this,a,u,l)||h};G.__f=!0;var s=G.shouldComponentUpdate,o=G.componentWillUpdate;G.componentWillUpdate=function(a,u,l){if(this.__e){var d=s;s=void 0,r(a,u,l),s=d}o&&o.call(this,a,u,l)},G.shouldComponentUpdate=r}return i.__N||i.__}function Fn(n,e){var t=Vn(We++,3);!K.__s&&fs(t.__H,e)&&(t.__=n,t.u=e,G.__H.__h.push(t))}function St(n){return Ge=5,Wn(function(){return{current:n}},[])}function Wn(n,e){var t=Vn(We++,7);return fs(t.__H,e)&&(t.__=n(),t.__H=e,t.__h=n),t.__}function fl(n,e){return Ge=8,Wn(function(){return n},e)}function ml(){for(var n;n=ps.shift();)if(n.__P&&n.__H)try{n.__H.__h.forEach(Ft),n.__H.__h.forEach(Pn),n.__H.__h=[]}catch(e){n.__H.__h=[],K.__e(e,n.__v)}}K.__b=function(n){G=null,fi&&fi(n)},K.__=function(n,e){n&&e.__k&&e.__k.__m&&(n.__m=e.__k.__m),vi&&vi(n,e)},K.__r=function(n){mi&&mi(n),We=0;var e=(G=n.__c).__H;e&&(Dt===G?(e.__h=[],G.__h=[],e.__.forEach(function(t){t.__N&&(t.__=t.__N),t.u=t.__N=void 0})):(e.__h.forEach(Ft),e.__h.forEach(Pn),e.__h=[],We=0)),Dt=G},K.diffed=function(n){gi&&gi(n);var e=n.__c;e&&e.__H&&(e.__H.__h.length&&(ps.push(e)!==1&&pi===K.requestAnimationFrame||((pi=K.requestAnimationFrame)||gl)(ml)),e.__H.__.forEach(function(t){t.u&&(t.__H=t.u),t.u=void 0})),Dt=G=null},K.__c=function(n,e){e.some(function(t){try{t.__h.forEach(Ft),t.__h=t.__h.filter(function(i){return!i.__||Pn(i)})}catch(i){e.some(function(r){r.__h&&(r.__h=[])}),e=[],K.__e(i,t.__v)}}),yi&&yi(n,e)},K.unmount=function(n){bi&&bi(n);var e,t=n.__c;t&&t.__H&&(t.__H.__.forEach(function(i){try{Ft(i)}catch(r){e=r}}),t.__H=void 0,e&&K.__e(e,t.__v))};var _i=typeof requestAnimationFrame=="function";function gl(n){var e,t=function(){clearTimeout(i),_i&&cancelAnimationFrame(e),setTimeout(n)},i=setTimeout(t,35);_i&&(e=requestAnimationFrame(t))}function Ft(n){var e=G,t=n.__c;typeof t=="function"&&(n.__c=void 0,t()),G=e}function Pn(n){var e=G;n.__c=n.__(),G=e}function fs(n,e){return!n||n.length!==e.length||e.some(function(t,i){return t!==n[i]})}function ms(n,e){return typeof e=="function"?e(n):e}function yl(n,e){for(var t in e)n[t]=e[t];return n}function wi(n,e){for(var t in n)if(t!=="__source"&&!(t in e))return!0;for(var i in e)if(i!=="__source"&&n[i]!==e[i])return!0;return!1}function Si(n,e){this.props=n,this.context=e}(Si.prototype=new se).isPureReactComponent=!0,Si.prototype.shouldComponentUpdate=function(n,e){return wi(this.props,n)||wi(this.state,e)};var Fi=N.__b;N.__b=function(n){n.type&&n.type.__f&&n.ref&&(n.props.ref=n.ref,n.ref=null),Fi&&Fi(n)};var bl=N.__e;N.__e=function(n,e,t,i){if(n.then){for(var r,s=e;s=s.__;)if((r=s.__c)&&r.__c)return e.__e==null&&(e.__e=t.__e,e.__k=t.__k),r.__c(n,e)}bl(n,e,t,i)};var Pi=N.unmount;function gs(n,e,t){return n&&(n.__c&&n.__c.__H&&(n.__c.__H.__.forEach(function(i){typeof i.__c=="function"&&i.__c()}),n.__c.__H=null),(n=yl({},n)).__c!=null&&(n.__c.__P===t&&(n.__c.__P=e),n.__c.__e=!0,n.__c=null),n.__k=n.__k&&n.__k.map(function(i){return gs(i,e,t)})),n}function ys(n,e,t){return n&&t&&(n.__v=null,n.__k=n.__k&&n.__k.map(function(i){return ys(i,e,t)}),n.__c&&n.__c.__P===e&&(n.__e&&t.appendChild(n.__e),n.__c.__e=!0,n.__c.__P=t)),n}function Nt(){this.__u=0,this.o=null,this.__b=null}function bs(n){if(!n.__)return null;var e=n.__.__c;return e&&e.__a&&e.__a(n)}function lt(){this.i=null,this.l=null}N.unmount=function(n){var e=n.__c;e&&(e.__z=!0),e&&e.__R&&e.__R(),e&&32&n.__u&&(n.type=null),Pi&&Pi(n)},(Nt.prototype=new se).__c=function(n,e){var t=e.__c,i=this;i.o==null&&(i.o=[]),i.o.push(t);var r=bs(i.__v),s=!1,o=function(){s||i.__z||(s=!0,t.__R=null,r?r(u):u())};t.__R=o;var a=t.__P;t.__P=null;var u=function(){if(!--i.__u){if(i.state.__a){var l=i.state.__a;i.__v.__k[0]=ys(l,l.__c.__P,l.__c.__O)}var d;for(i.setState({__a:i.__b=null});d=i.o.pop();)d.__P=a,d.forceUpdate()}};i.__u++||32&e.__u||i.setState({__a:i.__b=i.__v.__k[0]}),n.then(o,o)},Nt.prototype.componentWillUnmount=function(){this.o=[]},Nt.prototype.render=function(n,e){if(this.__b){if(this.__v.__k){var t=document.createElement("div"),i=this.__v.__k[0].__c;this.__v.__k[0]=gs(this.__b,t,i.__O=i.__P)}this.__b=null}var r=e.__a&&Ve(de,null,n.fallback);return r&&(r.__u&=-33),[Ve(de,null,e.__a?null:n.children),r]};var Ti=function(n,e,t){if(++t[1]===t[0]&&n.l.delete(e),n.props.revealOrder&&(n.props.revealOrder[0]!=="t"||!n.l.size))for(t=n.i;t;){for(;t.length>3;)t.pop()();if(t[1]<t[0])break;n.i=t=t[2]}};(lt.prototype=new se).__a=function(n){var e=this,t=bs(e.__v),i=e.l.get(n);return i[0]++,function(r){var s=function(){e.props.revealOrder?(i.push(r),Ti(e,n,i)):r()};t?t(s):s()}},lt.prototype.render=function(n){this.i=null,this.l=new Map;var e=ue(n.children);n.revealOrder&&n.revealOrder[0]==="b"&&e.reverse();for(var t=e.length;t--;)this.l.set(e[t],this.i=[1,0,this.i]);return n.children},lt.prototype.componentDidUpdate=lt.prototype.componentDidMount=function(){var n=this;this.l.forEach(function(e,t){Ti(n,t,e)})};var vl=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,_l=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,wl=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,Sl=/[A-Z0-9]/g,Fl=typeof document<"u",Pl=function(n){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(n)};function Ci(n,e,t){return e.__k==null&&(e.textContent=""),hl(n,e),typeof t=="function"&&t(),n?n.__c:null}se.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(n){Object.defineProperty(se.prototype,n,{configurable:!0,get:function(){return this["UNSAFE_"+n]},set:function(e){Object.defineProperty(this,n,{configurable:!0,writable:!0,value:e})}})});var Ei=N.event;function Tl(){}function Cl(){return this.cancelBubble}function El(){return this.defaultPrevented}N.event=function(n){return Ei&&(n=Ei(n)),n.persist=Tl,n.isPropagationStopped=Cl,n.isDefaultPrevented=El,n.nativeEvent=n};var xl={enumerable:!1,configurable:!0,get:function(){return this.class}},xi=N.vnode;N.vnode=function(n){typeof n.type=="string"&&(function(e){var t=e.props,i=e.type,r={},s=i.indexOf("-")===-1;for(var o in t){var a=t[o];if(!(o==="value"&&"defaultValue"in t&&a==null||Fl&&o==="children"&&i==="noscript"||o==="class"||o==="className")){var u=o.toLowerCase();o==="defaultValue"&&"value"in t&&t.value==null?o="value":o==="download"&&a===!0?a="":u==="translate"&&a==="no"?a=!1:u[0]==="o"&&u[1]==="n"?u==="ondoubleclick"?o="ondblclick":u!=="onchange"||i!=="input"&&i!=="textarea"||Pl(t.type)?u==="onfocus"?o="onfocusin":u==="onblur"?o="onfocusout":wl.test(o)&&(o=u):u=o="oninput":s&&_l.test(o)?o=o.replace(Sl,"-$&").toLowerCase():a===null&&(a=void 0),u==="oninput"&&r[o=u]&&(o="oninputCapture"),r[o]=a}}i=="select"&&r.multiple&&Array.isArray(r.value)&&(r.value=ue(t.children).forEach(function(l){l.props.selected=r.value.indexOf(l.props.value)!=-1})),i=="select"&&r.defaultValue!=null&&(r.value=ue(t.children).forEach(function(l){l.props.selected=r.multiple?r.defaultValue.indexOf(l.props.value)!=-1:r.defaultValue==l.props.value})),t.class&&!t.className?(r.class=t.class,Object.defineProperty(r,"className",xl)):(t.className&&!t.class||t.class&&t.className)&&(r.class=r.className=t.className),e.props=r})(n),n.$$typeof=vl,xi&&xi(n)};var ki=N.__r;N.__r=function(n){ki&&ki(n),n.__c};var Ui=N.diffed;N.diffed=function(n){Ui&&Ui(n);var e=n.props,t=n.__e;t!=null&&n.type==="textarea"&&"value"in e&&e.value!==t.value&&(t.value=e.value==null?"":e.value)};function kl(n){let e=null,t;return(...i)=>(t=i,e||(e=Promise.resolve().then(()=>(e=null,n(...t)))),e)}class Fe extends $n{#e;isTargetDOMEl;el;parent;title;getTargetPlugin(e){let t;if(typeof e?.addTarget=="function")t=e,t instanceof Fe||console.warn(new Error("The provided plugin is not an instance of UIPlugin. This is an indication of a bug with the way Uppy is bundled.",{cause:{targetPlugin:t,UIPlugin:Fe}}));else if(typeof e=="function"){const i=e;this.uppy.iteratePlugins(r=>{r instanceof i&&(t=r)})}return t}mount(e,t){const i=t.id,r=sl(e);if(r){this.isTargetDOMEl=!0;const a=document.createElement("div");return a.classList.add("uppy-Root"),this.#e=kl(u=>{this.uppy.getPlugin(this.id)&&(Ci(this.render(u,a),a),this.afterUpdate())}),this.uppy.log(`Installing ${i} to a DOM element '${e}'`),this.opts.replaceTargetContent&&(r.innerHTML=""),Ci(this.render(this.uppy.getState(),a),a),this.el=a,r.appendChild(a),a.dir=this.opts.direction||es(a)||"ltr",this.onMount(),this.el}const s=this.getTargetPlugin(e);if(s)return this.uppy.log(`Installing ${i} to ${s.id}`),this.parent=s,this.el=s.addTarget(t),this.onMount(),this.el;this.uppy.log(`Not installing ${i}`);let o=`Invalid target option given to ${i}.`;throw typeof e=="function"?o+=" The given target is not a Plugin class. Please check that you're not specifying a React Component instead of a plugin. If you are using @uppy/* packages directly, make sure you have only 1 version of @uppy/core installed: run `npm ls @uppy/core` on the command line and verify that all the versions match and are deduped correctly.":o+="If you meant to target an HTML element, please make sure that the element exists. Check that the <script> tag initializing Uppy is right before the closing </body> tag at the end of the page. (see https://github.com/transloadit/uppy/issues/1042)\n\nIf you meant to target a plugin, please confirm that your `import` statements or `require` calls are correct.",new Error(o)}render(e,t){throw new Error("Extend the render method to add your plugin to a DOM element")}update(e){this.el!=null&&this.#e?.(e)}unmount(){this.isTargetDOMEl&&this.el?.remove(),this.onUnmount()}onMount(){}onUnmount(){}}const Ul="4.3.2",Ol={version:Ul};class Al{static VERSION=Ol.version;state={};#e=new Set;getState(){return this.state}setState(e){const t={...this.state},i={...this.state,...e};this.state=i,this.#t(t,i,e)}subscribe(e){return this.#e.add(e),()=>{this.#e.delete(e)}}#t(...e){this.#e.forEach(t=>{t(...e)})}}function vs(n){const e=n.lastIndexOf(".");return e===-1||e===n.length-1?{name:n,extension:void 0}:{name:n.slice(0,e),extension:n.slice(e+1)}}const Oi={__proto__:null,md:"text/markdown",markdown:"text/markdown",mp4:"video/mp4",mp3:"audio/mp3",svg:"image/svg+xml",jpg:"image/jpeg",png:"image/png",webp:"image/webp",gif:"image/gif",heic:"image/heic",heif:"image/heif",yaml:"text/yaml",yml:"text/yaml",csv:"text/csv",tsv:"text/tab-separated-values",tab:"text/tab-separated-values",avi:"video/x-msvideo",mks:"video/x-matroska",mkv:"video/x-matroska",mov:"video/quicktime",dicom:"application/dicom",doc:"application/msword",msg:"application/vnd.ms-outlook",docm:"application/vnd.ms-word.document.macroenabled.12",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotm:"application/vnd.ms-word.template.macroenabled.12",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",xla:"application/vnd.ms-excel",xlam:"application/vnd.ms-excel.addin.macroenabled.12",xlc:"application/vnd.ms-excel",xlf:"application/x-xliff+xml",xlm:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlsb:"application/vnd.ms-excel.sheet.binary.macroenabled.12",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlt:"application/vnd.ms-excel",xltm:"application/vnd.ms-excel.template.macroenabled.12",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlw:"application/vnd.ms-excel",txt:"text/plain",text:"text/plain",conf:"text/plain",log:"text/plain",pdf:"application/pdf",zip:"application/zip","7z":"application/x-7z-compressed",rar:"application/x-rar-compressed",tar:"application/x-tar",gz:"application/gzip",dmg:"application/x-apple-diskimage"};function _s(n){if(n.type)return n.type;const e=n.name?vs(n.name).extension?.toLowerCase():null;return e&&e in Oi?Oi[e]:"application/octet-stream"}function Rl(n){return n.charCodeAt(0).toString(32)}function Ai(n){let e="";return n.replace(/[^A-Z0-9]/gi,t=>(e+=`-${Rl(t)}`,"/"))+e}function Il(n,e){let t=e||"uppy";return typeof n.name=="string"&&(t+=`-${Ai(n.name.toLowerCase())}`),n.type!==void 0&&(t+=`-${n.type}`),n.meta&&typeof n.meta.relativePath=="string"&&(t+=`-${Ai(n.meta.relativePath.toLowerCase())}`),n.data.size!==void 0&&(t+=`-${n.data.size}`),n.data.lastModified!==void 0&&(t+=`-${n.data.lastModified}`),t}function Dl(n){return!n.isRemote||!n.remote?!1:new Set(["box","dropbox","drive","facebook","unsplash"]).has(n.remote.provider)}function Nl(n,e){if(Dl(n))return n.id;const t=_s(n);return Il({...n,type:t},e)}var Bt,Ri;function Gn(){if(Ri)return Bt;Ri=1;function n(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}return Bt=n,Bt}var Lt,Ii;function Bl(){if(Ii)return Lt;Ii=1;var n=typeof ke=="object"&&ke&&ke.Object===Object&&ke;return Lt=n,Lt}var Mt,Di;function ws(){if(Di)return Mt;Di=1;var n=Bl(),e=typeof self=="object"&&self&&self.Object===Object&&self,t=n||e||Function("return this")();return Mt=t,Mt}var $t,Ni;function Ll(){if(Ni)return $t;Ni=1;var n=ws(),e=function(){return n.Date.now()};return $t=e,$t}var zt,Bi;function Ml(){if(Bi)return zt;Bi=1;var n=/\s/;function e(t){for(var i=t.length;i--&&n.test(t.charAt(i)););return i}return zt=e,zt}var jt,Li;function $l(){if(Li)return jt;Li=1;var n=Ml(),e=/^\s+/;function t(i){return i&&i.slice(0,n(i)+1).replace(e,"")}return jt=t,jt}var qt,Mi;function Ss(){if(Mi)return qt;Mi=1;var n=ws(),e=n.Symbol;return qt=e,qt}var Ht,$i;function zl(){if($i)return Ht;$i=1;var n=Ss(),e=Object.prototype,t=e.hasOwnProperty,i=e.toString,r=n?n.toStringTag:void 0;function s(o){var a=t.call(o,r),u=o[r];try{o[r]=void 0;var l=!0}catch{}var d=i.call(o);return l&&(a?o[r]=u:delete o[r]),d}return Ht=s,Ht}var Vt,zi;function jl(){if(zi)return Vt;zi=1;var n=Object.prototype,e=n.toString;function t(i){return e.call(i)}return Vt=t,Vt}var Wt,ji;function ql(){if(ji)return Wt;ji=1;var n=Ss(),e=zl(),t=jl(),i="[object Null]",r="[object Undefined]",s=n?n.toStringTag:void 0;function o(a){return a==null?a===void 0?r:i:s&&s in Object(a)?e(a):t(a)}return Wt=o,Wt}var Gt,qi;function Hl(){if(qi)return Gt;qi=1;function n(e){return e!=null&&typeof e=="object"}return Gt=n,Gt}var Kt,Hi;function Vl(){if(Hi)return Kt;Hi=1;var n=ql(),e=Hl(),t="[object Symbol]";function i(r){return typeof r=="symbol"||e(r)&&n(r)==t}return Kt=i,Kt}var Xt,Vi;function Wl(){if(Vi)return Xt;Vi=1;var n=$l(),e=Gn(),t=Vl(),i=NaN,r=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,o=/^0o[0-7]+$/i,a=parseInt;function u(l){if(typeof l=="number")return l;if(t(l))return i;if(e(l)){var d=typeof l.valueOf=="function"?l.valueOf():l;l=e(d)?d+"":d}if(typeof l!="string")return l===0?l:+l;l=n(l);var h=s.test(l);return h||o.test(l)?a(l.slice(2),h?2:8):r.test(l)?i:+l}return Xt=u,Xt}var Yt,Wi;function Fs(){if(Wi)return Yt;Wi=1;var n=Gn(),e=Ll(),t=Wl(),i="Expected a function",r=Math.max,s=Math.min;function o(a,u,l){var d,h,b,v,E,T,k=0,S=!1,m=!1,y=!0;if(typeof a!="function")throw new TypeError(i);u=t(u)||0,n(l)&&(S=!!l.leading,m="maxWait"in l,b=m?r(t(l.maxWait)||0,u):b,y="trailing"in l?!!l.trailing:y);function _(x){var V=d,ee=h;return d=h=void 0,k=x,v=a.apply(ee,V),v}function w(x){return k=x,E=setTimeout(I,u),S?_(x):v}function U(x){var V=x-T,ee=x-k,g=u-V;return m?s(g,b-ee):g}function O(x){var V=x-T,ee=x-k;return T===void 0||V>=u||V<0||m&&ee>=b}function I(){var x=e();if(O(x))return R(x);E=setTimeout(I,U(x))}function R(x){return E=void 0,y&&d?_(x):(d=h=void 0,v)}function j(){E!==void 0&&clearTimeout(E),k=0,d=T=h=E=void 0}function $(){return E===void 0?v:R(e())}function W(){var x=e(),V=O(x);if(d=arguments,h=this,T=x,V){if(E===void 0)return w(T);if(m)return clearTimeout(E),E=setTimeout(I,u),_(T)}return E===void 0&&(E=setTimeout(I,u)),v}return W.cancel=j,W.flush=$,W}return Yt=o,Yt}var Qt,Gi;function Gl(){if(Gi)return Qt;Gi=1;var n=Fs(),e=Gn(),t="Expected a function";function i(r,s,o){var a=!0,u=!0;if(typeof r!="function")throw new TypeError(t);return e(o)&&(a="leading"in o?!!o.leading:a,u="trailing"in o?!!o.trailing:u),n(r,s,{leading:a,maxWait:s,trailing:u})}return Qt=i,Qt}var Kl=Gl();const Xl=ve(Kl);var Zt,Ki;function Yl(){return Ki||(Ki=1,Zt=function(){var e={},t=e._fns={};e.emit=function(o,a,u,l,d,h,b){var v=i(o);v.length&&r(o,v,[a,u,l,d,h,b])},e.on=function(o,a){t[o]||(t[o]=[]),t[o].push(a)},e.once=function(o,a){function u(){a.apply(this,arguments),e.off(o,u)}this.on(o,u)},e.off=function(o,a){var u=[];if(o&&a){var l=this._fns[o],d=0,h=l?l.length:0;for(d;d<h;d++)l[d]!==a&&u.push(l[d])}u.length?this._fns[o]=u:delete this._fns[o]};function i(s){var o=t[s]?t[s]:[],a=s.indexOf(":"),u=a===-1?[s]:[s.substring(0,a),s.substring(a+1)],l=Object.keys(t),d=0,h=l.length;for(d;d<h;d++){var b=l[d];if(b==="*"&&(o=o.concat(t[b])),u.length===2&&u[0]===b){o=o.concat(t[b]);break}}return o}function r(s,o,a){var u=0,l=o.length;for(u;u<l&&o[u];u++)o[u].event=s,o[u].apply(o[u],a)}return e}),Zt}var Ql=Yl();const Zl=ve(Ql);let Jl="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",Kn=(n=21)=>{let e="",t=n|0;for(;t--;)e+=Jl[Math.random()*64|0];return e};const eu="4.5.3",tu={version:eu};function nu(n,e){return e.name?e.name:n.split("/")[0]==="image"?`${n.split("/")[0]}.${n.split("/")[1]}`:"noname"}const iu={strings:{addBulkFilesFailed:{0:"Failed to add %{smart_count} file due to an internal error",1:"Failed to add %{smart_count} files due to internal errors"},youCanOnlyUploadX:{0:"You can only upload %{smart_count} file",1:"You can only upload %{smart_count} files"},youHaveToAtLeastSelectX:{0:"You have to select at least %{smart_count} file",1:"You have to select at least %{smart_count} files"},aggregateExceedsSize:"You selected %{size} of files, but maximum allowed size is %{sizeAllowed}",exceedsSize:"%{file} exceeds maximum allowed size of %{size}",missingRequiredMetaField:"Missing required meta fields",missingRequiredMetaFieldOnFile:"Missing required meta fields in %{fileName}",inferiorSize:"This file is smaller than the allowed size of %{size}",youCanOnlyUploadFileTypes:"You can only upload: %{types}",noMoreFilesAllowed:"Cannot add more files",noDuplicates:"Cannot add the duplicate file '%{fileName}', it already exists",companionError:"Connection with Companion failed",authAborted:"Authentication aborted",companionUnauthorizeHint:"To unauthorize to your %{provider} account, please go to %{url}",failedToUpload:"Failed to upload %{file}",noInternetConnection:"No Internet connection",connectedToInternet:"Connected to the Internet",noFilesFound:"You have no files or folders here",noSearchResults:"Unfortunately, there are no results for this search",selectX:{0:"Select %{smart_count}",1:"Select %{smart_count}"},allFilesFromFolderNamed:"All files from folder %{name}",openFolderNamed:"Open folder %{name}",cancel:"Cancel",logOut:"Log out",logIn:"Log in",pickFiles:"Pick files",pickPhotos:"Pick photos",filter:"Filter",resetFilter:"Reset filter",loading:"Loading...",loadedXFiles:"Loaded %{numFiles} files",authenticateWithTitle:"Please authenticate with %{pluginName} to select files",authenticateWith:"Connect to %{pluginName}",signInWithGoogle:"Sign in with Google",searchImages:"Search for images",enterTextToSearch:"Enter text to search for images",search:"Search",resetSearch:"Reset search",emptyFolderAdded:"No files were added from empty folder",addedNumFiles:"Added %{numFiles} file(s)",folderAlreadyAdded:'The folder "%{folder}" was already added',folderAdded:{0:"Added %{smart_count} file from %{folder}",1:"Added %{smart_count} files from %{folder}"},additionalRestrictionsFailed:"%{count} additional restrictions were not fulfilled",unnamed:"Unnamed",pleaseWait:"Please wait"}};var Jt,Xi;function ru(){return Xi||(Xi=1,Jt=function(e){if(typeof e!="number"||Number.isNaN(e))throw new TypeError(`Expected a number, got ${typeof e}`);const t=e<0;let i=Math.abs(e);if(t&&(i=-i),i===0)return"0 B";const r=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],s=Math.min(Math.floor(Math.log(i)/Math.log(1024)),r.length-1),o=Number(i/1024**s),a=r[s];return`${o>=10||o%1===0?Math.round(o):o.toFixed(1)} ${a}`}),Jt}var su=ru();const Se=ve(su);var en,Yi;function ou(){if(Yi)return en;Yi=1;function n(e,t){this.text=e=e||"",this.hasWild=~e.indexOf("*"),this.separator=t,this.parts=e.split(t)}return n.prototype.match=function(e){var t=!0,i=this.parts,r,s=i.length,o;if(typeof e=="string"||e instanceof String)if(!this.hasWild&&this.text!=e)t=!1;else{for(o=(e||"").split(this.separator),r=0;t&&r<s;r++)i[r]!=="*"&&(r<o.length?t=i[r]===o[r]:t=!1);t=t&&o}else if(typeof e.splice=="function")for(t=[],r=e.length;r--;)this.match(e[r])&&(t[t.length]=e[r]);else if(typeof e=="object"){t={};for(var a in e)this.match(a)&&(t[a]=e[a])}return t},en=function(e,t,i){var r=new n(e,i||/[\/\.]/);return typeof t<"u"?r.match(t):r},en}var tn,Qi;function au(){if(Qi)return tn;Qi=1;var n=ou(),e=/[\/\+\.]/;return tn=function(t,i){function r(s){var o=n(s,t,e);return o&&o.length>=2}return i?r(i.split(";")[0]):r},tn}var lu=au();const uu=ve(lu),cu={maxFileSize:null,minFileSize:null,maxTotalFileSize:null,maxNumberOfFiles:null,minNumberOfFiles:null,allowedFileTypes:null,requiredMetaFields:[]};class ae extends Error{isUserFacing;file;constructor(e,t){super(e),this.isUserFacing=t?.isUserFacing??!0,t?.file&&(this.file=t.file)}isRestriction=!0}class du{getI18n;getOpts;constructor(e,t){this.getI18n=t,this.getOpts=()=>{const i=e();if(i.restrictions?.allowedFileTypes!=null&&!Array.isArray(i.restrictions.allowedFileTypes))throw new TypeError("`restrictions.allowedFileTypes` must be an array");return i}}validateAggregateRestrictions(e,t){const{maxTotalFileSize:i,maxNumberOfFiles:r}=this.getOpts().restrictions;if(r&&e.filter(o=>!o.isGhost).length+t.length>r)throw new ae(`${this.getI18n()("youCanOnlyUploadX",{smart_count:r})}`);if(i){const s=[...e,...t].reduce((o,a)=>o+(a.size??0),0);if(s>i)throw new ae(this.getI18n()("aggregateExceedsSize",{sizeAllowed:Se(i),size:Se(s)}))}}validateSingleFile(e){const{maxFileSize:t,minFileSize:i,allowedFileTypes:r}=this.getOpts().restrictions;if(r&&!r.some(o=>o.includes("/")?e.type?uu(e.type.replace(/;.*?$/,""),o):!1:o[0]==="."&&e.extension?e.extension.toLowerCase()===o.slice(1).toLowerCase():!1)){const o=r.join(", ");throw new ae(this.getI18n()("youCanOnlyUploadFileTypes",{types:o}),{file:e})}if(t&&e.size!=null&&e.size>t)throw new ae(this.getI18n()("exceedsSize",{size:Se(t),file:e.name??this.getI18n()("unnamed")}),{file:e});if(i&&e.size!=null&&e.size<i)throw new ae(this.getI18n()("inferiorSize",{size:Se(i)}),{file:e})}validate(e,t){t.forEach(i=>{this.validateSingleFile(i)}),this.validateAggregateRestrictions(e,t)}validateMinNumberOfFiles(e){const{minNumberOfFiles:t}=this.getOpts().restrictions;if(t&&Object.keys(e).length<t)throw new ae(this.getI18n()("youHaveToAtLeastSelectX",{smart_count:t}))}getMissingRequiredMetaFields(e){const t=new ae(this.getI18n()("missingRequiredMetaFieldOnFile",{fileName:e.name??this.getI18n()("unnamed")})),{requiredMetaFields:i}=this.getOpts().restrictions,r=[];for(const s of i)(!Object.hasOwn(e.meta,s)||e.meta[s]==="")&&r.push(s);return{missingFields:r,error:t}}}function hu(n){if(n==null&&typeof navigator<"u"&&(n=navigator.userAgent),!n)return!0;const e=/Edge\/(\d+\.\d+)/.exec(n);if(!e)return!0;const i=e[1].split(".",2),r=parseInt(i[0],10),s=parseInt(i[1],10);return r<15||r===15&&s<15063||r>18||r===18&&s>=18218}const ut={totalProgress:0,allowNewUpload:!0,error:null,recoveredState:null};class Xn{static VERSION=tu.version;#e=Object.create(null);#t;#i;#n=Zl();#r=new Set;#o=new Set;#a=new Set;defaultLocale;locale;opts;store;i18n;i18nArray;scheduledAutoProceed=null;wasOffline=!1;constructor(e){this.defaultLocale=iu;const t={id:"uppy",autoProceed:!1,allowMultipleUploadBatches:!0,debug:!1,restrictions:cu,meta:{},onBeforeFileAdded:(r,s)=>!Object.hasOwn(s,r.id),onBeforeUpload:r=>r,store:new Al,logger:il,infoTimeout:5e3},i={...t,...e};this.opts={...i,restrictions:{...t.restrictions,...e?.restrictions}},e?.logger&&e.debug?this.log("You are using a custom `logger`, but also set `debug: true`, which uses built-in logger to output logs to console. Ignoring `debug: true` and using your custom `logger`.","warning"):e?.debug&&(this.opts.logger=rl),this.log(`Using Core v${Xn.VERSION}`),this.i18nInit(),this.store=this.opts.store,this.setState({...ut,plugins:{},files:{},currentUploads:{},capabilities:{uploadProgress:hu(),individualCancellation:!0,resumableUploads:!1},meta:{...this.opts.meta},info:[]}),this.#t=new du(()=>this.opts,()=>this.i18n),this.#i=this.store.subscribe((r,s,o)=>{this.emit("state-update",r,s,o),this.updateAll(s)}),this.opts.debug&&typeof window<"u"&&(window[this.opts.id]=this),this.#T()}emit(e,...t){this.#n.emit(e,...t)}on(e,t){return this.#n.on(e,t),this}once(e,t){return this.#n.once(e,t),this}off(e,t){return this.#n.off(e,t),this}updateAll(e){this.iteratePlugins(t=>{t.update(e)})}setState(e){this.store.setState(e)}getState(){return this.store.getState()}patchFilesState(e){const t=this.getState().files;this.setState({files:{...t,...Object.fromEntries(Object.entries(e).map(([i,r])=>[i,{...t[i],...r}]))}})}setFileState(e,t){if(!this.getState().files[e])throw new Error(`Can’t set state for ${e} (the file could have been removed)`);this.patchFilesState({[e]:t})}i18nInit(){const e=i=>this.log(`Missing i18n string: ${i}`,"error"),t=new Zr([this.defaultLocale,this.opts.locale],{onMissingKey:e});this.i18n=t.translate.bind(t),this.i18nArray=t.translateArray.bind(t),this.locale=t.locale}setOptions(e){this.opts={...this.opts,...e,restrictions:{...this.opts.restrictions,...e?.restrictions}},e.meta&&this.setMeta(e.meta),this.i18nInit(),e.locale&&this.iteratePlugins(t=>{t.setOptions(e)}),this.setState(void 0)}resetProgress(){const e={percentage:0,bytesUploaded:!1,uploadComplete:!1,uploadStarted:null},t={...this.getState().files},i=Object.create(null);Object.keys(t).forEach(r=>{i[r]={...t[r],progress:{...t[r].progress,...e},tus:void 0,transloadit:void 0}}),this.setState({files:i,...ut})}clear(){const{capabilities:e,currentUploads:t}=this.getState();if(Object.keys(t).length>0&&!e.individualCancellation)throw new Error("The installed uploader plugin does not allow removing files during an upload.");this.setState({...ut,files:{}})}addPreProcessor(e){this.#r.add(e)}removePreProcessor(e){return this.#r.delete(e)}addPostProcessor(e){this.#a.add(e)}removePostProcessor(e){return this.#a.delete(e)}addUploader(e){this.#o.add(e)}removeUploader(e){return this.#o.delete(e)}setMeta(e){const t={...this.getState().meta,...e},i={...this.getState().files};Object.keys(i).forEach(r=>{i[r]={...i[r],meta:{...i[r].meta,...e}}}),this.log("Adding metadata:"),this.log(e),this.setState({meta:t,files:i})}setFileMeta(e,t){const i={...this.getState().files};if(!i[e]){this.log(`Was trying to set metadata for a file that has been removed: ${e}`);return}const r={...i[e].meta,...t};i[e]={...i[e],meta:r},this.setState({files:i})}getFile(e){return this.getState().files[e]}getFiles(){const{files:e}=this.getState();return Object.values(e)}getFilesByIds(e){return e.map(t=>this.getFile(t))}getObjectOfFilesPerState(){const{files:e,totalProgress:t,error:i}=this.getState(),r=Object.values(e),s=[],o=[],a=[],u=[],l=[],d=[],h=[],b=[],v=[];for(const E of r){const{progress:T}=E;!T.uploadComplete&&T.uploadStarted&&(s.push(E),E.isPaused||b.push(E)),T.uploadStarted||o.push(E),(T.uploadStarted||T.preprocess||T.postprocess)&&a.push(E),T.uploadStarted&&u.push(E),E.isPaused&&l.push(E),T.uploadComplete&&d.push(E),E.error&&h.push(E),(T.preprocess||T.postprocess)&&v.push(E)}return{newFiles:o,startedFiles:a,uploadStartedFiles:u,pausedFiles:l,completeFiles:d,erroredFiles:h,inProgressFiles:s,inProgressNotPausedFiles:b,processingFiles:v,isUploadStarted:u.length>0,isAllComplete:t===100&&d.length===r.length&&v.length===0,isAllErrored:!!i&&h.length===r.length,isAllPaused:s.length!==0&&l.length===s.length,isUploadInProgress:s.length>0,isSomeGhost:r.some(E=>E.isGhost)}}#s(e){for(const o of e)o.isRestriction?this.emit("restriction-failed",o.file,o):this.emit("error",o,o.file),this.log(o,"warning");const t=e.filter(o=>o.isUserFacing),i=4,r=t.slice(0,i),s=t.slice(i);r.forEach(({message:o,details:a=""})=>{this.info({message:o,details:a},"error",this.opts.infoTimeout)}),s.length>0&&this.info({message:this.i18n("additionalRestrictionsFailed",{count:s.length})})}validateRestrictions(e,t=this.getFiles()){try{this.#t.validate(t,[e])}catch(i){return i}return null}validateSingleFile(e){try{this.#t.validateSingleFile(e)}catch(t){return t.message}return null}validateAggregateRestrictions(e){const t=this.getFiles();try{this.#t.validateAggregateRestrictions(t,e)}catch(i){return i.message}return null}#l(e){const{missingFields:t,error:i}=this.#t.getMissingRequiredMetaFields(e);return t.length>0?(this.setFileState(e.id,{missingRequiredMetaFields:t,error:i.message}),this.log(i.message),this.emit("restriction-failed",e,i),!1):(t.length===0&&e.missingRequiredMetaFields&&this.setFileState(e.id,{missingRequiredMetaFields:[]}),!0)}#p(e){let t=!0;for(const i of Object.values(e))this.#l(i)||(t=!1);return t}#u(e){const{allowNewUpload:t}=this.getState();if(t===!1){const i=new ae(this.i18n("noMoreFilesAllowed"),{file:e});throw this.#s([i]),i}}checkIfFileAlreadyExists(e){const{files:t}=this.getState();return!!(t[e]&&!t[e].isGhost)}#h(e){const t=e instanceof File?{name:e.name,type:e.type,size:e.size,data:e}:e,i=_s(t),r=nu(i,t),s=vs(r).extension,o=Nl(t,this.getID()),a=t.meta||{};a.name=r,a.type=i;const u=Number.isFinite(t.data.size)?t.data.size:null;return{source:t.source||"",id:o,name:r,extension:s||"",meta:{...this.getState().meta,...a},type:i,data:t.data,progress:{percentage:0,bytesUploaded:!1,bytesTotal:u,uploadComplete:!1,uploadStarted:null},size:u,isGhost:!1,isRemote:t.isRemote||!1,remote:t.remote,preview:t.preview}}#d(){this.opts.autoProceed&&!this.scheduledAutoProceed&&(this.scheduledAutoProceed=setTimeout(()=>{this.scheduledAutoProceed=null,this.upload().catch(e=>{e.isRestriction||this.log(e.stack||e.message||e)})},4))}#c(e){let{files:t}=this.getState(),i={...t};const r=[],s=[];for(const o of e)try{let a=this.#h(o);const u=t[a.id]?.isGhost;u&&(a={...t[a.id],isGhost:!1,data:o.data},this.log(`Replaced the blob in the restored ghost file: ${a.name}, ${a.id}`));const l=this.opts.onBeforeFileAdded(a,i);if(t=this.getState().files,i={...t,...i},!l&&this.checkIfFileAlreadyExists(a.id))throw new ae(this.i18n("noDuplicates",{fileName:a.name??this.i18n("unnamed")}),{file:o});if(l===!1&&!u)throw new ae("Cannot add the file because onBeforeFileAdded returned false.",{isUserFacing:!1,file:o});typeof l=="object"&&l!==null&&(a=l),this.#t.validateSingleFile(a),i[a.id]=a,r.push(a)}catch(a){s.push(a)}try{this.#t.validateAggregateRestrictions(Object.values(t),r)}catch(o){return s.push(o),{nextFilesState:t,validFilesToAdd:[],errors:s}}return{nextFilesState:i,validFilesToAdd:r,errors:s}}addFile(e){this.#u(e);const{nextFilesState:t,validFilesToAdd:i,errors:r}=this.#c([e]),s=r.filter(a=>a.isRestriction);if(this.#s(s),r.length>0)throw r[0];this.setState({files:t});const[o]=i;return this.emit("file-added",o),this.emit("files-added",i),this.log(`Added file: ${o.name}, ${o.id}, mime type: ${o.type}`),this.#d(),o.id}addFiles(e){this.#u();const{nextFilesState:t,validFilesToAdd:i,errors:r}=this.#c(e),s=r.filter(a=>a.isRestriction);this.#s(s);const o=r.filter(a=>!a.isRestriction);if(o.length>0){let a=`Multiple errors occurred while adding files:
`;if(o.forEach(u=>{a+=`
 * ${u.message}`}),this.info({message:this.i18n("addBulkFilesFailed",{smart_count:o.length}),details:a},"error",this.opts.infoTimeout),typeof AggregateError=="function")throw new AggregateError(o,a);{const u=new Error(a);throw u.errors=o,u}}this.setState({files:t}),i.forEach(a=>{this.emit("file-added",a)}),this.emit("files-added",i),i.length>5?this.log(`Added batch of ${i.length} files`):Object.values(i).forEach(a=>{this.log(`Added file: ${a.name}
 id: ${a.id}
 type: ${a.type}`)}),i.length>0&&this.#d()}removeFiles(e){const{files:t,currentUploads:i}=this.getState(),r={...t},s={...i},o=Object.create(null);e.forEach(d=>{t[d]&&(o[d]=t[d],delete r[d])});function a(d){return o[d]===void 0}Object.keys(s).forEach(d=>{const h=i[d].fileIDs.filter(a);if(h.length===0){delete s[d];return}const{capabilities:b}=this.getState();if(h.length!==i[d].fileIDs.length&&!b.individualCancellation)throw new Error("The installed uploader plugin does not allow removing files during an upload.");s[d]={...i[d],fileIDs:h}});const u={currentUploads:s,files:r};Object.keys(r).length===0&&(u.allowNewUpload=!0,u.error=null,u.recoveredState=null),this.setState(u),this.#y();const l=Object.keys(o);l.forEach(d=>{this.emit("file-removed",o[d])}),l.length>5?this.log(`Removed ${l.length} files`):this.log(`Removed files: ${l.join(", ")}`)}removeFile(e){this.removeFiles([e])}pauseResume(e){if(!this.getState().capabilities.resumableUploads||this.getFile(e).progress.uploadComplete)return;const t=this.getFile(e),r=!(t.isPaused||!1);return this.setFileState(e,{isPaused:r}),this.emit("upload-pause",t,r),r}pauseAll(){const e={...this.getState().files};Object.keys(e).filter(i=>!e[i].progress.uploadComplete&&e[i].progress.uploadStarted).forEach(i=>{const r={...e[i],isPaused:!0};e[i]=r}),this.setState({files:e}),this.emit("pause-all")}resumeAll(){const e={...this.getState().files};Object.keys(e).filter(i=>!e[i].progress.uploadComplete&&e[i].progress.uploadStarted).forEach(i=>{const r={...e[i],isPaused:!1,error:null};e[i]=r}),this.setState({files:e}),this.emit("resume-all")}#f(){const{files:e}=this.getState();return Object.keys(e).filter(t=>{const i=e[t];return i.error&&(!i.missingRequiredMetaFields||i.missingRequiredMetaFields.length===0)})}async#m(){const e=this.#f(),t={...this.getState().files};if(e.forEach(r=>{t[r]={...t[r],isPaused:!1,error:null}}),this.setState({files:t,error:null}),this.emit("retry-all",this.getFilesByIds(e)),e.length===0)return{successful:[],failed:[]};const i=this.#b(e,{forceAllowNewUpload:!0});return this.#v(i)}async retryAll(){const e=await this.#m();return this.emit("complete",e),e}cancelAll(){this.emit("cancel-all");const{files:e}=this.getState(),t=Object.keys(e);t.length&&this.removeFiles(t),this.setState(ut)}retryUpload(e){this.setFileState(e,{error:null,isPaused:!1}),this.emit("upload-retry",this.getFile(e));const t=this.#b([e],{forceAllowNewUpload:!0});return this.#v(t)}logout(){this.iteratePlugins(e=>{e.provider?.logout?.()})}#_=(e,t)=>{const i=e?this.getFile(e.id):void 0;if(e==null||!i){this.log(`Not setting progress for a file that has been removed: ${e?.id}`);return}if(i.progress.percentage===100){this.log(`Not setting progress for a file that has been already uploaded: ${e.id}`);return}const r={bytesTotal:t.bytesTotal,percentage:t.bytesTotal!=null&&Number.isFinite(t.bytesTotal)&&t.bytesTotal>0?Math.round(t.bytesUploaded/t.bytesTotal*100):void 0};i.progress.uploadStarted!=null?this.setFileState(e.id,{progress:{...i.progress,...r,bytesUploaded:t.bytesUploaded}}):this.setFileState(e.id,{progress:{...i.progress,...r}}),this.#y()};#S(){const e=this.#P();let t=null;e!=null&&(t=Math.round(e*100),t>100?t=100:t<0&&(t=0)),this.emit("progress",t??0),this.setState({totalProgress:t??0})}#y=Xl(()=>this.#S(),500,{leading:!0,trailing:!0});[Symbol.for("uppy test: updateTotalProgress")](){return this.#S()}#P(){const t=this.getFiles().filter(u=>u.progress.uploadStarted||u.progress.preprocess||u.progress.postprocess);if(t.length===0)return 0;if(t.every(u=>u.progress.uploadComplete))return 1;const i=u=>u.progress.bytesTotal!=null&&u.progress.bytesTotal!==0,r=t.filter(i),s=t.filter(u=>!i(u));if(r.every(u=>u.progress.uploadComplete)&&s.length>0&&!s.every(u=>u.progress.uploadComplete))return null;const o=r.reduce((u,l)=>u+(l.progress.bytesTotal??0),0),a=r.reduce((u,l)=>u+(l.progress.bytesUploaded||0),0);return o===0?0:a/o}#T(){const e=(r,s,o)=>{let a=r.message||"Unknown error";r.details&&(a+=` ${r.details}`),this.setState({error:a}),s!=null&&s.id in this.getState().files&&this.setFileState(s.id,{error:a,response:o})};this.on("error",e),this.on("upload-error",(r,s,o)=>{if(e(s,r,o),typeof s=="object"&&s.message){this.log(s.message,"error");const a=new Error(this.i18n("failedToUpload",{file:r?.name??""}));a.isUserFacing=!0,a.details=s.message,s.details&&(a.details+=` ${s.details}`),this.#s([a])}else this.#s([s])});let t=null;this.on("upload-stalled",(r,s)=>{const{message:o}=r,a=s.map(u=>u.meta.name).join(", ");t||(this.info({message:o,details:a},"warning",this.opts.infoTimeout),t=setTimeout(()=>{t=null},this.opts.infoTimeout)),this.log(`${o} ${a}`.trim(),"warning")}),this.on("upload",()=>{this.setState({error:null})});const i=r=>{const s=r.filter(a=>{const u=a!=null&&this.getFile(a.id);return u||this.log(`Not setting progress for a file that has been removed: ${a?.id}`),u}),o=Object.fromEntries(s.map(a=>[a.id,{progress:{uploadStarted:Date.now(),uploadComplete:!1,bytesUploaded:0,bytesTotal:a.size}}]));this.patchFilesState(o)};this.on("upload-start",i),this.on("upload-progress",this.#_),this.on("upload-success",(r,s)=>{if(r==null||!this.getFile(r.id)){this.log(`Not setting progress for a file that has been removed: ${r?.id}`);return}const o=this.getFile(r.id).progress;this.setFileState(r.id,{progress:{...o,postprocess:this.#a.size>0?{mode:"indeterminate"}:void 0,uploadComplete:!0,percentage:100,bytesUploaded:o.bytesTotal},response:s,uploadURL:s.uploadURL,isPaused:!1}),r.size==null&&this.setFileState(r.id,{size:s.bytesUploaded||o.bytesTotal}),this.#y()}),this.on("preprocess-progress",(r,s)=>{if(r==null||!this.getFile(r.id)){this.log(`Not setting progress for a file that has been removed: ${r?.id}`);return}this.setFileState(r.id,{progress:{...this.getFile(r.id).progress,preprocess:s}})}),this.on("preprocess-complete",r=>{if(r==null||!this.getFile(r.id)){this.log(`Not setting progress for a file that has been removed: ${r?.id}`);return}const s={...this.getState().files};s[r.id]={...s[r.id],progress:{...s[r.id].progress}},delete s[r.id].progress.preprocess,this.setState({files:s})}),this.on("postprocess-progress",(r,s)=>{if(r==null||!this.getFile(r.id)){this.log(`Not setting progress for a file that has been removed: ${r?.id}`);return}this.setFileState(r.id,{progress:{...this.getState().files[r.id].progress,postprocess:s}})}),this.on("postprocess-complete",r=>{if(r==null||!this.getFile(r.id)){this.log(`Not setting progress for a file that has been removed: ${r?.id}`);return}const s={...this.getState().files};s[r.id]={...s[r.id],progress:{...s[r.id].progress}},delete s[r.id].progress.postprocess,this.setState({files:s})}),this.on("restored",()=>{this.#y()}),this.on("dashboard:file-edit-complete",r=>{r&&this.#l(r)}),typeof window<"u"&&window.addEventListener&&(window.addEventListener("online",this.#g),window.addEventListener("offline",this.#g),setTimeout(this.#g,3e3))}updateOnlineStatus(){window.navigator.onLine??!0?(this.emit("is-online"),this.wasOffline&&(this.emit("back-online"),this.info(this.i18n("connectedToInternet"),"success",3e3),this.wasOffline=!1)):(this.emit("is-offline"),this.info(this.i18n("noInternetConnection"),"error",0),this.wasOffline=!0)}#g=this.updateOnlineStatus.bind(this);getID(){return this.opts.id}use(e,...t){if(typeof e!="function"){const o=`Expected a plugin class, but got ${e===null?"null":typeof e}. Please verify that the plugin was imported and spelled correctly.`;throw new TypeError(o)}const i=new e(this,...t),r=i.id;if(!r)throw new Error("Your plugin must have an id");if(!i.type)throw new Error("Your plugin must have a type");const s=this.getPlugin(r);if(s){const o=`Already found a plugin named '${s.id}'. Tried to use: '${r}'.
Uppy plugins must have unique \`id\` options.`;throw new Error(o)}return e.VERSION&&this.log(`Using ${r} v${e.VERSION}`),i.type in this.#e?this.#e[i.type].push(i):this.#e[i.type]=[i],i.install(),this.emit("plugin-added",i),this}getPlugin(e){for(const t of Object.values(this.#e)){const i=t.find(r=>r.id===e);if(i!=null)return i}}[Symbol.for("uppy test: getPlugins")](e){return this.#e[e]}iteratePlugins(e){Object.values(this.#e).flat(1).forEach(e)}removePlugin(e){this.log(`Removing plugin ${e.id}`),this.emit("plugin-remove",e),e.uninstall&&e.uninstall();const t=this.#e[e.type],i=t.findIndex(o=>o.id===e.id);i!==-1&&t.splice(i,1);const s={plugins:{...this.getState().plugins,[e.id]:void 0}};this.setState(s)}destroy(){this.log(`Closing Uppy instance ${this.opts.id}: removing all files and uninstalling plugins`),this.cancelAll(),this.#i(),this.iteratePlugins(e=>{this.removePlugin(e)}),typeof window<"u"&&window.removeEventListener&&(window.removeEventListener("online",this.#g),window.removeEventListener("offline",this.#g))}hideInfo(){const{info:e}=this.getState();this.setState({info:e.slice(1)}),this.emit("info-hidden")}info(e,t="info",i=3e3){const r=typeof e=="object";this.setState({info:[...this.getState().info,{type:t,message:r?e.message:e,details:r?e.details:null}]}),setTimeout(()=>this.hideInfo(),i),this.emit("info-visible")}log(e,t){const{logger:i}=this.opts;switch(t){case"error":i.error(e);break;case"warning":i.warn(e);break;default:i.debug(e);break}}#F=new Map;registerRequestClient(e,t){this.#F.set(e,t)}getRequestClientForFile(e){if(!e.remote)throw new Error(`Tried to get RequestClient for a non-remote file ${e.id}`);const t=this.#F.get(e.remote.requestClientId);if(t==null)throw new Error(`requestClientId "${e.remote.requestClientId}" not registered for file "${e.id}"`);return t}restore(e){return this.log(`Core: attempting to restore upload "${e}"`),this.getState().currentUploads[e]?this.#v(e):(this.#w(e),Promise.reject(new Error("Nonexistent upload")))}#b(e,t={}){const{forceAllowNewUpload:i=!1}=t,{allowNewUpload:r,currentUploads:s}=this.getState();if(!r&&!i)throw new Error("Cannot create a new upload: already uploading.");const o=Kn();return this.emit("upload",o,this.getFilesByIds(e)),this.setState({allowNewUpload:this.opts.allowMultipleUploadBatches!==!1&&this.opts.allowMultipleUploads!==!1,currentUploads:{...s,[o]:{fileIDs:e,step:0,result:{}}}}),o}[Symbol.for("uppy test: createUpload")](...e){return this.#b(...e)}#C(e){const{currentUploads:t}=this.getState();return t[e]}addResultData(e,t){if(!this.#C(e)){this.log(`Not setting result for an upload that has been removed: ${e}`);return}const{currentUploads:i}=this.getState(),r={...i[e],result:{...i[e].result,...t}};this.setState({currentUploads:{...i,[e]:r}})}#w(e){const t={...this.getState().currentUploads};delete t[e],this.setState({currentUploads:t})}async#v(e){const t=()=>{const{currentUploads:o}=this.getState();return o[e]};let i=t();const r=[...this.#r,...this.#o,...this.#a];try{for(let o=i.step||0;o<r.length&&i;o++){const a=r[o];this.setState({currentUploads:{...this.getState().currentUploads,[e]:{...i,step:o}}});const{fileIDs:u}=i;await a(u,e),i=t()}}catch(o){throw this.#w(e),o}if(i){i.fileIDs.forEach(l=>{const d=this.getFile(l);d?.progress.postprocess&&this.emit("postprocess-complete",d)});const o=i.fileIDs.map(l=>this.getFile(l)),a=o.filter(l=>!l.error),u=o.filter(l=>l.error);this.addResultData(e,{successful:a,failed:u,uploadID:e}),i=t()}let s;return i&&(s=i.result,this.#w(e)),s==null&&(this.log(`Not setting result for an upload that has been removed: ${e}`),s={successful:[],failed:[],uploadID:e}),s}async upload(){this.#e.uploader?.length||this.log("No uploader type plugins are used","warning");let{files:e}=this.getState();if(this.#f().length>0){const r=await this.#m();if(!(this.getFiles().filter(o=>o.progress.uploadStarted==null).length>0))return this.emit("complete",r),r;({files:e}=this.getState())}const i=this.opts.onBeforeUpload(e);return i===!1?Promise.reject(new Error("Not starting the upload because onBeforeUpload returned false")):(i&&typeof i=="object"&&(e=i,this.setState({files:e})),Promise.resolve().then(()=>this.#t.validateMinNumberOfFiles(e)).catch(r=>{throw this.#s([r]),r}).then(()=>{if(!this.#p(e))throw new ae(this.i18n("missingRequiredMetaField"))}).catch(r=>{throw r}).then(async()=>{const{currentUploads:r}=this.getState(),s=Object.values(r).flatMap(l=>l.fileIDs),o=[];Object.keys(e).forEach(l=>{const d=this.getFile(l);!d.progress.uploadStarted&&s.indexOf(l)===-1&&o.push(d.id)});const a=this.#b(o),u=await this.#v(a);return this.emit("complete",u),u}).catch(r=>{throw this.emit("error",r),this.log(r,"error"),r}))}}var pu=0;function c(n,e,t,i,r,s){e||(e={});var o,a,u=e;if("ref"in u)for(a in u={},e)a=="ref"?o=e[a]:u[a]=e[a];var l={type:n,props:u,key:t,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--pu,__i:-1,__u:0,__source:r,__self:s};if(typeof n=="function"&&(o=n.defaultProps))for(a in o)u[a]===void 0&&(u[a]=o[a]);return N.vnode&&N.vnode(l),l}const fu="4.3.2",mu={version:fu},Zi=300;class gu extends se{ref=al();componentWillEnter(e){this.ref.current.style.opacity="1",this.ref.current.style.transform="none",setTimeout(e,Zi)}componentWillLeave(e){this.ref.current.style.opacity="0",this.ref.current.style.transform="translateY(350%)",setTimeout(e,Zi)}render(){const{children:e}=this.props;return c("div",{className:"uppy-Informer-animated",ref:this.ref,children:e})}}function yu(n,e){return Object.assign(n,e)}function bu(n,e){return n?.key??e}function vu(n,e){const t=n._ptgLinkedRefs||(n._ptgLinkedRefs={});return t[e]||(t[e]=i=>{n.refs[e]=i})}function Ne(n){const e={};for(let t=0;t<n.length;t++)if(n[t]!=null){const i=bu(n[t],t.toString(36));e[i]=n[t]}return e}function _u(n,e){n=n||{},e=e||{};const t=o=>Object.hasOwn(e,o)?e[o]:n[o],i={};let r=[];for(const o in n)Object.hasOwn(e,o)?r.length&&(i[o]=r,r=[]):r.push(o);const s={};for(const o in e){if(Object.hasOwn(i,o))for(let a=0;a<i[o].length;a++){const u=i[o][a];s[i[o][a]]=t(u)}s[o]=t(o)}for(let o=0;o<r.length;o++)s[r[o]]=t(r[o]);return s}const wu=n=>n;class Ps extends se{constructor(e,t){super(e,t),this.refs={},this.state={children:Ne(ue(ue(this.props.children))||[])},this.performAppear=this.performAppear.bind(this),this.performEnter=this.performEnter.bind(this),this.performLeave=this.performLeave.bind(this)}componentWillMount(){this.currentlyTransitioningKeys={},this.keysToAbortLeave=[],this.keysToEnter=[],this.keysToLeave=[]}componentDidMount(){const e=this.state.children;for(const t in e)e[t]&&this.performAppear(t)}componentWillReceiveProps(e){const t=Ne(ue(e.children)||[]),i=this.state.children;this.setState(s=>({children:_u(s.children,t)}));let r;for(r in t)if(Object.hasOwn(t,r)){const s=i&&Object.hasOwn(i,r);t[r]&&s&&this.currentlyTransitioningKeys[r]?(this.keysToEnter.push(r),this.keysToAbortLeave.push(r)):t[r]&&!s&&!this.currentlyTransitioningKeys[r]&&this.keysToEnter.push(r)}for(r in i)if(Object.hasOwn(i,r)){const s=t&&Object.hasOwn(t,r);i[r]&&!s&&!this.currentlyTransitioningKeys[r]&&this.keysToLeave.push(r)}}componentDidUpdate(){const{keysToEnter:e}=this;this.keysToEnter=[],e.forEach(this.performEnter);const{keysToLeave:t}=this;this.keysToLeave=[],t.forEach(this.performLeave)}_finishAbort(e){const t=this.keysToAbortLeave.indexOf(e);t!==-1&&this.keysToAbortLeave.splice(t,1)}performAppear(e){this.currentlyTransitioningKeys[e]=!0;const t=this.refs[e];t?.componentWillAppear?t.componentWillAppear(this._handleDoneAppearing.bind(this,e)):this._handleDoneAppearing(e)}_handleDoneAppearing(e){const t=this.refs[e];t?.componentDidAppear&&t.componentDidAppear(),delete this.currentlyTransitioningKeys[e],this._finishAbort(e);const i=Ne(ue(this.props.children)||[]);(!i||!Object.hasOwn(i,e))&&this.performLeave(e)}performEnter(e){this.currentlyTransitioningKeys[e]=!0;const t=this.refs[e];t?.componentWillEnter?t.componentWillEnter(this._handleDoneEntering.bind(this,e)):this._handleDoneEntering(e)}_handleDoneEntering(e){const t=this.refs[e];t?.componentDidEnter&&t.componentDidEnter(),delete this.currentlyTransitioningKeys[e],this._finishAbort(e);const i=Ne(ue(this.props.children)||[]);(!i||!Object.hasOwn(i,e))&&this.performLeave(e)}performLeave(e){if(this.keysToAbortLeave.indexOf(e)!==-1)return;this.currentlyTransitioningKeys[e]=!0;const i=this.refs[e];i?.componentWillLeave?i.componentWillLeave(this._handleDoneLeaving.bind(this,e)):this._handleDoneLeaving(e)}_handleDoneLeaving(e){if(this.keysToAbortLeave.indexOf(e)!==-1)return;const i=this.refs[e];i?.componentDidLeave&&i.componentDidLeave(),delete this.currentlyTransitioningKeys[e];const r=Ne(ue(this.props.children)||[]);if(r&&Object.hasOwn(r,e))this.performEnter(e);else{const s=yu({},this.state.children);delete s[e],this.setState({children:s})}}render({childFactory:e,transitionLeave:t,transitionName:i,transitionAppear:r,transitionEnter:s,transitionLeaveTimeout:o,transitionEnterTimeout:a,transitionAppearTimeout:u,component:l,...d},{children:h}){const b=Object.entries(h).map(([v,E])=>{if(!E)return;const T=vu(this,v);return hs(e(E),{ref:T,key:v})}).filter(Boolean);return Ve(l,d,b)}}Ps.defaultProps={component:"span",childFactory:wu};class Su extends Fe{static VERSION=mu.version;constructor(e,t){super(e,t),this.type="progressindicator",this.id=this.opts.id||"Informer",this.title="Informer"}render=e=>c("div",{className:"uppy uppy-Informer",children:c(Ps,{children:e.info.map(t=>c(gu,{children:c("p",{role:"alert",children:[t.message," ",t.details&&c("span",{"aria-label":t.details,"data-microtip-position":"top-left","data-microtip-size":"medium",role:"tooltip",onClick:()=>alert(`${t.message} 

 ${t.details}`),children:"?"})]})},t.message))})});install(){const{target:e}=this.opts;e&&this.mount(e,this)}}var nn={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var Ji;function Fu(){return Ji||(Ji=1,(function(n){(function(){var e={}.hasOwnProperty;function t(){for(var s="",o=0;o<arguments.length;o++){var a=arguments[o];a&&(s=r(s,i(a)))}return s}function i(s){if(typeof s=="string"||typeof s=="number")return s;if(typeof s!="object")return"";if(Array.isArray(s))return t.apply(null,s);if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]"))return s.toString();var o="";for(var a in s)e.call(s,a)&&s[a]&&(o=r(o,a));return o}function r(s,o){return o?s?s+" "+o:s+o:s}n.exports?(t.default=t,n.exports=t):window.classNames=t})()})(nn)),nn.exports}var Pu=Fu();const he=ve(Pu),Tu={position:"relative",width:"100%",minHeight:"100%"},Cu={position:"absolute",top:0,left:0,width:"100%",overflow:"visible"};class Eu extends se{constructor(e){super(e),this.focusElement=null,this.state={offset:0,height:0}}componentDidMount(){this.resize(),window.addEventListener("resize",this.handleResize)}componentWillUpdate(){this.base.contains(document.activeElement)&&(this.focusElement=document.activeElement)}componentDidUpdate(){this.focusElement?.parentNode&&document.activeElement!==this.focusElement&&this.focusElement.focus(),this.focusElement=null,this.resize()}componentWillUnmount(){window.removeEventListener("resize",this.handleResize)}handleScroll=()=>{this.setState({offset:this.base.scrollTop})};handleResize=()=>{this.resize()};resize(){const{height:e}=this.state;e!==this.base.offsetHeight&&this.setState({height:this.base.offsetHeight})}render({data:e,rowHeight:t,renderRow:i,overscanCount:r=10,...s}){const{offset:o,height:a}=this.state;let u=Math.floor(o/t),l=Math.floor(a/t);r&&(u=Math.max(0,u-u%r),l+=r);const d=u+l+4,h=e.slice(u,d),b={...Tu,height:e.length*t},v={...Cu,top:u*t};return c("div",{onScroll:this.handleScroll,...s,children:c("div",{role:"presentation",style:b,children:c("div",{role:"presentation",style:v,children:h.map(i)})})})}}function xu(){return c("svg",{"aria-hidden":"true",focusable:"false",width:"30",height:"30",viewBox:"0 0 30 30",children:c("path",{d:"M15 30c8.284 0 15-6.716 15-15 0-8.284-6.716-15-15-15C6.716 0 0 6.716 0 15c0 8.284 6.716 15 15 15zm4.258-12.676v6.846h-8.426v-6.846H5.204l9.82-12.364 9.82 12.364H19.26z"})})}function er(n,e,t,i){return n===e?n:i===0?e:n+(e-n)*2**(-i/t)}const ku="4.2.3",Uu={version:ku},Ou={strings:{uploading:"Uploading",complete:"Complete",uploadFailed:"Upload failed",paused:"Paused",retry:"Retry",cancel:"Cancel",pause:"Pause",resume:"Resume",done:"Done",filesUploadedOfTotal:{0:"%{complete} of %{smart_count} file uploaded",1:"%{complete} of %{smart_count} files uploaded"},dataUploadedOfTotal:"%{complete} of %{total}",dataUploadedOfUnknown:"%{complete} of unknown",xTimeLeft:"%{time} left",uploadXFiles:{0:"Upload %{smart_count} file",1:"Upload %{smart_count} files"},uploadXNewFiles:{0:"Upload +%{smart_count} file",1:"Upload +%{smart_count} files"},upload:"Upload",retryUpload:"Retry upload",xMoreFilesAdded:{0:"%{smart_count} more file added",1:"%{smart_count} more files added"},showErrorDetails:"Show error details"}},fe={STATE_ERROR:"error",STATE_WAITING:"waiting",STATE_PREPROCESSING:"preprocessing",STATE_UPLOADING:"uploading",STATE_POSTPROCESSING:"postprocessing",STATE_COMPLETE:"complete"};function Au(n){const e=Math.floor(n/3600)%24,t=Math.floor(n/60)%60,i=Math.floor(n%60);return{hours:e,minutes:t,seconds:i}}function Ru(n){const e=Au(n),t=e.hours===0?"":`${e.hours}h`,i=e.minutes===0?"":`${e.hours===0?e.minutes:` ${e.minutes.toString(10).padStart(2,"0")}`}m`,r=e.hours!==0?"":`${e.minutes===0?e.seconds:` ${e.seconds.toString(10).padStart(2,"0")}`}s`;return`${t}${i}${r}`}const Iu="·",tr=()=>` ${Iu} `;function Du(n){const{newFiles:e,isUploadStarted:t,recoveredState:i,i18n:r,uploadState:s,isSomeGhost:o,startUpload:a}=n,u=he("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--upload",{"uppy-c-btn-primary":s===fe.STATE_WAITING},{"uppy-StatusBar-actionBtn--disabled":o}),l=e&&t&&!i?r("uploadXNewFiles",{smart_count:e}):r("uploadXFiles",{smart_count:e});return c("button",{type:"button",className:u,"aria-label":r("uploadXFiles",{smart_count:e}),onClick:a,disabled:o,"data-uppy-super-focusable":!0,children:l})}function Nu(n){const{i18n:e,uppy:t}=n;return c("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--retry","aria-label":e("retryUpload"),onClick:()=>t.retryAll().catch(()=>{}),"data-uppy-super-focusable":!0,"data-cy":"retry",children:[c("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"8",height:"10",viewBox:"0 0 8 10",children:c("path",{d:"M4 2.408a2.75 2.75 0 1 0 2.75 2.75.626.626 0 0 1 1.25.018v.023a4 4 0 1 1-4-4.041V.25a.25.25 0 0 1 .389-.208l2.299 1.533a.25.25 0 0 1 0 .416l-2.3 1.533A.25.25 0 0 1 4 3.316v-.908z"})}),e("retry")]})}function Bu(n){const{i18n:e,uppy:t}=n;return c("button",{type:"button",className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",title:e("cancel"),"aria-label":e("cancel"),onClick:()=>t.cancelAll(),"data-cy":"cancel","data-uppy-super-focusable":!0,children:c("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16",children:c("g",{fill:"none",fillRule:"evenodd",children:[c("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),c("path",{fill:"#FFF",d:"M9.283 8l2.567 2.567-1.283 1.283L8 9.283 5.433 11.85 4.15 10.567 6.717 8 4.15 5.433 5.433 4.15 8 6.717l2.567-2.567 1.283 1.283z"})]})})})}function Lu(n){const{isAllPaused:e,i18n:t,isAllComplete:i,resumableUploads:r,uppy:s}=n,o=t(e?"resume":"pause");function a(){if(!i){if(!r){s.cancelAll();return}if(e){s.resumeAll();return}s.pauseAll()}}return c("button",{title:o,"aria-label":o,className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",type:"button",onClick:a,"data-cy":"togglePauseResume","data-uppy-super-focusable":!0,children:c("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16",children:c("g",{fill:"none",fillRule:"evenodd",children:[c("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),c("path",{fill:"#FFF",d:e?"M6 4.25L11.5 8 6 11.75z":"M5 4.5h2v7H5v-7zm4 0h2v7H9v-7z"})]})})})}function Mu(n){const{i18n:e,doneButtonHandler:t}=n;return c("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--done",onClick:t,"data-uppy-super-focusable":!0,children:e("done")})}function Ts(){return c("svg",{className:"uppy-StatusBar-spinner","aria-hidden":"true",focusable:"false",width:"14",height:"14",children:c("path",{d:"M13.983 6.547c-.12-2.509-1.64-4.893-3.939-5.936-2.48-1.127-5.488-.656-7.556 1.094C.524 3.367-.398 6.048.162 8.562c.556 2.495 2.46 4.52 4.94 5.183 2.932.784 5.61-.602 7.256-3.015-1.493 1.993-3.745 3.309-6.298 2.868-2.514-.434-4.578-2.349-5.153-4.84a6.226 6.226 0 0 1 2.98-6.778C6.34.586 9.74 1.1 11.373 3.493c.407.596.693 1.282.842 1.988.127.598.073 1.197.161 1.794.078.525.543 1.257 1.15.864.525-.341.49-1.05.456-1.592-.007-.15.02.3 0 0",fillRule:"evenodd"})})}function $u(n){const{progress:e}=n,{value:t,mode:i,message:r}=e;return c("div",{className:"uppy-StatusBar-content",children:[c(Ts,{}),i==="determinate"?`${Math.round(t*100)}% · `:"",r]})}function zu(n){const{numUploads:e,complete:t,totalUploadedSize:i,totalSize:r,totalETA:s,i18n:o}=n,a=e>1,u=Se(i);return c("div",{className:"uppy-StatusBar-statusSecondary",children:[a&&o("filesUploadedOfTotal",{complete:t,smart_count:e}),c("span",{className:"uppy-StatusBar-additionalInfo",children:[a&&tr(),r!=null?o("dataUploadedOfTotal",{complete:u,total:Se(r)}):o("dataUploadedOfUnknown",{complete:u}),tr(),s!=null&&o("xTimeLeft",{time:Ru(s)})]})]})}function Cs(n){const{i18n:e,complete:t,numUploads:i}=n;return c("div",{className:"uppy-StatusBar-statusSecondary",children:e("filesUploadedOfTotal",{complete:t,smart_count:i})})}function ju(n){const{i18n:e,newFiles:t,startUpload:i}=n,r=he("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--uploadNewlyAdded");return c("div",{className:"uppy-StatusBar-statusSecondary",children:[c("div",{className:"uppy-StatusBar-statusSecondaryHint",children:e("xMoreFilesAdded",{smart_count:t})}),c("button",{type:"button",className:r,"aria-label":e("uploadXFiles",{smart_count:t}),onClick:i,children:e("upload")})]})}function qu(n){const{i18n:e,supportsUploadProgress:t,totalProgress:i,showProgressDetails:r,isUploadStarted:s,isAllComplete:o,isAllPaused:a,newFiles:u,numUploads:l,complete:d,totalUploadedSize:h,totalSize:b,totalETA:v,startUpload:E}=n,T=u&&s;if(!s||o)return null;const k=e(a?"paused":"uploading");function S(){return!a&&!T&&r?t?c(zu,{numUploads:l,complete:d,totalUploadedSize:h,totalSize:b,totalETA:v,i18n:e}):c(Cs,{i18n:e,complete:d,numUploads:l}):null}return c("div",{className:"uppy-StatusBar-content",title:k,children:[a?null:c(Ts,{}),c("div",{className:"uppy-StatusBar-status",children:[c("div",{className:"uppy-StatusBar-statusPrimary",children:t&&i!==0?`${k}: ${i}%`:k}),S(),T?c(ju,{i18n:e,newFiles:u,startUpload:E}):null]})]})}function Hu(n){const{i18n:e}=n;return c("div",{className:"uppy-StatusBar-content",role:"status",title:e("complete"),children:c("div",{className:"uppy-StatusBar-status",children:c("div",{className:"uppy-StatusBar-statusPrimary",children:[c("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"15",height:"11",viewBox:"0 0 15 11",children:c("path",{d:"M.414 5.843L1.627 4.63l3.472 3.472L13.202 0l1.212 1.213L5.1 10.528z"})}),e("complete")]})})})}function Vu(n){const{error:e,i18n:t,complete:i,numUploads:r}=n;function s(){const o=`${t("uploadFailed")} 

 ${e}`;alert(o)}return c("div",{className:"uppy-StatusBar-content",title:t("uploadFailed"),children:[c("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"11",height:"11",viewBox:"0 0 11 11",children:c("path",{d:"M4.278 5.5L0 1.222 1.222 0 5.5 4.278 9.778 0 11 1.222 6.722 5.5 11 9.778 9.778 11 5.5 6.722 1.222 11 0 9.778z"})}),c("div",{className:"uppy-StatusBar-status",children:[c("div",{className:"uppy-StatusBar-statusPrimary",children:[t("uploadFailed"),c("button",{className:"uppy-u-reset uppy-StatusBar-details","aria-label":t("showErrorDetails"),"data-microtip-position":"top-right","data-microtip-size":"medium",onClick:s,type:"button",children:"?"})]}),c(Cs,{i18n:t,complete:i,numUploads:r})]})]})}function rn(n){const e=[];let t="indeterminate",i;for(const{progress:s}of Object.values(n)){const{preprocess:o,postprocess:a}=s;i==null&&(o||a)&&({mode:t,message:i}=o||a),o?.mode==="determinate"&&e.push(o.value),a?.mode==="determinate"&&e.push(a.value)}const r=e.reduce((s,o)=>s+o/e.length,0);return{mode:t,message:i,value:r}}const{STATE_ERROR:nr,STATE_WAITING:Wu,STATE_PREPROCESSING:sn,STATE_UPLOADING:ct,STATE_POSTPROCESSING:on,STATE_COMPLETE:dt}=fe;function Gu({newFiles:n,allowNewUpload:e,isUploadInProgress:t,isAllPaused:i,resumableUploads:r,error:s,hideUploadButton:o=void 0,hidePauseResumeButton:a=!1,hideCancelButton:u=!1,hideRetryButton:l=!1,recoveredState:d,uploadState:h,totalProgress:b,files:v,supportsUploadProgress:E,hideAfterFinish:T=!1,isSomeGhost:k,doneButtonHandler:S=void 0,isUploadStarted:m,i18n:y,startUpload:_,uppy:w,isAllComplete:U,showProgressDetails:O=void 0,numUploads:I,complete:R,totalSize:j,totalETA:$,totalUploadedSize:W}){function x(){switch(h){case on:case sn:{const rt=rn(v);return rt.mode==="determinate"?rt.value*100:b}case nr:return null;case ct:return E?b:null;default:return b}}function V(){switch(h){case on:case sn:{const{mode:rt}=rn(v);return rt==="indeterminate"}case ct:return!E;default:return!1}}const ee=x(),g=ee??100,p=!s&&n&&(!t&&!i||d)&&e&&!o,f=!u&&h!==Wu&&h!==dt,F=r&&!a&&h===ct,C=s&&!U&&!l,P=S&&h===dt,D=he("uppy-StatusBar-progress",{"is-indeterminate":V()}),B=he("uppy-StatusBar",`is-${h}`,{"has-ghosts":k}),M=(()=>{switch(h){case sn:case on:return c($u,{progress:rn(v)});case dt:return c(Hu,{i18n:y});case nr:return c(Vu,{error:s,i18n:y,numUploads:I,complete:R});case ct:return c(qu,{i18n:y,supportsUploadProgress:E,totalProgress:b,showProgressDetails:O,isUploadStarted:m,isAllComplete:U,isAllPaused:i,newFiles:n,numUploads:I,complete:R,totalUploadedSize:W,totalSize:j,totalETA:$,startUpload:_});default:return null}})();return!(p||C||F||f||P)&&!M||h===dt&&T?null:c("div",{className:B,children:[c("div",{className:D,style:{width:`${g}%`},role:"progressbar","aria-label":`${g}%`,"aria-valuetext":`${g}%`,"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":ee}),M,c("div",{className:"uppy-StatusBar-actions",children:[p?c(Du,{newFiles:n,isUploadStarted:m,recoveredState:d,i18n:y,isSomeGhost:k,startUpload:_,uploadState:h}):null,C?c(Nu,{i18n:y,uppy:w}):null,F?c(Lu,{isAllPaused:i,i18n:y,isAllComplete:U,resumableUploads:r,uppy:w}):null,f?c(Bu,{i18n:y,uppy:w}):null,P?c(Mu,{i18n:y,doneButtonHandler:S}):null]})]})}const Ku=2e3,Xu=2e3;function Yu(n,e,t,i){if(n)return fe.STATE_ERROR;if(e)return fe.STATE_COMPLETE;if(t)return fe.STATE_WAITING;let r=fe.STATE_WAITING;const s=Object.keys(i);for(let o=0;o<s.length;o++){const{progress:a}=i[s[o]];if(a.uploadStarted&&!a.uploadComplete)return fe.STATE_UPLOADING;a.preprocess&&(r=fe.STATE_PREPROCESSING),a.postprocess&&r!==fe.STATE_PREPROCESSING&&(r=fe.STATE_POSTPROCESSING)}return r}const Qu={hideUploadButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideCancelButton:!1,showProgressDetails:!1,hideAfterFinish:!0,doneButtonHandler:null};class Zu extends Fe{static VERSION=Uu.version;#e;#t;#i;#n;constructor(e,t){super(e,{...Qu,...t}),this.id=this.opts.id||"StatusBar",this.title="StatusBar",this.type="progressindicator",this.defaultLocale=Ou,this.i18nInit(),this.render=this.render.bind(this),this.install=this.install.bind(this)}#r(e){if(e.total==null||e.total===0)return null;const t=e.total-e.uploaded;if(t<=0)return null;this.#e??=performance.now();const i=performance.now()-this.#e;if(i===0)return Math.round((this.#n??0)/100)/10;const r=e.uploaded-this.#t;if(this.#t=e.uploaded,r<=0)return Math.round((this.#n??0)/100)/10;const s=r/i,o=this.#i==null?s:er(s,this.#i,Ku,i);this.#i=o;const a=t/o,u=Math.max(this.#n-i,0),l=this.#n==null?a:er(a,u,Xu,i);return this.#n=l,this.#e=performance.now(),Math.round(l/100)/10}startUpload=()=>this.uppy.upload().catch((()=>{}));render(e){const{capabilities:t,files:i,allowNewUpload:r,totalProgress:s,error:o,recoveredState:a}=e,{newFiles:u,startedFiles:l,completeFiles:d,isUploadStarted:h,isAllComplete:b,isAllPaused:v,isUploadInProgress:E,isSomeGhost:T}=this.uppy.getObjectOfFilesPerState(),k=a?Object.values(i):u,S=!!t.resumableUploads,m=t.uploadProgress!==!1;let y=null,_=0;l.every(U=>U.progress.bytesTotal!=null&&U.progress.bytesTotal!==0)?(y=0,l.forEach(U=>{y+=U.progress.bytesTotal||0,_+=U.progress.bytesUploaded||0})):l.forEach(U=>{_+=U.progress.bytesUploaded||0});const w=this.#r({uploaded:_,total:y});return Gu({error:o,uploadState:Yu(o,b,a,e.files||{}),allowNewUpload:r,totalProgress:s,totalSize:y,totalUploadedSize:_,isAllComplete:!1,isAllPaused:v,isUploadStarted:h,isUploadInProgress:E,isSomeGhost:T,recoveredState:a,complete:d.length,newFiles:k.length,numUploads:l.length,totalETA:w,files:i,i18n:this.i18n,uppy:this.uppy,startUpload:this.startUpload,doneButtonHandler:this.opts.doneButtonHandler,resumableUploads:S,supportsUploadProgress:m,showProgressDetails:this.opts.showProgressDetails,hideUploadButton:this.opts.hideUploadButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,hideCancelButton:this.opts.hideCancelButton,hideAfterFinish:this.opts.hideAfterFinish})}onMount(){const e=this.el;es(e)||(e.dir="ltr")}#o=()=>{const{recoveredState:e}=this.uppy.getState();if(this.#i=null,this.#n=null,e){this.#t=Object.values(e.files).reduce((t,{progress:i})=>t+i.bytesUploaded,0),this.uppy.emit("restore-confirmed");return}this.#e=performance.now(),this.#t=0};install(){const{target:e}=this.opts;e&&this.mount(e,this),this.uppy.on("upload",this.#o),this.#e=performance.now(),this.#t=this.uppy.getFiles().reduce((t,i)=>t+i.progress.bytesUploaded,0)}uninstall(){this.unmount(),this.uppy.off("upload",this.#o)}}const Ju=/^data:([^/]+\/[^,;]+(?:[^,]*?))(;base64)?,([\s\S]*)$/;function ec(n,e,t){const i=Ju.exec(n),r=e.mimeType??i?.[1]??"plain/text";let s;if(i?.[2]!=null){const o=atob(decodeURIComponent(i[3])),a=new Uint8Array(o.length);for(let u=0;u<o.length;u++)a[u]=o.charCodeAt(u);s=[a]}else i?.[3]!=null&&(s=[decodeURIComponent(i[3])]);return new Blob(s,{type:r})}function ir(n){return n.startsWith("blob:")}function rr(n){return n?/^[^/]+\/(jpe?g|gif|png|svg|svg\+xml|bmp|webp|avif)$/.test(n):!1}function z(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var Es=typeof self<"u"?self:global;const Ke=typeof navigator<"u",tc=Ke&&typeof HTMLImageElement>"u",sr=!(typeof global>"u"||typeof process>"u"||!process.versions||!process.versions.node),xs=Es.Buffer,ks=!!xs,nc=n=>n!==void 0;function Us(n){return n===void 0||(n instanceof Map?n.size===0:Object.values(n).filter(nc).length===0)}function Z(n){let e=new Error(n);throw delete e.stack,e}function or(n){let e=(function(t){let i=0;return t.ifd0.enabled&&(i+=1024),t.exif.enabled&&(i+=2048),t.makerNote&&(i+=2048),t.userComment&&(i+=1024),t.gps.enabled&&(i+=512),t.interop.enabled&&(i+=100),t.ifd1.enabled&&(i+=1024),i+2048})(n);return n.jfif.enabled&&(e+=50),n.xmp.enabled&&(e+=2e4),n.iptc.enabled&&(e+=14e3),n.icc.enabled&&(e+=6e3),e}const an=n=>String.fromCharCode.apply(null,n),ar=typeof TextDecoder<"u"?new TextDecoder("utf-8"):void 0;class ce{static from(e,t){return e instanceof this&&e.le===t?e:new ce(e,void 0,void 0,t)}constructor(e,t=0,i,r){if(typeof r=="boolean"&&(this.le=r),Array.isArray(e)&&(e=new Uint8Array(e)),e===0)this.byteOffset=0,this.byteLength=0;else if(e instanceof ArrayBuffer){i===void 0&&(i=e.byteLength-t);let s=new DataView(e,t,i);this._swapDataView(s)}else if(e instanceof Uint8Array||e instanceof DataView||e instanceof ce){i===void 0&&(i=e.byteLength-t),(t+=e.byteOffset)+i>e.byteOffset+e.byteLength&&Z("Creating view outside of available memory in ArrayBuffer");let s=new DataView(e.buffer,t,i);this._swapDataView(s)}else if(typeof e=="number"){let s=new DataView(new ArrayBuffer(e));this._swapDataView(s)}else Z("Invalid input argument for BufferView: "+e)}_swapArrayBuffer(e){this._swapDataView(new DataView(e))}_swapBuffer(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}_swapDataView(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}_lengthToEnd(e){return this.byteLength-e}set(e,t,i=ce){return e instanceof DataView||e instanceof ce?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e instanceof Uint8Array||Z("BufferView.set(): Invalid data argument."),this.toUint8().set(e,t),new i(this,t,e.byteLength)}subarray(e,t){return t=t||this._lengthToEnd(e),new ce(this,e,t)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}getString(e=0,t=this.byteLength){return r=this.getUint8Array(e,t),ar?ar.decode(r):ks?Buffer.from(r).toString("utf8"):decodeURIComponent(escape(an(r)));var r}getLatin1String(e=0,t=this.byteLength){let i=this.getUint8Array(e,t);return an(i)}getUnicodeString(e=0,t=this.byteLength){const i=[];for(let r=0;r<t&&e+r<this.byteLength;r+=2)i.push(this.getUint16(e+r));return an(i)}getInt8(e){return this.dataView.getInt8(e)}getUint8(e){return this.dataView.getUint8(e)}getInt16(e,t=this.le){return this.dataView.getInt16(e,t)}getInt32(e,t=this.le){return this.dataView.getInt32(e,t)}getUint16(e,t=this.le){return this.dataView.getUint16(e,t)}getUint32(e,t=this.le){return this.dataView.getUint32(e,t)}getFloat32(e,t=this.le){return this.dataView.getFloat32(e,t)}getFloat64(e,t=this.le){return this.dataView.getFloat64(e,t)}getFloat(e,t=this.le){return this.dataView.getFloat32(e,t)}getDouble(e,t=this.le){return this.dataView.getFloat64(e,t)}getUintBytes(e,t,i){switch(t){case 1:return this.getUint8(e,i);case 2:return this.getUint16(e,i);case 4:return this.getUint32(e,i);case 8:return this.getUint64&&this.getUint64(e,i)}}getUint(e,t,i){switch(t){case 8:return this.getUint8(e,i);case 16:return this.getUint16(e,i);case 32:return this.getUint32(e,i);case 64:return this.getUint64&&this.getUint64(e,i)}}toString(e){return this.dataView.toString(e,this.constructor.name)}ensureChunk(){}}function Tn(n,e){Z(`${n} '${e}' was not loaded, try using full build of exifr.`)}class Yn extends Map{constructor(e){super(),this.kind=e}get(e,t){return this.has(e)||Tn(this.kind,e),t&&(e in t||(function(i,r){Z(`Unknown ${i} '${r}'.`)})(this.kind,e),t[e].enabled||Tn(this.kind,e)),super.get(e)}keyList(){return Array.from(this.keys())}}var Os=new Yn("file parser"),le=new Yn("segment parser"),Qn=new Yn("file reader");let ic=Es.fetch;function lr(n,e){return(t=n).startsWith("data:")||t.length>1e4?En(n,e,"base64"):sr&&n.includes("://")?Cn(n,e,"url",ur):sr?En(n,e,"fs"):Ke?Cn(n,e,"url",ur):void Z("Invalid input argument");var t}async function Cn(n,e,t,i){return Qn.has(t)?En(n,e,t):i?(async function(r,s){let o=await s(r);return new ce(o)})(n,i):void Z(`Parser ${t} is not loaded`)}async function En(n,e,t){let i=new(Qn.get(t))(n,e);return await i.read(),i}const ur=n=>ic(n).then((e=>e.arrayBuffer())),xn=n=>new Promise(((e,t)=>{let i=new FileReader;i.onloadend=()=>e(i.result||new ArrayBuffer),i.onerror=t,i.readAsArrayBuffer(n)})),Zn=new Map,rc=new Map,sc=new Map,ht=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],As=["jfif","xmp","icc","iptc","ihdr"],kn=["tiff",...As],Y=["ifd0","ifd1","exif","gps","interop"],pt=[...kn,...Y],ft=["makerNote","userComment"],Rs=["translateKeys","translateValues","reviveValues","multiSegment"],mt=[...Rs,"sanitize","mergeOutput","silentErrors"];class Is{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}}class Be extends Is{get needed(){return this.enabled||this.deps.size>0}constructor(e,t,i,r){if(super(),z(this,"enabled",!1),z(this,"skip",new Set),z(this,"pick",new Set),z(this,"deps",new Set),z(this,"translateKeys",!1),z(this,"translateValues",!1),z(this,"reviveValues",!1),this.key=e,this.enabled=t,this.parse=this.enabled,this.applyInheritables(r),this.canBeFiltered=Y.includes(e),this.canBeFiltered&&(this.dict=Zn.get(e)),i!==void 0)if(Array.isArray(i))this.parse=this.enabled=!0,this.canBeFiltered&&i.length>0&&this.translateTagSet(i,this.pick);else if(typeof i=="object"){if(this.enabled=!0,this.parse=i.parse!==!1,this.canBeFiltered){let{pick:s,skip:o}=i;s&&s.length>0&&this.translateTagSet(s,this.pick),o&&o.length>0&&this.translateTagSet(o,this.skip)}this.applyInheritables(i)}else i===!0||i===!1?this.parse=this.enabled=i:Z(`Invalid options argument: ${i}`)}applyInheritables(e){let t,i;for(t of Rs)i=e[t],i!==void 0&&(this[t]=i)}translateTagSet(e,t){if(this.dict){let i,r,{tagKeys:s,tagValues:o}=this.dict;for(i of e)typeof i=="string"?(r=o.indexOf(i),r===-1&&(r=s.indexOf(Number(i))),r!==-1&&t.add(Number(s[r]))):t.add(i)}else for(let i of e)t.add(i)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,kt(this.pick,this.deps)):this.enabled&&this.pick.size>0&&kt(this.pick,this.deps)}}var ie={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},cr=new Map;class Jn extends Is{static useCached(e){let t=cr.get(e);return t!==void 0||(t=new this(e),cr.set(e,t)),t}constructor(e){super(),e===!0?this.setupFromTrue():e===void 0?this.setupFromUndefined():Array.isArray(e)?this.setupFromArray(e):typeof e=="object"?this.setupFromObject(e):Z(`Invalid options argument ${e}`),this.firstChunkSize===void 0&&(this.firstChunkSize=Ke?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let e;for(e of ht)this[e]=ie[e];for(e of mt)this[e]=ie[e];for(e of ft)this[e]=ie[e];for(e of pt)this[e]=new Be(e,ie[e],void 0,this)}setupFromTrue(){let e;for(e of ht)this[e]=ie[e];for(e of mt)this[e]=ie[e];for(e of ft)this[e]=!0;for(e of pt)this[e]=new Be(e,!0,void 0,this)}setupFromArray(e){let t;for(t of ht)this[t]=ie[t];for(t of mt)this[t]=ie[t];for(t of ft)this[t]=ie[t];for(t of pt)this[t]=new Be(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,Y)}setupFromObject(e){let t;for(t of(Y.ifd0=Y.ifd0||Y.image,Y.ifd1=Y.ifd1||Y.thumbnail,Object.assign(this,e),ht))this[t]=ln(e[t],ie[t]);for(t of mt)this[t]=ln(e[t],ie[t]);for(t of ft)this[t]=ln(e[t],ie[t]);for(t of kn)this[t]=new Be(t,ie[t],e[t],this);for(t of Y)this[t]=new Be(t,ie[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,Y,pt),e.tiff===!0?this.batchEnableWithBool(Y,!0):e.tiff===!1?this.batchEnableWithUserValue(Y,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,Y):typeof e.tiff=="object"&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,Y)}batchEnableWithBool(e,t){for(let i of e)this[i].enabled=t}batchEnableWithUserValue(e,t){for(let i of e){let r=t[i];this[i].enabled=r!==!1&&r!==void 0}}setupGlobalFilters(e,t,i,r=i){if(e&&e.length){for(let o of r)this[o].enabled=!1;let s=dr(e,i);for(let[o,a]of s)kt(this[o].pick,a),this[o].enabled=!0}else if(t&&t.length){let s=dr(t,i);for(let[o,a]of s)kt(this[o].skip,a)}}filterNestedSegmentTags(){let{ifd0:e,exif:t,xmp:i,iptc:r,icc:s}=this;this.makerNote?t.deps.add(37500):t.skip.add(37500),this.userComment?t.deps.add(37510):t.skip.add(37510),i.enabled||e.skip.add(700),r.enabled||e.skip.add(33723),s.enabled||e.skip.add(34675)}traverseTiffDependencyTree(){let{ifd0:e,exif:t,gps:i,interop:r}=this;r.needed&&(t.deps.add(40965),e.deps.add(40965)),t.needed&&e.deps.add(34665),i.needed&&e.deps.add(34853),this.tiff.enabled=Y.some((s=>this[s].enabled===!0))||this.makerNote||this.userComment;for(let s of Y)this[s].finalizeFilters()}get onlyTiff(){return!As.map((e=>this[e].enabled)).some((e=>e===!0))&&this.tiff.enabled}checkLoadedPlugins(){for(let e of kn)this[e].enabled&&!le.has(e)&&Tn("segment parser",e)}}function dr(n,e){let t,i,r,s,o=[];for(r of e){for(s of(t=Zn.get(r),i=[],t))(n.includes(s[0])||n.includes(s[1]))&&i.push(s[0]);i.length&&o.push([r,i])}return o}function ln(n,e){return n!==void 0?n:e!==void 0?e:void 0}function kt(n,e){for(let t of e)n.add(t)}z(Jn,"default",ie);class oc{constructor(e){z(this,"parsers",{}),z(this,"output",{}),z(this,"errors",[]),z(this,"pushToErrors",(t=>this.errors.push(t))),this.options=Jn.useCached(e)}async read(e){this.file=await(function(t,i){return typeof t=="string"?lr(t,i):Ke&&!tc&&t instanceof HTMLImageElement?lr(t.src,i):t instanceof Uint8Array||t instanceof ArrayBuffer||t instanceof DataView?new ce(t):Ke&&t instanceof Blob?Cn(t,i,"blob",xn):void Z("Invalid input argument")})(e,this.options)}setup(){if(this.fileParser)return;let{file:e}=this,t=e.getUint16(0);for(let[i,r]of Os)if(r.canHandle(e,t))return this.fileParser=new r(this.options,this.file,this.parsers),e[i]=!0;this.file.close&&this.file.close(),Z("Unknown file format")}async parse(){let{output:e,errors:t}=this;return this.setup(),this.options.silentErrors?(await this.executeParsers().catch(this.pushToErrors),t.push(...this.fileParser.errors)):await this.executeParsers(),this.file.close&&this.file.close(),this.options.silentErrors&&t.length>0&&(e.errors=t),Us(i=e)?void 0:i;var i}async executeParsers(){let{output:e}=this;await this.fileParser.parse();let t=Object.values(this.parsers).map((async i=>{let r=await i.parse();i.assignToOutput(e,r)}));this.options.silentErrors&&(t=t.map((i=>i.catch(this.pushToErrors)))),await Promise.all(t)}async extractThumbnail(){this.setup();let{options:e,file:t}=this,i=le.get("tiff",e);var r;if(t.tiff?r={start:0,type:"tiff"}:t.jpeg&&(r=await this.fileParser.getOrFindSegment("tiff")),r===void 0)return;let s=await this.fileParser.ensureSegmentChunk(r),o=this.parsers.tiff=new i(s,e,t),a=await o.extractThumbnail();return t.close&&t.close(),a}}class Ue{static findPosition(e,t){let i=e.getUint16(t+2)+2,r=typeof this.headerLength=="function"?this.headerLength(e,t,i):this.headerLength,s=t+r,o=i-r;return{offset:t,length:i,headerLength:r,start:s,size:o,end:s+o}}static parse(e,t={}){return new this(e,new Jn({[this.type]:t}),e).parse()}normalizeInput(e){return e instanceof ce?e:new ce(e)}constructor(e,t={},i){z(this,"errors",[]),z(this,"raw",new Map),z(this,"handleError",(r=>{if(!this.options.silentErrors)throw r;this.errors.push(r.message)})),this.chunk=this.normalizeInput(e),this.file=i,this.type=this.constructor.type,this.globalOptions=this.options=t,this.localOptions=t[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(e,t){let i=sc.get(t),r=rc.get(t),s=Zn.get(t),o=this.options[t],a=o.reviveValues&&!!i,u=o.translateValues&&!!r,l=o.translateKeys&&!!s,d={};for(let[h,b]of e)a&&i.has(h)?b=i.get(h)(b):u&&r.has(h)&&(b=this.translateValue(b,r.get(h))),l&&s.has(h)&&(h=s.get(h)||h),d[h]=b;return d}translateValue(e,t){return t[e]||t.DEFAULT||e}assignToOutput(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}assignObjectToOutput(e,t,i){if(this.globalOptions.mergeOutput)return Object.assign(e,i);e[t]?Object.assign(e[t],i):e[t]=i}}z(Ue,"headerLength",4),z(Ue,"type",void 0),z(Ue,"multiSegment",!1),z(Ue,"canHandle",(()=>!1));function ac(n){return n===192||n===194||n===196||n===219||n===221||n===218||n===254}function lc(n){return n>=224&&n<=239}function uc(n,e,t){for(let[i,r]of le)if(r.canHandle(n,e,t))return i}class hr extends class{constructor(e,t,i){z(this,"errors",[]),z(this,"ensureSegmentChunk",(async r=>{let s=r.start,o=r.size||65536;if(this.file.chunked)if(this.file.available(s,o))r.chunk=this.file.subarray(s,o);else try{r.chunk=await this.file.readChunk(s,o)}catch(a){Z(`Couldn't read segment: ${JSON.stringify(r)}. ${a.message}`)}else this.file.byteLength>s+o?r.chunk=this.file.subarray(s,o):r.size===void 0?r.chunk=this.file.subarray(s):Z("Segment unreachable: "+JSON.stringify(r));return r.chunk})),this.extendOptions&&this.extendOptions(e),this.options=e,this.file=t,this.parsers=i}injectSegment(e,t){this.options[e].enabled&&this.createParser(e,t)}createParser(e,t){let i=new(le.get(e))(t,this.options,this.file);return this.parsers[e]=i}createParsers(e){for(let t of e){let{type:i,chunk:r}=t,s=this.options[i];if(s&&s.enabled){let o=this.parsers[i];o&&o.append||o||this.createParser(i,r)}}}async readSegments(e){let t=e.map(this.ensureSegmentChunk);await Promise.all(t)}}{constructor(...e){super(...e),z(this,"appSegments",[]),z(this,"jpegSegments",[]),z(this,"unknownSegments",[])}static canHandle(e,t){return t===65496}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(e){e===!0?(this.findAll=!0,this.wanted=new Set(le.keyList())):(e=e===void 0?le.keyList().filter((t=>this.options[t].enabled)):e.filter((t=>this.options[t].enabled&&le.has(t))),this.findAll=!1,this.remaining=new Set(e),this.wanted=new Set(e)),this.unfinishedMultiSegment=!1}async findAppSegments(e=0,t){this.setupSegmentFinderArgs(t);let{file:i,findAll:r,wanted:s,remaining:o}=this;if(!r&&this.file.chunked&&(r=Array.from(s).some((a=>{let u=le.get(a),l=this.options[a];return u.multiSegment&&l.multiSegment})),r&&await this.file.readWhole()),e=this.findAppSegmentsInRange(e,i.byteLength),!this.options.onlyTiff&&i.chunked){let a=!1;for(;o.size>0&&!a&&(i.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:u}=i,l=this.appSegments.some((d=>!this.file.available(d.offset||d.start,d.length||d.size)));if(a=e>u&&!l?!await i.readNextChunk(e):!await i.readNextChunk(u),(e=this.findAppSegmentsInRange(e,i.byteLength))===void 0)return}}}findAppSegmentsInRange(e,t){t-=2;let i,r,s,o,a,u,{file:l,findAll:d,wanted:h,remaining:b,options:v}=this;for(;e<t;e++)if(l.getUint8(e)===255){if(i=l.getUint8(e+1),lc(i)){if(r=l.getUint16(e+2),s=uc(l,e,r),s&&h.has(s)&&(o=le.get(s),a=o.findPosition(l,e),u=v[s],a.type=s,this.appSegments.push(a),!d&&(o.multiSegment&&u.multiSegment?(this.unfinishedMultiSegment=a.chunkNumber<a.chunkCount,this.unfinishedMultiSegment||b.delete(s)):b.delete(s),b.size===0)))break;v.recordUnknownSegments&&(a=Ue.findPosition(l,e),a.marker=i,this.unknownSegments.push(a)),e+=r+1}else if(ac(i)){if(r=l.getUint16(e+2),i===218&&v.stopAfterSos!==!1)return;v.recordJpegSegments&&this.jpegSegments.push({offset:e,length:r,marker:i}),e+=r+1}}return e}mergeMultiSegments(){if(!this.appSegments.some((t=>t.multiSegment)))return;let e=(function(t,i){let r,s,o,a=new Map;for(let u=0;u<t.length;u++)r=t[u],s=r[i],a.has(s)?o=a.get(s):a.set(s,o=[]),o.push(r);return Array.from(a)})(this.appSegments,"type");this.mergedAppSegments=e.map((([t,i])=>{let r=le.get(t,this.options);return r.handleMultiSegments?{type:t,chunk:r.handleMultiSegments(i)}:i[0]}))}getSegment(e){return this.appSegments.find((t=>t.type===e))}async getOrFindSegment(e){let t=this.getSegment(e);return t===void 0&&(await this.findAppSegments(0,[e]),t=this.getSegment(e)),t}}z(hr,"type","jpeg"),Os.set("jpeg",hr);const cc=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4];class dc extends Ue{parseHeader(){var e=this.chunk.getUint16();e===18761?this.le=!0:e===19789&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(e,t,i=new Map){let{pick:r,skip:s}=this.options[t];r=new Set(r);let o=r.size>0,a=s.size===0,u=this.chunk.getUint16(e);e+=2;for(let l=0;l<u;l++){let d=this.chunk.getUint16(e);if(o){if(r.has(d)&&(i.set(d,this.parseTag(e,d,t)),r.delete(d),r.size===0))break}else!a&&s.has(d)||i.set(d,this.parseTag(e,d,t));e+=12}return i}parseTag(e,t,i){let{chunk:r}=this,s=r.getUint16(e+2),o=r.getUint32(e+4),a=cc[s];if(a*o<=4?e+=8:e=r.getUint32(e+8),(s<1||s>13)&&Z(`Invalid TIFF value type. block: ${i.toUpperCase()}, tag: ${t.toString(16)}, type: ${s}, offset ${e}`),e>r.byteLength&&Z(`Invalid TIFF value offset. block: ${i.toUpperCase()}, tag: ${t.toString(16)}, type: ${s}, offset ${e} is outside of chunk size ${r.byteLength}`),s===1)return r.getUint8Array(e,o);if(s===2)return(u=(function(l){for(;l.endsWith("\0");)l=l.slice(0,-1);return l})(u=r.getString(e,o)).trim())===""?void 0:u;var u;if(s===7)return r.getUint8Array(e,o);if(o===1)return this.parseTagValue(s,e);{let l=new((function(h){switch(h){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 10:return Array;case 11:return Float32Array;case 12:return Float64Array;default:return Array}})(s))(o),d=a;for(let h=0;h<o;h++)l[h]=this.parseTagValue(s,e),e+=d;return l}}parseTagValue(e,t){let{chunk:i}=this;switch(e){case 1:return i.getUint8(t);case 3:return i.getUint16(t);case 4:return i.getUint32(t);case 5:return i.getUint32(t)/i.getUint32(t+4);case 6:return i.getInt8(t);case 8:return i.getInt16(t);case 9:return i.getInt32(t);case 10:return i.getInt32(t)/i.getInt32(t+4);case 11:return i.getFloat(t);case 12:return i.getDouble(t);case 13:return i.getUint32(t);default:Z(`Invalid tiff type ${e}`)}}}class un extends dc{static canHandle(e,t){return e.getUint8(t+1)===225&&e.getUint32(t+4)===1165519206&&e.getUint16(t+8)===0}async parse(){this.parseHeader();let{options:e}=this;return e.ifd0.enabled&&await this.parseIfd0Block(),e.exif.enabled&&await this.safeParse("parseExifBlock"),e.gps.enabled&&await this.safeParse("parseGpsBlock"),e.interop.enabled&&await this.safeParse("parseInteropBlock"),e.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(e){let t=this[e]();return t.catch!==void 0&&(t=t.catch(this.handleError)),t}findIfd0Offset(){this.ifd0Offset===void 0&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(this.ifd1Offset===void 0){this.findIfd0Offset();let e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}parseBlock(e,t){let i=new Map;return this[t]=i,this.parseTags(e,t,i),i}async parseIfd0Block(){if(this.ifd0)return;let{file:e}=this;this.findIfd0Offset(),this.ifd0Offset<8&&Z("Malformed EXIF data"),!e.chunked&&this.ifd0Offset>e.byteLength&&Z(`IFD0 offset points to outside of file.
this.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${e.byteLength}`),e.tiff&&await e.ensureChunk(this.ifd0Offset,or(this.options));let t=this.parseBlock(this.ifd0Offset,"ifd0");return t.size!==0?(this.exifOffset=t.get(34665),this.interopOffset=t.get(40965),this.gpsOffset=t.get(34853),this.xmp=t.get(700),this.iptc=t.get(33723),this.icc=t.get(34675),this.options.sanitize&&(t.delete(34665),t.delete(40965),t.delete(34853),t.delete(700),t.delete(33723),t.delete(34675)),t):void 0}async parseExifBlock(){if(this.exif||(this.ifd0||await this.parseIfd0Block(),this.exifOffset===void 0))return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,or(this.options));let e=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=e.get(40965)),this.makerNote=e.get(37500),this.userComment=e.get(37510),this.options.sanitize&&(e.delete(40965),e.delete(37500),e.delete(37510)),this.unpack(e,41728),this.unpack(e,41729),e}unpack(e,t){let i=e.get(t);i&&i.length===1&&e.set(t,i[0])}async parseGpsBlock(){if(this.gps||(this.ifd0||await this.parseIfd0Block(),this.gpsOffset===void 0))return;let e=this.parseBlock(this.gpsOffset,"gps");return e&&e.has(2)&&e.has(4)&&(e.set("latitude",pr(...e.get(2),e.get(1))),e.set("longitude",pr(...e.get(4),e.get(3)))),e}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),this.interopOffset!==void 0||this.exif||await this.parseExifBlock(),this.interopOffset!==void 0))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(e=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||e))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),this.ifd1===void 0)return;let e=this.ifd1.get(513),t=this.ifd1.get(514);return this.chunk.getUint8Array(e,t)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let e,t,i,r={};for(t of Y)if(e=this[t],!Us(e))if(i=this.canTranslate?this.translateBlock(e,t):Object.fromEntries(e),this.options.mergeOutput){if(t==="ifd1")continue;Object.assign(r,i)}else r[t]=i;return this.makerNote&&(r.makerNote=this.makerNote),this.userComment&&(r.userComment=this.userComment),r}assignToOutput(e,t){if(this.globalOptions.mergeOutput)Object.assign(e,t);else for(let[i,r]of Object.entries(t))this.assignObjectToOutput(e,i,r)}}function pr(n,e,t,i){var r=n+e/60+t/3600;return i!=="S"&&i!=="W"||(r*=-1),r}z(un,"type","tiff"),z(un,"headerLength",10),le.set("tiff",un);const ei={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1};Object.assign({},ei,{firstChunkSize:4e4,gps:[1,2,3,4]});Object.assign({},ei,{tiff:!1,ifd1:!0,mergeOutput:!1});const hc=Object.assign({},ei,{firstChunkSize:4e4,ifd0:[274]});async function pc(n){let e=new oc(hc);await e.read(n);let t=await e.parse();if(t&&t.ifd0)return t.ifd0[274]}const fc=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}});let Le=!0,Me=!0;if(typeof navigator=="object"){let n=navigator.userAgent;if(n.includes("iPad")||n.includes("iPhone")){let e=n.match(/OS (\d+)_(\d+)/);if(e){let[,t,i]=e;Le=Number(t)+.1*Number(i)<13.4,Me=!1}}else if(n.includes("OS X 10")){let[,e]=n.match(/OS X 10[_.](\d+)/);Le=Me=Number(e)<15}if(n.includes("Chrome/")){let[,e]=n.match(/Chrome\/(\d+)/);Le=Me=Number(e)<81}else if(n.includes("Firefox/")){let[,e]=n.match(/Firefox\/(\d+)/);Le=Me=Number(e)<77}}async function mc(n){let e=await pc(n);return Object.assign({canvas:Le,css:Me},fc[e])}class gc extends ce{constructor(...e){super(...e),z(this,"ranges",new yc),this.byteLength!==0&&this.ranges.add(0,this.byteLength)}_tryExtend(e,t,i){if(e===0&&this.byteLength===0&&i){let r=new DataView(i.buffer||i,i.byteOffset,i.byteLength);this._swapDataView(r)}else{let r=e+t;if(r>this.byteLength){let{dataView:s}=this._extend(r);this._swapDataView(s)}}}_extend(e){let t;t=ks?xs.allocUnsafe(e):new Uint8Array(e);let i=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:i}}subarray(e,t,i=!1){return t=t||this._lengthToEnd(e),i&&this._tryExtend(e,t),this.ranges.add(e,t),super.subarray(e,t)}set(e,t,i=!1){i&&this._tryExtend(t,e.byteLength,e);let r=super.set(e,t);return this.ranges.add(t,r.byteLength),r}async ensureChunk(e,t){this.chunked&&(this.ranges.available(e,t)||await this.readChunk(e,t))}available(e,t){return this.ranges.available(e,t)}}class yc{constructor(){z(this,"list",[])}get length(){return this.list.length}add(e,t,i=0){let r=e+t,s=this.list.filter((o=>fr(e,o.offset,r)||fr(e,o.end,r)));if(s.length>0){e=Math.min(e,...s.map((a=>a.offset))),r=Math.max(r,...s.map((a=>a.end))),t=r-e;let o=s.shift();o.offset=e,o.length=t,o.end=r,this.list=this.list.filter((a=>!s.includes(a)))}else this.list.push({offset:e,length:t,end:r})}available(e,t){let i=e+t;return this.list.some((r=>r.offset<=e&&i<=r.end))}}function fr(n,e,t){return n<=e&&e<=t}class bc extends gc{constructor(e,t){super(0),z(this,"chunksRead",0),this.input=e,this.options=t}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(e=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let t=this.options.chunkSize,i=await this.readChunk(e,t);return!!i&&i.byteLength===t}async readChunk(e,t){if(this.chunksRead++,(t=this.safeWrapAddress(e,t))!==0)return this._readChunk(e,t)}safeWrapAddress(e,t){return this.size!==void 0&&e+t>this.size?Math.max(0,this.size-e):t}get nextChunkOffset(){if(this.ranges.list.length!==0)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return this.size!==void 0&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}}Qn.set("blob",class extends bc{async readWhole(){this.chunked=!1;let n=await xn(this.input);this._swapArrayBuffer(n)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(n,e){let t=e?n+e:void 0,i=this.input.slice(n,t),r=await xn(i);return this.set(r,n,!0)}});const vc="4.2.3",_c={version:vc},wc={strings:{generatingThumbnails:"Generating thumbnails..."}};function Sc(n,e,t){try{n.getContext("2d").getImageData(0,0,1,1)}catch(i){if(i.code===18)return Promise.reject(new Error("cannot read image, probably an svg with external resources"))}return n.toBlob?new Promise(i=>{n.toBlob(i,e,t)}).then(i=>{if(i===null)throw new Error("cannot read image, probably an svg with external resources");return i}):Promise.resolve().then(()=>ec(n.toDataURL(e,t),{})).then(i=>{if(i===null)throw new Error("could not extract blob, probably an old browser");return i})}function Fc(n,e){let t=n.width,i=n.height;(e.deg===90||e.deg===270)&&(t=n.height,i=n.width);const r=document.createElement("canvas");r.width=t,r.height=i;const s=r.getContext("2d");return s.translate(t/2,i/2),e.canvas&&(s.rotate(e.rad),s.scale(e.scaleX,e.scaleY)),s.drawImage(n,-n.width/2,-n.height/2,n.width,n.height),r}function Pc(n){const e=n.width/n.height,t=5e6,i=4096;let r=Math.floor(Math.sqrt(t*e)),s=Math.floor(t/Math.sqrt(t*e));if(r>i&&(r=i,s=Math.round(r/e)),s>i&&(s=i,r=Math.round(e*s)),n.width>r){const o=document.createElement("canvas");return o.width=r,o.height=s,o.getContext("2d").drawImage(n,0,0,r,s),o}return n}const Tc={thumbnailWidth:null,thumbnailHeight:null,thumbnailType:"image/jpeg",waitForThumbnailsBeforeUpload:!1,lazy:!1};class Cc extends Fe{static VERSION=_c.version;queue;queueProcessing;defaultThumbnailDimension;thumbnailType;constructor(e,t){if(super(e,{...Tc,...t}),this.type="modifier",this.id=this.opts.id||"ThumbnailGenerator",this.title="Thumbnail Generator",this.queue=[],this.queueProcessing=!1,this.defaultThumbnailDimension=200,this.thumbnailType=this.opts.thumbnailType,this.defaultLocale=wc,this.i18nInit(),this.opts.lazy&&this.opts.waitForThumbnailsBeforeUpload)throw new Error("ThumbnailGenerator: The `lazy` and `waitForThumbnailsBeforeUpload` options are mutually exclusive. Please ensure at most one of them is set to `true`.")}createThumbnail(e,t,i){const r=URL.createObjectURL(e.data),s=new Promise((a,u)=>{const l=new Image;l.src=r,l.addEventListener("load",()=>{URL.revokeObjectURL(r),a(l)}),l.addEventListener("error",d=>{URL.revokeObjectURL(r),u(d.error||new Error("Could not create thumbnail"))})}),o=mc(e.data).catch(()=>1);return Promise.all([s,o]).then(([a,u])=>{const l=this.getProportionalDimensions(a,t,i,u.deg),d=Fc(a,u),h=this.resizeImage(d,l.width,l.height);return Sc(h,this.thumbnailType,80)}).then(a=>URL.createObjectURL(a))}getProportionalDimensions(e,t,i,r){let s=e.width/e.height;if((r===90||r===270)&&(s=e.height/e.width),t!=null){let o=t;return e.width<t&&(o=e.width),{width:o,height:Math.round(o/s)}}if(i!=null){let o=i;return e.height<i&&(o=e.height),{width:Math.round(o*s),height:o}}return{width:this.defaultThumbnailDimension,height:Math.round(this.defaultThumbnailDimension/s)}}resizeImage(e,t,i){let r=Pc(e),s=Math.ceil(Math.log2(r.width/t));s<1&&(s=1);let o=t*2**(s-1),a=i*2**(s-1);const u=2;for(;s--;){const l=document.createElement("canvas");l.width=o,l.height=a,l.getContext("2d").drawImage(r,0,0,o,a),r=l,o=Math.round(o/u),a=Math.round(a/u)}return r}setPreviewURL(e,t){this.uppy.setFileState(e,{preview:t})}addToQueue(e){this.queue.push(e),this.queueProcessing===!1&&this.processQueue()}processQueue(){if(this.queueProcessing=!0,this.queue.length>0){const e=this.uppy.getFile(this.queue.shift());return e?this.requestThumbnail(e).catch(()=>{}).then(()=>this.processQueue()):(this.uppy.log("[ThumbnailGenerator] file was removed before a thumbnail could be generated, but not removed from the queue. This is probably a bug","error"),Promise.resolve())}return this.queueProcessing=!1,this.uppy.log("[ThumbnailGenerator] Emptied thumbnail queue"),this.uppy.emit("thumbnail:all-generated"),Promise.resolve()}requestThumbnail(e){return rr(e.type)&&!e.isRemote?this.createThumbnail(e,this.opts.thumbnailWidth,this.opts.thumbnailHeight).then(t=>{this.setPreviewURL(e.id,t),this.uppy.log(`[ThumbnailGenerator] Generated thumbnail for ${e.id}`),this.uppy.emit("thumbnail:generated",this.uppy.getFile(e.id),t)}).catch(t=>{this.uppy.log(`[ThumbnailGenerator] Failed thumbnail for ${e.id}:`,"warning"),this.uppy.log(t,"warning"),this.uppy.emit("thumbnail:error",this.uppy.getFile(e.id),t)}):Promise.resolve()}onFileAdded=e=>{!e.preview&&e.data&&rr(e.type)&&!e.isRemote&&this.addToQueue(e.id)};onCancelRequest=e=>{const t=this.queue.indexOf(e.id);t!==-1&&this.queue.splice(t,1)};onFileRemoved=e=>{const t=this.queue.indexOf(e.id);t!==-1&&this.queue.splice(t,1),e.preview&&ir(e.preview)&&URL.revokeObjectURL(e.preview)};onRestored=()=>{this.uppy.getFiles().filter(t=>t.isRestored).forEach(t=>{(!t.preview||ir(t.preview))&&this.addToQueue(t.id)})};onAllFilesRemoved=()=>{this.queue=[]};waitUntilAllProcessed=e=>{e.forEach(i=>{const r=this.uppy.getFile(i);this.uppy.emit("preprocess-progress",r,{mode:"indeterminate",message:this.i18n("generatingThumbnails")})});const t=()=>{e.forEach(i=>{const r=this.uppy.getFile(i);this.uppy.emit("preprocess-complete",r)})};return new Promise(i=>{this.queueProcessing?this.uppy.once("thumbnail:all-generated",()=>{t(),i()}):(t(),i())})};install(){this.uppy.on("file-removed",this.onFileRemoved),this.uppy.on("cancel-all",this.onAllFilesRemoved),this.opts.lazy?(this.uppy.on("thumbnail:request",this.onFileAdded),this.uppy.on("thumbnail:cancel",this.onCancelRequest)):(this.uppy.on("thumbnail:request",this.onFileAdded),this.uppy.on("file-added",this.onFileAdded),this.uppy.on("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.addPreProcessor(this.waitUntilAllProcessed)}uninstall(){this.uppy.off("file-removed",this.onFileRemoved),this.uppy.off("cancel-all",this.onAllFilesRemoved),this.opts.lazy?(this.uppy.off("thumbnail:request",this.onFileAdded),this.uppy.off("thumbnail:cancel",this.onCancelRequest)):(this.uppy.off("thumbnail:request",this.onFileAdded),this.uppy.off("file-added",this.onFileAdded),this.uppy.off("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.removePreProcessor(this.waitUntilAllProcessed)}}function mr(n){if(typeof n=="string"){const e=document.querySelectorAll(n);return e.length===0?null:Array.from(e)}return typeof n=="object"&&Jr(n)?[n]:null}const qe=Array.from;function Ec(n){const e=qe(n.files);return Promise.resolve(e)}function Ds(n,e,t,{onSuccess:i}){n.readEntries(r=>{const s=[...e,...r];r.length?queueMicrotask(()=>{Ds(n,s,t,{onSuccess:i})}):i(s)},r=>{t(r),i(e)})}function Ns(n,e){return n==null?n:{kind:n.isFile?"file":n.isDirectory?"directory":void 0,name:n.name,getFile(){return new Promise((t,i)=>n.file(t,i))},async*values(){const t=n.createReader();yield*await new Promise(r=>{Ds(t,[],e,{onSuccess:s=>r(s.map(o=>Ns(o,e)))})})},isSameEntry:void 0}}async function*Bs(n,e,t=void 0){const i=()=>`${e}/${n.name}`;if(n.kind==="file"){const r=await n.getFile();r!=null?(r.relativePath=e?i():null,yield r):t!=null&&(yield t)}else if(n.kind==="directory")for await(const r of n.values())yield*Bs(r,e?i():n.name);else t!=null&&(yield t)}async function*xc(n,e){const t=await Promise.all(Array.from(n.items,async i=>{let r;return r??=Ns(typeof i.getAsEntry=="function"?i.getAsEntry():i.webkitGetAsEntry(),e),{fileSystemHandle:r,lastResortFile:i.getAsFile()}}));for(const{lastResortFile:i,fileSystemHandle:r}of t)if(r!=null)try{yield*Bs(r,"",i)}catch(s){i!=null?yield i:e(s)}else i!=null&&(yield i)}async function kc(n,e){const t=e?.logDropError??Function.prototype;try{const i=[];for await(const r of xc(n,t))i.push(r);return i}catch{return Ec(n)}}const Uc="4.4.3",Oc={version:Uc};function Ac(){const n=document.body;return!(!("draggable"in n)||!("ondragstart"in n&&"ondrop"in n)||!("FormData"in window)||!("FileReader"in window))}class Ls extends se{fileInput=null;folderInput=null;mobilePhotoFileInput=null;mobileVideoFileInput=null;triggerFileInputClick=()=>{this.fileInput?.click()};triggerFolderInputClick=()=>{this.folderInput?.click()};triggerVideoCameraInputClick=()=>{this.mobileVideoFileInput?.click()};triggerPhotoCameraInputClick=()=>{this.mobilePhotoFileInput?.click()};onFileInputChange=e=>{this.props.handleInputChange(e),e.currentTarget.value=""};renderHiddenInput=(e,t)=>c("input",{className:"uppy-Dashboard-input",hidden:!0,"aria-hidden":"true",tabIndex:-1,webkitdirectory:e,type:"file",name:"files[]",multiple:this.props.maxNumberOfFiles!==1,onChange:this.onFileInputChange,accept:this.props.allowedFileTypes?.join(", "),ref:t});renderHiddenCameraInput=(e,t,i)=>{const s={photo:"image/*",video:"video/*"}[e];return c("input",{className:"uppy-Dashboard-input",hidden:!0,"aria-hidden":"true",tabIndex:-1,type:"file",name:`camera-${e}`,onChange:this.onFileInputChange,capture:t===""?"environment":t,accept:s,ref:i})};renderMyDeviceAcquirer=()=>c("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MyDevice",children:c("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerFileInputClick,children:[c("div",{className:"uppy-DashboardTab-inner",children:c("svg",{className:"uppy-DashboardTab-iconMyDevice","aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:c("path",{d:"M8.45 22.087l-1.305-6.674h17.678l-1.572 6.674H8.45zm4.975-12.412l1.083 1.765a.823.823 0 00.715.386h7.951V13.5H8.587V9.675h4.838zM26.043 13.5h-1.195v-2.598c0-.463-.336-.75-.798-.75h-8.356l-1.082-1.766A.823.823 0 0013.897 8H7.728c-.462 0-.815.256-.815.718V13.5h-.956a.97.97 0 00-.746.37.972.972 0 00-.19.81l1.724 8.565c.095.44.484.755.933.755H24c.44 0 .824-.3.929-.727l2.043-8.568a.972.972 0 00-.176-.825.967.967 0 00-.753-.38z",fill:"currentcolor","fill-rule":"evenodd"})})}),c("div",{className:"uppy-DashboardTab-name",children:this.props.i18n("myDevice")})]})});renderPhotoCamera=()=>c("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MobilePhotoCamera",children:c("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerPhotoCameraInputClick,children:[c("div",{className:"uppy-DashboardTab-inner",children:c("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:c("path",{d:"M23.5 9.5c1.417 0 2.5 1.083 2.5 2.5v9.167c0 1.416-1.083 2.5-2.5 2.5h-15c-1.417 0-2.5-1.084-2.5-2.5V12c0-1.417 1.083-2.5 2.5-2.5h2.917l1.416-2.167C13 7.167 13.25 7 13.5 7h5c.25 0 .5.167.667.333L20.583 9.5H23.5zM16 11.417a4.706 4.706 0 00-4.75 4.75 4.704 4.704 0 004.75 4.75 4.703 4.703 0 004.75-4.75c0-2.663-2.09-4.75-4.75-4.75zm0 7.825c-1.744 0-3.076-1.332-3.076-3.074 0-1.745 1.333-3.077 3.076-3.077 1.744 0 3.074 1.333 3.074 3.076s-1.33 3.075-3.074 3.075z",fill:"#02B383","fill-rule":"nonzero"})})}),c("div",{className:"uppy-DashboardTab-name",children:this.props.i18n("takePictureBtn")})]})});renderVideoCamera=()=>c("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MobileVideoCamera",children:c("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerVideoCameraInputClick,children:[c("div",{className:"uppy-DashboardTab-inner",children:c("svg",{"aria-hidden":"true",width:"32",height:"32",viewBox:"0 0 32 32",children:c("path",{fill:"#FF675E",fillRule:"nonzero",d:"m21.254 14.277 2.941-2.588c.797-.313 1.243.818 1.09 1.554-.01 2.094.02 4.189-.017 6.282-.126.915-1.145 1.08-1.58.34l-2.434-2.142c-.192.287-.504 1.305-.738.468-.104-1.293-.028-2.596-.05-3.894.047-.312.381.823.426 1.069.063-.384.206-.744.362-1.09zm-12.939-3.73c3.858.013 7.717-.025 11.574.02.912.129 1.492 1.237 1.351 2.217-.019 2.412.04 4.83-.03 7.239-.17 1.025-1.166 1.59-2.029 1.429-3.705-.012-7.41.025-11.114-.019-.913-.129-1.492-1.237-1.352-2.217.018-2.404-.036-4.813.029-7.214.136-.82.83-1.473 1.571-1.454z "})})}),c("div",{className:"uppy-DashboardTab-name",children:this.props.i18n("recordVideoBtn")})]})});renderBrowseButton=(e,t)=>{const i=this.props.acquirers.length;return c("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-Dashboard-browse",onClick:t,"data-uppy-super-focusable":i===0,children:e})};renderDropPasteBrowseTagline=e=>{const t=this.renderBrowseButton(this.props.i18n("browseFiles"),this.triggerFileInputClick),i=this.renderBrowseButton(this.props.i18n("browseFolders"),this.triggerFolderInputClick),r=this.props.fileManagerSelectionType,s=r.charAt(0).toUpperCase()+r.slice(1);return c("div",{class:"uppy-Dashboard-AddFiles-title",children:this.props.disableLocalFiles?this.props.i18n("importFiles"):e>0?this.props.i18nArray(`dropPasteImport${s}`,{browseFiles:t,browseFolders:i,browse:t}):this.props.i18nArray(`dropPaste${s}`,{browseFiles:t,browseFolders:i,browse:t})})};[Symbol.for("uppy test: disable unused locale key warning")](){this.props.i18nArray("dropPasteBoth"),this.props.i18nArray("dropPasteFiles"),this.props.i18nArray("dropPasteFolders"),this.props.i18nArray("dropPasteImportBoth"),this.props.i18nArray("dropPasteImportFiles"),this.props.i18nArray("dropPasteImportFolders")}renderAcquirer=e=>c("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":e.id,children:c("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-cy":e.id,"aria-controls":`uppy-DashboardContent-panel--${e.id}`,"aria-selected":this.props.activePickerPanel?.id===e.id,"data-uppy-super-focusable":!0,onClick:()=>this.props.showPanel(e.id),children:[c("div",{className:"uppy-DashboardTab-inner",children:e.icon()}),c("div",{className:"uppy-DashboardTab-name",children:e.name})]})});renderAcquirers=e=>{const t=[...e],i=t.splice(e.length-2,e.length);return c(de,{children:[t.map(r=>this.renderAcquirer(r)),c("span",{role:"presentation",style:{"white-space":"nowrap"},children:i.map(r=>this.renderAcquirer(r))})]})};renderSourcesList=(e,t)=>{const{showNativePhotoCameraButton:i,showNativeVideoCameraButton:r}=this.props;let s=[];const o="myDevice";t||s.push({key:o,elements:this.renderMyDeviceAcquirer()}),i&&s.push({key:"nativePhotoCameraButton",elements:this.renderPhotoCamera()}),r&&s.push({key:"nativePhotoCameraButton",elements:this.renderVideoCamera()}),s.push(...e.map(d=>({key:d.id,elements:this.renderAcquirer(d)}))),s.length===1&&s[0].key===o&&(s=[]);const u=[...s],l=u.splice(s.length-2,s.length);return c(de,{children:[this.renderDropPasteBrowseTagline(s.length),c("div",{className:"uppy-Dashboard-AddFiles-list",role:"tablist",children:[u.map(({key:d,elements:h})=>c(de,{children:h},d)),c("span",{role:"presentation",style:{"white-space":"nowrap"},children:l.map(({key:d,elements:h})=>c(de,{children:h},d))})]})]})};renderPoweredByUppy(){const{i18nArray:e}=this.props,t=c("span",{children:[c("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-Dashboard-poweredByIcon",width:"11",height:"11",viewBox:"0 0 11 11",children:c("path",{d:"M7.365 10.5l-.01-4.045h2.612L5.5.806l-4.467 5.65h2.604l.01 4.044h3.718z",fillRule:"evenodd"})}),c("span",{className:"uppy-Dashboard-poweredByUppy",children:"Uppy"})]}),i=e("poweredBy",{uppy:t});return c("a",{tabIndex:-1,href:"https://uppy.io",rel:"noreferrer noopener",target:"_blank",className:"uppy-Dashboard-poweredBy",children:i})}render(){const{showNativePhotoCameraButton:e,showNativeVideoCameraButton:t,nativeCameraFacingMode:i}=this.props;return c("div",{className:"uppy-Dashboard-AddFiles",children:[this.renderHiddenInput(!1,r=>{this.fileInput=r}),this.renderHiddenInput(!0,r=>{this.folderInput=r}),e&&this.renderHiddenCameraInput("photo",i,r=>{this.mobilePhotoFileInput=r}),t&&this.renderHiddenCameraInput("video",i,r=>{this.mobileVideoFileInput=r}),this.renderSourcesList(this.props.acquirers,this.props.disableLocalFiles),c("div",{className:"uppy-Dashboard-AddFiles-info",children:[this.props.note&&c("div",{className:"uppy-Dashboard-note",children:this.props.note}),this.props.proudlyDisplayPoweredByUppy&&this.renderPoweredByUppy()]})]})}}const Rc=n=>c("div",{className:he("uppy-Dashboard-AddFilesPanel",n.className),"data-uppy-panelType":"AddFiles","aria-hidden":!n.showAddFilesPanel,children:[c("div",{className:"uppy-DashboardContent-bar",children:[c("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:n.i18n("addingMoreFiles")}),c("button",{className:"uppy-DashboardContent-back",type:"button",onClick:()=>n.toggleAddFilesPanel(!1),children:n.i18n("back")})]}),c(Ls,{...n})]});function Ic(n){const e=n.files[n.fileCardFor],t=()=>{n.uppy.emit("file-editor:cancel",e),n.closeFileEditor()};return c("div",{className:he("uppy-DashboardContent-panel",n.className),role:"tabpanel","data-uppy-panelType":"FileEditor",id:"uppy-DashboardContent-panel--editor",children:[c("div",{className:"uppy-DashboardContent-bar",children:[c("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:n.i18nArray("editing",{file:c("span",{className:"uppy-DashboardContent-titleFile",children:e.meta?e.meta.name:e.name})})}),c("button",{className:"uppy-DashboardContent-back",type:"button",onClick:t,children:n.i18n("cancel")}),c("button",{className:"uppy-DashboardContent-save",type:"button",onClick:n.saveFileEditor,children:n.i18n("save")})]}),c("div",{className:"uppy-DashboardContent-panelBody",children:n.editors.map(i=>n.uppy.getPlugin(i.id).render(n.state))})]})}function Dc(){return c("svg",{"aria-hidden":"true",focusable:"false",width:"25",height:"25",viewBox:"0 0 25 25",children:c("g",{fill:"#686DE0",fillRule:"evenodd",children:[c("path",{d:"M5 7v10h15V7H5zm0-1h15a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1z",fillRule:"nonzero"}),c("path",{d:"M6.35 17.172l4.994-5.026a.5.5 0 0 1 .707 0l2.16 2.16 3.505-3.505a.5.5 0 0 1 .707 0l2.336 2.31-.707.72-1.983-1.97-3.505 3.505a.5.5 0 0 1-.707 0l-2.16-2.159-3.938 3.939-1.409.026z",fillRule:"nonzero"}),c("circle",{cx:"7.5",cy:"9.5",r:"1.5"})]})})}function Nc(){return c("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:c("path",{d:"M9.5 18.64c0 1.14-1.145 2-2.5 2s-2.5-.86-2.5-2c0-1.14 1.145-2 2.5-2 .557 0 1.079.145 1.5.396V7.25a.5.5 0 0 1 .379-.485l9-2.25A.5.5 0 0 1 18.5 5v11.64c0 1.14-1.145 2-2.5 2s-2.5-.86-2.5-2c0-1.14 1.145-2 2.5-2 .557 0 1.079.145 1.5.396V8.67l-8 2v7.97zm8-11v-2l-8 2v2l8-2zM7 19.64c.855 0 1.5-.484 1.5-1s-.645-1-1.5-1-1.5.484-1.5 1 .645 1 1.5 1zm9-2c.855 0 1.5-.484 1.5-1s-.645-1-1.5-1-1.5.484-1.5 1 .645 1 1.5 1z",fill:"#049BCF",fillRule:"nonzero"})})}function Bc(){return c("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:c("path",{d:"M16 11.834l4.486-2.691A1 1 0 0 1 22 10v6a1 1 0 0 1-1.514.857L16 14.167V17a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V9a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v2.834zM15 9H5v8h10V9zm1 4l5 3v-6l-5 3z",fill:"#19AF67",fillRule:"nonzero"})})}function Lc(){return c("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:c("path",{d:"M9.766 8.295c-.691-1.843-.539-3.401.747-3.726 1.643-.414 2.505.938 2.39 3.299-.039.79-.194 1.662-.537 3.148.324.49.66.967 1.055 1.51.17.231.382.488.629.757 1.866-.128 3.653.114 4.918.655 1.487.635 2.192 1.685 1.614 2.84-.566 1.133-1.839 1.084-3.416.249-1.141-.604-2.457-1.634-3.51-2.707a13.467 13.467 0 0 0-2.238.426c-1.392 4.051-4.534 6.453-5.707 4.572-.986-1.58 1.38-4.206 4.914-5.375.097-.322.185-.656.264-1.001.08-.353.306-1.31.407-1.737-.678-1.059-1.2-2.031-1.53-2.91zm2.098 4.87c-.033.144-.068.287-.104.427l.033-.01-.012.038a14.065 14.065 0 0 1 1.02-.197l-.032-.033.052-.004a7.902 7.902 0 0 1-.208-.271c-.197-.27-.38-.526-.555-.775l-.006.028-.002-.003c-.076.323-.148.632-.186.8zm5.77 2.978c1.143.605 1.832.632 2.054.187.26-.519-.087-1.034-1.113-1.473-.911-.39-2.175-.608-3.55-.608.845.766 1.787 1.459 2.609 1.894zM6.559 18.789c.14.223.693.16 1.425-.413.827-.648 1.61-1.747 2.208-3.206-2.563 1.064-4.102 2.867-3.633 3.62zm5.345-10.97c.088-1.793-.351-2.48-1.146-2.28-.473.119-.564 1.05-.056 2.405.213.566.52 1.188.908 1.859.18-.858.268-1.453.294-1.984z",fill:"#E2514A",fillRule:"nonzero"})})}function Mc(){return c("svg",{"aria-hidden":"true",focusable:"false",width:"25",height:"25",viewBox:"0 0 25 25",children:c("path",{d:"M10.45 2.05h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5V2.55a.5.5 0 0 1 .5-.5zm2.05 1.024h1.05a.5.5 0 0 1 .5.5V3.6a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5v-.001zM10.45 0h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5V.5a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-2.05 3.074h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-2.05 1.024h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm-2.05 1.025h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-1.656 3.074l-.82 5.946c.52.302 1.174.458 1.976.458.803 0 1.455-.156 1.975-.458l-.82-5.946h-2.311zm0-1.025h2.312c.512 0 .946.378 1.015.885l.82 5.946c.056.412-.142.817-.501 1.026-.686.398-1.515.597-2.49.597-.974 0-1.804-.199-2.49-.597a1.025 1.025 0 0 1-.5-1.026l.819-5.946c.07-.507.503-.885 1.015-.885zm.545 6.6a.5.5 0 0 1-.397-.561l.143-.999a.5.5 0 0 1 .495-.429h.74a.5.5 0 0 1 .495.43l.143.998a.5.5 0 0 1-.397.561c-.404.08-.819.08-1.222 0z",fill:"#00C469",fillRule:"nonzero"})})}function $c(){return c("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:c("g",{fill:"#A7AFB7",fillRule:"nonzero",children:[c("path",{d:"M5.5 22a.5.5 0 0 1-.5-.5v-18a.5.5 0 0 1 .5-.5h10.719a.5.5 0 0 1 .367.16l3.281 3.556a.5.5 0 0 1 .133.339V21.5a.5.5 0 0 1-.5.5h-14zm.5-1h13V7.25L16 4H6v17z"}),c("path",{d:"M15 4v3a1 1 0 0 0 1 1h3V7h-3V4h-1z"})]})})}function zc(){return c("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:c("path",{d:"M4.5 7h13a.5.5 0 1 1 0 1h-13a.5.5 0 0 1 0-1zm0 3h15a.5.5 0 1 1 0 1h-15a.5.5 0 1 1 0-1zm0 3h15a.5.5 0 1 1 0 1h-15a.5.5 0 1 1 0-1zm0 3h10a.5.5 0 1 1 0 1h-10a.5.5 0 1 1 0-1z",fill:"#5A5E69",fillRule:"nonzero"})})}function ti(n){const e={color:"#838999",icon:$c()};if(!n)return e;const t=n.split("/")[0],i=n.split("/")[1];return t==="text"?{color:"#5a5e69",icon:zc()}:t==="image"?{color:"#686de0",icon:Dc()}:t==="audio"?{color:"#068dbb",icon:Nc()}:t==="video"?{color:"#19af67",icon:Bc()}:t==="application"&&i==="pdf"?{color:"#e25149",icon:Lc()}:t==="application"&&["zip","x-7z-compressed","x-zip-compressed","x-rar-compressed","x-tar","x-gzip","x-apple-diskimage"].indexOf(i)!==-1?{color:"#00C469",icon:Mc()}:e}function ye(n){const{tagName:e}=n.target;if(e==="INPUT"||e==="TEXTAREA"){n.stopPropagation();return}n.preventDefault(),n.stopPropagation()}function Ms(n){const{file:e}=n;if(e.preview)return c("img",{draggable:!1,className:"uppy-Dashboard-Item-previewImg",alt:e.name,src:e.preview});const{color:t,icon:i}=ti(e.type);return c("div",{className:"uppy-Dashboard-Item-previewIconWrap",children:[c("span",{className:"uppy-Dashboard-Item-previewIcon",style:{color:t},children:i}),c("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-Dashboard-Item-previewIconBg",width:"58",height:"76",viewBox:"0 0 58 76",children:c("rect",{fill:"#FFF",width:"58",height:"76",rx:"3",fillRule:"evenodd"})})]})}function jc(n){const{computedMetaFields:e,requiredMetaFields:t,updateMeta:i,form:r,formState:s}=n,o={text:"uppy-u-reset uppy-c-textInput uppy-Dashboard-FileCard-input"};return e.map(a=>{const u=`uppy-Dashboard-FileCard-input-${a.id}`,l=t.includes(a.id);return c("fieldset",{className:"uppy-Dashboard-FileCard-fieldset",children:[c("label",{className:"uppy-Dashboard-FileCard-label",htmlFor:u,children:a.name}),a.render!==void 0?a.render({value:s[a.id],onChange:d=>i(d,a.id),fieldCSSClasses:o,required:l,form:r.id},Ve):c("input",{className:o.text,id:u,form:r.id,type:a.type||"text",required:l,value:s[a.id],placeholder:a.placeholder,onInput:d=>i(d.target.value,a.id),"data-uppy-super-focusable":!0})]},a.id)})}function qc(n){const{files:e,fileCardFor:t,toggleFileCard:i,saveFileCard:r,metaFields:s,requiredMetaFields:o,openFileEditor:a,i18n:u,i18nArray:l,className:d,canEditFile:h}=n,b=()=>typeof s=="function"?s(e[t]):s,v=e[t],E=b()??[],T=h(v),k={};E.forEach(O=>{k[O.id]=v.meta[O.id]??""});const[S,m]=xt(k),y=fl(O=>{O.preventDefault(),r(S,t)},[r,S,t]),_=(O,I)=>{m({...S,[I]:O})},w=()=>{i(!1)},[U]=xt(()=>{const O=document.createElement("form");return O.setAttribute("tabindex","-1"),O.id=Kn(),O});return Fn(()=>(document.body.appendChild(U),U.addEventListener("submit",y),()=>{U.removeEventListener("submit",y),document.body.removeChild(U)}),[U,y]),c("div",{className:he("uppy-Dashboard-FileCard",d),"data-uppy-panelType":"FileCard",onDragOver:ye,onDragLeave:ye,onDrop:ye,onPaste:ye,children:[c("div",{className:"uppy-DashboardContent-bar",children:[c("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:l("editing",{file:c("span",{className:"uppy-DashboardContent-titleFile",children:v.meta?v.meta.name:v.name})})}),c("button",{className:"uppy-DashboardContent-back",type:"button",form:U.id,title:u("finishEditingFile"),onClick:w,children:u("cancel")})]}),c("div",{className:"uppy-Dashboard-FileCard-inner",children:[c("div",{className:"uppy-Dashboard-FileCard-preview",style:{backgroundColor:ti(v.type).color},children:[c(Ms,{file:v}),T&&c("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-Dashboard-FileCard-edit",onClick:O=>{y(O),a(v)},children:u("editImage")})]}),c("div",{className:"uppy-Dashboard-FileCard-info",children:c(jc,{computedMetaFields:E,requiredMetaFields:o,updateMeta:_,form:U,formState:S})}),c("div",{className:"uppy-Dashboard-FileCard-actions",children:[c("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Dashboard-FileCard-actionsBtn",type:"submit",form:U.id,children:u("saveChanges")}),c("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-link uppy-Dashboard-FileCard-actionsBtn",type:"button",onClick:w,form:U.id,children:u("cancel")})]})]})]})}function Hc(n,e){if(n===e)return!0;if(!n||!e)return!1;const t=Object.keys(n),i=Object.keys(e),r=t.length;if(i.length!==r)return!1;for(let s=0;s<r;s++){const o=t[s];if(n[o]!==e[o]||!Object.prototype.hasOwnProperty.call(e,o))return!1}return!0}function Vc(n,e="Copy the URL below"){return new Promise(t=>{const i=document.createElement("textarea");i.setAttribute("style",{position:"fixed",top:0,left:0,width:"2em",height:"2em",padding:0,border:"none",outline:"none",boxShadow:"none",background:"transparent"}),i.value=n,document.body.appendChild(i),i.select();const r=()=>{document.body.removeChild(i),window.prompt(e,n),t()};try{return document.execCommand("copy")?(document.body.removeChild(i),t()):r()}catch{return document.body.removeChild(i),r()}})}function Wc({file:n,uploadInProgressOrComplete:e,metaFields:t,canEditFile:i,i18n:r,onClick:s}){return!e&&t&&t.length>0||!e&&i(n)?c("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-action uppy-Dashboard-Item-action--edit",type:"button","aria-label":r("editFileWithFilename",{file:n.meta.name}),title:r("editFileWithFilename",{file:n.meta.name}),onClick:()=>s(),children:c("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"14",height:"14",viewBox:"0 0 14 14",children:c("g",{fillRule:"evenodd",children:[c("path",{d:"M1.5 10.793h2.793A1 1 0 0 0 5 10.5L11.5 4a1 1 0 0 0 0-1.414L9.707.793a1 1 0 0 0-1.414 0l-6.5 6.5A1 1 0 0 0 1.5 8v2.793zm1-1V8L9 1.5l1.793 1.793-6.5 6.5H2.5z",fillRule:"nonzero"}),c("rect",{x:"1",y:"12.293",width:"11",height:"1",rx:".5"}),c("path",{fillRule:"nonzero",d:"M6.793 2.5L9.5 5.207l.707-.707L7.5 1.793z"})]})})}):null}function Gc({i18n:n,onClick:e,file:t}){return c("button",{className:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--remove",type:"button","aria-label":n("removeFile",{file:t.meta.name}),title:n("removeFile",{file:t.meta.name}),onClick:()=>e(),children:c("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"18",height:"18",viewBox:"0 0 18 18",children:[c("path",{d:"M9 0C4.034 0 0 4.034 0 9s4.034 9 9 9 9-4.034 9-9-4.034-9-9-9z"}),c("path",{fill:"#FFF",d:"M13 12.222l-.778.778L9 9.778 5.778 13 5 12.222 8.222 9 5 5.778 5.778 5 9 8.222 12.222 5l.778.778L9.778 9z"})]})})}function Kc({file:n,uppy:e,i18n:t}){const i=r=>{Vc(n.uploadURL,t("copyLinkToClipboardFallback")).then(()=>{e.log("Link copied to clipboard."),e.info(t("copyLinkToClipboardSuccess"),"info",3e3)}).catch(e.log).then(()=>r.target.focus({preventScroll:!0}))};return c("button",{className:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--copyLink",type:"button","aria-label":t("copyLink"),title:t("copyLink"),onClick:r=>i(r),children:c("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"14",height:"14",viewBox:"0 0 14 12",children:c("path",{d:"M7.94 7.703a2.613 2.613 0 0 1-.626 2.681l-.852.851a2.597 2.597 0 0 1-1.849.766A2.616 2.616 0 0 1 2.764 7.54l.852-.852a2.596 2.596 0 0 1 2.69-.625L5.267 7.099a1.44 1.44 0 0 0-.833.407l-.852.851a1.458 1.458 0 0 0 1.03 2.486c.39 0 .755-.152 1.03-.426l.852-.852c.231-.231.363-.522.406-.824l1.04-1.038zm4.295-5.937A2.596 2.596 0 0 0 10.387 1c-.698 0-1.355.272-1.849.766l-.852.851a2.614 2.614 0 0 0-.624 2.688l1.036-1.036c.041-.304.173-.6.407-.833l.852-.852c.275-.275.64-.426 1.03-.426a1.458 1.458 0 0 1 1.03 2.486l-.852.851a1.442 1.442 0 0 1-.824.406l-1.04 1.04a2.596 2.596 0 0 0 2.683-.628l.851-.85a2.616 2.616 0 0 0 0-3.697zm-6.88 6.883a.577.577 0 0 0 .82 0l3.474-3.474a.579.579 0 1 0-.819-.82L5.355 7.83a.579.579 0 0 0 0 .819z"})})})}function Xc(n){const{uppy:e,file:t,uploadInProgressOrComplete:i,canEditFile:r,metaFields:s,showLinkToFileUploadResult:o,showRemoveButton:a,i18n:u,toggleFileCard:l,openFileEditor:d}=n;return c("div",{className:"uppy-Dashboard-Item-actionWrapper",children:[c(Wc,{i18n:u,file:t,uploadInProgressOrComplete:i,canEditFile:r,metaFields:s,onClick:()=>{s&&s.length>0?l(!0,t.id):d(t)}}),o&&t.uploadURL?c(Kc,{file:t,uppy:e,i18n:u}):null,a?c(Gc,{i18n:u,file:t,onClick:()=>e.removeFile(t.id)}):null]})}const cn="...";function $s(n,e){if(e===0)return"";if(n.length<=e)return n;if(e<=cn.length+1)return`${n.slice(0,e-1)}…`;const t=e-cn.length,i=Math.ceil(t/2),r=Math.floor(t/2);return n.slice(0,i)+cn+n.slice(-r)}const Yc=(n,e)=>(typeof e=="function"?e():e).filter(r=>r.id===n)[0].name;function zs(n){const{file:e,toggleFileCard:t,i18n:i,metaFields:r}=n,{missingRequiredMetaFields:s}=e;if(!s?.length)return null;const o=s.map(a=>Yc(a,r)).join(", ");return c("div",{className:"uppy-Dashboard-Item-errorMessage",children:[i("missingRequiredMetaFields",{smart_count:s.length,fields:o})," ",c("button",{type:"button",class:"uppy-u-reset uppy-Dashboard-Item-errorMessageBtn",onClick:()=>t(!0,e.id),children:i("editFile")})]})}const Qc=n=>{const{author:e,name:t}=n.file.meta;function i(){return n.isSingleFile&&n.containerHeight>=350?90:n.containerWidth<=352?35:n.containerWidth<=576?60:e?20:30}return c("div",{className:"uppy-Dashboard-Item-name",title:t,children:$s(t,i())})},Zc=n=>{const{author:e}=n.file.meta,t=n.file.remote?.providerName,i="·";return e?c("div",{className:"uppy-Dashboard-Item-author",children:[c("a",{href:`${e.url}?utm_source=Companion&utm_medium=referral`,target:"_blank",rel:"noopener noreferrer",children:$s(e.name,13)}),t?c(de,{children:[` ${i} `,t,` ${i} `]}):null]}):null},Jc=n=>n.file.size&&c("div",{className:"uppy-Dashboard-Item-statusSize",children:Se(n.file.size)}),ed=n=>n.file.isGhost&&c("span",{children:[" • ",c("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-reSelect",type:"button",onClick:()=>n.toggleAddFilesPanel(!0),children:n.i18n("reSelect")})]}),td=({file:n,onClick:e})=>n.error?c("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-errorDetails","aria-label":n.error,"data-microtip-position":"bottom","data-microtip-size":"medium",onClick:e,type:"button",children:"?"}):null;function nd(n){const{file:e,i18n:t,toggleFileCard:i,metaFields:r,toggleAddFilesPanel:s,isSingleFile:o,containerHeight:a,containerWidth:u}=n;return c("div",{className:"uppy-Dashboard-Item-fileInfo","data-uppy-file-source":e.source,children:[c("div",{className:"uppy-Dashboard-Item-fileName",children:[Qc({file:e,isSingleFile:o,containerHeight:a,containerWidth:u}),c(td,{file:e,onClick:()=>alert(e.error)})]}),c("div",{className:"uppy-Dashboard-Item-status",children:[Zc({file:e}),Jc({file:e}),ed({file:e,toggleAddFilesPanel:s,i18n:t})]}),c(zs,{file:e,i18n:t,toggleFileCard:i,metaFields:r})]})}function id(n){const{file:e,i18n:t,toggleFileCard:i,metaFields:r,showLinkToFileUploadResult:s}=n,a=e.preview?"rgba(255, 255, 255, 0.5)":ti(e.type).color;return c("div",{className:"uppy-Dashboard-Item-previewInnerWrap",style:{backgroundColor:a},children:[s&&e.uploadURL&&c("a",{className:"uppy-Dashboard-Item-previewLink",href:e.uploadURL,rel:"noreferrer noopener",target:"_blank","aria-label":e.meta.name,children:c("span",{hidden:!0,children:e.meta.name})}),c(Ms,{file:e}),c(zs,{file:e,i18n:t,toggleFileCard:i,metaFields:r})]})}function rd(n){if(!n.isUploaded){if(n.error&&!n.hideRetryButton){n.uppy.retryUpload(n.file.id);return}n.resumableUploads&&!n.hidePauseResumeButton?n.uppy.pauseResume(n.file.id):n.individualCancellation&&!n.hideCancelButton&&n.uppy.removeFile(n.file.id)}}function gr(n){return n.isUploaded?n.i18n("uploadComplete"):n.error?n.i18n("retryUpload"):n.resumableUploads?n.file.isPaused?n.i18n("resumeUpload"):n.i18n("pauseUpload"):n.individualCancellation?n.i18n("cancelUpload"):""}function dn(n){return c("div",{className:"uppy-Dashboard-Item-progress",children:c("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-progressIndicator",type:"button","aria-label":gr(n),title:gr(n),onClick:()=>rd(n),children:n.children})})}function gt({children:n}){return c("svg",{"aria-hidden":"true",focusable:"false",width:"70",height:"70",viewBox:"0 0 36 36",className:"uppy-c-icon uppy-Dashboard-Item-progressIcon--circle",children:n})}function hn({progress:n}){const e=2*Math.PI*15;return c("g",{children:[c("circle",{className:"uppy-Dashboard-Item-progressIcon--bg",r:"15",cx:"18",cy:"18","stroke-width":"2",fill:"none"}),c("circle",{className:"uppy-Dashboard-Item-progressIcon--progress",r:"15",cx:"18",cy:"18",transform:"rotate(-90, 18, 18)",fill:"none","stroke-width":"2","stroke-dasharray":e,"stroke-dashoffset":e-e/100*n})]})}function sd(n){return!n.file.progress.uploadStarted||n.file.progress.percentage===void 0?null:n.isUploaded?c("div",{className:"uppy-Dashboard-Item-progress",children:c("div",{className:"uppy-Dashboard-Item-progressIndicator",children:c(gt,{children:[c("circle",{r:"15",cx:"18",cy:"18",fill:"#1bb240"}),c("polygon",{className:"uppy-Dashboard-Item-progressIcon--check",transform:"translate(2, 3)",points:"14 22.5 7 15.2457065 8.99985857 13.1732815 14 18.3547104 22.9729883 9 25 11.1005634"})]})})}):n.recoveredState?null:n.error&&!n.hideRetryButton?c(dn,{...n,children:c("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-Dashboard-Item-progressIcon--retry",width:"28",height:"31",viewBox:"0 0 16 19",children:[c("path",{d:"M16 11a8 8 0 1 1-8-8v2a6 6 0 1 0 6 6h2z"}),c("path",{d:"M7.9 3H10v2H7.9z"}),c("path",{d:"M8.536.5l3.535 3.536-1.414 1.414L7.12 1.914z"}),c("path",{d:"M10.657 2.621l1.414 1.415L8.536 7.57 7.12 6.157z"})]})}):n.resumableUploads&&!n.hidePauseResumeButton?c(dn,{...n,children:c(gt,{children:[c(hn,{progress:n.file.progress.percentage}),n.file.isPaused?c("polygon",{className:"uppy-Dashboard-Item-progressIcon--play",transform:"translate(3, 3)",points:"12 20 12 10 20 15"}):c("g",{className:"uppy-Dashboard-Item-progressIcon--pause",transform:"translate(14.5, 13)",children:[c("rect",{x:"0",y:"0",width:"2",height:"10",rx:"0"}),c("rect",{x:"5",y:"0",width:"2",height:"10",rx:"0"})]})]})}):!n.resumableUploads&&n.individualCancellation&&!n.hideCancelButton?c(dn,{...n,children:c(gt,{children:[c(hn,{progress:n.file.progress.percentage}),c("polygon",{className:"cancel",transform:"translate(2, 2)",points:"19.8856516 11.0625 16 14.9481516 12.1019737 11.0625 11.0625 12.1143484 14.9481516 16 11.0625 19.8980263 12.1019737 20.9375 16 17.0518484 19.8856516 20.9375 20.9375 19.8980263 17.0518484 16 20.9375 12"})]})}):c("div",{className:"uppy-Dashboard-Item-progress",children:c("div",{className:"uppy-Dashboard-Item-progressIndicator",children:c(gt,{children:c(hn,{progress:n.file.progress.percentage})})})})}class od extends se{componentDidMount(){const{file:e}=this.props;e.preview||this.props.handleRequestThumbnail(e)}shouldComponentUpdate(e){return!Hc(this.props,e)}componentDidUpdate(){const{file:e}=this.props;e.preview||this.props.handleRequestThumbnail(e)}componentWillUnmount(){const{file:e}=this.props;e.preview||this.props.handleCancelThumbnail(e)}render(){const{file:e}=this.props,t=e.progress.preprocess||e.progress.postprocess,i=!!e.progress.uploadComplete&&!t&&!e.error,r=!!e.progress.uploadStarted||!!t,s=e.progress.uploadStarted&&!e.progress.uploadComplete||t,o=e.error||!1,{isGhost:a}=e;let u=(this.props.individualCancellation||!s)&&!i;i&&this.props.showRemoveButtonAfterComplete&&(u=!0);const l=he({"uppy-Dashboard-Item":!0,"is-inprogress":s&&!this.props.recoveredState,"is-processing":t,"is-complete":i,"is-error":!!o,"is-resumable":this.props.resumableUploads,"is-noIndividualCancellation":!this.props.individualCancellation,"is-ghost":a});return c("div",{className:l,id:`uppy_${e.id}`,role:this.props.role,children:[c("div",{className:"uppy-Dashboard-Item-preview",children:[c(id,{file:e,showLinkToFileUploadResult:this.props.showLinkToFileUploadResult,i18n:this.props.i18n,toggleFileCard:this.props.toggleFileCard,metaFields:this.props.metaFields}),c(sd,{uppy:this.props.uppy,file:e,error:o,isUploaded:i,hideRetryButton:this.props.hideRetryButton,hideCancelButton:this.props.hideCancelButton,hidePauseResumeButton:this.props.hidePauseResumeButton,recoveredState:this.props.recoveredState,resumableUploads:this.props.resumableUploads,individualCancellation:this.props.individualCancellation,i18n:this.props.i18n})]}),c("div",{className:"uppy-Dashboard-Item-fileInfoAndButtons",children:[c(nd,{file:e,containerWidth:this.props.containerWidth,containerHeight:this.props.containerHeight,i18n:this.props.i18n,toggleAddFilesPanel:this.props.toggleAddFilesPanel,toggleFileCard:this.props.toggleFileCard,metaFields:this.props.metaFields,isSingleFile:this.props.isSingleFile}),c(Xc,{file:e,metaFields:this.props.metaFields,showLinkToFileUploadResult:this.props.showLinkToFileUploadResult,showRemoveButton:u,canEditFile:this.props.canEditFile,uploadInProgressOrComplete:r,toggleFileCard:this.props.toggleFileCard,openFileEditor:this.props.openFileEditor,uppy:this.props.uppy,i18n:this.props.i18n})]})]})}}function ad(n,e){const t=[];let i=[];return n.forEach(r=>{i.length<e?i.push(r):(t.push(i),i=[r])}),i.length&&t.push(i),t}function ld({id:n,i18n:e,uppy:t,files:i,resumableUploads:r,hideRetryButton:s,hidePauseResumeButton:o,hideCancelButton:a,showLinkToFileUploadResult:u,showRemoveButtonAfterComplete:l,metaFields:d,isSingleFile:h,toggleFileCard:b,handleRequestThumbnail:v,handleCancelThumbnail:E,recoveredState:T,individualCancellation:k,itemsPerRow:S,openFileEditor:m,canEditFile:y,toggleAddFilesPanel:_,containerWidth:w,containerHeight:U}){const O=S===1?71:200,I=Wn(()=>{const j=(W,x)=>Number(i[x].isGhost)-Number(i[W].isGhost),$=Object.keys(i);return T&&$.sort(j),ad($,S)},[i,S,T]),R=j=>c("div",{class:"uppy-Dashboard-filesInner",role:"presentation",children:j.map($=>c(od,{uppy:t,id:n,i18n:e,resumableUploads:r,individualCancellation:k,hideRetryButton:s,hidePauseResumeButton:o,hideCancelButton:a,showLinkToFileUploadResult:u,showRemoveButtonAfterComplete:l,metaFields:d,recoveredState:T,isSingleFile:h,containerWidth:w,containerHeight:U,toggleFileCard:b,handleRequestThumbnail:v,handleCancelThumbnail:E,role:"listitem",openFileEditor:m,canEditFile:y,toggleAddFilesPanel:_,file:i[$]},$))},j[0]);return h?c("div",{class:"uppy-Dashboard-files",children:R(I[0])}):c(Eu,{class:"uppy-Dashboard-files",role:"list",data:I,renderRow:R,rowHeight:O})}function ud({activePickerPanel:n,className:e,hideAllPanels:t,i18n:i,state:r,uppy:s}){const o=St(null);return c("div",{className:he("uppy-DashboardContent-panel",e),role:"tabpanel","data-uppy-panelType":"PickerPanel",id:`uppy-DashboardContent-panel--${n.id}`,onDragOver:ye,onDragLeave:ye,onDrop:ye,onPaste:ye,children:[c("div",{className:"uppy-DashboardContent-bar",children:[c("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:i("importFrom",{name:n.name})}),c("button",{className:"uppy-DashboardContent-back",type:"button",onClick:t,children:i("cancel")})]}),c("div",{ref:o,className:"uppy-DashboardContent-panelBody",children:s.getPlugin(n.id).render(r,o.current)})]})}const pe={STATE_ERROR:"error",STATE_WAITING:"waiting",STATE_PREPROCESSING:"preprocessing",STATE_UPLOADING:"uploading",STATE_POSTPROCESSING:"postprocessing",STATE_COMPLETE:"complete",STATE_PAUSED:"paused"};function cd(n,e,t,i={}){if(n)return pe.STATE_ERROR;if(e)return pe.STATE_COMPLETE;if(t)return pe.STATE_PAUSED;let r=pe.STATE_WAITING;const s=Object.keys(i);for(let o=0;o<s.length;o++){const{progress:a}=i[s[o]];if(a.uploadStarted&&!a.uploadComplete)return pe.STATE_UPLOADING;a.preprocess&&r!==pe.STATE_UPLOADING&&(r=pe.STATE_PREPROCESSING),a.postprocess&&r!==pe.STATE_UPLOADING&&r!==pe.STATE_PREPROCESSING&&(r=pe.STATE_POSTPROCESSING)}return r}function dd({files:n,i18n:e,isAllComplete:t,isAllErrored:i,isAllPaused:r,inProgressNotPausedFiles:s,newFiles:o,processingFiles:a}){switch(cd(i,t,r,n)){case"uploading":return e("uploadingXFiles",{smart_count:s.length});case"preprocessing":case"postprocessing":return e("processingXFiles",{smart_count:a.length});case"paused":return e("uploadPaused");case"waiting":return e("xFilesSelected",{smart_count:o.length});case"complete":return e("uploadComplete");case"error":return e("error")}}function hd(n){const{i18n:e,isAllComplete:t,hideCancelButton:i,maxNumberOfFiles:r,toggleAddFilesPanel:s,uppy:o}=n;let{allowNewUpload:a}=n;return a&&r&&(a=n.totalFileCount<n.maxNumberOfFiles),c("div",{className:"uppy-DashboardContent-bar",children:[!t&&!i?c("button",{className:"uppy-DashboardContent-back",type:"button",onClick:()=>o.cancelAll(),children:e("cancel")}):c("div",{}),c("div",{className:"uppy-DashboardContent-title",children:c(dd,{...n})}),a?c("button",{className:"uppy-DashboardContent-addMore",type:"button","aria-label":e("addMoreFiles"),title:e("addMoreFiles"),onClick:()=>s(!0),children:[c("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"15",height:"15",viewBox:"0 0 15 15",children:c("path",{d:"M8 6.5h6a.5.5 0 0 1 .5.5v.5a.5.5 0 0 1-.5.5H8v6a.5.5 0 0 1-.5.5H7a.5.5 0 0 1-.5-.5V8h-6a.5.5 0 0 1-.5-.5V7a.5.5 0 0 1 .5-.5h6v-6A.5.5 0 0 1 7 0h.5a.5.5 0 0 1 .5.5v6z"})}),c("span",{className:"uppy-DashboardContent-addMoreCaption",children:e("addMore")})]}):c("div",{})]})}const Ce="uppy-transition-slideDownUp",yr=250;function yt({children:n}){const[e,t]=xt(null),[i,r]=xt(""),s=St(),o=St(),a=St(),u=()=>{r(`${Ce}-enter`),cancelAnimationFrame(a.current),clearTimeout(o.current),o.current=void 0,a.current=requestAnimationFrame(()=>{r(`${Ce}-enter ${Ce}-enter-active`),s.current=setTimeout(()=>{r("")},yr)})},l=()=>{r(`${Ce}-leave`),cancelAnimationFrame(a.current),clearTimeout(s.current),s.current=void 0,a.current=requestAnimationFrame(()=>{r(`${Ce}-leave ${Ce}-leave-active`),o.current=setTimeout(()=>{t(null),r("")},yr)})};return Fn(()=>{const d=ue(n)[0];e!==d&&(d&&!e?u():e&&!d&&!o.current&&l(),t(d))},[n,e]),Fn(()=>()=>{clearTimeout(s.current),clearTimeout(o.current),cancelAnimationFrame(a.current)},[]),e?hs(e,{className:he(i,e.props.className)}):null}const br=900,vr=700,pn=576,_r=330;function pd(n){const e=n.totalFileCount===0,t=n.totalFileCount===1,i=n.containerWidth>pn,r=n.containerHeight>_r,s=he({"uppy-Dashboard":!0,"uppy-Dashboard--isDisabled":n.disabled,"uppy-Dashboard--animateOpenClose":n.animateOpenClose,"uppy-Dashboard--isClosing":n.isClosing,"uppy-Dashboard--isDraggingOver":n.isDraggingOver,"uppy-Dashboard--modal":!n.inline,"uppy-size--md":n.containerWidth>pn,"uppy-size--lg":n.containerWidth>vr,"uppy-size--xl":n.containerWidth>br,"uppy-size--height-md":n.containerHeight>_r,"uppy-Dashboard--isAddFilesPanelVisible":n.showAddFilesPanel,"uppy-Dashboard--isInnerWrapVisible":n.areInsidesReadyToBeVisible,"uppy-Dashboard--singleFile":n.singleFileFullScreen&&t&&r});let o=1;n.containerWidth>br?o=5:n.containerWidth>vr?o=4:n.containerWidth>pn&&(o=3);const a=n.showSelectedFiles&&!e,u=n.recoveredState?Object.keys(n.recoveredState.files).length:null,l=n.files?Object.keys(n.files).filter(b=>n.files[b].isGhost).length:0,d=()=>l>0?n.i18n("recoveredXFiles",{smart_count:l}):n.i18n("recoveredAllFiles");return c("div",{className:s,"data-uppy-theme":n.theme,"data-uppy-num-acquirers":n.acquirers.length,"data-uppy-drag-drop-supported":!n.disableLocalFiles&&Ac(),"aria-hidden":n.inline?"false":n.isHidden,"aria-disabled":n.disabled,"aria-label":n.inline?n.i18n("dashboardTitle"):n.i18n("dashboardWindowTitle"),onPaste:n.handlePaste,onDragOver:n.handleDragOver,onDragLeave:n.handleDragLeave,onDrop:n.handleDrop,children:[c("div",{"aria-hidden":"true",className:"uppy-Dashboard-overlay",tabIndex:-1,onClick:n.handleClickOutside}),c("div",{className:"uppy-Dashboard-inner",role:n.inline?void 0:"dialog",style:{width:n.inline&&n.width?n.width:"",height:n.inline&&n.height?n.height:""},children:[n.inline?null:c("button",{className:"uppy-u-reset uppy-Dashboard-close",type:"button","aria-label":n.i18n("closeModal"),title:n.i18n("closeModal"),onClick:n.closeModal,children:c("span",{"aria-hidden":"true",children:"×"})}),c("div",{className:"uppy-Dashboard-innerWrap",children:[c("div",{className:"uppy-Dashboard-dropFilesHereHint",children:n.i18n("dropHint")}),a&&c(hd,{...n}),u&&c("div",{className:"uppy-Dashboard-serviceMsg",children:[c("svg",{className:"uppy-Dashboard-serviceMsg-icon","aria-hidden":"true",focusable:"false",width:"21",height:"16",viewBox:"0 0 24 19",children:c("g",{transform:"translate(0 -1)",fill:"none",fillRule:"evenodd",children:[c("path",{d:"M12.857 1.43l10.234 17.056A1 1 0 0122.234 20H1.766a1 1 0 01-.857-1.514L11.143 1.429a1 1 0 011.714 0z",fill:"#FFD300"}),c("path",{fill:"#000",d:"M11 6h2l-.3 8h-1.4z"}),c("circle",{fill:"#000",cx:"12",cy:"17",r:"1"})]})}),c("strong",{className:"uppy-Dashboard-serviceMsg-title",children:n.i18n("sessionRestored")}),c("div",{className:"uppy-Dashboard-serviceMsg-text",children:d()})]}),a?c(ld,{id:n.id,i18n:n.i18n,uppy:n.uppy,files:n.files,resumableUploads:n.resumableUploads,hideRetryButton:n.hideRetryButton,hidePauseResumeButton:n.hidePauseResumeButton,hideCancelButton:n.hideCancelButton,showLinkToFileUploadResult:n.showLinkToFileUploadResult,showRemoveButtonAfterComplete:n.showRemoveButtonAfterComplete,metaFields:n.metaFields,toggleFileCard:n.toggleFileCard,handleRequestThumbnail:n.handleRequestThumbnail,handleCancelThumbnail:n.handleCancelThumbnail,recoveredState:n.recoveredState,individualCancellation:n.individualCancellation,openFileEditor:n.openFileEditor,canEditFile:n.canEditFile,toggleAddFilesPanel:n.toggleAddFilesPanel,isSingleFile:t,itemsPerRow:o,containerWidth:n.containerWidth,containerHeight:n.containerHeight}):c(Ls,{i18n:n.i18n,i18nArray:n.i18nArray,acquirers:n.acquirers,handleInputChange:n.handleInputChange,maxNumberOfFiles:n.maxNumberOfFiles,allowedFileTypes:n.allowedFileTypes,showNativePhotoCameraButton:n.showNativePhotoCameraButton,showNativeVideoCameraButton:n.showNativeVideoCameraButton,nativeCameraFacingMode:n.nativeCameraFacingMode,showPanel:n.showPanel,activePickerPanel:n.activePickerPanel,disableLocalFiles:n.disableLocalFiles,fileManagerSelectionType:n.fileManagerSelectionType,note:n.note,proudlyDisplayPoweredByUppy:n.proudlyDisplayPoweredByUppy}),c(yt,{children:n.showAddFilesPanel?c(Rc,{...n,isSizeMD:i},"AddFiles"):null}),c(yt,{children:n.fileCardFor?c(qc,{...n},"FileCard"):null}),c(yt,{children:n.activePickerPanel?c(ud,{...n},"Picker"):null}),c(yt,{children:n.showFileEditor?c(Ic,{...n},"Editor"):null}),c("div",{className:"uppy-Dashboard-progressindicators",children:n.progressindicators.map(b=>n.uppy.getPlugin(b.id).render(n.state))})]})]})]})}const fd={strings:{closeModal:"Close Modal",addMoreFiles:"Add more files",addingMoreFiles:"Adding more files",importFrom:"Import from %{name}",dashboardWindowTitle:"Uppy Dashboard Window (Press escape to close)",dashboardTitle:"Uppy Dashboard",copyLinkToClipboardSuccess:"Link copied to clipboard.",copyLinkToClipboardFallback:"Copy the URL below",copyLink:"Copy link",back:"Back",removeFile:"Remove file",editFile:"Edit file",editImage:"Edit image",editing:"Editing %{file}",error:"Error",finishEditingFile:"Finish editing file",saveChanges:"Save changes",myDevice:"My Device",dropHint:"Drop your files here",uploadComplete:"Upload complete",uploadPaused:"Upload paused",resumeUpload:"Resume upload",pauseUpload:"Pause upload",retryUpload:"Retry upload",cancelUpload:"Cancel upload",xFilesSelected:{0:"%{smart_count} file selected",1:"%{smart_count} files selected"},uploadingXFiles:{0:"Uploading %{smart_count} file",1:"Uploading %{smart_count} files"},processingXFiles:{0:"Processing %{smart_count} file",1:"Processing %{smart_count} files"},poweredBy:"Powered by %{uppy}",addMore:"Add more",editFileWithFilename:"Edit file %{file}",save:"Save",cancel:"Cancel",dropPasteFiles:"Drop files here or %{browseFiles}",dropPasteFolders:"Drop files here or %{browseFolders}",dropPasteBoth:"Drop files here, %{browseFiles} or %{browseFolders}",dropPasteImportFiles:"Drop files here, %{browseFiles} or import from:",dropPasteImportFolders:"Drop files here, %{browseFolders} or import from:",dropPasteImportBoth:"Drop files here, %{browseFiles}, %{browseFolders} or import from:",importFiles:"Import files from:",browseFiles:"browse files",browseFolders:"browse folders",recoveredXFiles:{0:"We could not fully recover 1 file. Please re-select it and resume the upload.",1:"We could not fully recover %{smart_count} files. Please re-select them and resume the upload."},recoveredAllFiles:"We restored all files. You can now resume the upload.",sessionRestored:"Session restored",reSelect:"Re-select",missingRequiredMetaFields:{0:"Missing required meta field: %{fields}.",1:"Missing required meta fields: %{fields}."},takePictureBtn:"Take Picture",recordVideoBtn:"Record Video"}},js=['a[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','area[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])',"input:not([disabled]):not([inert]):not([aria-hidden])","select:not([disabled]):not([inert]):not([aria-hidden])","textarea:not([disabled]):not([inert]):not([aria-hidden])","button:not([disabled]):not([inert]):not([aria-hidden])",'iframe:not([tabindex^="-"]):not([inert]):not([aria-hidden])','object:not([tabindex^="-"]):not([inert]):not([aria-hidden])','embed:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[contenteditable]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[tabindex]:not([tabindex^="-"]):not([inert]):not([aria-hidden])'];var md=Fs();const gd=ve(md);function qs(n,e){if(e){const t=n.querySelector(`[data-uppy-paneltype="${e}"]`);if(t)return t}return n}function yd(){let n=!1;return gd((t,i)=>{const r=qs(t,i),s=r.contains(document.activeElement);if(s&&n)return;const o=r.querySelector("[data-uppy-super-focusable]");s&&!o||(o?(o.focus({preventScroll:!0}),n=!0):(r.querySelector(js)?.focus({preventScroll:!0}),n=!1))},260)}function wr(n,e){const t=e[0];t&&(t.focus(),n.preventDefault())}function bd(n,e){const t=e[e.length-1];t&&(t.focus(),n.preventDefault())}function vd(n){return n.contains(document.activeElement)}function Hs(n,e,t){const i=qs(t,e),r=qe(i.querySelectorAll(js)),s=r.indexOf(document.activeElement);vd(i)?n.shiftKey&&s===0?bd(n,r):!n.shiftKey&&s===r.length-1&&wr(n,r):wr(n,r)}function _d(n,e,t){e===null||Hs(n,e,t)}const Sr=9,wd=27;function Fr(){const n={};return n.promise=new Promise((e,t)=>{n.resolve=e,n.reject=t}),n}const Sd={target:"body",metaFields:[],thumbnailWidth:280,thumbnailType:"image/jpeg",waitForThumbnailsBeforeUpload:!1,defaultPickerIcon:xu,showLinkToFileUploadResult:!1,showProgressDetails:!1,hideUploadButton:!1,hideCancelButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideProgressAfterFinish:!1,note:null,singleFileFullScreen:!0,disableStatusBar:!1,disableInformer:!1,disableThumbnailGenerator:!1,fileManagerSelectionType:"files",proudlyDisplayPoweredByUppy:!0,showSelectedFiles:!0,showRemoveButtonAfterComplete:!1,showNativePhotoCameraButton:!1,showNativeVideoCameraButton:!1,theme:"light",autoOpen:null,disabled:!1,disableLocalFiles:!1,nativeCameraFacingMode:"",onDragLeave:()=>{},onDragOver:()=>{},onDrop:()=>{},plugins:[],doneButtonHandler:void 0,onRequestCloseModal:null,inline:!1,animateOpenClose:!0,browserBackButtonClose:!1,closeAfterFinish:!1,closeModalOnClickOutside:!1,disablePageScrollWhenModalOpen:!0,trigger:null,width:750,height:550};class Fd extends Fe{static VERSION=Oc.version;#e;modalName=`uppy-Dashboard-${Kn()}`;superFocus=yd();ifFocusedOnUppyRecently=!1;dashboardIsDisabled;savedScrollPosition;savedActiveElement;resizeObserver;darkModeMediaQuery;makeDashboardInsidesVisibleAnywayTimeout;constructor(e,t){const i=t?.autoOpen??null;super(e,{...Sd,...t,autoOpen:i}),this.id=this.opts.id||"Dashboard",this.title="Dashboard",this.type="orchestrator",this.defaultLocale=fd,this.opts.doneButtonHandler===void 0&&(this.opts.doneButtonHandler=()=>{this.uppy.clear(),this.requestCloseModal()}),this.opts.onRequestCloseModal??=()=>this.closeModal(),this.i18nInit()}removeTarget=e=>{const i=this.getPluginState().targets.filter(r=>r.id!==e.id);this.setPluginState({targets:i})};addTarget=e=>{const t=e.id||e.constructor.name,i=e.title||t,r=e.type;if(r!=="acquirer"&&r!=="progressindicator"&&r!=="editor")return this.uppy.log("Dashboard: can only be targeted by plugins of types: acquirer, progressindicator, editor","error"),null;const s={id:t,name:i,type:r},a=this.getPluginState().targets.slice();return a.push(s),this.setPluginState({targets:a}),this.el};hideAllPanels=()=>{const e=this.getPluginState(),t={activePickerPanel:void 0,showAddFilesPanel:!1,activeOverlayType:null,fileCardFor:null,showFileEditor:!1};e.activePickerPanel===t.activePickerPanel&&e.showAddFilesPanel===t.showAddFilesPanel&&e.showFileEditor===t.showFileEditor&&e.activeOverlayType===t.activeOverlayType||(this.setPluginState(t),this.uppy.emit("dashboard:close-panel",e.activePickerPanel?.id))};showPanel=e=>{const{targets:t}=this.getPluginState(),i=t.find(r=>r.type==="acquirer"&&r.id===e);this.setPluginState({activePickerPanel:i,activeOverlayType:"PickerPanel"}),this.uppy.emit("dashboard:show-panel",e)};canEditFile=e=>{const{targets:t}=this.getPluginState();return this.#s(t).some(r=>this.uppy.getPlugin(r.id).canEditFile(e))};openFileEditor=e=>{const{targets:t}=this.getPluginState(),i=this.#s(t);this.setPluginState({showFileEditor:!0,fileCardFor:e.id||null,activeOverlayType:"FileEditor"}),i.forEach(r=>{this.uppy.getPlugin(r.id).selectFile(e)})};closeFileEditor=()=>{const{metaFields:e}=this.getPluginState();e&&e.length>0?this.setPluginState({showFileEditor:!1,activeOverlayType:"FileCard"}):this.setPluginState({showFileEditor:!1,fileCardFor:null,activeOverlayType:"AddFiles"})};saveFileEditor=()=>{const{targets:e}=this.getPluginState();this.#s(e).forEach(i=>{this.uppy.getPlugin(i.id).save()}),this.closeFileEditor()};openModal=()=>{const{promise:e,resolve:t}=Fr();if(this.savedScrollPosition=window.pageYOffset,this.savedActiveElement=document.activeElement,this.opts.disablePageScrollWhenModalOpen&&document.body.classList.add("uppy-Dashboard-isFixed"),this.opts.animateOpenClose&&this.getPluginState().isClosing){const i=()=>{this.setPluginState({isHidden:!1}),this.el.removeEventListener("animationend",i,!1),t()};this.el.addEventListener("animationend",i,!1)}else this.setPluginState({isHidden:!1}),t();return this.opts.browserBackButtonClose&&this.updateBrowserHistory(),document.addEventListener("keydown",this.handleKeyDownInModal),this.uppy.emit("dashboard:modal-open"),e};closeModal=e=>{const t=e?.manualClose??!0,{isHidden:i,isClosing:r}=this.getPluginState();if(i||r)return;const{promise:s,resolve:o}=Fr();if(this.opts.disablePageScrollWhenModalOpen&&document.body.classList.remove("uppy-Dashboard-isFixed"),this.opts.animateOpenClose){this.setPluginState({isClosing:!0});const a=()=>{this.setPluginState({isHidden:!0,isClosing:!1}),this.superFocus.cancel(),this.savedActiveElement.focus(),this.el.removeEventListener("animationend",a,!1),o()};this.el.addEventListener("animationend",a,!1)}else this.setPluginState({isHidden:!0}),this.superFocus.cancel(),this.savedActiveElement.focus(),o();return document.removeEventListener("keydown",this.handleKeyDownInModal),t&&this.opts.browserBackButtonClose&&history.state?.[this.modalName]&&history.back(),this.uppy.emit("dashboard:modal-closed"),s};isModalOpen=()=>!this.getPluginState().isHidden||!1;requestCloseModal=()=>this.opts.onRequestCloseModal?this.opts.onRequestCloseModal():this.closeModal();setDarkModeCapability=e=>{const{capabilities:t}=this.uppy.getState();this.uppy.setState({capabilities:{...t,darkMode:e}})};handleSystemDarkModeChange=e=>{const t=e.matches;this.uppy.log(`[Dashboard] Dark mode is ${t?"on":"off"}`),this.setDarkModeCapability(t)};toggleFileCard=(e,t)=>{const i=this.uppy.getFile(t);e?this.uppy.emit("dashboard:file-edit-start",i):this.uppy.emit("dashboard:file-edit-complete",i),this.setPluginState({fileCardFor:e?t:null,activeOverlayType:e?"FileCard":null})};toggleAddFilesPanel=e=>{this.setPluginState({showAddFilesPanel:e,activeOverlayType:e?"AddFiles":null})};addFiles=e=>{const t=e.map(i=>({source:this.id,name:i.name,type:i.type,data:i,meta:{relativePath:i.relativePath||i.webkitRelativePath||null}}));try{this.uppy.addFiles(t)}catch(i){this.uppy.log(i)}};startListeningToResize=()=>{this.resizeObserver=new ResizeObserver(e=>{const t=e[0],{width:i,height:r}=t.contentRect;this.setPluginState({containerWidth:i,containerHeight:r,areInsidesReadyToBeVisible:!0})}),this.resizeObserver.observe(this.el.querySelector(".uppy-Dashboard-inner")),this.makeDashboardInsidesVisibleAnywayTimeout=setTimeout(()=>{const e=this.getPluginState(),t=!this.opts.inline&&e.isHidden;!e.areInsidesReadyToBeVisible&&!t&&(this.uppy.log("[Dashboard] resize event didn’t fire on time: defaulted to mobile layout","warning"),this.setPluginState({areInsidesReadyToBeVisible:!0}))},1e3)};stopListeningToResize=()=>{this.resizeObserver.disconnect(),clearTimeout(this.makeDashboardInsidesVisibleAnywayTimeout)};recordIfFocusedOnUppyRecently=e=>{this.el.contains(e.target)?this.ifFocusedOnUppyRecently=!0:(this.ifFocusedOnUppyRecently=!1,this.superFocus.cancel())};disableInteractiveElements=e=>{const t=["a[href]","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])",'[role="button"]:not([disabled])'],i=this.#e??qe(this.el.querySelectorAll(t)).filter(r=>!r.classList.contains("uppy-Dashboard-close"));for(const r of i)r.tagName==="A"?r.setAttribute("aria-disabled",e):r.disabled=e;e?this.#e=i:this.#e=null,this.dashboardIsDisabled=e};updateBrowserHistory=()=>{history.state?.[this.modalName]||history.pushState({...history.state,[this.modalName]:!0},""),window.addEventListener("popstate",this.handlePopState,!1)};handlePopState=e=>{this.isModalOpen()&&(!e.state||!e.state[this.modalName])&&this.closeModal({manualClose:!1}),!this.isModalOpen()&&e.state?.[this.modalName]&&history.back()};handleKeyDownInModal=e=>{e.keyCode===wd&&this.requestCloseModal(),e.keyCode===Sr&&Hs(e,this.getPluginState().activeOverlayType,this.el)};handleClickOutside=()=>{this.opts.closeModalOnClickOutside&&this.requestCloseModal()};handlePaste=e=>{this.uppy.iteratePlugins(i=>{i.type==="acquirer"&&i.handleRootPaste?.(e)});const t=qe(e.clipboardData.files);t.length>0&&(this.uppy.log("[Dashboard] Files pasted"),this.addFiles(t))};handleInputChange=e=>{e.preventDefault();const t=qe(e.currentTarget.files||[]);t.length>0&&(this.uppy.log("[Dashboard] Files selected through input"),this.addFiles(t))};handleDragOver=e=>{e.preventDefault(),e.stopPropagation();const t=()=>{let o=!0;return this.uppy.iteratePlugins(a=>{a.canHandleRootDrop?.(e)&&(o=!0)}),o},i=()=>{const{types:o}=e.dataTransfer;return o.some(a=>a==="Files")},r=t(),s=i();if(!r&&!s||this.opts.disabled||this.opts.disableLocalFiles&&(s||!r)||!this.uppy.getState().allowNewUpload){e.dataTransfer.dropEffect="none";return}e.dataTransfer.dropEffect="copy",this.setPluginState({isDraggingOver:!0}),this.opts.onDragOver(e)};handleDragLeave=e=>{e.preventDefault(),e.stopPropagation(),this.setPluginState({isDraggingOver:!1}),this.opts.onDragLeave(e)};handleDrop=async e=>{e.preventDefault(),e.stopPropagation(),this.setPluginState({isDraggingOver:!1}),this.uppy.iteratePlugins(s=>{s.type==="acquirer"&&s.handleRootDrop?.(e)});let t=!1;const i=s=>{this.uppy.log(s,"error"),t||(this.uppy.info(s.message,"error"),t=!0)};this.uppy.log("[Dashboard] Processing dropped files");const r=await kc(e.dataTransfer,{logDropError:i});r.length>0&&(this.uppy.log("[Dashboard] Files dropped"),this.addFiles(r)),this.opts.onDrop(e)};handleRequestThumbnail=e=>{this.opts.waitForThumbnailsBeforeUpload||this.uppy.emit("thumbnail:request",e)};handleCancelThumbnail=e=>{this.opts.waitForThumbnailsBeforeUpload||this.uppy.emit("thumbnail:cancel",e)};handleKeyDownInInline=e=>{e.keyCode===Sr&&_d(e,this.getPluginState().activeOverlayType,this.el)};handlePasteOnBody=e=>{this.el.contains(document.activeElement)&&this.handlePaste(e)};handleComplete=({failed:e})=>{this.opts.closeAfterFinish&&!e?.length&&this.requestCloseModal()};handleCancelRestore=()=>{this.uppy.emit("restore-canceled")};#t=()=>{if(this.opts.disableThumbnailGenerator)return;const e=600,t=this.uppy.getFiles();if(t.length===1){const i=this.uppy.getPlugin(`${this.id}:ThumbnailGenerator`);i?.setOptions({thumbnailWidth:e});const r={...t[0],preview:void 0};i?.requestThumbnail(r).then(()=>{i?.setOptions({thumbnailWidth:this.opts.thumbnailWidth})})}};#i=e=>{const t=e[0],{metaFields:i}=this.getPluginState(),r=i&&i.length>0,s=this.canEditFile(t);r&&this.opts.autoOpen==="metaEditor"?this.toggleFileCard(!0,t.id):s&&this.opts.autoOpen==="imageEditor"&&this.openFileEditor(t)};initEvents=()=>{if(this.opts.trigger&&!this.opts.inline){const e=mr(this.opts.trigger);e?e.forEach(t=>t.addEventListener("click",this.openModal)):this.uppy.log("Dashboard modal trigger not found. Make sure `trigger` is set in Dashboard options, unless you are planning to call `dashboard.openModal()` method yourself","warning")}this.startListeningToResize(),document.addEventListener("paste",this.handlePasteOnBody),this.uppy.on("plugin-added",this.#u),this.uppy.on("plugin-remove",this.removeTarget),this.uppy.on("file-added",this.hideAllPanels),this.uppy.on("dashboard:modal-closed",this.hideAllPanels),this.uppy.on("complete",this.handleComplete),this.uppy.on("files-added",this.#t),this.uppy.on("file-removed",this.#t),document.addEventListener("focus",this.recordIfFocusedOnUppyRecently,!0),document.addEventListener("click",this.recordIfFocusedOnUppyRecently,!0),this.opts.inline&&this.el.addEventListener("keydown",this.handleKeyDownInInline),this.opts.autoOpen&&this.uppy.on("files-added",this.#i)};removeEvents=()=>{const e=mr(this.opts.trigger);!this.opts.inline&&e&&e.forEach(t=>t.removeEventListener("click",this.openModal)),this.stopListeningToResize(),document.removeEventListener("paste",this.handlePasteOnBody),window.removeEventListener("popstate",this.handlePopState,!1),this.uppy.off("plugin-added",this.#u),this.uppy.off("plugin-remove",this.removeTarget),this.uppy.off("file-added",this.hideAllPanels),this.uppy.off("dashboard:modal-closed",this.hideAllPanels),this.uppy.off("complete",this.handleComplete),this.uppy.off("files-added",this.#t),this.uppy.off("file-removed",this.#t),document.removeEventListener("focus",this.recordIfFocusedOnUppyRecently),document.removeEventListener("click",this.recordIfFocusedOnUppyRecently),this.opts.inline&&this.el.removeEventListener("keydown",this.handleKeyDownInInline),this.opts.autoOpen&&this.uppy.off("files-added",this.#i)};superFocusOnEachUpdate=()=>{const e=this.el.contains(document.activeElement),t=document.activeElement===document.body||document.activeElement===null,i=this.uppy.getState().info.length===0,r=!this.opts.inline;i&&(r||e||t&&this.ifFocusedOnUppyRecently)?this.superFocus(this.el,this.getPluginState().activeOverlayType):this.superFocus.cancel()};afterUpdate=()=>{if(this.opts.disabled&&!this.dashboardIsDisabled){this.disableInteractiveElements(!0);return}!this.opts.disabled&&this.dashboardIsDisabled&&this.disableInteractiveElements(!1),this.superFocusOnEachUpdate()};saveFileCard=(e,t)=>{this.uppy.setFileMeta(t,e),this.toggleFileCard(!1,t)};#n=e=>{const t=this.uppy.getPlugin(e.id);return{...e,icon:t.icon||this.opts.defaultPickerIcon,render:t.render}};#r=e=>{const t=this.uppy.getPlugin(e.id);return typeof t.isSupported!="function"?!0:t.isSupported()};#o=e=>e.filter(t=>t.type==="acquirer"&&this.#r(t)).map(this.#n);#a=e=>e.filter(t=>t.type==="progressindicator").map(this.#n);#s=e=>e.filter(t=>t.type==="editor").map(this.#n);render=e=>{const t=this.getPluginState(),{files:i,capabilities:r,allowNewUpload:s}=e,{newFiles:o,uploadStartedFiles:a,completeFiles:u,erroredFiles:l,inProgressFiles:d,inProgressNotPausedFiles:h,processingFiles:b,isUploadStarted:v,isAllComplete:E,isAllPaused:T}=this.uppy.getObjectOfFilesPerState(),k=this.#o(t.targets),S=this.#a(t.targets),m=this.#s(t.targets);let y;return this.opts.theme==="auto"?y=r.darkMode?"dark":"light":y=this.opts.theme,["files","folders","both"].indexOf(this.opts.fileManagerSelectionType)<0&&(this.opts.fileManagerSelectionType="files",console.warn(`Unsupported option for "fileManagerSelectionType". Using default of "${this.opts.fileManagerSelectionType}".`)),pd({state:e,isHidden:t.isHidden,files:i,newFiles:o,uploadStartedFiles:a,completeFiles:u,erroredFiles:l,inProgressFiles:d,inProgressNotPausedFiles:h,processingFiles:b,isUploadStarted:v,isAllComplete:E,isAllPaused:T,totalFileCount:Object.keys(i).length,totalProgress:e.totalProgress,allowNewUpload:s,acquirers:k,theme:y,disabled:this.opts.disabled,disableLocalFiles:this.opts.disableLocalFiles,direction:this.opts.direction,activePickerPanel:t.activePickerPanel,showFileEditor:t.showFileEditor,saveFileEditor:this.saveFileEditor,closeFileEditor:this.closeFileEditor,disableInteractiveElements:this.disableInteractiveElements,animateOpenClose:this.opts.animateOpenClose,isClosing:t.isClosing,progressindicators:S,editors:m,autoProceed:this.uppy.opts.autoProceed,id:this.id,closeModal:this.requestCloseModal,handleClickOutside:this.handleClickOutside,handleInputChange:this.handleInputChange,handlePaste:this.handlePaste,inline:this.opts.inline,showPanel:this.showPanel,hideAllPanels:this.hideAllPanels,i18n:this.i18n,i18nArray:this.i18nArray,uppy:this.uppy,note:this.opts.note,recoveredState:e.recoveredState,metaFields:t.metaFields,resumableUploads:r.resumableUploads||!1,individualCancellation:r.individualCancellation,isMobileDevice:r.isMobileDevice,fileCardFor:t.fileCardFor,toggleFileCard:this.toggleFileCard,toggleAddFilesPanel:this.toggleAddFilesPanel,showAddFilesPanel:t.showAddFilesPanel,saveFileCard:this.saveFileCard,openFileEditor:this.openFileEditor,canEditFile:this.canEditFile,width:this.opts.width,height:this.opts.height,showLinkToFileUploadResult:this.opts.showLinkToFileUploadResult,fileManagerSelectionType:this.opts.fileManagerSelectionType,proudlyDisplayPoweredByUppy:this.opts.proudlyDisplayPoweredByUppy,hideCancelButton:this.opts.hideCancelButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,showRemoveButtonAfterComplete:this.opts.showRemoveButtonAfterComplete,containerWidth:t.containerWidth,containerHeight:t.containerHeight,areInsidesReadyToBeVisible:t.areInsidesReadyToBeVisible,parentElement:this.el,allowedFileTypes:this.uppy.opts.restrictions.allowedFileTypes,maxNumberOfFiles:this.uppy.opts.restrictions.maxNumberOfFiles,requiredMetaFields:this.uppy.opts.restrictions.requiredMetaFields,showSelectedFiles:this.opts.showSelectedFiles,showNativePhotoCameraButton:this.opts.showNativePhotoCameraButton,showNativeVideoCameraButton:this.opts.showNativeVideoCameraButton,nativeCameraFacingMode:this.opts.nativeCameraFacingMode,singleFileFullScreen:this.opts.singleFileFullScreen,handleCancelRestore:this.handleCancelRestore,handleRequestThumbnail:this.handleRequestThumbnail,handleCancelThumbnail:this.handleCancelThumbnail,isDraggingOver:t.isDraggingOver,handleDragOver:this.handleDragOver,handleDragLeave:this.handleDragLeave,handleDrop:this.handleDrop})};#l=()=>{const{plugins:e}=this.opts;e.forEach(t=>{const i=this.uppy.getPlugin(t);i?i.mount(this,i):this.uppy.log(`[Uppy] Dashboard could not find plugin '${t}', make sure to uppy.use() the plugins you are specifying`,"warning")})};#p=()=>{this.uppy.iteratePlugins(this.#u)};#u=e=>{const t=["acquirer","editor"];e&&!e.opts?.target&&t.includes(e.type)&&(this.getPluginState().targets.some(r=>e.id===r.id)||e.mount(this,e))};#h(){const{hideUploadButton:e,hideRetryButton:t,hidePauseResumeButton:i,hideCancelButton:r,showProgressDetails:s,hideProgressAfterFinish:o,locale:a,doneButtonHandler:u}=this.opts;return{hideUploadButton:e,hideRetryButton:t,hidePauseResumeButton:i,hideCancelButton:r,showProgressDetails:s,hideAfterFinish:o,locale:a,doneButtonHandler:u}}#d(){const{thumbnailWidth:e,thumbnailHeight:t,thumbnailType:i,waitForThumbnailsBeforeUpload:r}=this.opts;return{thumbnailWidth:e,thumbnailHeight:t,thumbnailType:i,waitForThumbnailsBeforeUpload:r,lazy:!r}}#c(){return{}}setOptions(e){super.setOptions(e),this.uppy.getPlugin(this.#f())?.setOptions(this.#h()),this.uppy.getPlugin(this.#m())?.setOptions(this.#d())}#f(){return`${this.id}:StatusBar`}#m(){return`${this.id}:ThumbnailGenerator`}#_(){return`${this.id}:Informer`}install=()=>{this.setPluginState({isHidden:!0,fileCardFor:null,activeOverlayType:null,showAddFilesPanel:!1,activePickerPanel:void 0,showFileEditor:!1,metaFields:this.opts.metaFields,targets:[],areInsidesReadyToBeVisible:!1,isDraggingOver:!1});const{inline:e,closeAfterFinish:t}=this.opts;if(e&&t)throw new Error("[Dashboard] `closeAfterFinish: true` cannot be used on an inline Dashboard, because an inline Dashboard cannot be closed at all. Either set `inline: false`, or disable the `closeAfterFinish` option.");const{allowMultipleUploads:i,allowMultipleUploadBatches:r}=this.uppy.opts;(i||r)&&t&&this.uppy.log("[Dashboard] When using `closeAfterFinish`, we recommended setting the `allowMultipleUploadBatches` option to `false` in the Uppy constructor. See https://uppy.io/docs/uppy/#allowMultipleUploads-true","warning");const{target:s}=this.opts;s&&this.mount(s,this),this.opts.disableStatusBar||this.uppy.use(Zu,{id:this.#f(),target:this,...this.#h()}),this.opts.disableInformer||this.uppy.use(Su,{id:this.#_(),target:this,...this.#c()}),this.opts.disableThumbnailGenerator||this.uppy.use(Cc,{id:this.#m(),...this.#d()}),this.darkModeMediaQuery=typeof window<"u"&&window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)"):null;const o=this.darkModeMediaQuery?this.darkModeMediaQuery.matches:!1;this.uppy.log(`[Dashboard] Dark mode is ${o?"on":"off"}`),this.setDarkModeCapability(o),this.opts.theme==="auto"&&this.darkModeMediaQuery?.addListener(this.handleSystemDarkModeChange),this.#l(),this.#p(),this.initEvents()};uninstall=()=>{if(!this.opts.disableInformer){const t=this.uppy.getPlugin(`${this.id}:Informer`);t&&this.uppy.removePlugin(t)}if(!this.opts.disableStatusBar){const t=this.uppy.getPlugin(`${this.id}:StatusBar`);t&&this.uppy.removePlugin(t)}if(!this.opts.disableThumbnailGenerator){const t=this.uppy.getPlugin(`${this.id}:ThumbnailGenerator`);t&&this.uppy.removePlugin(t)}const{plugins:e}=this.opts;e.forEach(t=>{const i=this.uppy.getPlugin(t);i&&i.unmount()}),this.opts.theme==="auto"&&this.darkModeMediaQuery?.removeListener(this.handleSystemDarkModeChange),this.opts.disablePageScrollWhenModalOpen&&document.body.classList.remove("uppy-Dashboard-isFixed"),this.unmount(),this.removeEvents()}}class Pd{#e;#t=[];constructor(e){this.#e=e}on(e,t){return this.#t.push([e,t]),this.#e.on(e,t)}remove(){for(const[e,t]of this.#t.splice(0))this.#e.off(e,t)}onFilePause(e,t){this.on("upload-pause",(i,r)=>{e===i?.id&&t(r)})}onFileRemove(e,t){this.on("file-removed",i=>{e===i.id&&t(i.id)})}onPause(e,t){this.on("upload-pause",(i,r)=>{e===i?.id&&t(r)})}onRetry(e,t){this.on("upload-retry",i=>{e===i?.id&&t()})}onRetryAll(e,t){this.on("retry-all",()=>{this.#e.getFile(e)&&t()})}onPauseAll(e,t){this.on("pause-all",()=>{this.#e.getFile(e)&&t()})}onCancelAll(e,t){this.on("cancel-all",(...i)=>{this.#e.getFile(e)&&t(...i)})}onResumeAll(e,t){this.on("resume-all",()=>{this.#e.getFile(e)&&t()})}}function Td(n){const e=t=>"error"in t&&!!t.error;return n.filter(t=>!e(t))}function Cd(n){return n.filter(e=>!e.progress?.uploadStarted||!e.isRestored)}function Ed(n,e){return n===!0?Object.keys(e):Array.isArray(n)?n:[]}function fn(n,e){return Object.hasOwn(n,e)}function xd(n){return n?n.readyState!==0&&n.readyState!==4||n.status===0:!1}class kd extends Error{cause;isNetworkError;request;constructor(e,t=null){super("This looks like a network error, the endpoint might be blocked by an internet provider or a firewall."),this.cause=e,this.isNetworkError=!0,this.request=t}}function Ud(n){return new Error("Cancelled",{cause:n})}function Pr(n){if(n!=null){const e=()=>this.abort(n.reason);n.addEventListener("abort",e,{once:!0});const t=()=>{n.removeEventListener("abort",e)};this.then?.(t,t)}return this}class Od{#e=0;#t=[];#i=!1;#n;#r=1;#o;#a;limit;constructor(e){typeof e!="number"||e===0?this.limit=1/0:this.limit=e}#s(e){this.#e+=1;let t=!1,i;try{i=e()}catch(r){throw this.#e-=1,r}return{abort:r=>{t||(t=!0,this.#e-=1,i?.(r),this.#l())},done:()=>{t||(t=!0,this.#e-=1,this.#l())}}}#l(){queueMicrotask(()=>this.#p())}#p(){if(this.#i||this.#e>=this.limit||this.#t.length===0)return;const e=this.#t.shift();if(e==null)throw new Error("Invariant violation: next is null");const t=this.#s(e.fn);e.abort=t.abort,e.done=t.done}#u(e,t){const i={fn:e,priority:t?.priority||0,abort:()=>{this.#h(i)},done:()=>{throw new Error("Cannot mark a queued request as done: this indicates a bug")}},r=this.#t.findIndex(s=>i.priority>s.priority);return r===-1?this.#t.push(i):this.#t.splice(r,0,i),i}#h(e){const t=this.#t.indexOf(e);t!==-1&&this.#t.splice(t,1)}run(e,t){return!this.#i&&this.#e<this.limit?this.#s(e):this.#u(e,t)}wrapSyncFunction(e,t){return(...i)=>{const r=this.run(()=>(e(...i),queueMicrotask(()=>r.done()),()=>{}),t);return{abortOn:Pr,abort(){r.abort()}}}}wrapPromiseFunction(e,t){return(...i)=>{let r;const s=new Promise((o,a)=>{r=this.run(()=>{let u,l;try{l=Promise.resolve(e(...i))}catch(d){l=Promise.reject(d)}return l.then(d=>{u?a(u):(r.done(),o(d))},d=>{u?a(u):(r.done(),a(d))}),d=>{u=Ud(d)}},t)});return s.abort=o=>{r.abort(o)},s.abortOn=Pr,s}}resume(){this.#i=!1,clearTimeout(this.#n);for(let e=0;e<this.limit;e++)this.#l()}#d=()=>this.resume();pause(e=null){this.#i=!0,clearTimeout(this.#n),e!=null&&(this.#n=setTimeout(this.#d,e))}rateLimit(e){clearTimeout(this.#a),this.pause(e),this.limit>1&&Number.isFinite(this.limit)&&(this.#o=this.limit-1,this.limit=this.#r,this.#a=setTimeout(this.#c,e))}#c=()=>{if(this.#i){this.#a=setTimeout(this.#c,0);return}this.#r=this.limit,this.limit=Math.ceil((this.#o+this.#r)/2);for(let e=this.#r;e<=this.limit;e++)this.#l();this.#o-this.#r>3?this.#a=setTimeout(this.#c,2e3):this.#r=Math.floor(this.#r/2)};get isPaused(){return this.#i}}function Un(n){"@babel/helpers - typeof";return Un=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Un(n)}function Ad(n,e,t){return Object.defineProperty(n,"prototype",{writable:!1}),n}function Rd(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Id(n,e,t){return e=Ye(e),Dd(n,ni()?Reflect.construct(e,t||[],Ye(n).constructor):e.apply(n,t))}function Dd(n,e){if(e&&(Un(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nd(n)}function Nd(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Bd(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&Xe(n,e)}function On(n){var e=typeof Map=="function"?new Map:void 0;return On=function(i){if(i===null||!Md(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(i))return e.get(i);e.set(i,r)}function r(){return Ld(i,arguments,Ye(this).constructor)}return r.prototype=Object.create(i.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Xe(r,i)},On(n)}function Ld(n,e,t){if(ni())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var r=new(n.bind.apply(n,i));return t&&Xe(r,t.prototype),r}function ni(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ni=function(){return!!n})()}function Md(n){try{return Function.toString.call(n).indexOf("[native code]")!==-1}catch{return typeof n=="function"}}function Xe(n,e){return Xe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},Xe(n,e)}function Ye(n){return Ye=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ye(n)}var bt=(function(n){function e(t){var i,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(Rd(this,e),i=Id(this,e,[t]),i.originalRequest=s,i.originalResponse=o,i.causingError=r,r!=null&&(t+=", caused by ".concat(r.toString())),s!=null){var a=s.getHeader("X-Request-ID")||"n/a",u=s.getMethod(),l=s.getURL(),d=o?o.getStatus():"n/a",h=o?o.getBody()||"":"n/a";t+=", originated from request (method: ".concat(u,", url: ").concat(l,", response code: ").concat(d,", response text: ").concat(h,", request id: ").concat(a,")")}return i.message=t,i}return Bd(e,n),Ad(e)})(On(Error));function Qe(n){"@babel/helpers - typeof";return Qe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qe(n)}function $d(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function zd(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,qd(i.key),i)}}function jd(n,e,t){return e&&zd(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}function qd(n){var e=Hd(n,"string");return Qe(e)=="symbol"?e:e+""}function Hd(n,e){if(Qe(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(Qe(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}var Vd=(function(){function n(){$d(this,n)}return jd(n,[{key:"listAllUploads",value:function(){return Promise.resolve([])}},{key:"findUploadsByFingerprint",value:function(t){return Promise.resolve([])}},{key:"removeUpload",value:function(t){return Promise.resolve()}},{key:"addUpload",value:function(t,i){return Promise.resolve(null)}}])})();const Vs="3.7.8",Wd=Vs,De=typeof Buffer=="function",Tr=typeof TextDecoder=="function"?new TextDecoder:void 0,Cr=typeof TextEncoder=="function"?new TextEncoder:void 0,Gd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",$e=Array.prototype.slice.call(Gd),vt=(n=>{let e={};return n.forEach((t,i)=>e[t]=i),e})($e),Kd=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,J=String.fromCharCode.bind(String),Er=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):n=>new Uint8Array(Array.prototype.slice.call(n,0)),Ws=n=>n.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),Gs=n=>n.replace(/[^A-Za-z0-9\+\/]/g,""),Ks=n=>{let e,t,i,r,s="";const o=n.length%3;for(let a=0;a<n.length;){if((t=n.charCodeAt(a++))>255||(i=n.charCodeAt(a++))>255||(r=n.charCodeAt(a++))>255)throw new TypeError("invalid character found");e=t<<16|i<<8|r,s+=$e[e>>18&63]+$e[e>>12&63]+$e[e>>6&63]+$e[e&63]}return o?s.slice(0,o-3)+"===".substring(o):s},ii=typeof btoa=="function"?n=>btoa(n):De?n=>Buffer.from(n,"binary").toString("base64"):Ks,An=De?n=>Buffer.from(n).toString("base64"):n=>{let t=[];for(let i=0,r=n.length;i<r;i+=4096)t.push(J.apply(null,n.subarray(i,i+4096)));return ii(t.join(""))},Pt=(n,e=!1)=>e?Ws(An(n)):An(n),Xd=n=>{if(n.length<2){var e=n.charCodeAt(0);return e<128?n:e<2048?J(192|e>>>6)+J(128|e&63):J(224|e>>>12&15)+J(128|e>>>6&63)+J(128|e&63)}else{var e=65536+(n.charCodeAt(0)-55296)*1024+(n.charCodeAt(1)-56320);return J(240|e>>>18&7)+J(128|e>>>12&63)+J(128|e>>>6&63)+J(128|e&63)}},Yd=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,Xs=n=>n.replace(Yd,Xd),xr=De?n=>Buffer.from(n,"utf8").toString("base64"):Cr?n=>An(Cr.encode(n)):n=>ii(Xs(n)),Ae=(n,e=!1)=>e?Ws(xr(n)):xr(n),kr=n=>Ae(n,!0),Qd=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,Zd=n=>{switch(n.length){case 4:var e=(7&n.charCodeAt(0))<<18|(63&n.charCodeAt(1))<<12|(63&n.charCodeAt(2))<<6|63&n.charCodeAt(3),t=e-65536;return J((t>>>10)+55296)+J((t&1023)+56320);case 3:return J((15&n.charCodeAt(0))<<12|(63&n.charCodeAt(1))<<6|63&n.charCodeAt(2));default:return J((31&n.charCodeAt(0))<<6|63&n.charCodeAt(1))}},Ys=n=>n.replace(Qd,Zd),Qs=n=>{if(n=n.replace(/\s+/g,""),!Kd.test(n))throw new TypeError("malformed base64.");n+="==".slice(2-(n.length&3));let e,t,i,r=[];for(let s=0;s<n.length;)e=vt[n.charAt(s++)]<<18|vt[n.charAt(s++)]<<12|(t=vt[n.charAt(s++)])<<6|(i=vt[n.charAt(s++)]),t===64?r.push(J(e>>16&255)):i===64?r.push(J(e>>16&255,e>>8&255)):r.push(J(e>>16&255,e>>8&255,e&255));return r.join("")},ri=typeof atob=="function"?n=>atob(Gs(n)):De?n=>Buffer.from(n,"base64").toString("binary"):Qs,Zs=De?n=>Er(Buffer.from(n,"base64")):n=>Er(ri(n).split("").map(e=>e.charCodeAt(0))),Js=n=>Zs(eo(n)),Jd=De?n=>Buffer.from(n,"base64").toString("utf8"):Tr?n=>Tr.decode(Zs(n)):n=>Ys(ri(n)),eo=n=>Gs(n.replace(/[-_]/g,e=>e=="-"?"+":"/")),Rn=n=>Jd(eo(n)),eh=n=>{if(typeof n!="string")return!1;const e=n.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(e)||!/[^\s0-9a-zA-Z\-_]/.test(e)},to=n=>({value:n,enumerable:!1,writable:!0,configurable:!0}),no=function(){const n=(e,t)=>Object.defineProperty(String.prototype,e,to(t));n("fromBase64",function(){return Rn(this)}),n("toBase64",function(e){return Ae(this,e)}),n("toBase64URI",function(){return Ae(this,!0)}),n("toBase64URL",function(){return Ae(this,!0)}),n("toUint8Array",function(){return Js(this)})},io=function(){const n=(e,t)=>Object.defineProperty(Uint8Array.prototype,e,to(t));n("toBase64",function(e){return Pt(this,e)}),n("toBase64URI",function(){return Pt(this,!0)}),n("toBase64URL",function(){return Pt(this,!0)})},th=()=>{no(),io()},nh={version:Vs,VERSION:Wd,atob:ri,atobPolyfill:Qs,btoa:ii,btoaPolyfill:Ks,fromBase64:Rn,toBase64:Ae,encode:Ae,encodeURI:kr,encodeURL:kr,utob:Xs,btou:Ys,decode:Rn,isValid:eh,fromUint8Array:Pt,toUint8Array:Js,extendString:no,extendUint8Array:io,extendBuiltins:th};var mn,Ur;function ih(){return Ur||(Ur=1,mn=function(e,t){if(t=t.split(":")[0],e=+e,!e)return!1;switch(t){case"http":case"ws":return e!==80;case"https":case"wss":return e!==443;case"ftp":return e!==21;case"gopher":return e!==70;case"file":return!1}return e!==0}),mn}var _t={},Or;function rh(){if(Or)return _t;Or=1;var n=Object.prototype.hasOwnProperty,e;function t(o){try{return decodeURIComponent(o.replace(/\+/g," "))}catch{return null}}function i(o){try{return encodeURIComponent(o)}catch{return null}}function r(o){for(var a=/([^=?#&]+)=?([^&]*)/g,u={},l;l=a.exec(o);){var d=t(l[1]),h=t(l[2]);d===null||h===null||d in u||(u[d]=h)}return u}function s(o,a){a=a||"";var u=[],l,d;typeof a!="string"&&(a="?");for(d in o)if(n.call(o,d)){if(l=o[d],!l&&(l===null||l===e||isNaN(l))&&(l=""),d=i(d),l=i(l),d===null||l===null)continue;u.push(d+"="+l)}return u.length?a+u.join("&"):""}return _t.stringify=s,_t.parse=r,_t}var gn,Ar;function sh(){if(Ar)return gn;Ar=1;var n=ih(),e=rh(),t=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,i=/[\n\r\t]/g,r=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,s=/:\d+$/,o=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,a=/^[a-zA-Z]:/;function u(m){return(m||"").toString().replace(t,"")}var l=[["#","hash"],["?","query"],function(y,_){return b(_.protocol)?y.replace(/\\/g,"/"):y},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],d={hash:1,query:1};function h(m){var y;typeof window<"u"?y=window:typeof ke<"u"?y=ke:typeof self<"u"?y=self:y={};var _=y.location||{};m=m||_;var w={},U=typeof m,O;if(m.protocol==="blob:")w=new T(unescape(m.pathname),{});else if(U==="string"){w=new T(m,{});for(O in d)delete w[O]}else if(U==="object"){for(O in m)O in d||(w[O]=m[O]);w.slashes===void 0&&(w.slashes=r.test(m.href))}return w}function b(m){return m==="file:"||m==="ftp:"||m==="http:"||m==="https:"||m==="ws:"||m==="wss:"}function v(m,y){m=u(m),m=m.replace(i,""),y=y||{};var _=o.exec(m),w=_[1]?_[1].toLowerCase():"",U=!!_[2],O=!!_[3],I=0,R;return U?O?(R=_[2]+_[3]+_[4],I=_[2].length+_[3].length):(R=_[2]+_[4],I=_[2].length):O?(R=_[3]+_[4],I=_[3].length):R=_[4],w==="file:"?I>=2&&(R=R.slice(2)):b(w)?R=_[4]:w?U&&(R=R.slice(2)):I>=2&&b(y.protocol)&&(R=_[4]),{protocol:w,slashes:U||b(w),slashesCount:I,rest:R}}function E(m,y){if(m==="")return y;for(var _=(y||"/").split("/").slice(0,-1).concat(m.split("/")),w=_.length,U=_[w-1],O=!1,I=0;w--;)_[w]==="."?_.splice(w,1):_[w]===".."?(_.splice(w,1),I++):I&&(w===0&&(O=!0),_.splice(w,1),I--);return O&&_.unshift(""),(U==="."||U==="..")&&_.push(""),_.join("/")}function T(m,y,_){if(m=u(m),m=m.replace(i,""),!(this instanceof T))return new T(m,y,_);var w,U,O,I,R,j,$=l.slice(),W=typeof y,x=this,V=0;for(W!=="object"&&W!=="string"&&(_=y,y=null),_&&typeof _!="function"&&(_=e.parse),y=h(y),U=v(m||"",y),w=!U.protocol&&!U.slashes,x.slashes=U.slashes||w&&y.slashes,x.protocol=U.protocol||y.protocol||"",m=U.rest,(U.protocol==="file:"&&(U.slashesCount!==2||a.test(m))||!U.slashes&&(U.protocol||U.slashesCount<2||!b(x.protocol)))&&($[3]=[/(.*)/,"pathname"]);V<$.length;V++){if(I=$[V],typeof I=="function"){m=I(m,x);continue}O=I[0],j=I[1],O!==O?x[j]=m:typeof O=="string"?(R=O==="@"?m.lastIndexOf(O):m.indexOf(O),~R&&(typeof I[2]=="number"?(x[j]=m.slice(0,R),m=m.slice(R+I[2])):(x[j]=m.slice(R),m=m.slice(0,R)))):(R=O.exec(m))&&(x[j]=R[1],m=m.slice(0,R.index)),x[j]=x[j]||w&&I[3]&&y[j]||"",I[4]&&(x[j]=x[j].toLowerCase())}_&&(x.query=_(x.query)),w&&y.slashes&&x.pathname.charAt(0)!=="/"&&(x.pathname!==""||y.pathname!=="")&&(x.pathname=E(x.pathname,y.pathname)),x.pathname.charAt(0)!=="/"&&b(x.protocol)&&(x.pathname="/"+x.pathname),n(x.port,x.protocol)||(x.host=x.hostname,x.port=""),x.username=x.password="",x.auth&&(R=x.auth.indexOf(":"),~R?(x.username=x.auth.slice(0,R),x.username=encodeURIComponent(decodeURIComponent(x.username)),x.password=x.auth.slice(R+1),x.password=encodeURIComponent(decodeURIComponent(x.password))):x.username=encodeURIComponent(decodeURIComponent(x.auth)),x.auth=x.password?x.username+":"+x.password:x.username),x.origin=x.protocol!=="file:"&&b(x.protocol)&&x.host?x.protocol+"//"+x.host:"null",x.href=x.toString()}function k(m,y,_){var w=this;switch(m){case"query":typeof y=="string"&&y.length&&(y=(_||e.parse)(y)),w[m]=y;break;case"port":w[m]=y,n(y,w.protocol)?y&&(w.host=w.hostname+":"+y):(w.host=w.hostname,w[m]="");break;case"hostname":w[m]=y,w.port&&(y+=":"+w.port),w.host=y;break;case"host":w[m]=y,s.test(y)?(y=y.split(":"),w.port=y.pop(),w.hostname=y.join(":")):(w.hostname=y,w.port="");break;case"protocol":w.protocol=y.toLowerCase(),w.slashes=!_;break;case"pathname":case"hash":if(y){var U=m==="pathname"?"/":"#";w[m]=y.charAt(0)!==U?U+y:y}else w[m]=y;break;case"username":case"password":w[m]=encodeURIComponent(y);break;case"auth":var O=y.indexOf(":");~O?(w.username=y.slice(0,O),w.username=encodeURIComponent(decodeURIComponent(w.username)),w.password=y.slice(O+1),w.password=encodeURIComponent(decodeURIComponent(w.password))):w.username=encodeURIComponent(decodeURIComponent(y))}for(var I=0;I<l.length;I++){var R=l[I];R[4]&&(w[R[1]]=w[R[1]].toLowerCase())}return w.auth=w.password?w.username+":"+w.password:w.username,w.origin=w.protocol!=="file:"&&b(w.protocol)&&w.host?w.protocol+"//"+w.host:"null",w.href=w.toString(),w}function S(m){(!m||typeof m!="function")&&(m=e.stringify);var y,_=this,w=_.host,U=_.protocol;U&&U.charAt(U.length-1)!==":"&&(U+=":");var O=U+(_.protocol&&_.slashes||b(_.protocol)?"//":"");return _.username?(O+=_.username,_.password&&(O+=":"+_.password),O+="@"):_.password?(O+=":"+_.password,O+="@"):_.protocol!=="file:"&&b(_.protocol)&&!w&&_.pathname!=="/"&&(O+="@"),(w[w.length-1]===":"||s.test(_.hostname)&&!_.port)&&(w+=":"),O+=w+_.pathname,y=typeof _.query=="object"?m(_.query):_.query,y&&(O+=y.charAt(0)!=="?"?"?"+y:y),_.hash&&(O+=_.hash),O}return T.prototype={set:k,toString:S},T.extractProtocol=v,T.location=h,T.trimLeft=u,T.qs=e,gn=T,gn}var oh=sh();const ah=ve(oh);function lh(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var e=Math.random()*16|0,t=n==="x"?e:e&3|8;return t.toString(16)})}function In(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */In=function(){return e};var n,e={},t=Object.prototype,i=t.hasOwnProperty,r=Object.defineProperty||function(g,p,f){g[p]=f.value},s=typeof Symbol=="function"?Symbol:{},o=s.iterator||"@@iterator",a=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function l(g,p,f){return Object.defineProperty(g,p,{value:f,enumerable:!0,configurable:!0,writable:!0}),g[p]}try{l({},"")}catch{l=function(f,F,C){return f[F]=C}}function d(g,p,f,F){var C=p&&p.prototype instanceof S?p:S,P=Object.create(C.prototype),D=new V(F||[]);return r(P,"_invoke",{value:j(g,f,D)}),P}function h(g,p,f){try{return{type:"normal",arg:g.call(p,f)}}catch(F){return{type:"throw",arg:F}}}e.wrap=d;var b="suspendedStart",v="suspendedYield",E="executing",T="completed",k={};function S(){}function m(){}function y(){}var _={};l(_,o,function(){return this});var w=Object.getPrototypeOf,U=w&&w(w(ee([])));U&&U!==t&&i.call(U,o)&&(_=U);var O=y.prototype=S.prototype=Object.create(_);function I(g){["next","throw","return"].forEach(function(p){l(g,p,function(f){return this._invoke(p,f)})})}function R(g,p){function f(C,P,D,B){var M=h(g[C],g,P);if(M.type!=="throw"){var te=M.arg,X=te.value;return X&&Pe(X)=="object"&&i.call(X,"__await")?p.resolve(X.__await).then(function(ne){f("next",ne,D,B)},function(ne){f("throw",ne,D,B)}):p.resolve(X).then(function(ne){te.value=ne,D(te)},function(ne){return f("throw",ne,D,B)})}B(M.arg)}var F;r(this,"_invoke",{value:function(P,D){function B(){return new p(function(M,te){f(P,D,M,te)})}return F=F?F.then(B,B):B()}})}function j(g,p,f){var F=b;return function(C,P){if(F===E)throw Error("Generator is already running");if(F===T){if(C==="throw")throw P;return{value:n,done:!0}}for(f.method=C,f.arg=P;;){var D=f.delegate;if(D){var B=$(D,f);if(B){if(B===k)continue;return B}}if(f.method==="next")f.sent=f._sent=f.arg;else if(f.method==="throw"){if(F===b)throw F=T,f.arg;f.dispatchException(f.arg)}else f.method==="return"&&f.abrupt("return",f.arg);F=E;var M=h(g,p,f);if(M.type==="normal"){if(F=f.done?T:v,M.arg===k)continue;return{value:M.arg,done:f.done}}M.type==="throw"&&(F=T,f.method="throw",f.arg=M.arg)}}}function $(g,p){var f=p.method,F=g.iterator[f];if(F===n)return p.delegate=null,f==="throw"&&g.iterator.return&&(p.method="return",p.arg=n,$(g,p),p.method==="throw")||f!=="return"&&(p.method="throw",p.arg=new TypeError("The iterator does not provide a '"+f+"' method")),k;var C=h(F,g.iterator,p.arg);if(C.type==="throw")return p.method="throw",p.arg=C.arg,p.delegate=null,k;var P=C.arg;return P?P.done?(p[g.resultName]=P.value,p.next=g.nextLoc,p.method!=="return"&&(p.method="next",p.arg=n),p.delegate=null,k):P:(p.method="throw",p.arg=new TypeError("iterator result is not an object"),p.delegate=null,k)}function W(g){var p={tryLoc:g[0]};1 in g&&(p.catchLoc=g[1]),2 in g&&(p.finallyLoc=g[2],p.afterLoc=g[3]),this.tryEntries.push(p)}function x(g){var p=g.completion||{};p.type="normal",delete p.arg,g.completion=p}function V(g){this.tryEntries=[{tryLoc:"root"}],g.forEach(W,this),this.reset(!0)}function ee(g){if(g||g===""){var p=g[o];if(p)return p.call(g);if(typeof g.next=="function")return g;if(!isNaN(g.length)){var f=-1,F=function C(){for(;++f<g.length;)if(i.call(g,f))return C.value=g[f],C.done=!1,C;return C.value=n,C.done=!0,C};return F.next=F}}throw new TypeError(Pe(g)+" is not iterable")}return m.prototype=y,r(O,"constructor",{value:y,configurable:!0}),r(y,"constructor",{value:m,configurable:!0}),m.displayName=l(y,u,"GeneratorFunction"),e.isGeneratorFunction=function(g){var p=typeof g=="function"&&g.constructor;return!!p&&(p===m||(p.displayName||p.name)==="GeneratorFunction")},e.mark=function(g){return Object.setPrototypeOf?Object.setPrototypeOf(g,y):(g.__proto__=y,l(g,u,"GeneratorFunction")),g.prototype=Object.create(O),g},e.awrap=function(g){return{__await:g}},I(R.prototype),l(R.prototype,a,function(){return this}),e.AsyncIterator=R,e.async=function(g,p,f,F,C){C===void 0&&(C=Promise);var P=new R(d(g,p,f,F),C);return e.isGeneratorFunction(p)?P:P.next().then(function(D){return D.done?D.value:P.next()})},I(O),l(O,u,"Generator"),l(O,o,function(){return this}),l(O,"toString",function(){return"[object Generator]"}),e.keys=function(g){var p=Object(g),f=[];for(var F in p)f.push(F);return f.reverse(),function C(){for(;f.length;){var P=f.pop();if(P in p)return C.value=P,C.done=!1,C}return C.done=!0,C}},e.values=ee,V.prototype={constructor:V,reset:function(p){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(x),!p)for(var f in this)f.charAt(0)==="t"&&i.call(this,f)&&!isNaN(+f.slice(1))&&(this[f]=n)},stop:function(){this.done=!0;var p=this.tryEntries[0].completion;if(p.type==="throw")throw p.arg;return this.rval},dispatchException:function(p){if(this.done)throw p;var f=this;function F(te,X){return D.type="throw",D.arg=p,f.next=te,X&&(f.method="next",f.arg=n),!!X}for(var C=this.tryEntries.length-1;C>=0;--C){var P=this.tryEntries[C],D=P.completion;if(P.tryLoc==="root")return F("end");if(P.tryLoc<=this.prev){var B=i.call(P,"catchLoc"),M=i.call(P,"finallyLoc");if(B&&M){if(this.prev<P.catchLoc)return F(P.catchLoc,!0);if(this.prev<P.finallyLoc)return F(P.finallyLoc)}else if(B){if(this.prev<P.catchLoc)return F(P.catchLoc,!0)}else{if(!M)throw Error("try statement without catch or finally");if(this.prev<P.finallyLoc)return F(P.finallyLoc)}}}},abrupt:function(p,f){for(var F=this.tryEntries.length-1;F>=0;--F){var C=this.tryEntries[F];if(C.tryLoc<=this.prev&&i.call(C,"finallyLoc")&&this.prev<C.finallyLoc){var P=C;break}}P&&(p==="break"||p==="continue")&&P.tryLoc<=f&&f<=P.finallyLoc&&(P=null);var D=P?P.completion:{};return D.type=p,D.arg=f,P?(this.method="next",this.next=P.finallyLoc,k):this.complete(D)},complete:function(p,f){if(p.type==="throw")throw p.arg;return p.type==="break"||p.type==="continue"?this.next=p.arg:p.type==="return"?(this.rval=this.arg=p.arg,this.method="return",this.next="end"):p.type==="normal"&&f&&(this.next=f),k},finish:function(p){for(var f=this.tryEntries.length-1;f>=0;--f){var F=this.tryEntries[f];if(F.finallyLoc===p)return this.complete(F.completion,F.afterLoc),x(F),k}},catch:function(p){for(var f=this.tryEntries.length-1;f>=0;--f){var F=this.tryEntries[f];if(F.tryLoc===p){var C=F.completion;if(C.type==="throw"){var P=C.arg;x(F)}return P}}throw Error("illegal catch attempt")},delegateYield:function(p,f,F){return this.delegate={iterator:ee(p),resultName:f,nextLoc:F},this.method==="next"&&(this.arg=n),k}},e}function Rr(n,e,t,i,r,s,o){try{var a=n[s](o),u=a.value}catch(l){t(l);return}a.done?e(u):Promise.resolve(u).then(i,r)}function uh(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(u){Rr(s,i,r,o,a,"next",u)}function a(u){Rr(s,i,r,o,a,"throw",u)}o(void 0)})}}function ro(n,e){return hh(n)||dh(n,e)||so(n,e)||ch()}function ch(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dh(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i,r,s,o,a=[],u=!0,l=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(u=(i=s.call(t)).done)&&(a.push(i.value),a.length!==e);u=!0);}catch(d){l=!0,r=d}finally{try{if(!u&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(l)throw r}}return a}}function hh(n){if(Array.isArray(n))return n}function Pe(n){"@babel/helpers - typeof";return Pe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pe(n)}function ph(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=so(n))||e){t&&(n=t);var i=0,r=function(){};return{s:r,n:function(){return i>=n.length?{done:!0}:{done:!1,value:n[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,o=!1,a;return{s:function(){t=t.call(n)},n:function(){var l=t.next();return s=l.done,l},e:function(l){o=!0,a=l},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(o)throw a}}}}function so(n,e){if(n){if(typeof n=="string")return Ir(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ir(n,e)}}function Ir(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function Dr(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function Ee(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Dr(Object(t),!0).forEach(function(i){fh(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Dr(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function fh(n,e,t){return e=oo(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function mh(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Nr(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,oo(i.key),i)}}function gh(n,e,t){return e&&Nr(n.prototype,e),t&&Nr(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function oo(n){var e=yh(n,"string");return Pe(e)=="symbol"?e:e+""}function yh(n,e){if(Pe(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(Pe(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}var Tt="tus-v1",Ct="ietf-draft-03",ze="ietf-draft-05",bh={endpoint:null,uploadUrl:null,metadata:{},metadataForPartialUploads:{},fingerprint:null,uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,onUploadUrlAvailable:null,overridePatchMethod:!1,headers:{},addRequestId:!1,onBeforeRequest:null,onAfterResponse:null,onShouldRetry:ao,chunkSize:Number.POSITIVE_INFINITY,retryDelays:[0,1e3,3e3,5e3],parallelUploads:1,parallelUploadBoundaries:null,storeFingerprintForResuming:!0,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1,urlStorage:null,fileReader:null,httpStack:null,protocol:Tt},Ut=(function(){function n(e,t){mh(this,n),"resume"in t&&console.log("tus: The `resume` option has been removed in tus-js-client v2. Please use the URL storage API instead."),this.options=t,this.options.chunkSize=Number(this.options.chunkSize),this._urlStorage=this.options.urlStorage,this.file=e,this.url=null,this._req=null,this._fingerprint=null,this._urlStorageKey=null,this._offset=null,this._aborted=!1,this._size=null,this._source=null,this._retryAttempt=0,this._retryTimeout=null,this._offsetBeforeRetry=0,this._parallelUploads=null,this._parallelUploadUrls=null}return gh(n,[{key:"findPreviousUploads",value:function(){var t=this;return this.options.fingerprint(this.file,this.options).then(function(i){return t._urlStorage.findUploadsByFingerprint(i)})}},{key:"resumeFromPreviousUpload",value:function(t){this.url=t.uploadUrl||null,this._parallelUploadUrls=t.parallelUploadUrls||null,this._urlStorageKey=t.urlStorageKey}},{key:"start",value:function(){var t=this,i=this.file;if(!i){this._emitError(new Error("tus: no file or stream to upload provided"));return}if(![Tt,Ct,ze].includes(this.options.protocol)){this._emitError(new Error("tus: unsupported protocol ".concat(this.options.protocol)));return}if(!this.options.endpoint&&!this.options.uploadUrl&&!this.url){this._emitError(new Error("tus: neither an endpoint or an upload URL is provided"));return}var r=this.options.retryDelays;if(r!=null&&Object.prototype.toString.call(r)!=="[object Array]"){this._emitError(new Error("tus: the `retryDelays` option must either be an array or null"));return}if(this.options.parallelUploads>1)for(var s=0,o=["uploadUrl","uploadSize","uploadLengthDeferred"];s<o.length;s++){var a=o[s];if(this.options[a]){this._emitError(new Error("tus: cannot use the ".concat(a," option when parallelUploads is enabled")));return}}if(this.options.parallelUploadBoundaries){if(this.options.parallelUploads<=1){this._emitError(new Error("tus: cannot use the `parallelUploadBoundaries` option when `parallelUploads` is disabled"));return}if(this.options.parallelUploads!==this.options.parallelUploadBoundaries.length){this._emitError(new Error("tus: the `parallelUploadBoundaries` must have the same length as the value of `parallelUploads`"));return}}this.options.fingerprint(i,this.options).then(function(u){return t._fingerprint=u,t._source?t._source:t.options.fileReader.openFile(i,t.options.chunkSize)}).then(function(u){if(t._source=u,t.options.uploadLengthDeferred)t._size=null;else if(t.options.uploadSize!=null){if(t._size=Number(t.options.uploadSize),Number.isNaN(t._size)){t._emitError(new Error("tus: cannot convert `uploadSize` option into a number"));return}}else if(t._size=t._source.size,t._size==null){t._emitError(new Error("tus: cannot automatically derive upload's size from input. Specify it manually using the `uploadSize` option or use the `uploadLengthDeferred` option"));return}t.options.parallelUploads>1||t._parallelUploadUrls!=null?t._startParallelUpload():t._startSingleUpload()}).catch(function(u){t._emitError(u)})}},{key:"_startParallelUpload",value:function(){var t,i=this,r=this._size,s=0;this._parallelUploads=[];var o=this._parallelUploadUrls!=null?this._parallelUploadUrls.length:this.options.parallelUploads,a=(t=this.options.parallelUploadBoundaries)!==null&&t!==void 0?t:_h(this._source.size,o);this._parallelUploadUrls&&a.forEach(function(d,h){d.uploadUrl=i._parallelUploadUrls[h]||null}),this._parallelUploadUrls=new Array(a.length);var u=a.map(function(d,h){var b=0;return i._source.slice(d.start,d.end).then(function(v){var E=v.value;return new Promise(function(T,k){var S=Ee(Ee({},i.options),{},{uploadUrl:d.uploadUrl||null,storeFingerprintForResuming:!1,removeFingerprintOnSuccess:!1,parallelUploads:1,parallelUploadBoundaries:null,metadata:i.options.metadataForPartialUploads,headers:Ee(Ee({},i.options.headers),{},{"Upload-Concat":"partial"}),onSuccess:T,onError:k,onProgress:function(_){s=s-b+_,b=_,i._emitProgress(s,r)},onUploadUrlAvailable:function(){i._parallelUploadUrls[h]=m.url,i._parallelUploadUrls.filter(function(_){return!!_}).length===a.length&&i._saveUploadInUrlStorage()}}),m=new n(E,S);m.start(),i._parallelUploads.push(m)})})}),l;Promise.all(u).then(function(){l=i._openRequest("POST",i.options.endpoint),l.setHeader("Upload-Concat","final;".concat(i._parallelUploadUrls.join(" ")));var d=Br(i.options.metadata);return d!==""&&l.setHeader("Upload-Metadata",d),i._sendRequest(l,null)}).then(function(d){if(!xe(d.getStatus(),200)){i._emitHttpError(l,d,"tus: unexpected response while creating upload");return}var h=d.getHeader("Location");if(h==null){i._emitHttpError(l,d,"tus: invalid or missing Location header");return}i.url=zr(i.options.endpoint,h),"Created upload at ".concat(i.url),i._emitSuccess(d)}).catch(function(d){i._emitError(d)})}},{key:"_startSingleUpload",value:function(){if(this._aborted=!1,this.url!=null){"Resuming upload from previous URL: ".concat(this.url),this._resumeUpload();return}if(this.options.uploadUrl!=null){"Resuming upload from provided URL: ".concat(this.options.uploadUrl),this.url=this.options.uploadUrl,this._resumeUpload();return}this._createUpload()}},{key:"abort",value:function(t){var i=this;if(this._parallelUploads!=null){var r=ph(this._parallelUploads),s;try{for(r.s();!(s=r.n()).done;){var o=s.value;o.abort(t)}}catch(a){r.e(a)}finally{r.f()}}return this._req!==null&&this._req.abort(),this._aborted=!0,this._retryTimeout!=null&&(clearTimeout(this._retryTimeout),this._retryTimeout=null),!t||this.url==null?Promise.resolve():n.terminate(this.url,this.options).then(function(){return i._removeFromUrlStorage()})}},{key:"_emitHttpError",value:function(t,i,r,s){this._emitError(new bt(r,s,t,i))}},{key:"_emitError",value:function(t){var i=this;if(!this._aborted){if(this.options.retryDelays!=null){var r=this._offset!=null&&this._offset>this._offsetBeforeRetry;if(r&&(this._retryAttempt=0),$r(t,this._retryAttempt,this.options)){var s=this.options.retryDelays[this._retryAttempt++];this._offsetBeforeRetry=this._offset,this._retryTimeout=setTimeout(function(){i.start()},s);return}}if(typeof this.options.onError=="function")this.options.onError(t);else throw t}}},{key:"_emitSuccess",value:function(t){this.options.removeFingerprintOnSuccess&&this._removeFromUrlStorage(),typeof this.options.onSuccess=="function"&&this.options.onSuccess({lastResponse:t})}},{key:"_emitProgress",value:function(t,i){typeof this.options.onProgress=="function"&&this.options.onProgress(t,i)}},{key:"_emitChunkComplete",value:function(t,i,r){typeof this.options.onChunkComplete=="function"&&this.options.onChunkComplete(t,i,r)}},{key:"_createUpload",value:function(){var t=this;if(!this.options.endpoint){this._emitError(new Error("tus: unable to create upload because no endpoint is provided"));return}var i=this._openRequest("POST",this.options.endpoint);this.options.uploadLengthDeferred?i.setHeader("Upload-Defer-Length","1"):i.setHeader("Upload-Length","".concat(this._size));var r=Br(this.options.metadata);r!==""&&i.setHeader("Upload-Metadata",r);var s;this.options.uploadDataDuringCreation&&!this.options.uploadLengthDeferred?(this._offset=0,s=this._addChunkToRequest(i)):((this.options.protocol===Ct||this.options.protocol===ze)&&i.setHeader("Upload-Complete","?0"),s=this._sendRequest(i,null)),s.then(function(o){if(!xe(o.getStatus(),200)){t._emitHttpError(i,o,"tus: unexpected response while creating upload");return}var a=o.getHeader("Location");if(a==null){t._emitHttpError(i,o,"tus: invalid or missing Location header");return}if(t.url=zr(t.options.endpoint,a),"Created upload at ".concat(t.url),typeof t.options.onUploadUrlAvailable=="function"&&t.options.onUploadUrlAvailable(),t._size===0){t._emitSuccess(o),t._source.close();return}t._saveUploadInUrlStorage().then(function(){t.options.uploadDataDuringCreation?t._handleUploadResponse(i,o):(t._offset=0,t._performUpload())})}).catch(function(o){t._emitHttpError(i,null,"tus: failed to create upload",o)})}},{key:"_resumeUpload",value:function(){var t=this,i=this._openRequest("HEAD",this.url),r=this._sendRequest(i,null);r.then(function(s){var o=s.getStatus();if(!xe(o,200)){if(o===423){t._emitHttpError(i,s,"tus: upload is currently locked; retry later");return}if(xe(o,400)&&t._removeFromUrlStorage(),!t.options.endpoint){t._emitHttpError(i,s,"tus: unable to resume upload (new upload cannot be created without an endpoint)");return}t.url=null,t._createUpload();return}var a=Number.parseInt(s.getHeader("Upload-Offset"),10);if(Number.isNaN(a)){t._emitHttpError(i,s,"tus: invalid or missing offset value");return}var u=Number.parseInt(s.getHeader("Upload-Length"),10);if(Number.isNaN(u)&&!t.options.uploadLengthDeferred&&t.options.protocol===Tt){t._emitHttpError(i,s,"tus: invalid or missing length value");return}typeof t.options.onUploadUrlAvailable=="function"&&t.options.onUploadUrlAvailable(),t._saveUploadInUrlStorage().then(function(){if(a===u){t._emitProgress(u,u),t._emitSuccess(s);return}t._offset=a,t._performUpload()})}).catch(function(s){t._emitHttpError(i,null,"tus: failed to resume upload",s)})}},{key:"_performUpload",value:function(){var t=this;if(!this._aborted){var i;this.options.overridePatchMethod?(i=this._openRequest("POST",this.url),i.setHeader("X-HTTP-Method-Override","PATCH")):i=this._openRequest("PATCH",this.url),i.setHeader("Upload-Offset","".concat(this._offset));var r=this._addChunkToRequest(i);r.then(function(s){if(!xe(s.getStatus(),200)){t._emitHttpError(i,s,"tus: unexpected response while uploading chunk");return}t._handleUploadResponse(i,s)}).catch(function(s){t._aborted||t._emitHttpError(i,null,"tus: failed to upload chunk at offset ".concat(t._offset),s)})}}},{key:"_addChunkToRequest",value:function(t){var i=this,r=this._offset,s=this._offset+this.options.chunkSize;return t.setProgressHandler(function(o){i._emitProgress(r+o,i._size)}),this.options.protocol===Tt?t.setHeader("Content-Type","application/offset+octet-stream"):this.options.protocol===ze&&t.setHeader("Content-Type","application/partial-upload"),(s===Number.POSITIVE_INFINITY||s>this._size)&&!this.options.uploadLengthDeferred&&(s=this._size),this._source.slice(r,s).then(function(o){var a=o.value,u=o.done,l=a!=null&&a.size?a.size:0;i.options.uploadLengthDeferred&&u&&(i._size=i._offset+l,t.setHeader("Upload-Length","".concat(i._size)));var d=i._offset+l;return!i.options.uploadLengthDeferred&&u&&d!==i._size?Promise.reject(new Error("upload was configured with a size of ".concat(i._size," bytes, but the source is done after ").concat(d," bytes"))):a===null?i._sendRequest(t):((i.options.protocol===Ct||i.options.protocol===ze)&&t.setHeader("Upload-Complete",u?"?1":"?0"),i._emitProgress(i._offset,i._size),i._sendRequest(t,a))})}},{key:"_handleUploadResponse",value:function(t,i){var r=Number.parseInt(i.getHeader("Upload-Offset"),10);if(Number.isNaN(r)){this._emitHttpError(t,i,"tus: invalid or missing offset value");return}if(this._emitProgress(r,this._size),this._emitChunkComplete(r-this._offset,r,this._size),this._offset=r,r===this._size){this._emitSuccess(i),this._source.close();return}this._performUpload()}},{key:"_openRequest",value:function(t,i){var r=Lr(t,i,this.options);return this._req=r,r}},{key:"_removeFromUrlStorage",value:function(){var t=this;this._urlStorageKey&&(this._urlStorage.removeUpload(this._urlStorageKey).catch(function(i){t._emitError(i)}),this._urlStorageKey=null)}},{key:"_saveUploadInUrlStorage",value:function(){var t=this;if(!this.options.storeFingerprintForResuming||!this._fingerprint||this._urlStorageKey!==null)return Promise.resolve();var i={size:this._size,metadata:this.options.metadata,creationTime:new Date().toString()};return this._parallelUploads?i.parallelUploadUrls=this._parallelUploadUrls:i.uploadUrl=this.url,this._urlStorage.addUpload(this._fingerprint,i).then(function(r){t._urlStorageKey=r})}},{key:"_sendRequest",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return Mr(t,i,this.options)}}],[{key:"terminate",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=Lr("DELETE",t,i);return Mr(r,null,i).then(function(s){if(s.getStatus()!==204)throw new bt("tus: unexpected response while terminating upload",null,r,s)}).catch(function(s){if(s instanceof bt||(s=new bt("tus: failed to terminate upload",s,r,null)),!$r(s,0,i))throw s;var o=i.retryDelays[0],a=i.retryDelays.slice(1),u=Ee(Ee({},i),{},{retryDelays:a});return new Promise(function(l){return setTimeout(l,o)}).then(function(){return n.terminate(t,u)})})}}])})();function Br(n){return Object.entries(n).map(function(e){var t=ro(e,2),i=t[0],r=t[1];return"".concat(i," ").concat(nh.encode(String(r)))}).join(",")}function xe(n,e){return n>=e&&n<e+100}function Lr(n,e,t){var i=t.httpStack.createRequest(n,e);t.protocol===Ct?i.setHeader("Upload-Draft-Interop-Version","5"):t.protocol===ze?i.setHeader("Upload-Draft-Interop-Version","6"):i.setHeader("Tus-Resumable","1.0.0");for(var r=t.headers||{},s=0,o=Object.entries(r);s<o.length;s++){var a=ro(o[s],2),u=a[0],l=a[1];i.setHeader(u,l)}if(t.addRequestId){var d=lh();i.setHeader("X-Request-ID",d)}return i}function Mr(n,e,t){return Dn.apply(this,arguments)}function Dn(){return Dn=uh(In().mark(function n(e,t,i){var r;return In().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(typeof i.onBeforeRequest!="function"){o.next=3;break}return o.next=3,i.onBeforeRequest(e);case 3:return o.next=5,e.send(t);case 5:if(r=o.sent,typeof i.onAfterResponse!="function"){o.next=9;break}return o.next=9,i.onAfterResponse(e,r);case 9:return o.abrupt("return",r);case 10:case"end":return o.stop()}},n)})),Dn.apply(this,arguments)}function vh(){var n=!0;return typeof navigator<"u"&&navigator.onLine===!1&&(n=!1),n}function $r(n,e,t){return t.retryDelays==null||e>=t.retryDelays.length||n.originalRequest==null?!1:t&&typeof t.onShouldRetry=="function"?t.onShouldRetry(n,e,t):ao(n)}function ao(n){var e=n.originalResponse?n.originalResponse.getStatus():0;return(!xe(e,400)||e===409||e===423)&&vh()}function zr(n,e){return new ah(e,n).toString()}function _h(n,e){for(var t=Math.floor(n/e),i=[],r=0;r<e;r++)i.push({start:t*r,end:t*(r+1)});return i[e-1].end=n,i}Ut.defaultOptions=bh;var lo=function(){return typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative"};function wh(n){return new Promise(function(e,t){var i=new XMLHttpRequest;i.responseType="blob",i.onload=function(){var r=i.response;e(r)},i.onerror=function(r){t(r)},i.open("GET",n),i.send()})}var Sh=function(){return typeof window<"u"&&(typeof window.PhoneGap<"u"||typeof window.Cordova<"u"||typeof window.cordova<"u")};function Fh(n){return new Promise(function(e,t){var i=new FileReader;i.onload=function(){var r=new Uint8Array(i.result);e({value:r})},i.onerror=function(r){t(r)},i.readAsArrayBuffer(n)})}function Ze(n){"@babel/helpers - typeof";return Ze=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ze(n)}function Ph(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Th(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,Eh(i.key),i)}}function Ch(n,e,t){return e&&Th(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}function Eh(n){var e=xh(n,"string");return Ze(e)=="symbol"?e:e+""}function xh(n,e){if(Ze(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(Ze(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}var jr=(function(){function n(e){Ph(this,n),this._file=e,this.size=e.size}return Ch(n,[{key:"slice",value:function(t,i){if(Sh())return Fh(this._file.slice(t,i));var r=this._file.slice(t,i),s=i>=this.size;return Promise.resolve({value:r,done:s})}},{key:"close",value:function(){}}])})();function Je(n){"@babel/helpers - typeof";return Je=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Je(n)}function kh(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Uh(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,Ah(i.key),i)}}function Oh(n,e,t){return e&&Uh(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}function Ah(n){var e=Rh(n,"string");return Je(e)=="symbol"?e:e+""}function Rh(n,e){if(Je(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(Je(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}function qr(n){return n===void 0?0:n.size!==void 0?n.size:n.length}function Ih(n,e){if(n.concat)return n.concat(e);if(n instanceof Blob)return new Blob([n,e],{type:n.type});if(n.set){var t=new n.constructor(n.length+e.length);return t.set(n),t.set(e,n.length),t}throw new Error("Unknown data type")}var Dh=(function(){function n(e){kh(this,n),this._buffer=void 0,this._bufferOffset=0,this._reader=e,this._done=!1}return Oh(n,[{key:"slice",value:function(t,i){return t<this._bufferOffset?Promise.reject(new Error("Requested data is before the reader's current offset")):this._readUntilEnoughDataOrDone(t,i)}},{key:"_readUntilEnoughDataOrDone",value:function(t,i){var r=this,s=i<=this._bufferOffset+qr(this._buffer);if(this._done||s){var o=this._getDataFromBuffer(t,i),a=o==null?this._done:!1;return Promise.resolve({value:o,done:a})}return this._reader.read().then(function(u){var l=u.value,d=u.done;return d?r._done=!0:r._buffer===void 0?r._buffer=l:r._buffer=Ih(r._buffer,l),r._readUntilEnoughDataOrDone(t,i)})}},{key:"_getDataFromBuffer",value:function(t,i){t>this._bufferOffset&&(this._buffer=this._buffer.slice(t-this._bufferOffset),this._bufferOffset=t);var r=qr(this._buffer)===0;return this._done&&r?null:this._buffer.slice(0,i-t)}},{key:"close",value:function(){this._reader.cancel&&this._reader.cancel()}}])})();function Te(n){"@babel/helpers - typeof";return Te=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Te(n)}function Nn(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Nn=function(){return e};var n,e={},t=Object.prototype,i=t.hasOwnProperty,r=Object.defineProperty||function(g,p,f){g[p]=f.value},s=typeof Symbol=="function"?Symbol:{},o=s.iterator||"@@iterator",a=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function l(g,p,f){return Object.defineProperty(g,p,{value:f,enumerable:!0,configurable:!0,writable:!0}),g[p]}try{l({},"")}catch{l=function(f,F,C){return f[F]=C}}function d(g,p,f,F){var C=p&&p.prototype instanceof S?p:S,P=Object.create(C.prototype),D=new V(F||[]);return r(P,"_invoke",{value:j(g,f,D)}),P}function h(g,p,f){try{return{type:"normal",arg:g.call(p,f)}}catch(F){return{type:"throw",arg:F}}}e.wrap=d;var b="suspendedStart",v="suspendedYield",E="executing",T="completed",k={};function S(){}function m(){}function y(){}var _={};l(_,o,function(){return this});var w=Object.getPrototypeOf,U=w&&w(w(ee([])));U&&U!==t&&i.call(U,o)&&(_=U);var O=y.prototype=S.prototype=Object.create(_);function I(g){["next","throw","return"].forEach(function(p){l(g,p,function(f){return this._invoke(p,f)})})}function R(g,p){function f(C,P,D,B){var M=h(g[C],g,P);if(M.type!=="throw"){var te=M.arg,X=te.value;return X&&Te(X)=="object"&&i.call(X,"__await")?p.resolve(X.__await).then(function(ne){f("next",ne,D,B)},function(ne){f("throw",ne,D,B)}):p.resolve(X).then(function(ne){te.value=ne,D(te)},function(ne){return f("throw",ne,D,B)})}B(M.arg)}var F;r(this,"_invoke",{value:function(P,D){function B(){return new p(function(M,te){f(P,D,M,te)})}return F=F?F.then(B,B):B()}})}function j(g,p,f){var F=b;return function(C,P){if(F===E)throw Error("Generator is already running");if(F===T){if(C==="throw")throw P;return{value:n,done:!0}}for(f.method=C,f.arg=P;;){var D=f.delegate;if(D){var B=$(D,f);if(B){if(B===k)continue;return B}}if(f.method==="next")f.sent=f._sent=f.arg;else if(f.method==="throw"){if(F===b)throw F=T,f.arg;f.dispatchException(f.arg)}else f.method==="return"&&f.abrupt("return",f.arg);F=E;var M=h(g,p,f);if(M.type==="normal"){if(F=f.done?T:v,M.arg===k)continue;return{value:M.arg,done:f.done}}M.type==="throw"&&(F=T,f.method="throw",f.arg=M.arg)}}}function $(g,p){var f=p.method,F=g.iterator[f];if(F===n)return p.delegate=null,f==="throw"&&g.iterator.return&&(p.method="return",p.arg=n,$(g,p),p.method==="throw")||f!=="return"&&(p.method="throw",p.arg=new TypeError("The iterator does not provide a '"+f+"' method")),k;var C=h(F,g.iterator,p.arg);if(C.type==="throw")return p.method="throw",p.arg=C.arg,p.delegate=null,k;var P=C.arg;return P?P.done?(p[g.resultName]=P.value,p.next=g.nextLoc,p.method!=="return"&&(p.method="next",p.arg=n),p.delegate=null,k):P:(p.method="throw",p.arg=new TypeError("iterator result is not an object"),p.delegate=null,k)}function W(g){var p={tryLoc:g[0]};1 in g&&(p.catchLoc=g[1]),2 in g&&(p.finallyLoc=g[2],p.afterLoc=g[3]),this.tryEntries.push(p)}function x(g){var p=g.completion||{};p.type="normal",delete p.arg,g.completion=p}function V(g){this.tryEntries=[{tryLoc:"root"}],g.forEach(W,this),this.reset(!0)}function ee(g){if(g||g===""){var p=g[o];if(p)return p.call(g);if(typeof g.next=="function")return g;if(!isNaN(g.length)){var f=-1,F=function C(){for(;++f<g.length;)if(i.call(g,f))return C.value=g[f],C.done=!1,C;return C.value=n,C.done=!0,C};return F.next=F}}throw new TypeError(Te(g)+" is not iterable")}return m.prototype=y,r(O,"constructor",{value:y,configurable:!0}),r(y,"constructor",{value:m,configurable:!0}),m.displayName=l(y,u,"GeneratorFunction"),e.isGeneratorFunction=function(g){var p=typeof g=="function"&&g.constructor;return!!p&&(p===m||(p.displayName||p.name)==="GeneratorFunction")},e.mark=function(g){return Object.setPrototypeOf?Object.setPrototypeOf(g,y):(g.__proto__=y,l(g,u,"GeneratorFunction")),g.prototype=Object.create(O),g},e.awrap=function(g){return{__await:g}},I(R.prototype),l(R.prototype,a,function(){return this}),e.AsyncIterator=R,e.async=function(g,p,f,F,C){C===void 0&&(C=Promise);var P=new R(d(g,p,f,F),C);return e.isGeneratorFunction(p)?P:P.next().then(function(D){return D.done?D.value:P.next()})},I(O),l(O,u,"Generator"),l(O,o,function(){return this}),l(O,"toString",function(){return"[object Generator]"}),e.keys=function(g){var p=Object(g),f=[];for(var F in p)f.push(F);return f.reverse(),function C(){for(;f.length;){var P=f.pop();if(P in p)return C.value=P,C.done=!1,C}return C.done=!0,C}},e.values=ee,V.prototype={constructor:V,reset:function(p){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(x),!p)for(var f in this)f.charAt(0)==="t"&&i.call(this,f)&&!isNaN(+f.slice(1))&&(this[f]=n)},stop:function(){this.done=!0;var p=this.tryEntries[0].completion;if(p.type==="throw")throw p.arg;return this.rval},dispatchException:function(p){if(this.done)throw p;var f=this;function F(te,X){return D.type="throw",D.arg=p,f.next=te,X&&(f.method="next",f.arg=n),!!X}for(var C=this.tryEntries.length-1;C>=0;--C){var P=this.tryEntries[C],D=P.completion;if(P.tryLoc==="root")return F("end");if(P.tryLoc<=this.prev){var B=i.call(P,"catchLoc"),M=i.call(P,"finallyLoc");if(B&&M){if(this.prev<P.catchLoc)return F(P.catchLoc,!0);if(this.prev<P.finallyLoc)return F(P.finallyLoc)}else if(B){if(this.prev<P.catchLoc)return F(P.catchLoc,!0)}else{if(!M)throw Error("try statement without catch or finally");if(this.prev<P.finallyLoc)return F(P.finallyLoc)}}}},abrupt:function(p,f){for(var F=this.tryEntries.length-1;F>=0;--F){var C=this.tryEntries[F];if(C.tryLoc<=this.prev&&i.call(C,"finallyLoc")&&this.prev<C.finallyLoc){var P=C;break}}P&&(p==="break"||p==="continue")&&P.tryLoc<=f&&f<=P.finallyLoc&&(P=null);var D=P?P.completion:{};return D.type=p,D.arg=f,P?(this.method="next",this.next=P.finallyLoc,k):this.complete(D)},complete:function(p,f){if(p.type==="throw")throw p.arg;return p.type==="break"||p.type==="continue"?this.next=p.arg:p.type==="return"?(this.rval=this.arg=p.arg,this.method="return",this.next="end"):p.type==="normal"&&f&&(this.next=f),k},finish:function(p){for(var f=this.tryEntries.length-1;f>=0;--f){var F=this.tryEntries[f];if(F.finallyLoc===p)return this.complete(F.completion,F.afterLoc),x(F),k}},catch:function(p){for(var f=this.tryEntries.length-1;f>=0;--f){var F=this.tryEntries[f];if(F.tryLoc===p){var C=F.completion;if(C.type==="throw"){var P=C.arg;x(F)}return P}}throw Error("illegal catch attempt")},delegateYield:function(p,f,F){return this.delegate={iterator:ee(p),resultName:f,nextLoc:F},this.method==="next"&&(this.arg=n),k}},e}function Hr(n,e,t,i,r,s,o){try{var a=n[s](o),u=a.value}catch(l){t(l);return}a.done?e(u):Promise.resolve(u).then(i,r)}function Nh(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(u){Hr(s,i,r,o,a,"next",u)}function a(u){Hr(s,i,r,o,a,"throw",u)}o(void 0)})}}function Bh(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Lh(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,$h(i.key),i)}}function Mh(n,e,t){return e&&Lh(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}function $h(n){var e=zh(n,"string");return Te(e)=="symbol"?e:e+""}function zh(n,e){if(Te(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(Te(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}var jh=(function(){function n(){Bh(this,n)}return Mh(n,[{key:"openFile",value:(function(){var e=Nh(Nn().mark(function i(r,s){var o;return Nn().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!(lo()&&r&&typeof r.uri<"u")){u.next=11;break}return u.prev=1,u.next=4,wh(r.uri);case 4:return o=u.sent,u.abrupt("return",new jr(o));case 8:throw u.prev=8,u.t0=u.catch(1),new Error("tus: cannot fetch `file.uri` as Blob, make sure the uri is correct and accessible. ".concat(u.t0));case 11:if(!(typeof r.slice=="function"&&typeof r.size<"u")){u.next=13;break}return u.abrupt("return",Promise.resolve(new jr(r)));case 13:if(typeof r.read!="function"){u.next=18;break}if(s=Number(s),Number.isFinite(s)){u.next=17;break}return u.abrupt("return",Promise.reject(new Error("cannot create source for stream without a finite value for the `chunkSize` option")));case 17:return u.abrupt("return",Promise.resolve(new Dh(r,s)));case 18:return u.abrupt("return",Promise.reject(new Error("source object may only be an instance of File, Blob, or Reader in this environment")));case 19:case"end":return u.stop()}},i,null,[[1,8]])}));function t(i,r){return e.apply(this,arguments)}return t})()}])})();function qh(n,e){return lo()?Promise.resolve(Hh(n,e)):Promise.resolve(["tus-br",n.name,n.type,n.size,n.lastModified,e.endpoint].join("-"))}function Hh(n,e){var t=n.exif?Vh(JSON.stringify(n.exif)):"noexif";return["tus-rn",n.name||"noname",n.size||"nosize",t,e.endpoint].join("/")}function Vh(n){var e=0;if(n.length===0)return e;for(var t=0;t<n.length;t++){var i=n.charCodeAt(t);e=(e<<5)-e+i,e&=e}return e}function et(n){"@babel/helpers - typeof";return et=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},et(n)}function si(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Wh(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,Gh(i.key),i)}}function oi(n,e,t){return e&&Wh(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}function Gh(n){var e=Kh(n,"string");return et(e)=="symbol"?e:e+""}function Kh(n,e){if(et(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(et(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}var Xh=(function(){function n(){si(this,n)}return oi(n,[{key:"createRequest",value:function(t,i){return new Yh(t,i)}},{key:"getName",value:function(){return"XHRHttpStack"}}])})(),Yh=(function(){function n(e,t){si(this,n),this._xhr=new XMLHttpRequest,this._xhr.open(e,t,!0),this._method=e,this._url=t,this._headers={}}return oi(n,[{key:"getMethod",value:function(){return this._method}},{key:"getURL",value:function(){return this._url}},{key:"setHeader",value:function(t,i){this._xhr.setRequestHeader(t,i),this._headers[t]=i}},{key:"getHeader",value:function(t){return this._headers[t]}},{key:"setProgressHandler",value:function(t){"upload"in this._xhr&&(this._xhr.upload.onprogress=function(i){i.lengthComputable&&t(i.loaded)})}},{key:"send",value:function(){var t=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return new Promise(function(r,s){t._xhr.onload=function(){r(new Qh(t._xhr))},t._xhr.onerror=function(o){s(o)},t._xhr.send(i)})}},{key:"abort",value:function(){return this._xhr.abort(),Promise.resolve()}},{key:"getUnderlyingObject",value:function(){return this._xhr}}])})(),Qh=(function(){function n(e){si(this,n),this._xhr=e}return oi(n,[{key:"getStatus",value:function(){return this._xhr.status}},{key:"getHeader",value:function(t){return this._xhr.getResponseHeader(t)}},{key:"getBody",value:function(){return this._xhr.responseText}},{key:"getUnderlyingObject",value:function(){return this._xhr}}])})();function tt(n){"@babel/helpers - typeof";return tt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tt(n)}function Zh(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Jh(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,tp(i.key),i)}}function ep(n,e,t){return e&&Jh(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}function tp(n){var e=np(n,"string");return tt(e)=="symbol"?e:e+""}function np(n,e){if(tt(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(tt(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}var Bn=!1;try{Bn="localStorage"in window;var yn="tusSupport",Vr=localStorage.getItem(yn);localStorage.setItem(yn,Vr),Vr===null&&localStorage.removeItem(yn)}catch(n){if(n.code===n.SECURITY_ERR||n.code===n.QUOTA_EXCEEDED_ERR)Bn=!1;else throw n}var ip=Bn,rp=(function(){function n(){Zh(this,n)}return ep(n,[{key:"findAllUploads",value:function(){var t=this._findEntries("tus::");return Promise.resolve(t)}},{key:"findUploadsByFingerprint",value:function(t){var i=this._findEntries("tus::".concat(t,"::"));return Promise.resolve(i)}},{key:"removeUpload",value:function(t){return localStorage.removeItem(t),Promise.resolve()}},{key:"addUpload",value:function(t,i){var r=Math.round(Math.random()*1e12),s="tus::".concat(t,"::").concat(r);return localStorage.setItem(s,JSON.stringify(i)),Promise.resolve(s)}},{key:"_findEntries",value:function(t){for(var i=[],r=0;r<localStorage.length;r++){var s=localStorage.key(r);if(s.indexOf(t)===0)try{var o=JSON.parse(localStorage.getItem(s));o.urlStorageKey=s,i.push(o)}catch{}}return i}}])})();function Ie(n){"@babel/helpers - typeof";return Ie=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ie(n)}function sp(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function op(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,co(i.key),i)}}function ap(n,e,t){return t&&op(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function lp(n,e,t){return e=Ot(e),up(n,uo()?Reflect.construct(e,t||[],Ot(n).constructor):e.apply(n,t))}function up(n,e){if(e&&(Ie(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cp(n)}function cp(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function uo(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(uo=function(){return!!n})()}function Ot(n){return Ot=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ot(n)}function dp(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&Ln(n,e)}function Ln(n,e){return Ln=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},Ln(n,e)}function Wr(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function Oe(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Wr(Object(t),!0).forEach(function(i){hp(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Wr(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function hp(n,e,t){return e=co(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function co(n){var e=pp(n,"string");return Ie(e)=="symbol"?e:e+""}function pp(n,e){if(Ie(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(Ie(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}var Mn=Oe(Oe({},Ut.defaultOptions),{},{httpStack:new Xh,fileReader:new jh,urlStorage:ip?new rp:new Vd,fingerprint:qh}),fp=(function(n){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return sp(this,e),i=Oe(Oe({},Mn),i),lp(this,e,[t,i])}return dp(e,n),ap(e,null,[{key:"terminate",value:function(i){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return r=Oe(Oe({},Mn),r),Ut.terminate(i,r)}}])})(Ut);const mp="4.3.2",gp={version:mp};function yp(){return typeof window<"u"&&(typeof window.PhoneGap<"u"||typeof window.Cordova<"u"||typeof window.cordova<"u")}function bp(){return typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative"}function vp(n){return(e,t)=>{if(yp()||bp())return Mn.fingerprint(e,t);const i=["tus",n.id,t.endpoint].join("-");return Promise.resolve(i)}}const ho={endpoint:"",uploadUrl:null,metadata:{},uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,overridePatchMethod:!1,headers:{},addRequestId:!1,chunkSize:1/0,retryDelays:[100,1e3,3e3,5e3],parallelUploads:1,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1},_p={limit:20,retryDelays:ho.retryDelays,withCredentials:!1,allowedMetaFields:!0};class wp extends $n{static VERSION=gp.version;#e;requests;uploaders;uploaderEvents;constructor(e,t){if(super(e,{..._p,...t}),this.type="uploader",this.id=this.opts.id||"Tus",t?.allowedMetaFields===void 0&&"metaFields"in this.opts)throw new Error("The `metaFields` option has been renamed to `allowedMetaFields`.");if("autoRetry"in t)throw new Error("The `autoRetry` option was deprecated and has been removed.");this.requests=this.opts.rateLimitedQueue??new Od(this.opts.limit),this.#e=this.opts.retryDelays?.values(),this.uploaders=Object.create(null),this.uploaderEvents=Object.create(null)}resetUploaderReferences(e,t){const i=this.uploaders[e];i&&(i.abort(),t?.abort&&i.abort(!0),this.uploaders[e]=null),this.uploaderEvents[e]&&(this.uploaderEvents[e].remove(),this.uploaderEvents[e]=null)}#t(e){return this.resetUploaderReferences(e.id),new Promise((t,i)=>{let r,s,o;const a={...this.opts,...e.tus||{}};typeof a.headers=="function"&&(a.headers=a.headers(e));const{onShouldRetry:u,onBeforeRequest:l,...d}=a,h={...ho,...d};h.fingerprint=vp(e),h.onBeforeRequest=async S=>{const m=S.getUnderlyingObject();m.withCredentials=!!a.withCredentials;let y;if(typeof l=="function"&&(y=l(S,e)),fn(r,"shouldBeRequeued")){if(!r.shouldBeRequeued)return Promise.reject();let _;const w=new Promise(U=>{_=U});r=this.requests.run(()=>(e.isPaused&&r.abort(),_(),()=>{})),await Promise.all([w,y]);return}return y},h.onError=S=>{this.uppy.log(S);const m=S.originalRequest!=null?S.originalRequest.getUnderlyingObject():null;xd(m)&&(S=new kd(S,m)),this.resetUploaderReferences(e.id),r?.abort(),typeof a.onError=="function"&&a.onError(S),i(S)},h.onProgress=(S,m)=>{this.onReceiveUploadUrl(e,o.url),typeof a.onProgress=="function"&&a.onProgress(S,m);const y=this.uppy.getFile(e.id);this.uppy.emit("upload-progress",y,{uploadStarted:y.progress.uploadStarted??0,bytesUploaded:S,bytesTotal:m})},h.onSuccess=S=>{const m={uploadURL:o.url??void 0,status:200,body:{xhr:S.lastResponse.getUnderlyingObject()}};if(this.uppy.emit("upload-success",this.uppy.getFile(e.id),m),this.resetUploaderReferences(e.id),r.done(),o.url){const{name:y}=o.file;this.uppy.log(`Download ${y} from ${o.url}`)}typeof a.onSuccess=="function"&&a.onSuccess(S),t(o)};const b=S=>{const m=S?.originalResponse?.getStatus();if(m===429){if(!this.requests.isPaused){const y=this.#e?.next();if(y==null||y.done)return!1;this.requests.rateLimit(y.value)}}else{if(m!=null&&m>=400&&m<500&&m!==409&&m!==423)return!1;typeof navigator<"u"&&navigator.onLine===!1&&(this.requests.isPaused||(this.requests.pause(),window.addEventListener("online",()=>{this.requests.resume()},{once:!0})))}return r.abort(),r={shouldBeRequeued:!0,abort(){this.shouldBeRequeued=!1},done(){throw new Error("Cannot mark a queued request as done: this indicates a bug")},fn(){throw new Error("Cannot run a queued request: this indicates a bug")}},!0};u!=null?h.onShouldRetry=(S,m)=>u(S,m,a,b):h.onShouldRetry=b;const v=(S,m,y)=>{fn(S,m)&&!fn(S,y)&&(S[y]=S[m])},E={};Ed(a.allowedMetaFields,e.meta).forEach(S=>{E[S]=String(e.meta[S])}),v(E,"type","filetype"),v(E,"name","filename"),h.metadata=E,o=new fp(e.data,h),this.uploaders[e.id]=o;const k=new Pd(this.uppy);this.uploaderEvents[e.id]=k,s=()=>(e.isPaused||o.start(),()=>{}),o.findPreviousUploads().then(S=>{const m=S[0];m&&(this.uppy.log(`[Tus] Resuming upload of ${e.id} started at ${m.creationTime}`),o.resumeFromPreviousUpload(m)),r=this.requests.run(s)}),k.onFileRemove(e.id,S=>{r.abort(),this.resetUploaderReferences(e.id,{abort:!!o.url}),t(`upload ${S} was removed`)}),k.onPause(e.id,S=>{r.abort(),S?o.abort():r=this.requests.run(s)}),k.onPauseAll(e.id,()=>{r.abort(),o.abort()}),k.onCancelAll(e.id,()=>{r.abort(),this.resetUploaderReferences(e.id,{abort:!!o.url}),t(`upload ${e.id} was canceled`)}),k.onResumeAll(e.id,()=>{r.abort(),e.error&&o.abort(),r=this.requests.run(s)})}).catch(t=>{throw this.uppy.emit("upload-error",e,t),t})}onReceiveUploadUrl(e,t){const i=this.uppy.getFile(e.id);i&&(!i.tus||i.tus.uploadUrl!==t)&&(this.uppy.log("[Tus] Storing upload url"),this.uppy.setFileState(i.id,{tus:{...i.tus,uploadUrl:t}}))}#i(e){const t={...this.opts};return e.tus&&Object.assign(t,e.tus),typeof t.headers=="function"&&(t.headers=t.headers(e)),{...e.remote?.body,endpoint:t.endpoint,uploadUrl:t.uploadUrl,protocol:"tus",size:e.data.size,headers:t.headers,metadata:e.meta}}async#n(e){const t=Td(e),i=Cd(t);this.uppy.emit("upload-start",i),await Promise.allSettled(t.map(r=>{if(r.isRemote){const s=()=>this.requests,o=new AbortController,a=l=>{l.id===r.id&&o.abort()};this.uppy.on("file-removed",a);const u=this.uppy.getRequestClientForFile(r).uploadRemoteFile(r,this.#i(r),{signal:o.signal,getQueue:s});return this.requests.wrapSyncFunction(()=>{this.uppy.off("file-removed",a)},{priority:-1})(),u}return this.#t(r)}))}#r=async e=>{if(e.length===0){this.uppy.log("[Tus] No files to upload");return}this.opts.limit===0&&this.uppy.log("[Tus] When uploading multiple files at once, consider setting the `limit` option (to `10` for example), to limit the number of concurrent uploads, which helps prevent memory and network issues: https://uppy.io/docs/tus/#limit-0","warning"),this.uppy.log("[Tus] Uploading...");const t=this.uppy.getFilesByIds(e);await this.#n(t)};install(){this.uppy.setState({capabilities:{...this.uppy.getState().capabilities,resumableUploads:!0}}),this.uppy.addUploader(this.#r)}uninstall(){this.uppy.setState({capabilities:{...this.uppy.getState().capabilities,resumableUploads:!1}}),this.uppy.removeUploader(this.#r)}}class Sp extends $n{constructor(e,t){super(e,t),this.id=this.opts.id||"UppyBunnyCreator",this.type="modifier"}async create(e){const t=await fetch(`https://video.bunnycdn.com/library/${this.opts.library}/videos`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/*+json",AccessKey:this.opts.access},body:JSON.stringify({title:e.meta.name,thumbnailTime:this.getMsFromTime(e.meta.thumbTime)})});if(!t.ok)throw new Error(`Failed to create video: ${t.status}`);return(await t.json()).guid}prepareUpload=async e=>{const t=e.map(r=>{const s=this.uppy.getFile(r);return this.create(s).then(o=>{this.uppy.setFileMeta(r,{bunnyId:o})}).catch(o=>{this.uppy.log(o,"warning")})}),i=()=>{e.forEach(r=>{const s=this.uppy.getFile(r);this.uppy.emit("preprocess-complete",s)})};return await Promise.all(t),i()};install(){this.uppy.addPreProcessor(this.prepareUpload)}uninstall(){this.uppy.removePreProcessor(this.prepareUpload)}getMsFromTime(e){if(typeof e>"u"||e==null||e=="")return 0;if(!this.validateTime(e))throw this.uppy.info("Falsches Zeitformat für die Thumbnailerstellung.","error",3e3),new Error("Wrong timestamp format for thumbnail creation.");let t=e.split(":");return(+t[0]*60*60+ +t[1]*60+ +t[2])*1e3}validateTime(e){if(!/^(?:[01]\d|2[0-3]):[0-5]\d:[0-5]\d$/.test(e))return!1;const[i,r,s]=e.split(":").map(Number);return!(i<0||i>23||r<0||r>59||s<0||s>59)}}const Fp={components:{PlusIcon:el},inject:["bunnyApiKey","bunnyHostname","bunnyLibrary"],data(){return{expirationTime:0,uploader:null}},methods:{getExpirationTime(){const n=new Date;return n.setDate(n.getDate()+1),n.getTime()},async getAuthorizationSignature(n){const e=this.bunnyLibrary+this.bunnyApiKey+this.expirationTime+n,t=new TextEncoder().encode(e),i=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(i)).map(r=>r.toString(16).padStart(2,"0")).join("")},initializeUppy(){this.expirationTime=this.getExpirationTime(),this.uploader=go(new Xn().use(Fd,{inline:!1,trigger:"#bunny-upload",width:"auto",proudlyDisplayPoweredByUppy:!1,closeModalOnClickOutside:!0,closeAfterFinish:!0,metaFields:[{id:"name",name:__("Name"),placeholder:__("Filename")},{id:"thumbTime",name:__("Timestamp"),placeholder:__("hh:mm:ss e.g. 00:01:04 for minute 1, second 4")},{id:"bunnyId",name:__("Bunny ID"),render:({value:n},e)=>e("input",{type:"text",class:"uppy-u-reset uppy-c-textInput uppy-Dashboard-FileCard-input bg-gray-300",value:n,placeholder:__("Bunny ID"),disabled:!0},[])}]}).use(Sp,{access:this.bunnyApiKey,library:this.bunnyLibrary}).use(wp,{endpoint:"https://video.bunnycdn.com/tusupload",retryDelays:[0,30,50,3e3,5e3,1e4,6e4],onBeforeRequest:async(n,e)=>{const t=this.uploader.getFile(e.id).meta;if(t.bunnyId){const i=await this.getAuthorizationSignature(t.bunnyId);n.setHeader("AuthorizationSignature",i),n.setHeader("AuthorizationExpire",this.expirationTime),n.setHeader("VideoId",t.bunnyId),n.setHeader("LibraryId",this.bunnyLibrary)}else throw new Error("Missing Bunny video ID")}})),this.uploader.on("complete",n=>{if(n.successful.length>0){const e=n.successful.length===1?__("1 video uploaded successfully."):__(":count videos successfully uploaded.",{count:n.successful.length});console.log(e)}n.failed.length>0&&console.log("Failed files: ",n.failed),ge.emit("load")})}},created(){ge.on("upload",()=>document.getElementById("bunny-upload").click())},mounted(){this.initializeUppy()}},Pp={class:"btn-primary",id:"bunny-upload"};function Tp(n,e,t,i,r,s){const o=re("PlusIcon");return q(),H("button",Pp,[Q(o,{class:"h-6 w-6"}),be(" "+L(n.__("Upload Video")),1)])}const Cp=oe(Fp,[["render",Tp]]),Ep={},xp={class:"container w-full lg:w-4/5 mx-auto"},kp={class:"flex flex-col items-center justify-center gap-2"},Up={class:"mb-2"},Op={class:"text-sm"},Ap={class:"text-sm"},Rp={href:"https://bunny.net?ref=uhvsqhaw0n",target:"_blank",class:"btn-primary my-2"},Ip={class:"text-sm"},Dp={class:"text-sm"};function Np(n,e){return q(),H("div",xp,[A("div",kp,[A("h1",Up,L(n.__("Bunny Account Required")),1),A("p",Op,L(n.__("To use this addon, you'll need a Bunny.net account. Make sure to add your credentials to the .env file.")),1),A("p",Ap,L(n.__("If you don't have one yet, you can sign up using our affiliate link.")),1),A("a",Rp,L(n.__("Sign Up Now")),1),A("p",Ip,L(n.__("By doing so, you'll be supporting the development of this addon at no extra cost to you.")),1),A("p",Dp,[A("b",null,L(n.__("Thank you for your support!")),1)])])])}const Bp=oe(Ep,[["render",Np]]),Lp={class:"flex gap-2 justify-between"},Mp={class:"flex-grow mb-4"},$p={__name:"Overview",props:{title:String,addon:Object,bunny:Object},setup(n){const e=n;return At("bunnyApiKey",e.bunny.apiKey),At("bunnyHostname",e.bunny.hostname),At("bunnyLibrary",e.bunny.library),(t,i)=>(q(),H(bn,null,[Q(vn(So),{title:n.title},null,8,["title"]),n.bunny.apiKey&&n.bunny.hostname&&n.bunny.library?(q(),H(bn,{key:0},[A("div",Lp,[A("h1",Mp,L(n.title),1),Q(Cp)]),Q(Ya)],64)):(q(),Gr(Bp,{key:1})),Q(vn(vo),{topic:n.addon.name,url:n.addon.url},null,8,["topic","url"])],64))}};Statamic.booting(()=>{Statamic.$inertia.register("BunnyOverview",$p),Statamic.$components.register("bunny-fieldtype",wo)});
