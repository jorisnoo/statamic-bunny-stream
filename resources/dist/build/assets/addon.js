const lo=window.Vue,{BaseTransition:Gh,BaseTransitionPropsValidators:Kh,Comment:Xh,DeprecationTypes:Yh,EffectScope:Qh,ErrorCodes:Zh,ErrorTypeStrings:Jh,Fragment:ke,KeepAlive:ep,ReactiveEffect:tp,Static:ip,Suspense:np,Teleport:uo,Text:rp,TrackOpTypes:sp,Transition:op,TransitionGroup:ap,TriggerOpTypes:lp,VueElement:up,__esModule:dp,assertNumber:cp,callWithAsyncErrorHandling:hp,callWithErrorHandling:pp,camelize:fp,capitalize:mp,cloneVNode:gp,compatUtils:yp,compile:bp,computed:co,createApp:vp,createBlock:Mi,createCommentVNode:ho,createElementBlock:K,createElementVNode:D,createHydrationRenderer:_p,createPropsRestProxy:wp,createRenderer:Sp,createSSRApp:Fp,createSlots:Pp,createStaticVNode:Tp,createTextVNode:bi,createVNode:pe,customRef:Cp,defineAsyncComponent:Ep,defineComponent:kp,defineCustomElement:Up,defineEmits:xp,defineExpose:Op,defineModel:Ap,defineOptions:Rp,defineProps:Ip,defineSSRCustomElement:Dp,defineSlots:Np,devtools:Bp,effect:Lp,effectScope:Mp,getCurrentInstance:$p,getCurrentScope:zp,getCurrentWatcher:jp,getTransitionRawChildren:qp,guardReactiveProps:Hp,h:Vp,handleError:Wp,hasInjectionContext:Gp,hydrate:Kp,hydrateOnIdle:Xp,hydrateOnInteraction:Yp,hydrateOnMediaQuery:Qp,hydrateOnVisible:Zp,initCustomFormatter:Jp,initDirectivesForSSR:ef,inject:tf,isMemoSame:nf,isProxy:rf,isReactive:sf,isReadonly:of,isRef:af,isRuntimeOnly:lf,isShallow:uf,isVNode:df,markRaw:po,mergeDefaults:cf,mergeModels:hf,mergeProps:pf,nextTick:ff,nodeOps:mf,normalizeClass:gf,normalizeProps:yf,normalizeStyle:bf,onActivated:vf,onBeforeMount:_f,onBeforeUnmount:wf,onBeforeUpdate:Sf,onDeactivated:Ff,onErrorCaptured:Pf,onMounted:fo,onRenderTracked:Tf,onRenderTriggered:Cf,onScopeDispose:Ef,onServerPrefetch:kf,onUnmounted:Uf,onUpdated:xf,onWatcherCleanup:Of,openBlock:H,patchProp:Af,popScopeId:Rf,provide:Rt,proxyRefs:If,pushScopeId:Df,queuePostFlushCb:Nf,reactive:Bf,readonly:Lf,ref:nt,registerRuntimeCompiler:Mf,render:$f,renderList:mo,renderSlot:zf,resolveComponent:Et,resolveDirective:jf,resolveDynamicComponent:qf,resolveFilter:Hf,resolveTransitionHooks:Vf,setBlockTracking:Wf,setDevtoolsHook:Gf,setTransitionHooks:Kf,shallowReactive:Xf,shallowReadonly:Yf,shallowRef:Qf,ssrContextKey:Zf,ssrUtils:Jf,stop:em,toDisplayString:j,toHandlerKey:tm,toHandlers:im,toRaw:nm,toRef:rm,toRefs:sm,toValue:om,transformVNodeArgs:am,triggerRef:lm,unref:vt,useAttrs:um,useCssModule:dm,useCssVars:cm,useHost:hm,useId:pm,useModel:fm,useSSRContext:mm,useShadowRoot:gm,useSlots:ym,useTemplateRef:bm,useTransitionState:vm,vModelCheckbox:_m,vModelDynamic:wm,vModelRadio:Sm,vModelSelect:Fm,vModelText:go,vShow:Pm,version:Tm,warn:Cm,watch:Em,watchEffect:km,watchPostEffect:Um,watchSyncEffect:xm,withAsyncContext:Om,withCtx:_t,withDefaults:Am,withDirectives:yo,withKeys:Rm,withMemo:Im,withModifiers:Dm,withScopeId:Nm}=lo,{Fieldtype:It,IndexFieldtype:Bm,FieldtypeMixin:Lm,HasActionsMixin:Mm,HasInputOptionsMixin:$m,HasPreferencesMixin:zm,IndexFieldtypeMixin:jm,InlineEditForm:qm,DateFormatter:Hm,ItemActions:Vm,RelatedItem:Wm,RestoreRevision:Gm,RevisionHistory:Km,RevisionPreview:Xm,SaveButtonOptions:Ym,SortableList:Qm,requireElevatedSession:Zm,requireElevatedSessionIf:Jm,clone:eg,deepClone:tg,resetValuesFromResponse:ig}=__STATAMIC__.core,{Alert:ng,AuthCard:rg,Avatar:sg,Badge:og,Button:ag,ButtonGroup:lg,Calendar:ug,Card:dg,CardList:cg,CardListItem:hg,CardPanel:pg,CharacterCounter:fg,Checkbox:mg,CheckboxGroup:gg,CodeEditor:yg,Combobox:bo,CommandPaletteItem:bg,ConfirmationModal:vg,Context:_g,ContextFooter:wg,ContextHeader:Sg,ContextItem:Fg,ContextLabel:Pg,ContextMenu:Tg,ContextSeparator:Cg,CreateForm:Eg,DatePicker:kg,DateRangePicker:Ug,Description:xg,DocsCallout:vo,DragHandle:Og,Dropdown:Ag,DropdownItem:Rg,DropdownLabel:Ig,DropdownMenu:Dg,DropdownSeparator:Ng,DropdownFooter:Bg,DropdownHeader:Lg,Editable:Mg,ErrorMessage:$g,EmptyStateItem:zg,EmptyStateMenu:jg,Field:qg,Header:_o,Heading:Hg,HoverCard:Vg,Icon:Wg,Input:Gg,InputGroup:Kg,InputGroupAppend:Xg,InputGroupPrepend:Yg,Label:Qg,Listing:Zg,ListingCustomizeColumns:Jg,ListingFilters:ey,ListingHeaderCell:ty,ListingPagination:iy,ListingPresets:ny,ListingPresetTrigger:ry,ListingRowActions:sy,ListingSearch:oy,ListingTable:ay,ListingTableBody:ly,ListingTableHead:uy,ListingToggleAll:dy,LivePreview:cy,LivePreviewPopout:hy,Modal:py,ModalClose:fy,ModalTitle:my,Pagination:gy,Panel:yy,PanelFooter:by,PanelHeader:vy,Popover:_y,PublishComponents:wy,PublishContainer:Sy,publishContextKey:Fy,injectPublishContext:Py,PublishField:Ty,PublishFields:Cy,PublishFieldsProvider:Ey,PublishForm:ky,PublishLocalizations:Uy,PublishSections:xy,PublishTabs:Oy,Radio:Ay,RadioGroup:Ry,Select:Iy,Separator:Dy,Slider:Ny,Skeleton:By,SplitterGroup:Ly,SplitterPanel:My,SplitterResizeHandle:$y,StatusIndicator:zy,Subheading:jy,Switch:qy,TabContent:Hy,Stack:Vy,StackClose:Wy,StackHeader:Gy,StackFooter:Ky,StackContent:Xy,Table:Yy,TableCell:Qy,TableColumn:Zy,TableColumns:Jy,TableRow:eb,TableRows:tb,TabList:ib,TabProvider:nb,Tabs:rb,TabTrigger:sb,Textarea:ob,TimePicker:ab,ToggleGroup:lb,ToggleItem:ub,Widget:db,registerIconSet:cb,registerIconSetFromStrings:hb}=__STATAMIC__.ui,wo=["textContent"],So={__name:"Bunny",props:It.props,emits:It.emits,setup(i,{expose:e,emit:t}){const n=t,r=i,{expose:s,update:o}=It.use(n,r);e(s);const a=nt(null),l=nt(!0),u=nt([]),c=nt([]),h=co(()=>{let T=r.value||[];return(typeof T=="string"||typeof T=="number")&&(T=[T]),T.map(U=>c.value.find(S=>S.value===U)||{value:U,label:U})});function b(){fetch(`https://video.bunnycdn.com/library/${r.meta.library}/videos?page=1&itemsPerPage=100&orderBy=date`,{headers:{Accept:"application/json",AccessKey:r.meta.api}}).then(T=>T.json()).then(T=>{u.value=T,l.value=!1,v()}).catch(T=>{console.error(T)})}function v(){u.value.items.forEach(T=>{c.value.push({value:T.guid,label:`${T.title} (${new Date(T.dateUploaded).toLocaleString()})`})})}function E(T){o(T?T.value:null)}return fo(()=>{b()}),(T,U)=>(H(),K("div",null,[pe(vt(bo),{ref_key:"input",ref:a,class:"flex-1",clearable:!1,disabled:!1,options:c.value,placeholder:T.__("Select Video..."),searchable:!0,multiple:!1,"close-on-select":!0,"model-value":h.value,"onUpdate:modelValue":E,onFocus:U[0]||(U[0]=S=>T.$emit("focus")),onBlur:U[1]||(U[1]=S=>T.$emit("blur"))},{option:_t(({label:S})=>[bi(j(S),1)]),"selected-option":_t(({label:S})=>[bi(j(S),1)]),"no-options":_t(()=>[D("div",{class:"text-sm text-gray-700 text-left py-2 px-4",textContent:j(T.__("No options to choose from."))},null,8,wo)]),_:1},8,["options","placeholder","model-value"])]))}},{Form:pb,Head:Fo,Link:fb,router:mb,toggleArchitecturalBackground:gb,useArchitecturalBackground:yb,useForm:bb,usePoll:vb}=__STATAMIC__.inertia,Ae=(i,e)=>{const t=i.__vccOpts||i;for(const[n,r]of e)t[n]=r;return t},Po={},To={"aria-hidden":"true",viewBox:"0 0 100 101",style:{color:"#eef2f6"},fill:"#2D9EFC",xmlns:"http://www.w3.org/2000/svg"};function Co(i,e){return H(),K("svg",To,[...e[0]||(e[0]=[D("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"currentColor"},null,-1),D("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentFill"},null,-1)])])}const Eo=Ae(Po,[["render",Co]]);function ko(i){return{all:i=i||new Map,on:function(e,t){var n=i.get(e);n?n.push(t):i.set(e,[t])},off:function(e,t){var n=i.get(e);n&&(t?n.splice(n.indexOf(t)>>>0,1):i.set(e,[]))},emit:function(e,t){var n=i.get(e);n&&n.slice().map(function(r){r(t)}),(n=i.get("*"))&&n.slice().map(function(r){r(e,t)})}}}const be=ko(),Uo={inject:["bunnyApiKey","bunnyHostname","bunnyLibrary"],props:{video:Object},data(){return{currentVideo:this.video,isLoading:!1,thumbnailUrl:`https://${this.bunnyHostname}/${this.video.guid}/${this.video.thumbnailFileName}`,videoUrl:`https://iframe.mediadelivery.net/play/${this.video.videoLibraryId}/${this.video.guid}`,triggerDeletion:!1}},mounted(){this.currentVideo.status<4&&(this.polling=setInterval(()=>{this.loadVideo()},5e3))},methods:{formatDate(i){return new Date(i).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})},confirmDeletion(){this.triggerDeletion=!0},loadVideo(){this.isLoading=!0,fetch(`https://video.bunnycdn.com/library/${this.bunnyLibrary}/videos/${this.currentVideo.guid}`,{headers:{Accept:"application/json",AccessKey:this.bunnyApiKey}}).then(i=>i.json()).then(i=>{this.currentVideo=i,this.currentVideo.status>=4&&(clearInterval(this.polling),be.emit("load"))}).catch(i=>{console.error(i)}).finally(()=>{this.isLoading=!1})},deleteVideo(){this.isLoading=!0,fetch(`https://video.bunnycdn.com/library/${this.bunnyLibrary}/videos/${this.currentVideo.guid}`,{method:"DELETE",headers:{Accept:"application/json",AccessKey:this.bunnyApiKey}}).then(()=>{this.cancelDeletion(),clearInterval(this.polling),be.emit("load")}).catch(i=>{console.error(i)}).finally(()=>{this.isLoading=!1})},cancelDeletion(){this.triggerDeletion=!1}}},xo={class:"flex items-center gap-2"},Oo=["href"],Ao=["src"],Ro=["href"],Io={class:"text-sm text-gray-500"},Do={class:"hidden md:table-cell"},No={key:0,class:"text-sm text-gray-500"},Bo={key:1,class:"text-sm text-gray-500"},Lo={class:"actions-column"};function Mo(i,e,t,n,r,s){const o=Et("ui-confirmation-modal");return H(),K(ke,null,[D("tr",null,[D("td",null,[D("div",xo,[r.currentVideo.status>=4?(H(),K(ke,{key:0},[D("a",{href:r.videoUrl,target:"_blank",class:"shrink-0"},[D("img",{src:r.thumbnailUrl,class:"size-10 rounded object-cover"},null,8,Ao)],8,Oo),D("a",{href:r.videoUrl,target:"_blank",class:"text-sm font-medium truncate"},j(r.currentVideo.title),9,Ro)],64)):(H(),K(ke,{key:1},[e[2]||(e[2]=D("div",{class:"size-10 rounded bg-gray-300 dark:bg-dark-200 flex items-center justify-center shrink-0"},[D("svg",{class:"size-5 animate-spin text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[D("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),D("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})])],-1)),D("span",Io,j(i.__("Processing..."))+" "+j(r.currentVideo.encodeProgress*2)+"% ",1)],64))])]),D("td",Do,[r.currentVideo.status>=4?(H(),K("span",No,j(s.formatDate(r.currentVideo.dateUploaded)),1)):(H(),K("span",Bo,j(i.__("Processing...")),1))]),D("td",Lo,[D("button",{onClick:e[0]||(e[0]=(...a)=>s.confirmDeletion&&s.confirmDeletion(...a)),class:"text-gray-500 hover:text-red-500"},[...e[3]||(e[3]=[D("svg",{class:"size-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[D("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})],-1)])])])]),(H(),Mi(uo,{to:"body"},[pe(o,{open:r.triggerDeletion,"onUpdate:open":e[1]||(e[1]=a=>r.triggerDeletion=a),title:i.__("Delete video :title",{title:r.currentVideo.title}),onConfirm:s.deleteVideo,onCancel:s.cancelDeletion,danger:"true"},null,8,["open","title","onConfirm","onCancel"])]))],64)}const $o=Ae(Uo,[["render",Mo]]);var Te=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function me(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var rt={exports:{}},ln;function zo(){if(ln)return rt.exports;ln=1;function i(e,t=100,n={}){if(typeof e!="function")throw new TypeError(`Expected the first parameter to be a function, got \`${typeof e}\`.`);if(t<0)throw new RangeError("`wait` must not be negative.");const{immediate:r}=typeof n=="boolean"?{immediate:n}:n;let s,o,a,l,u;function c(){const v=s,E=o;return s=void 0,o=void 0,u=e.apply(v,E),u}function h(){const v=Date.now()-l;v<t&&v>=0?a=setTimeout(h,t-v):(a=void 0,r||(u=c()))}const b=function(...v){if(s&&this!==s&&Object.getPrototypeOf(this)===Object.getPrototypeOf(s))throw new Error("Debounced method called with different contexts of the same prototype.");s=this,o=v,l=Date.now();const E=r&&!a;return a||(a=setTimeout(h,t)),E&&(u=c()),u};return Object.defineProperty(b,"isPending",{get(){return a!==void 0}}),b.clear=()=>{a&&(clearTimeout(a),a=void 0)},b.flush=()=>{a&&b.trigger()},b.trigger=()=>{u=c(),b.clear()},b}return rt.exports.debounce=i,rt.exports=i,rt.exports}var jo=zo();const qo=me(jo),Ho={components:{SpinnerIcon:Eo,VideoCard:$o},inject:["bunnyApiKey","bunnyLibrary"],data(){return{search:"",loading:!0,polling:null,result:null,page:1,maxPage:1,itemsPerPage:10}},computed:{rangeStart(){return(this.page-1)*this.itemsPerPage+1},rangeEnd(){return Math.min(this.page*this.itemsPerPage,this.result.totalItems)}},created(){this.getVideos(),be.on("load",i=>{i&&i.page&&(this.page=i.page),this.getVideos()})},methods:{getVideos(){let i=`https://video.bunnycdn.com/library/${this.bunnyLibrary}/videos?page=${this.page}&itemsPerPage=${this.itemsPerPage}&orderBy=date`;this.search!==""&&(i+=`&search=${this.search}`),fetch(i,{headers:{Accept:"application/json",AccessKey:this.bunnyApiKey}}).then(e=>e.json()).then(e=>{this.maxPage=Math.ceil(e.totalItems/this.itemsPerPage),this.result=e,this.loading=!1}).catch(e=>{console.error(e)})},openUpload(){be.emit("upload")},debouncedSearch:qo(()=>{be.emit("load",{page:1})},500),nextPage(){this.page<this.maxPage&&(this.page++,this.getVideos())},prevPage(){this.page>1&&(this.page--,this.getVideos())}}},Vo={class:"mb-4"},Wo=["placeholder"],Go={key:0,class:"flex items-center justify-center py-12"},Ko={key:1,class:"card p-0"},Xo={class:"data-table"},Yo={class:"hidden md:table-cell"},Qo={key:0,class:"flex items-center justify-between border-t px-4 py-2 text-sm text-gray-700 dark:text-dark-150"},Zo={class:"flex gap-1"},Jo=["disabled"],ea=["disabled"],ta={key:2,class:"text-center text-sm text-gray-500 py-8"},ia={key:3,class:"text-center text-sm text-gray-500 py-8"};function na(i,e,t,n,r,s){const o=Et("SpinnerIcon"),a=Et("VideoCard");return H(),K("div",null,[D("div",Vo,[yo(D("input",{type:"text",placeholder:i.__("Search videos..."),"onUpdate:modelValue":e[0]||(e[0]=l=>r.search=l),onInput:e[1]||(e[1]=(...l)=>s.debouncedSearch&&s.debouncedSearch(...l)),class:"input-text"},null,40,Wo),[[go,r.search]])]),r.loading?(H(),K("div",Go,[pe(o,{class:"size-8 animate-spin text-gray-500"})])):r.result.totalItems>=1?(H(),K("div",Ko,[D("table",Xo,[D("thead",null,[D("tr",null,[D("th",null,j(i.__("Video")),1),D("th",Yo,j(i.__("Date")),1),e[5]||(e[5]=D("th",{class:"actions-column"},null,-1))])]),D("tbody",null,[(H(!0),K(ke,null,mo(r.result.items,l=>(H(),Mi(a,{key:l.guid,video:l},null,8,["video"]))),128))])]),r.result.totalItems>r.itemsPerPage?(H(),K("div",Qo,[D("span",null,j(s.rangeStart)+"–"+j(s.rangeEnd)+" "+j(i.__("of"))+" "+j(r.result.totalItems),1),D("div",Zo,[D("button",{class:"btn-flat btn-sm",disabled:r.page<=1,onClick:e[2]||(e[2]=(...l)=>s.prevPage&&s.prevPage(...l))},"«",8,Jo),D("button",{class:"btn-flat btn-sm",disabled:r.page>=r.maxPage,onClick:e[3]||(e[3]=(...l)=>s.nextPage&&s.nextPage(...l))},"»",8,ea)])])):ho("",!0)])):r.search.length>0?(H(),K("div",ta,j(i.__("No videos found.")),1)):(H(),K("div",ia,[D("p",null,j(i.__("No videos yet.")),1),D("button",{class:"btn-primary mt-4",onClick:e[4]||(e[4]=(...l)=>s.openUpload&&s.openUpload(...l))},j(i.__("Upload Video")),1)]))])}const ra=Ae(Ho,[["render",na]]),sa={},oa={xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor"};function aa(i,e){return H(),K("svg",oa,[...e[0]||(e[0]=[D("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v12m6-6H6"},null,-1)])])}const la=Ae(sa,[["render",aa]]);function ua(i,e,t){const n=[];return i.forEach(r=>typeof r!="string"?n.push(r):e[Symbol.split](r).forEach((s,o,a)=>{s!==""&&n.push(s),o<a.length-1&&n.push(t)})),n}/**
 * Takes a string with placeholder variables like `%{smart_count} file selected`
 * and replaces it with values from options `{smart_count: 5}`
 *
 * @license https://github.com/airbnb/polyglot.js/blob/master/LICENSE
 * taken from https://github.com/airbnb/polyglot.js/blob/master/lib/polyglot.js#L299
 *
 * @param phrase that needs interpolation, with placeholders
 * @param options with values that will be used to replace placeholders
 */function un(i,e){const t=/\$/g,n="$$$$";let r=[i];if(e==null)return r;for(const s of Object.keys(e))if(s!=="_"){let o=e[s];typeof o=="string"&&(o=t[Symbol.replace](o,n)),r=ua(r,new RegExp(`%\\{${s}\\}`,"g"),o)}return r}const da=i=>{throw new Error(`missing string: ${i}`)};class Kr{locale;constructor(e,{onMissingKey:t=da}={}){this.locale={strings:{},pluralize(n){return n===1?0:1}},Array.isArray(e)?e.forEach(this.#t,this):this.#t(e),this.#e=t}#e;#t(e){if(!e?.strings)return;const t=this.locale;Object.assign(this.locale,{strings:{...t.strings,...e.strings},pluralize:e.pluralize||t.pluralize})}translate(e,t){return this.translateArray(e,t).join("")}translateArray(e,t){let n=this.locale.strings[e];if(n==null&&(this.#e(e),n=e),typeof n=="object"){if(t&&typeof t.smart_count<"u"){const s=this.locale.pluralize(t.smart_count);return un(n[s],t)}throw new Error("Attempted to use a string with plural forms, but no value was given for %{smart_count}")}if(typeof n!="string")throw new Error("string was not a string");return un(n,t)}}class $i{uppy;opts;id;defaultLocale;i18n;i18nArray;type;VERSION;constructor(e,t){this.uppy=e,this.opts=t??{}}getPluginState(){const{plugins:e}=this.uppy.getState();return e?.[this.id]||{}}setPluginState(e){const{plugins:t}=this.uppy.getState();this.uppy.setState({plugins:{...t,[this.id]:{...t[this.id],...e}}})}setOptions(e){this.opts={...this.opts,...e},this.setPluginState(void 0),this.i18nInit()}i18nInit(){const e=new Kr([this.defaultLocale,this.uppy.locale,this.opts.locale]);this.i18n=e.translate.bind(e),this.i18nArray=e.translateArray.bind(e),this.setPluginState(void 0)}addTarget(e){throw new Error("Extend the addTarget method to add your plugin to another plugin's target")}install(){}uninstall(){}update(e){}afterUpdate(){}}function Dt(i){return i<10?`0${i}`:i.toString()}function wt(){const i=new Date,e=Dt(i.getHours()),t=Dt(i.getMinutes()),n=Dt(i.getSeconds());return`${e}:${t}:${n}`}const ca={debug:()=>{},warn:()=>{},error:(...i)=>console.error(`[Uppy] [${wt()}]`,...i)},ha={debug:(...i)=>console.debug(`[Uppy] [${wt()}]`,...i),warn:(...i)=>console.warn(`[Uppy] [${wt()}]`,...i),error:(...i)=>console.error(`[Uppy] [${wt()}]`,...i)};function Xr(i){return typeof i!="object"||i===null||!("nodeType"in i)?!1:i.nodeType===Node.ELEMENT_NODE}function pa(i,e=document){return typeof i=="string"?e.querySelector(i):Xr(i)?i:null}function Yr(i){for(;i&&!i.dir;)i=i.parentNode;return i?.dir}var et,N,Qr,ge,dn,Zr,Jr,es,zi,vi,_i,je={},ts=[],fa=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,tt=Array.isArray;function he(i,e){for(var t in e)i[t]=e[t];return i}function ji(i){i&&i.parentNode&&i.parentNode.removeChild(i)}function qe(i,e,t){var n,r,s,o={};for(s in e)s=="key"?n=e[s]:s=="ref"?r=e[s]:o[s]=e[s];if(arguments.length>2&&(o.children=arguments.length>3?et.call(arguments,2):t),typeof i=="function"&&i.defaultProps!=null)for(s in i.defaultProps)o[s]===void 0&&(o[s]=i.defaultProps[s]);return $e(i,o,n,r,null)}function $e(i,e,t,n,r){var s={type:i,props:e,key:t,ref:n,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:r??++Qr,__i:-1,__u:0};return r==null&&N.vnode!=null&&N.vnode(s),s}function ma(){return{current:null}}function le(i){return i.children}function ne(i,e){this.props=i,this.context=e}function xe(i,e){if(e==null)return i.__?xe(i.__,i.__i+1):null;for(var t;e<i.__k.length;e++)if((t=i.__k[e])!=null&&t.__e!=null)return t.__e;return typeof i.type=="function"?xe(i):null}function is(i){var e,t;if((i=i.__)!=null&&i.__c!=null){for(i.__e=i.__c.base=null,e=0;e<i.__k.length;e++)if((t=i.__k[e])!=null&&t.__e!=null){i.__e=i.__c.base=t.__e;break}return is(i)}}function cn(i){(!i.__d&&(i.__d=!0)&&ge.push(i)&&!kt.__r++||dn!=N.debounceRendering)&&((dn=N.debounceRendering)||Zr)(kt)}function kt(){for(var i,e,t,n,r,s,o,a=1;ge.length;)ge.length>a&&ge.sort(Jr),i=ge.shift(),a=ge.length,i.__d&&(t=void 0,n=void 0,r=(n=(e=i).__v).__e,s=[],o=[],e.__P&&((t=he({},n)).__v=n.__v+1,N.vnode&&N.vnode(t),qi(e.__P,t,n,e.__n,e.__P.namespaceURI,32&n.__u?[r]:null,s,r??xe(n),!!(32&n.__u),o),t.__v=n.__v,t.__.__k[t.__i]=t,ss(s,t,o),n.__e=n.__=null,t.__e!=r&&is(t)));kt.__r=0}function ns(i,e,t,n,r,s,o,a,l,u,c){var h,b,v,E,T,U,S,m=n&&n.__k||ts,y=e.length;for(l=ga(t,e,m,l,y),h=0;h<y;h++)(v=t.__k[h])!=null&&(b=v.__i==-1?je:m[v.__i]||je,v.__i=h,U=qi(i,v,b,r,s,o,a,l,u,c),E=v.__e,v.ref&&b.ref!=v.ref&&(b.ref&&Hi(b.ref,null,v),c.push(v.ref,v.__c||E,v)),T==null&&E!=null&&(T=E),(S=!!(4&v.__u))||b.__k===v.__k?l=rs(v,l,i,S):typeof v.type=="function"&&U!==void 0?l=U:E&&(l=E.nextSibling),v.__u&=-7);return t.__e=T,l}function ga(i,e,t,n,r){var s,o,a,l,u,c=t.length,h=c,b=0;for(i.__k=new Array(r),s=0;s<r;s++)(o=e[s])!=null&&typeof o!="boolean"&&typeof o!="function"?(typeof o=="string"||typeof o=="number"||typeof o=="bigint"||o.constructor==String?o=i.__k[s]=$e(null,o,null,null,null):tt(o)?o=i.__k[s]=$e(le,{children:o},null,null,null):o.constructor===void 0&&o.__b>0?o=i.__k[s]=$e(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):i.__k[s]=o,l=s+b,o.__=i,o.__b=i.__b+1,a=null,(u=o.__i=ya(o,t,l,h))!=-1&&(h--,(a=t[u])&&(a.__u|=2)),a==null||a.__v==null?(u==-1&&(r>c?b--:r<c&&b++),typeof o.type!="function"&&(o.__u|=4)):u!=l&&(u==l-1?b--:u==l+1?b++:(u>l?b--:b++,o.__u|=4))):i.__k[s]=null;if(h)for(s=0;s<c;s++)(a=t[s])!=null&&(2&a.__u)==0&&(a.__e==n&&(n=xe(a)),as(a,a));return n}function rs(i,e,t,n){var r,s;if(typeof i.type=="function"){for(r=i.__k,s=0;r&&s<r.length;s++)r[s]&&(r[s].__=i,e=rs(r[s],e,t,n));return e}i.__e!=e&&(n&&(e&&i.type&&!e.parentNode&&(e=xe(i)),t.insertBefore(i.__e,e||null)),e=i.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function oe(i,e){return e=e||[],i==null||typeof i=="boolean"||(tt(i)?i.some(function(t){oe(t,e)}):e.push(i)),e}function ya(i,e,t,n){var r,s,o,a=i.key,l=i.type,u=e[t],c=u!=null&&(2&u.__u)==0;if(u===null&&a==null||c&&a==u.key&&l==u.type)return t;if(n>(c?1:0)){for(r=t-1,s=t+1;r>=0||s<e.length;)if((u=e[o=r>=0?r--:s++])!=null&&(2&u.__u)==0&&a==u.key&&l==u.type)return o}return-1}function hn(i,e,t){e[0]=="-"?i.setProperty(e,t??""):i[e]=t==null?"":typeof t!="number"||fa.test(e)?t:t+"px"}function st(i,e,t,n,r){var s,o;e:if(e=="style")if(typeof t=="string")i.style.cssText=t;else{if(typeof n=="string"&&(i.style.cssText=n=""),n)for(e in n)t&&e in t||hn(i.style,e,"");if(t)for(e in t)n&&t[e]==n[e]||hn(i.style,e,t[e])}else if(e[0]=="o"&&e[1]=="n")s=e!=(e=e.replace(es,"$1")),o=e.toLowerCase(),e=o in i||e=="onFocusOut"||e=="onFocusIn"?o.slice(2):e.slice(2),i.l||(i.l={}),i.l[e+s]=t,t?n?t.u=n.u:(t.u=zi,i.addEventListener(e,s?_i:vi,s)):i.removeEventListener(e,s?_i:vi,s);else{if(r=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in i)try{i[e]=t??"";break e}catch{}typeof t=="function"||(t==null||t===!1&&e[4]!="-"?i.removeAttribute(e):i.setAttribute(e,e=="popover"&&t==1?"":t))}}function pn(i){return function(e){if(this.l){var t=this.l[e.type+i];if(e.t==null)e.t=zi++;else if(e.t<t.u)return;return t(N.event?N.event(e):e)}}}function qi(i,e,t,n,r,s,o,a,l,u){var c,h,b,v,E,T,U,S,m,y,_,w,x,O,R,A,z,M=e.type;if(e.constructor!==void 0)return null;128&t.__u&&(l=!!(32&t.__u),s=[a=e.__e=t.__e]),(c=N.__b)&&c(e);e:if(typeof M=="function")try{if(S=e.props,m="prototype"in M&&M.prototype.render,y=(c=M.contextType)&&n[c.__c],_=c?y?y.props.value:c.__:n,t.__c?U=(h=e.__c=t.__c).__=h.__E:(m?e.__c=h=new M(S,_):(e.__c=h=new ne(S,_),h.constructor=M,h.render=va),y&&y.sub(h),h.state||(h.state={}),h.__n=n,b=h.__d=!0,h.__h=[],h._sb=[]),m&&h.__s==null&&(h.__s=h.state),m&&M.getDerivedStateFromProps!=null&&(h.__s==h.state&&(h.__s=he({},h.__s)),he(h.__s,M.getDerivedStateFromProps(S,h.__s))),v=h.props,E=h.state,h.__v=e,b)m&&M.getDerivedStateFromProps==null&&h.componentWillMount!=null&&h.componentWillMount(),m&&h.componentDidMount!=null&&h.__h.push(h.componentDidMount);else{if(m&&M.getDerivedStateFromProps==null&&S!==v&&h.componentWillReceiveProps!=null&&h.componentWillReceiveProps(S,_),e.__v==t.__v||!h.__e&&h.shouldComponentUpdate!=null&&h.shouldComponentUpdate(S,h.__s,_)===!1){for(e.__v!=t.__v&&(h.props=S,h.state=h.__s,h.__d=!1),e.__e=t.__e,e.__k=t.__k,e.__k.some(function(V){V&&(V.__=e)}),w=0;w<h._sb.length;w++)h.__h.push(h._sb[w]);h._sb=[],h.__h.length&&o.push(h);break e}h.componentWillUpdate!=null&&h.componentWillUpdate(S,h.__s,_),m&&h.componentDidUpdate!=null&&h.__h.push(function(){h.componentDidUpdate(v,E,T)})}if(h.context=_,h.props=S,h.__P=i,h.__e=!1,x=N.__r,O=0,m){for(h.state=h.__s,h.__d=!1,x&&x(e),c=h.render(h.props,h.state,h.context),R=0;R<h._sb.length;R++)h.__h.push(h._sb[R]);h._sb=[]}else do h.__d=!1,x&&x(e),c=h.render(h.props,h.state,h.context),h.state=h.__s;while(h.__d&&++O<25);h.state=h.__s,h.getChildContext!=null&&(n=he(he({},n),h.getChildContext())),m&&!b&&h.getSnapshotBeforeUpdate!=null&&(T=h.getSnapshotBeforeUpdate(v,E)),A=c,c!=null&&c.type===le&&c.key==null&&(A=os(c.props.children)),a=ns(i,tt(A)?A:[A],e,t,n,r,s,o,a,l,u),h.base=e.__e,e.__u&=-161,h.__h.length&&o.push(h),U&&(h.__E=h.__=null)}catch(V){if(e.__v=null,l||s!=null)if(V.then){for(e.__u|=l?160:128;a&&a.nodeType==8&&a.nextSibling;)a=a.nextSibling;s[s.indexOf(a)]=null,e.__e=a}else{for(z=s.length;z--;)ji(s[z]);wi(e)}else e.__e=t.__e,e.__k=t.__k,V.then||wi(e);N.__e(V,e,t)}else s==null&&e.__v==t.__v?(e.__k=t.__k,e.__e=t.__e):a=e.__e=ba(t.__e,e,t,n,r,s,o,l,u);return(c=N.diffed)&&c(e),128&e.__u?void 0:a}function wi(i){i&&i.__c&&(i.__c.__e=!0),i&&i.__k&&i.__k.forEach(wi)}function ss(i,e,t){for(var n=0;n<t.length;n++)Hi(t[n],t[++n],t[++n]);N.__c&&N.__c(e,i),i.some(function(r){try{i=r.__h,r.__h=[],i.some(function(s){s.call(r)})}catch(s){N.__e(s,r.__v)}})}function os(i){return typeof i!="object"||i==null||i.__b&&i.__b>0?i:tt(i)?i.map(os):he({},i)}function ba(i,e,t,n,r,s,o,a,l){var u,c,h,b,v,E,T,U=t.props||je,S=e.props,m=e.type;if(m=="svg"?r="http://www.w3.org/2000/svg":m=="math"?r="http://www.w3.org/1998/Math/MathML":r||(r="http://www.w3.org/1999/xhtml"),s!=null){for(u=0;u<s.length;u++)if((v=s[u])&&"setAttribute"in v==!!m&&(m?v.localName==m:v.nodeType==3)){i=v,s[u]=null;break}}if(i==null){if(m==null)return document.createTextNode(S);i=document.createElementNS(r,m,S.is&&S),a&&(N.__m&&N.__m(e,s),a=!1),s=null}if(m==null)U===S||a&&i.data==S||(i.data=S);else{if(s=s&&et.call(i.childNodes),!a&&s!=null)for(U={},u=0;u<i.attributes.length;u++)U[(v=i.attributes[u]).name]=v.value;for(u in U)if(v=U[u],u!="children"){if(u=="dangerouslySetInnerHTML")h=v;else if(!(u in S)){if(u=="value"&&"defaultValue"in S||u=="checked"&&"defaultChecked"in S)continue;st(i,u,null,v,r)}}for(u in S)v=S[u],u=="children"?b=v:u=="dangerouslySetInnerHTML"?c=v:u=="value"?E=v:u=="checked"?T=v:a&&typeof v!="function"||U[u]===v||st(i,u,v,U[u],r);if(c)a||h&&(c.__html==h.__html||c.__html==i.innerHTML)||(i.innerHTML=c.__html),e.__k=[];else if(h&&(i.innerHTML=""),ns(e.type=="template"?i.content:i,tt(b)?b:[b],e,t,n,m=="foreignObject"?"http://www.w3.org/1999/xhtml":r,s,o,s?s[0]:t.__k&&xe(t,0),a,l),s!=null)for(u=s.length;u--;)ji(s[u]);a||(u="value",m=="progress"&&E==null?i.removeAttribute("value"):E!=null&&(E!==i[u]||m=="progress"&&!E||m=="option"&&E!=U[u])&&st(i,u,E,U[u],r),u="checked",T!=null&&T!=i[u]&&st(i,u,T,U[u],r))}return i}function Hi(i,e,t){try{if(typeof i=="function"){var n=typeof i.__u=="function";n&&i.__u(),n&&e==null||(i.__u=i(e))}else i.current=e}catch(r){N.__e(r,t)}}function as(i,e,t){var n,r;if(N.unmount&&N.unmount(i),(n=i.ref)&&(n.current&&n.current!=i.__e||Hi(n,null,e)),(n=i.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(s){N.__e(s,e)}n.base=n.__P=null}if(n=i.__k)for(r=0;r<n.length;r++)n[r]&&as(n[r],e,t||typeof i.type!="function");t||ji(i.__e),i.__c=i.__=i.__e=void 0}function va(i,e,t){return this.constructor(i,t)}function _a(i,e,t){var n,r,s,o;e==document&&(e=document.documentElement),N.__&&N.__(i,e),r=(n=!1)?null:e.__k,s=[],o=[],qi(e,i=e.__k=qe(le,null,[i]),r||je,je,e.namespaceURI,r?null:e.firstChild?et.call(e.childNodes):null,s,r?r.__e:e.firstChild,n,o),ss(s,i,o)}function ls(i,e,t){var n,r,s,o,a=he({},i.props);for(s in i.type&&i.type.defaultProps&&(o=i.type.defaultProps),e)s=="key"?n=e[s]:s=="ref"?r=e[s]:a[s]=e[s]===void 0&&o!=null?o[s]:e[s];return arguments.length>2&&(a.children=arguments.length>3?et.call(arguments,2):t),$e(i.type,a,n||i.key,r||i.ref,null)}et=ts.slice,N={__e:function(i,e,t,n){for(var r,s,o;e=e.__;)if((r=e.__c)&&!r.__)try{if((s=r.constructor)&&s.getDerivedStateFromError!=null&&(r.setState(s.getDerivedStateFromError(i)),o=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(i,n||{}),o=r.__d),o)return r.__E=r}catch(a){i=a}throw i}},Qr=0,ne.prototype.setState=function(i,e){var t;t=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=he({},this.state),typeof i=="function"&&(i=i(he({},t),this.props)),i&&he(t,i),i!=null&&this.__v&&(e&&this._sb.push(e),cn(this))},ne.prototype.forceUpdate=function(i){this.__v&&(this.__e=!0,i&&this.__h.push(i),cn(this))},ne.prototype.render=le,ge=[],Zr=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Jr=function(i,e){return i.__v.__b-e.__v.__b},kt.__r=0,es=/(PointerCapture)$|Capture$/i,zi=0,vi=pn(!1),_i=pn(!0);var He,W,Nt,fn,Ve=0,us=[],G=N,mn=G.__b,gn=G.__r,yn=G.diffed,bn=G.__c,vn=G.unmount,_n=G.__;function Vi(i,e){G.__h&&G.__h(W,i,Ve||e),Ve=0;var t=W.__H||(W.__H={__:[],__h:[]});return i>=t.__.length&&t.__.push({}),t.__[i]}function Ut(i){return Ve=1,wa(cs,i)}function wa(i,e,t){var n=Vi(He++,2);if(n.t=i,!n.__c&&(n.__=[t?t(e):cs(void 0,e),function(a){var l=n.__N?n.__N[0]:n.__[0],u=n.t(l,a);l!==u&&(n.__N=[u,n.__[1]],n.__c.setState({}))}],n.__c=W,!W.__f)){var r=function(a,l,u){if(!n.__c.__H)return!0;var c=n.__c.__H.__.filter(function(b){return!!b.__c});if(c.every(function(b){return!b.__N}))return!s||s.call(this,a,l,u);var h=n.__c.props!==a;return c.forEach(function(b){if(b.__N){var v=b.__[0];b.__=b.__N,b.__N=void 0,v!==b.__[0]&&(h=!0)}}),s&&s.call(this,a,l,u)||h};W.__f=!0;var s=W.shouldComponentUpdate,o=W.componentWillUpdate;W.componentWillUpdate=function(a,l,u){if(this.__e){var c=s;s=void 0,r(a,l,u),s=c}o&&o.call(this,a,l,u)},W.shouldComponentUpdate=r}return n.__N||n.__}function Si(i,e){var t=Vi(He++,3);!G.__s&&ds(t.__H,e)&&(t.__=i,t.u=e,W.__H.__h.push(t))}function St(i){return Ve=5,Wi(function(){return{current:i}},[])}function Wi(i,e){var t=Vi(He++,7);return ds(t.__H,e)&&(t.__=i(),t.__H=e,t.__h=i),t.__}function Sa(i,e){return Ve=8,Wi(function(){return i},e)}function Fa(){for(var i;i=us.shift();)if(i.__P&&i.__H)try{i.__H.__h.forEach(Ft),i.__H.__h.forEach(Fi),i.__H.__h=[]}catch(e){i.__H.__h=[],G.__e(e,i.__v)}}G.__b=function(i){W=null,mn&&mn(i)},G.__=function(i,e){i&&e.__k&&e.__k.__m&&(i.__m=e.__k.__m),_n&&_n(i,e)},G.__r=function(i){gn&&gn(i),He=0;var e=(W=i.__c).__H;e&&(Nt===W?(e.__h=[],W.__h=[],e.__.forEach(function(t){t.__N&&(t.__=t.__N),t.u=t.__N=void 0})):(e.__h.forEach(Ft),e.__h.forEach(Fi),e.__h=[],He=0)),Nt=W},G.diffed=function(i){yn&&yn(i);var e=i.__c;e&&e.__H&&(e.__H.__h.length&&(us.push(e)!==1&&fn===G.requestAnimationFrame||((fn=G.requestAnimationFrame)||Pa)(Fa)),e.__H.__.forEach(function(t){t.u&&(t.__H=t.u),t.u=void 0})),Nt=W=null},G.__c=function(i,e){e.some(function(t){try{t.__h.forEach(Ft),t.__h=t.__h.filter(function(n){return!n.__||Fi(n)})}catch(n){e.some(function(r){r.__h&&(r.__h=[])}),e=[],G.__e(n,t.__v)}}),bn&&bn(i,e)},G.unmount=function(i){vn&&vn(i);var e,t=i.__c;t&&t.__H&&(t.__H.__.forEach(function(n){try{Ft(n)}catch(r){e=r}}),t.__H=void 0,e&&G.__e(e,t.__v))};var wn=typeof requestAnimationFrame=="function";function Pa(i){var e,t=function(){clearTimeout(n),wn&&cancelAnimationFrame(e),setTimeout(i)},n=setTimeout(t,35);wn&&(e=requestAnimationFrame(t))}function Ft(i){var e=W,t=i.__c;typeof t=="function"&&(i.__c=void 0,t()),W=e}function Fi(i){var e=W;i.__c=i.__(),W=e}function ds(i,e){return!i||i.length!==e.length||e.some(function(t,n){return t!==i[n]})}function cs(i,e){return typeof e=="function"?e(i):e}function Ta(i,e){for(var t in e)i[t]=e[t];return i}function Sn(i,e){for(var t in i)if(t!=="__source"&&!(t in e))return!0;for(var n in e)if(n!=="__source"&&i[n]!==e[n])return!0;return!1}function Fn(i,e){this.props=i,this.context=e}(Fn.prototype=new ne).isPureReactComponent=!0,Fn.prototype.shouldComponentUpdate=function(i,e){return Sn(this.props,i)||Sn(this.state,e)};var Pn=N.__b;N.__b=function(i){i.type&&i.type.__f&&i.ref&&(i.props.ref=i.ref,i.ref=null),Pn&&Pn(i)};var Ca=N.__e;N.__e=function(i,e,t,n){if(i.then){for(var r,s=e;s=s.__;)if((r=s.__c)&&r.__c)return e.__e==null&&(e.__e=t.__e,e.__k=t.__k),r.__c(i,e)}Ca(i,e,t,n)};var Tn=N.unmount;function hs(i,e,t){return i&&(i.__c&&i.__c.__H&&(i.__c.__H.__.forEach(function(n){typeof n.__c=="function"&&n.__c()}),i.__c.__H=null),(i=Ta({},i)).__c!=null&&(i.__c.__P===t&&(i.__c.__P=e),i.__c.__e=!0,i.__c=null),i.__k=i.__k&&i.__k.map(function(n){return hs(n,e,t)})),i}function ps(i,e,t){return i&&t&&(i.__v=null,i.__k=i.__k&&i.__k.map(function(n){return ps(n,e,t)}),i.__c&&i.__c.__P===e&&(i.__e&&t.appendChild(i.__e),i.__c.__e=!0,i.__c.__P=t)),i}function Bt(){this.__u=0,this.o=null,this.__b=null}function fs(i){if(!i.__)return null;var e=i.__.__c;return e&&e.__a&&e.__a(i)}function ot(){this.i=null,this.l=null}N.unmount=function(i){var e=i.__c;e&&(e.__z=!0),e&&e.__R&&e.__R(),e&&32&i.__u&&(i.type=null),Tn&&Tn(i)},(Bt.prototype=new ne).__c=function(i,e){var t=e.__c,n=this;n.o==null&&(n.o=[]),n.o.push(t);var r=fs(n.__v),s=!1,o=function(){s||n.__z||(s=!0,t.__R=null,r?r(l):l())};t.__R=o;var a=t.__P;t.__P=null;var l=function(){if(!--n.__u){if(n.state.__a){var u=n.state.__a;n.__v.__k[0]=ps(u,u.__c.__P,u.__c.__O)}var c;for(n.setState({__a:n.__b=null});c=n.o.pop();)c.__P=a,c.forceUpdate()}};n.__u++||32&e.__u||n.setState({__a:n.__b=n.__v.__k[0]}),i.then(o,o)},Bt.prototype.componentWillUnmount=function(){this.o=[]},Bt.prototype.render=function(i,e){if(this.__b){if(this.__v.__k){var t=document.createElement("div"),n=this.__v.__k[0].__c;this.__v.__k[0]=hs(this.__b,t,n.__O=n.__P)}this.__b=null}var r=e.__a&&qe(le,null,i.fallback);return r&&(r.__u&=-33),[qe(le,null,e.__a?null:i.children),r]};var Cn=function(i,e,t){if(++t[1]===t[0]&&i.l.delete(e),i.props.revealOrder&&(i.props.revealOrder[0]!=="t"||!i.l.size))for(t=i.i;t;){for(;t.length>3;)t.pop()();if(t[1]<t[0])break;i.i=t=t[2]}};(ot.prototype=new ne).__a=function(i){var e=this,t=fs(e.__v),n=e.l.get(i);return n[0]++,function(r){var s=function(){e.props.revealOrder?(n.push(r),Cn(e,i,n)):r()};t?t(s):s()}},ot.prototype.render=function(i){this.i=null,this.l=new Map;var e=oe(i.children);i.revealOrder&&i.revealOrder[0]==="b"&&e.reverse();for(var t=e.length;t--;)this.l.set(e[t],this.i=[1,0,this.i]);return i.children},ot.prototype.componentDidUpdate=ot.prototype.componentDidMount=function(){var i=this;this.l.forEach(function(e,t){Cn(i,t,e)})};var Ea=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,ka=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Ua=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,xa=/[A-Z0-9]/g,Oa=typeof document<"u",Aa=function(i){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(i)};function En(i,e,t){return e.__k==null&&(e.textContent=""),_a(i,e),typeof t=="function"&&t(),i?i.__c:null}ne.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(i){Object.defineProperty(ne.prototype,i,{configurable:!0,get:function(){return this["UNSAFE_"+i]},set:function(e){Object.defineProperty(this,i,{configurable:!0,writable:!0,value:e})}})});var kn=N.event;function Ra(){}function Ia(){return this.cancelBubble}function Da(){return this.defaultPrevented}N.event=function(i){return kn&&(i=kn(i)),i.persist=Ra,i.isPropagationStopped=Ia,i.isDefaultPrevented=Da,i.nativeEvent=i};var Na={enumerable:!1,configurable:!0,get:function(){return this.class}},Un=N.vnode;N.vnode=function(i){typeof i.type=="string"&&(function(e){var t=e.props,n=e.type,r={},s=n.indexOf("-")===-1;for(var o in t){var a=t[o];if(!(o==="value"&&"defaultValue"in t&&a==null||Oa&&o==="children"&&n==="noscript"||o==="class"||o==="className")){var l=o.toLowerCase();o==="defaultValue"&&"value"in t&&t.value==null?o="value":o==="download"&&a===!0?a="":l==="translate"&&a==="no"?a=!1:l[0]==="o"&&l[1]==="n"?l==="ondoubleclick"?o="ondblclick":l!=="onchange"||n!=="input"&&n!=="textarea"||Aa(t.type)?l==="onfocus"?o="onfocusin":l==="onblur"?o="onfocusout":Ua.test(o)&&(o=l):l=o="oninput":s&&ka.test(o)?o=o.replace(xa,"-$&").toLowerCase():a===null&&(a=void 0),l==="oninput"&&r[o=l]&&(o="oninputCapture"),r[o]=a}}n=="select"&&r.multiple&&Array.isArray(r.value)&&(r.value=oe(t.children).forEach(function(u){u.props.selected=r.value.indexOf(u.props.value)!=-1})),n=="select"&&r.defaultValue!=null&&(r.value=oe(t.children).forEach(function(u){u.props.selected=r.multiple?r.defaultValue.indexOf(u.props.value)!=-1:r.defaultValue==u.props.value})),t.class&&!t.className?(r.class=t.class,Object.defineProperty(r,"className",Na)):(t.className&&!t.class||t.class&&t.className)&&(r.class=r.className=t.className),e.props=r})(i),i.$$typeof=Ea,Un&&Un(i)};var xn=N.__r;N.__r=function(i){xn&&xn(i),i.__c};var On=N.diffed;N.diffed=function(i){On&&On(i);var e=i.props,t=i.__e;t!=null&&i.type==="textarea"&&"value"in e&&e.value!==t.value&&(t.value=e.value==null?"":e.value)};function Ba(i){let e=null,t;return(...n)=>(t=n,e||(e=Promise.resolve().then(()=>(e=null,i(...t)))),e)}class ve extends $i{#e;isTargetDOMEl;el;parent;title;getTargetPlugin(e){let t;if(typeof e?.addTarget=="function")t=e,t instanceof ve||console.warn(new Error("The provided plugin is not an instance of UIPlugin. This is an indication of a bug with the way Uppy is bundled.",{cause:{targetPlugin:t,UIPlugin:ve}}));else if(typeof e=="function"){const n=e;this.uppy.iteratePlugins(r=>{r instanceof n&&(t=r)})}return t}mount(e,t){const n=t.id,r=pa(e);if(r){this.isTargetDOMEl=!0;const a=document.createElement("div");return a.classList.add("uppy-Root"),this.#e=Ba(l=>{this.uppy.getPlugin(this.id)&&(En(this.render(l,a),a),this.afterUpdate())}),this.uppy.log(`Installing ${n} to a DOM element '${e}'`),this.opts.replaceTargetContent&&(r.innerHTML=""),En(this.render(this.uppy.getState(),a),a),this.el=a,r.appendChild(a),a.dir=this.opts.direction||Yr(a)||"ltr",this.onMount(),this.el}const s=this.getTargetPlugin(e);if(s)return this.uppy.log(`Installing ${n} to ${s.id}`),this.parent=s,this.el=s.addTarget(t),this.onMount(),this.el;this.uppy.log(`Not installing ${n}`);let o=`Invalid target option given to ${n}.`;throw typeof e=="function"?o+=" The given target is not a Plugin class. Please check that you're not specifying a React Component instead of a plugin. If you are using @uppy/* packages directly, make sure you have only 1 version of @uppy/core installed: run `npm ls @uppy/core` on the command line and verify that all the versions match and are deduped correctly.":o+="If you meant to target an HTML element, please make sure that the element exists. Check that the <script> tag initializing Uppy is right before the closing </body> tag at the end of the page. (see https://github.com/transloadit/uppy/issues/1042)\n\nIf you meant to target a plugin, please confirm that your `import` statements or `require` calls are correct.",new Error(o)}render(e,t){throw new Error("Extend the render method to add your plugin to a DOM element")}update(e){this.el!=null&&this.#e?.(e)}unmount(){this.isTargetDOMEl&&this.el?.remove(),this.onUnmount()}onMount(){}onUnmount(){}}const La="4.3.2",Ma={version:La};class $a{static VERSION=Ma.version;state={};#e=new Set;getState(){return this.state}setState(e){const t={...this.state},n={...this.state,...e};this.state=n,this.#t(t,n,e)}subscribe(e){return this.#e.add(e),()=>{this.#e.delete(e)}}#t(...e){this.#e.forEach(t=>{t(...e)})}}function ms(i){const e=i.lastIndexOf(".");return e===-1||e===i.length-1?{name:i,extension:void 0}:{name:i.slice(0,e),extension:i.slice(e+1)}}const An={__proto__:null,md:"text/markdown",markdown:"text/markdown",mp4:"video/mp4",mp3:"audio/mp3",svg:"image/svg+xml",jpg:"image/jpeg",png:"image/png",webp:"image/webp",gif:"image/gif",heic:"image/heic",heif:"image/heif",yaml:"text/yaml",yml:"text/yaml",csv:"text/csv",tsv:"text/tab-separated-values",tab:"text/tab-separated-values",avi:"video/x-msvideo",mks:"video/x-matroska",mkv:"video/x-matroska",mov:"video/quicktime",dicom:"application/dicom",doc:"application/msword",msg:"application/vnd.ms-outlook",docm:"application/vnd.ms-word.document.macroenabled.12",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotm:"application/vnd.ms-word.template.macroenabled.12",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",xla:"application/vnd.ms-excel",xlam:"application/vnd.ms-excel.addin.macroenabled.12",xlc:"application/vnd.ms-excel",xlf:"application/x-xliff+xml",xlm:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlsb:"application/vnd.ms-excel.sheet.binary.macroenabled.12",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlt:"application/vnd.ms-excel",xltm:"application/vnd.ms-excel.template.macroenabled.12",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlw:"application/vnd.ms-excel",txt:"text/plain",text:"text/plain",conf:"text/plain",log:"text/plain",pdf:"application/pdf",zip:"application/zip","7z":"application/x-7z-compressed",rar:"application/x-rar-compressed",tar:"application/x-tar",gz:"application/gzip",dmg:"application/x-apple-diskimage"};function gs(i){if(i.type)return i.type;const e=i.name?ms(i.name).extension?.toLowerCase():null;return e&&e in An?An[e]:"application/octet-stream"}function za(i){return i.charCodeAt(0).toString(32)}function Rn(i){let e="";return i.replace(/[^A-Z0-9]/gi,t=>(e+=`-${za(t)}`,"/"))+e}function ja(i,e){let t=e||"uppy";return typeof i.name=="string"&&(t+=`-${Rn(i.name.toLowerCase())}`),i.type!==void 0&&(t+=`-${i.type}`),i.meta&&typeof i.meta.relativePath=="string"&&(t+=`-${Rn(i.meta.relativePath.toLowerCase())}`),i.data.size!==void 0&&(t+=`-${i.data.size}`),i.data.lastModified!==void 0&&(t+=`-${i.data.lastModified}`),t}function qa(i){return!i.isRemote||!i.remote?!1:new Set(["box","dropbox","drive","facebook","unsplash"]).has(i.remote.provider)}function Ha(i,e){if(qa(i))return i.id;const t=gs(i);return ja({...i,type:t},e)}var Lt,In;function Gi(){if(In)return Lt;In=1;function i(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}return Lt=i,Lt}var Mt,Dn;function Va(){if(Dn)return Mt;Dn=1;var i=typeof Te=="object"&&Te&&Te.Object===Object&&Te;return Mt=i,Mt}var $t,Nn;function ys(){if(Nn)return $t;Nn=1;var i=Va(),e=typeof self=="object"&&self&&self.Object===Object&&self,t=i||e||Function("return this")();return $t=t,$t}var zt,Bn;function Wa(){if(Bn)return zt;Bn=1;var i=ys(),e=function(){return i.Date.now()};return zt=e,zt}var jt,Ln;function Ga(){if(Ln)return jt;Ln=1;var i=/\s/;function e(t){for(var n=t.length;n--&&i.test(t.charAt(n)););return n}return jt=e,jt}var qt,Mn;function Ka(){if(Mn)return qt;Mn=1;var i=Ga(),e=/^\s+/;function t(n){return n&&n.slice(0,i(n)+1).replace(e,"")}return qt=t,qt}var Ht,$n;function bs(){if($n)return Ht;$n=1;var i=ys(),e=i.Symbol;return Ht=e,Ht}var Vt,zn;function Xa(){if(zn)return Vt;zn=1;var i=bs(),e=Object.prototype,t=e.hasOwnProperty,n=e.toString,r=i?i.toStringTag:void 0;function s(o){var a=t.call(o,r),l=o[r];try{o[r]=void 0;var u=!0}catch{}var c=n.call(o);return u&&(a?o[r]=l:delete o[r]),c}return Vt=s,Vt}var Wt,jn;function Ya(){if(jn)return Wt;jn=1;var i=Object.prototype,e=i.toString;function t(n){return e.call(n)}return Wt=t,Wt}var Gt,qn;function Qa(){if(qn)return Gt;qn=1;var i=bs(),e=Xa(),t=Ya(),n="[object Null]",r="[object Undefined]",s=i?i.toStringTag:void 0;function o(a){return a==null?a===void 0?r:n:s&&s in Object(a)?e(a):t(a)}return Gt=o,Gt}var Kt,Hn;function Za(){if(Hn)return Kt;Hn=1;function i(e){return e!=null&&typeof e=="object"}return Kt=i,Kt}var Xt,Vn;function Ja(){if(Vn)return Xt;Vn=1;var i=Qa(),e=Za(),t="[object Symbol]";function n(r){return typeof r=="symbol"||e(r)&&i(r)==t}return Xt=n,Xt}var Yt,Wn;function el(){if(Wn)return Yt;Wn=1;var i=Ka(),e=Gi(),t=Ja(),n=NaN,r=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,o=/^0o[0-7]+$/i,a=parseInt;function l(u){if(typeof u=="number")return u;if(t(u))return n;if(e(u)){var c=typeof u.valueOf=="function"?u.valueOf():u;u=e(c)?c+"":c}if(typeof u!="string")return u===0?u:+u;u=i(u);var h=s.test(u);return h||o.test(u)?a(u.slice(2),h?2:8):r.test(u)?n:+u}return Yt=l,Yt}var Qt,Gn;function vs(){if(Gn)return Qt;Gn=1;var i=Gi(),e=Wa(),t=el(),n="Expected a function",r=Math.max,s=Math.min;function o(a,l,u){var c,h,b,v,E,T,U=0,S=!1,m=!1,y=!0;if(typeof a!="function")throw new TypeError(n);l=t(l)||0,i(u)&&(S=!!u.leading,m="maxWait"in u,b=m?r(t(u.maxWait)||0,l):b,y="trailing"in u?!!u.trailing:y);function _(k){var q=c,J=h;return c=h=void 0,U=k,v=a.apply(J,q),v}function w(k){return U=k,E=setTimeout(R,l),S?_(k):v}function x(k){var q=k-T,J=k-U,g=l-q;return m?s(g,b-J):g}function O(k){var q=k-T,J=k-U;return T===void 0||q>=l||q<0||m&&J>=b}function R(){var k=e();if(O(k))return A(k);E=setTimeout(R,x(k))}function A(k){return E=void 0,y&&c?_(k):(c=h=void 0,v)}function z(){E!==void 0&&clearTimeout(E),U=0,c=T=h=E=void 0}function M(){return E===void 0?v:A(e())}function V(){var k=e(),q=O(k);if(c=arguments,h=this,T=k,q){if(E===void 0)return w(T);if(m)return clearTimeout(E),E=setTimeout(R,l),_(T)}return E===void 0&&(E=setTimeout(R,l)),v}return V.cancel=z,V.flush=M,V}return Qt=o,Qt}var Zt,Kn;function tl(){if(Kn)return Zt;Kn=1;var i=vs(),e=Gi(),t="Expected a function";function n(r,s,o){var a=!0,l=!0;if(typeof r!="function")throw new TypeError(t);return e(o)&&(a="leading"in o?!!o.leading:a,l="trailing"in o?!!o.trailing:l),i(r,s,{leading:a,maxWait:s,trailing:l})}return Zt=n,Zt}var il=tl();const nl=me(il);var Jt,Xn;function rl(){return Xn||(Xn=1,Jt=function(){var e={},t=e._fns={};e.emit=function(o,a,l,u,c,h,b){var v=n(o);v.length&&r(o,v,[a,l,u,c,h,b])},e.on=function(o,a){t[o]||(t[o]=[]),t[o].push(a)},e.once=function(o,a){function l(){a.apply(this,arguments),e.off(o,l)}this.on(o,l)},e.off=function(o,a){var l=[];if(o&&a){var u=this._fns[o],c=0,h=u?u.length:0;for(c;c<h;c++)u[c]!==a&&l.push(u[c])}l.length?this._fns[o]=l:delete this._fns[o]};function n(s){var o=t[s]?t[s]:[],a=s.indexOf(":"),l=a===-1?[s]:[s.substring(0,a),s.substring(a+1)],u=Object.keys(t),c=0,h=u.length;for(c;c<h;c++){var b=u[c];if(b==="*"&&(o=o.concat(t[b])),l.length===2&&l[0]===b){o=o.concat(t[b]);break}}return o}function r(s,o,a){var l=0,u=o.length;for(l;l<u&&o[l];l++)o[l].event=s,o[l].apply(o[l],a)}return e}),Jt}var sl=rl();const ol=me(sl);let al="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",Ki=(i=21)=>{let e="",t=i|0;for(;t--;)e+=al[Math.random()*64|0];return e};const ll="4.5.3",ul={version:ll};function dl(i,e){return e.name?e.name:i.split("/")[0]==="image"?`${i.split("/")[0]}.${i.split("/")[1]}`:"noname"}const cl={strings:{addBulkFilesFailed:{0:"Failed to add %{smart_count} file due to an internal error",1:"Failed to add %{smart_count} files due to internal errors"},youCanOnlyUploadX:{0:"You can only upload %{smart_count} file",1:"You can only upload %{smart_count} files"},youHaveToAtLeastSelectX:{0:"You have to select at least %{smart_count} file",1:"You have to select at least %{smart_count} files"},aggregateExceedsSize:"You selected %{size} of files, but maximum allowed size is %{sizeAllowed}",exceedsSize:"%{file} exceeds maximum allowed size of %{size}",missingRequiredMetaField:"Missing required meta fields",missingRequiredMetaFieldOnFile:"Missing required meta fields in %{fileName}",inferiorSize:"This file is smaller than the allowed size of %{size}",youCanOnlyUploadFileTypes:"You can only upload: %{types}",noMoreFilesAllowed:"Cannot add more files",noDuplicates:"Cannot add the duplicate file '%{fileName}', it already exists",companionError:"Connection with Companion failed",authAborted:"Authentication aborted",companionUnauthorizeHint:"To unauthorize to your %{provider} account, please go to %{url}",failedToUpload:"Failed to upload %{file}",noInternetConnection:"No Internet connection",connectedToInternet:"Connected to the Internet",noFilesFound:"You have no files or folders here",noSearchResults:"Unfortunately, there are no results for this search",selectX:{0:"Select %{smart_count}",1:"Select %{smart_count}"},allFilesFromFolderNamed:"All files from folder %{name}",openFolderNamed:"Open folder %{name}",cancel:"Cancel",logOut:"Log out",logIn:"Log in",pickFiles:"Pick files",pickPhotos:"Pick photos",filter:"Filter",resetFilter:"Reset filter",loading:"Loading...",loadedXFiles:"Loaded %{numFiles} files",authenticateWithTitle:"Please authenticate with %{pluginName} to select files",authenticateWith:"Connect to %{pluginName}",signInWithGoogle:"Sign in with Google",searchImages:"Search for images",enterTextToSearch:"Enter text to search for images",search:"Search",resetSearch:"Reset search",emptyFolderAdded:"No files were added from empty folder",addedNumFiles:"Added %{numFiles} file(s)",folderAlreadyAdded:'The folder "%{folder}" was already added',folderAdded:{0:"Added %{smart_count} file from %{folder}",1:"Added %{smart_count} files from %{folder}"},additionalRestrictionsFailed:"%{count} additional restrictions were not fulfilled",unnamed:"Unnamed",pleaseWait:"Please wait"}};var ei,Yn;function hl(){return Yn||(Yn=1,ei=function(e){if(typeof e!="number"||Number.isNaN(e))throw new TypeError(`Expected a number, got ${typeof e}`);const t=e<0;let n=Math.abs(e);if(t&&(n=-n),n===0)return"0 B";const r=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],s=Math.min(Math.floor(Math.log(n)/Math.log(1024)),r.length-1),o=Number(n/1024**s),a=r[s];return`${o>=10||o%1===0?Math.round(o):o.toFixed(1)} ${a}`}),ei}var pl=hl();const ye=me(pl);var ti,Qn;function fl(){if(Qn)return ti;Qn=1;function i(e,t){this.text=e=e||"",this.hasWild=~e.indexOf("*"),this.separator=t,this.parts=e.split(t)}return i.prototype.match=function(e){var t=!0,n=this.parts,r,s=n.length,o;if(typeof e=="string"||e instanceof String)if(!this.hasWild&&this.text!=e)t=!1;else{for(o=(e||"").split(this.separator),r=0;t&&r<s;r++)n[r]!=="*"&&(r<o.length?t=n[r]===o[r]:t=!1);t=t&&o}else if(typeof e.splice=="function")for(t=[],r=e.length;r--;)this.match(e[r])&&(t[t.length]=e[r]);else if(typeof e=="object"){t={};for(var a in e)this.match(a)&&(t[a]=e[a])}return t},ti=function(e,t,n){var r=new i(e,n||/[\/\.]/);return typeof t<"u"?r.match(t):r},ti}var ii,Zn;function ml(){if(Zn)return ii;Zn=1;var i=fl(),e=/[\/\+\.]/;return ii=function(t,n){function r(s){var o=i(s,t,e);return o&&o.length>=2}return n?r(n.split(";")[0]):r},ii}var gl=ml();const yl=me(gl),bl={maxFileSize:null,minFileSize:null,maxTotalFileSize:null,maxNumberOfFiles:null,minNumberOfFiles:null,allowedFileTypes:null,requiredMetaFields:[]};class re extends Error{isUserFacing;file;constructor(e,t){super(e),this.isUserFacing=t?.isUserFacing??!0,t?.file&&(this.file=t.file)}isRestriction=!0}class vl{getI18n;getOpts;constructor(e,t){this.getI18n=t,this.getOpts=()=>{const n=e();if(n.restrictions?.allowedFileTypes!=null&&!Array.isArray(n.restrictions.allowedFileTypes))throw new TypeError("`restrictions.allowedFileTypes` must be an array");return n}}validateAggregateRestrictions(e,t){const{maxTotalFileSize:n,maxNumberOfFiles:r}=this.getOpts().restrictions;if(r&&e.filter(o=>!o.isGhost).length+t.length>r)throw new re(`${this.getI18n()("youCanOnlyUploadX",{smart_count:r})}`);if(n){const s=[...e,...t].reduce((o,a)=>o+(a.size??0),0);if(s>n)throw new re(this.getI18n()("aggregateExceedsSize",{sizeAllowed:ye(n),size:ye(s)}))}}validateSingleFile(e){const{maxFileSize:t,minFileSize:n,allowedFileTypes:r}=this.getOpts().restrictions;if(r&&!r.some(o=>o.includes("/")?e.type?yl(e.type.replace(/;.*?$/,""),o):!1:o[0]==="."&&e.extension?e.extension.toLowerCase()===o.slice(1).toLowerCase():!1)){const o=r.join(", ");throw new re(this.getI18n()("youCanOnlyUploadFileTypes",{types:o}),{file:e})}if(t&&e.size!=null&&e.size>t)throw new re(this.getI18n()("exceedsSize",{size:ye(t),file:e.name??this.getI18n()("unnamed")}),{file:e});if(n&&e.size!=null&&e.size<n)throw new re(this.getI18n()("inferiorSize",{size:ye(n)}),{file:e})}validate(e,t){t.forEach(n=>{this.validateSingleFile(n)}),this.validateAggregateRestrictions(e,t)}validateMinNumberOfFiles(e){const{minNumberOfFiles:t}=this.getOpts().restrictions;if(t&&Object.keys(e).length<t)throw new re(this.getI18n()("youHaveToAtLeastSelectX",{smart_count:t}))}getMissingRequiredMetaFields(e){const t=new re(this.getI18n()("missingRequiredMetaFieldOnFile",{fileName:e.name??this.getI18n()("unnamed")})),{requiredMetaFields:n}=this.getOpts().restrictions,r=[];for(const s of n)(!Object.hasOwn(e.meta,s)||e.meta[s]==="")&&r.push(s);return{missingFields:r,error:t}}}function _l(i){if(i==null&&typeof navigator<"u"&&(i=navigator.userAgent),!i)return!0;const e=/Edge\/(\d+\.\d+)/.exec(i);if(!e)return!0;const n=e[1].split(".",2),r=parseInt(n[0],10),s=parseInt(n[1],10);return r<15||r===15&&s<15063||r>18||r===18&&s>=18218}const at={totalProgress:0,allowNewUpload:!0,error:null,recoveredState:null};class Xi{static VERSION=ul.version;#e=Object.create(null);#t;#n;#i=ol();#r=new Set;#o=new Set;#a=new Set;defaultLocale;locale;opts;store;i18n;i18nArray;scheduledAutoProceed=null;wasOffline=!1;constructor(e){this.defaultLocale=cl;const t={id:"uppy",autoProceed:!1,allowMultipleUploadBatches:!0,debug:!1,restrictions:bl,meta:{},onBeforeFileAdded:(r,s)=>!Object.hasOwn(s,r.id),onBeforeUpload:r=>r,store:new $a,logger:ca,infoTimeout:5e3},n={...t,...e};this.opts={...n,restrictions:{...t.restrictions,...e?.restrictions}},e?.logger&&e.debug?this.log("You are using a custom `logger`, but also set `debug: true`, which uses built-in logger to output logs to console. Ignoring `debug: true` and using your custom `logger`.","warning"):e?.debug&&(this.opts.logger=ha),this.log(`Using Core v${Xi.VERSION}`),this.i18nInit(),this.store=this.opts.store,this.setState({...at,plugins:{},files:{},currentUploads:{},capabilities:{uploadProgress:_l(),individualCancellation:!0,resumableUploads:!1},meta:{...this.opts.meta},info:[]}),this.#t=new vl(()=>this.opts,()=>this.i18n),this.#n=this.store.subscribe((r,s,o)=>{this.emit("state-update",r,s,o),this.updateAll(s)}),this.opts.debug&&typeof window<"u"&&(window[this.opts.id]=this),this.#T()}emit(e,...t){this.#i.emit(e,...t)}on(e,t){return this.#i.on(e,t),this}once(e,t){return this.#i.once(e,t),this}off(e,t){return this.#i.off(e,t),this}updateAll(e){this.iteratePlugins(t=>{t.update(e)})}setState(e){this.store.setState(e)}getState(){return this.store.getState()}patchFilesState(e){const t=this.getState().files;this.setState({files:{...t,...Object.fromEntries(Object.entries(e).map(([n,r])=>[n,{...t[n],...r}]))}})}setFileState(e,t){if(!this.getState().files[e])throw new Error(`Can’t set state for ${e} (the file could have been removed)`);this.patchFilesState({[e]:t})}i18nInit(){const e=n=>this.log(`Missing i18n string: ${n}`,"error"),t=new Kr([this.defaultLocale,this.opts.locale],{onMissingKey:e});this.i18n=t.translate.bind(t),this.i18nArray=t.translateArray.bind(t),this.locale=t.locale}setOptions(e){this.opts={...this.opts,...e,restrictions:{...this.opts.restrictions,...e?.restrictions}},e.meta&&this.setMeta(e.meta),this.i18nInit(),e.locale&&this.iteratePlugins(t=>{t.setOptions(e)}),this.setState(void 0)}resetProgress(){const e={percentage:0,bytesUploaded:!1,uploadComplete:!1,uploadStarted:null},t={...this.getState().files},n=Object.create(null);Object.keys(t).forEach(r=>{n[r]={...t[r],progress:{...t[r].progress,...e},tus:void 0,transloadit:void 0}}),this.setState({files:n,...at})}clear(){const{capabilities:e,currentUploads:t}=this.getState();if(Object.keys(t).length>0&&!e.individualCancellation)throw new Error("The installed uploader plugin does not allow removing files during an upload.");this.setState({...at,files:{}})}addPreProcessor(e){this.#r.add(e)}removePreProcessor(e){return this.#r.delete(e)}addPostProcessor(e){this.#a.add(e)}removePostProcessor(e){return this.#a.delete(e)}addUploader(e){this.#o.add(e)}removeUploader(e){return this.#o.delete(e)}setMeta(e){const t={...this.getState().meta,...e},n={...this.getState().files};Object.keys(n).forEach(r=>{n[r]={...n[r],meta:{...n[r].meta,...e}}}),this.log("Adding metadata:"),this.log(e),this.setState({meta:t,files:n})}setFileMeta(e,t){const n={...this.getState().files};if(!n[e]){this.log(`Was trying to set metadata for a file that has been removed: ${e}`);return}const r={...n[e].meta,...t};n[e]={...n[e],meta:r},this.setState({files:n})}getFile(e){return this.getState().files[e]}getFiles(){const{files:e}=this.getState();return Object.values(e)}getFilesByIds(e){return e.map(t=>this.getFile(t))}getObjectOfFilesPerState(){const{files:e,totalProgress:t,error:n}=this.getState(),r=Object.values(e),s=[],o=[],a=[],l=[],u=[],c=[],h=[],b=[],v=[];for(const E of r){const{progress:T}=E;!T.uploadComplete&&T.uploadStarted&&(s.push(E),E.isPaused||b.push(E)),T.uploadStarted||o.push(E),(T.uploadStarted||T.preprocess||T.postprocess)&&a.push(E),T.uploadStarted&&l.push(E),E.isPaused&&u.push(E),T.uploadComplete&&c.push(E),E.error&&h.push(E),(T.preprocess||T.postprocess)&&v.push(E)}return{newFiles:o,startedFiles:a,uploadStartedFiles:l,pausedFiles:u,completeFiles:c,erroredFiles:h,inProgressFiles:s,inProgressNotPausedFiles:b,processingFiles:v,isUploadStarted:l.length>0,isAllComplete:t===100&&c.length===r.length&&v.length===0,isAllErrored:!!n&&h.length===r.length,isAllPaused:s.length!==0&&u.length===s.length,isUploadInProgress:s.length>0,isSomeGhost:r.some(E=>E.isGhost)}}#s(e){for(const o of e)o.isRestriction?this.emit("restriction-failed",o.file,o):this.emit("error",o,o.file),this.log(o,"warning");const t=e.filter(o=>o.isUserFacing),n=4,r=t.slice(0,n),s=t.slice(n);r.forEach(({message:o,details:a=""})=>{this.info({message:o,details:a},"error",this.opts.infoTimeout)}),s.length>0&&this.info({message:this.i18n("additionalRestrictionsFailed",{count:s.length})})}validateRestrictions(e,t=this.getFiles()){try{this.#t.validate(t,[e])}catch(n){return n}return null}validateSingleFile(e){try{this.#t.validateSingleFile(e)}catch(t){return t.message}return null}validateAggregateRestrictions(e){const t=this.getFiles();try{this.#t.validateAggregateRestrictions(t,e)}catch(n){return n.message}return null}#l(e){const{missingFields:t,error:n}=this.#t.getMissingRequiredMetaFields(e);return t.length>0?(this.setFileState(e.id,{missingRequiredMetaFields:t,error:n.message}),this.log(n.message),this.emit("restriction-failed",e,n),!1):(t.length===0&&e.missingRequiredMetaFields&&this.setFileState(e.id,{missingRequiredMetaFields:[]}),!0)}#p(e){let t=!0;for(const n of Object.values(e))this.#l(n)||(t=!1);return t}#u(e){const{allowNewUpload:t}=this.getState();if(t===!1){const n=new re(this.i18n("noMoreFilesAllowed"),{file:e});throw this.#s([n]),n}}checkIfFileAlreadyExists(e){const{files:t}=this.getState();return!!(t[e]&&!t[e].isGhost)}#h(e){const t=e instanceof File?{name:e.name,type:e.type,size:e.size,data:e}:e,n=gs(t),r=dl(n,t),s=ms(r).extension,o=Ha(t,this.getID()),a=t.meta||{};a.name=r,a.type=n;const l=Number.isFinite(t.data.size)?t.data.size:null;return{source:t.source||"",id:o,name:r,extension:s||"",meta:{...this.getState().meta,...a},type:n,data:t.data,progress:{percentage:0,bytesUploaded:!1,bytesTotal:l,uploadComplete:!1,uploadStarted:null},size:l,isGhost:!1,isRemote:t.isRemote||!1,remote:t.remote,preview:t.preview}}#c(){this.opts.autoProceed&&!this.scheduledAutoProceed&&(this.scheduledAutoProceed=setTimeout(()=>{this.scheduledAutoProceed=null,this.upload().catch(e=>{e.isRestriction||this.log(e.stack||e.message||e)})},4))}#d(e){let{files:t}=this.getState(),n={...t};const r=[],s=[];for(const o of e)try{let a=this.#h(o);const l=t[a.id]?.isGhost;l&&(a={...t[a.id],isGhost:!1,data:o.data},this.log(`Replaced the blob in the restored ghost file: ${a.name}, ${a.id}`));const u=this.opts.onBeforeFileAdded(a,n);if(t=this.getState().files,n={...t,...n},!u&&this.checkIfFileAlreadyExists(a.id))throw new re(this.i18n("noDuplicates",{fileName:a.name??this.i18n("unnamed")}),{file:o});if(u===!1&&!l)throw new re("Cannot add the file because onBeforeFileAdded returned false.",{isUserFacing:!1,file:o});typeof u=="object"&&u!==null&&(a=u),this.#t.validateSingleFile(a),n[a.id]=a,r.push(a)}catch(a){s.push(a)}try{this.#t.validateAggregateRestrictions(Object.values(t),r)}catch(o){return s.push(o),{nextFilesState:t,validFilesToAdd:[],errors:s}}return{nextFilesState:n,validFilesToAdd:r,errors:s}}addFile(e){this.#u(e);const{nextFilesState:t,validFilesToAdd:n,errors:r}=this.#d([e]),s=r.filter(a=>a.isRestriction);if(this.#s(s),r.length>0)throw r[0];this.setState({files:t});const[o]=n;return this.emit("file-added",o),this.emit("files-added",n),this.log(`Added file: ${o.name}, ${o.id}, mime type: ${o.type}`),this.#c(),o.id}addFiles(e){this.#u();const{nextFilesState:t,validFilesToAdd:n,errors:r}=this.#d(e),s=r.filter(a=>a.isRestriction);this.#s(s);const o=r.filter(a=>!a.isRestriction);if(o.length>0){let a=`Multiple errors occurred while adding files:
`;if(o.forEach(l=>{a+=`
 * ${l.message}`}),this.info({message:this.i18n("addBulkFilesFailed",{smart_count:o.length}),details:a},"error",this.opts.infoTimeout),typeof AggregateError=="function")throw new AggregateError(o,a);{const l=new Error(a);throw l.errors=o,l}}this.setState({files:t}),n.forEach(a=>{this.emit("file-added",a)}),this.emit("files-added",n),n.length>5?this.log(`Added batch of ${n.length} files`):Object.values(n).forEach(a=>{this.log(`Added file: ${a.name}
 id: ${a.id}
 type: ${a.type}`)}),n.length>0&&this.#c()}removeFiles(e){const{files:t,currentUploads:n}=this.getState(),r={...t},s={...n},o=Object.create(null);e.forEach(c=>{t[c]&&(o[c]=t[c],delete r[c])});function a(c){return o[c]===void 0}Object.keys(s).forEach(c=>{const h=n[c].fileIDs.filter(a);if(h.length===0){delete s[c];return}const{capabilities:b}=this.getState();if(h.length!==n[c].fileIDs.length&&!b.individualCancellation)throw new Error("The installed uploader plugin does not allow removing files during an upload.");s[c]={...n[c],fileIDs:h}});const l={currentUploads:s,files:r};Object.keys(r).length===0&&(l.allowNewUpload=!0,l.error=null,l.recoveredState=null),this.setState(l),this.#y();const u=Object.keys(o);u.forEach(c=>{this.emit("file-removed",o[c])}),u.length>5?this.log(`Removed ${u.length} files`):this.log(`Removed files: ${u.join(", ")}`)}removeFile(e){this.removeFiles([e])}pauseResume(e){if(!this.getState().capabilities.resumableUploads||this.getFile(e).progress.uploadComplete)return;const t=this.getFile(e),r=!(t.isPaused||!1);return this.setFileState(e,{isPaused:r}),this.emit("upload-pause",t,r),r}pauseAll(){const e={...this.getState().files};Object.keys(e).filter(n=>!e[n].progress.uploadComplete&&e[n].progress.uploadStarted).forEach(n=>{const r={...e[n],isPaused:!0};e[n]=r}),this.setState({files:e}),this.emit("pause-all")}resumeAll(){const e={...this.getState().files};Object.keys(e).filter(n=>!e[n].progress.uploadComplete&&e[n].progress.uploadStarted).forEach(n=>{const r={...e[n],isPaused:!1,error:null};e[n]=r}),this.setState({files:e}),this.emit("resume-all")}#f(){const{files:e}=this.getState();return Object.keys(e).filter(t=>{const n=e[t];return n.error&&(!n.missingRequiredMetaFields||n.missingRequiredMetaFields.length===0)})}async#m(){const e=this.#f(),t={...this.getState().files};if(e.forEach(r=>{t[r]={...t[r],isPaused:!1,error:null}}),this.setState({files:t,error:null}),this.emit("retry-all",this.getFilesByIds(e)),e.length===0)return{successful:[],failed:[]};const n=this.#b(e,{forceAllowNewUpload:!0});return this.#v(n)}async retryAll(){const e=await this.#m();return this.emit("complete",e),e}cancelAll(){this.emit("cancel-all");const{files:e}=this.getState(),t=Object.keys(e);t.length&&this.removeFiles(t),this.setState(at)}retryUpload(e){this.setFileState(e,{error:null,isPaused:!1}),this.emit("upload-retry",this.getFile(e));const t=this.#b([e],{forceAllowNewUpload:!0});return this.#v(t)}logout(){this.iteratePlugins(e=>{e.provider?.logout?.()})}#_=(e,t)=>{const n=e?this.getFile(e.id):void 0;if(e==null||!n){this.log(`Not setting progress for a file that has been removed: ${e?.id}`);return}if(n.progress.percentage===100){this.log(`Not setting progress for a file that has been already uploaded: ${e.id}`);return}const r={bytesTotal:t.bytesTotal,percentage:t.bytesTotal!=null&&Number.isFinite(t.bytesTotal)&&t.bytesTotal>0?Math.round(t.bytesUploaded/t.bytesTotal*100):void 0};n.progress.uploadStarted!=null?this.setFileState(e.id,{progress:{...n.progress,...r,bytesUploaded:t.bytesUploaded}}):this.setFileState(e.id,{progress:{...n.progress,...r}}),this.#y()};#S(){const e=this.#P();let t=null;e!=null&&(t=Math.round(e*100),t>100?t=100:t<0&&(t=0)),this.emit("progress",t??0),this.setState({totalProgress:t??0})}#y=nl(()=>this.#S(),500,{leading:!0,trailing:!0});[Symbol.for("uppy test: updateTotalProgress")](){return this.#S()}#P(){const t=this.getFiles().filter(l=>l.progress.uploadStarted||l.progress.preprocess||l.progress.postprocess);if(t.length===0)return 0;if(t.every(l=>l.progress.uploadComplete))return 1;const n=l=>l.progress.bytesTotal!=null&&l.progress.bytesTotal!==0,r=t.filter(n),s=t.filter(l=>!n(l));if(r.every(l=>l.progress.uploadComplete)&&s.length>0&&!s.every(l=>l.progress.uploadComplete))return null;const o=r.reduce((l,u)=>l+(u.progress.bytesTotal??0),0),a=r.reduce((l,u)=>l+(u.progress.bytesUploaded||0),0);return o===0?0:a/o}#T(){const e=(r,s,o)=>{let a=r.message||"Unknown error";r.details&&(a+=` ${r.details}`),this.setState({error:a}),s!=null&&s.id in this.getState().files&&this.setFileState(s.id,{error:a,response:o})};this.on("error",e),this.on("upload-error",(r,s,o)=>{if(e(s,r,o),typeof s=="object"&&s.message){this.log(s.message,"error");const a=new Error(this.i18n("failedToUpload",{file:r?.name??""}));a.isUserFacing=!0,a.details=s.message,s.details&&(a.details+=` ${s.details}`),this.#s([a])}else this.#s([s])});let t=null;this.on("upload-stalled",(r,s)=>{const{message:o}=r,a=s.map(l=>l.meta.name).join(", ");t||(this.info({message:o,details:a},"warning",this.opts.infoTimeout),t=setTimeout(()=>{t=null},this.opts.infoTimeout)),this.log(`${o} ${a}`.trim(),"warning")}),this.on("upload",()=>{this.setState({error:null})});const n=r=>{const s=r.filter(a=>{const l=a!=null&&this.getFile(a.id);return l||this.log(`Not setting progress for a file that has been removed: ${a?.id}`),l}),o=Object.fromEntries(s.map(a=>[a.id,{progress:{uploadStarted:Date.now(),uploadComplete:!1,bytesUploaded:0,bytesTotal:a.size}}]));this.patchFilesState(o)};this.on("upload-start",n),this.on("upload-progress",this.#_),this.on("upload-success",(r,s)=>{if(r==null||!this.getFile(r.id)){this.log(`Not setting progress for a file that has been removed: ${r?.id}`);return}const o=this.getFile(r.id).progress;this.setFileState(r.id,{progress:{...o,postprocess:this.#a.size>0?{mode:"indeterminate"}:void 0,uploadComplete:!0,percentage:100,bytesUploaded:o.bytesTotal},response:s,uploadURL:s.uploadURL,isPaused:!1}),r.size==null&&this.setFileState(r.id,{size:s.bytesUploaded||o.bytesTotal}),this.#y()}),this.on("preprocess-progress",(r,s)=>{if(r==null||!this.getFile(r.id)){this.log(`Not setting progress for a file that has been removed: ${r?.id}`);return}this.setFileState(r.id,{progress:{...this.getFile(r.id).progress,preprocess:s}})}),this.on("preprocess-complete",r=>{if(r==null||!this.getFile(r.id)){this.log(`Not setting progress for a file that has been removed: ${r?.id}`);return}const s={...this.getState().files};s[r.id]={...s[r.id],progress:{...s[r.id].progress}},delete s[r.id].progress.preprocess,this.setState({files:s})}),this.on("postprocess-progress",(r,s)=>{if(r==null||!this.getFile(r.id)){this.log(`Not setting progress for a file that has been removed: ${r?.id}`);return}this.setFileState(r.id,{progress:{...this.getState().files[r.id].progress,postprocess:s}})}),this.on("postprocess-complete",r=>{if(r==null||!this.getFile(r.id)){this.log(`Not setting progress for a file that has been removed: ${r?.id}`);return}const s={...this.getState().files};s[r.id]={...s[r.id],progress:{...s[r.id].progress}},delete s[r.id].progress.postprocess,this.setState({files:s})}),this.on("restored",()=>{this.#y()}),this.on("dashboard:file-edit-complete",r=>{r&&this.#l(r)}),typeof window<"u"&&window.addEventListener&&(window.addEventListener("online",this.#g),window.addEventListener("offline",this.#g),setTimeout(this.#g,3e3))}updateOnlineStatus(){window.navigator.onLine??!0?(this.emit("is-online"),this.wasOffline&&(this.emit("back-online"),this.info(this.i18n("connectedToInternet"),"success",3e3),this.wasOffline=!1)):(this.emit("is-offline"),this.info(this.i18n("noInternetConnection"),"error",0),this.wasOffline=!0)}#g=this.updateOnlineStatus.bind(this);getID(){return this.opts.id}use(e,...t){if(typeof e!="function"){const o=`Expected a plugin class, but got ${e===null?"null":typeof e}. Please verify that the plugin was imported and spelled correctly.`;throw new TypeError(o)}const n=new e(this,...t),r=n.id;if(!r)throw new Error("Your plugin must have an id");if(!n.type)throw new Error("Your plugin must have a type");const s=this.getPlugin(r);if(s){const o=`Already found a plugin named '${s.id}'. Tried to use: '${r}'.
Uppy plugins must have unique \`id\` options.`;throw new Error(o)}return e.VERSION&&this.log(`Using ${r} v${e.VERSION}`),n.type in this.#e?this.#e[n.type].push(n):this.#e[n.type]=[n],n.install(),this.emit("plugin-added",n),this}getPlugin(e){for(const t of Object.values(this.#e)){const n=t.find(r=>r.id===e);if(n!=null)return n}}[Symbol.for("uppy test: getPlugins")](e){return this.#e[e]}iteratePlugins(e){Object.values(this.#e).flat(1).forEach(e)}removePlugin(e){this.log(`Removing plugin ${e.id}`),this.emit("plugin-remove",e),e.uninstall&&e.uninstall();const t=this.#e[e.type],n=t.findIndex(o=>o.id===e.id);n!==-1&&t.splice(n,1);const s={plugins:{...this.getState().plugins,[e.id]:void 0}};this.setState(s)}destroy(){this.log(`Closing Uppy instance ${this.opts.id}: removing all files and uninstalling plugins`),this.cancelAll(),this.#n(),this.iteratePlugins(e=>{this.removePlugin(e)}),typeof window<"u"&&window.removeEventListener&&(window.removeEventListener("online",this.#g),window.removeEventListener("offline",this.#g))}hideInfo(){const{info:e}=this.getState();this.setState({info:e.slice(1)}),this.emit("info-hidden")}info(e,t="info",n=3e3){const r=typeof e=="object";this.setState({info:[...this.getState().info,{type:t,message:r?e.message:e,details:r?e.details:null}]}),setTimeout(()=>this.hideInfo(),n),this.emit("info-visible")}log(e,t){const{logger:n}=this.opts;switch(t){case"error":n.error(e);break;case"warning":n.warn(e);break;default:n.debug(e);break}}#F=new Map;registerRequestClient(e,t){this.#F.set(e,t)}getRequestClientForFile(e){if(!e.remote)throw new Error(`Tried to get RequestClient for a non-remote file ${e.id}`);const t=this.#F.get(e.remote.requestClientId);if(t==null)throw new Error(`requestClientId "${e.remote.requestClientId}" not registered for file "${e.id}"`);return t}restore(e){return this.log(`Core: attempting to restore upload "${e}"`),this.getState().currentUploads[e]?this.#v(e):(this.#w(e),Promise.reject(new Error("Nonexistent upload")))}#b(e,t={}){const{forceAllowNewUpload:n=!1}=t,{allowNewUpload:r,currentUploads:s}=this.getState();if(!r&&!n)throw new Error("Cannot create a new upload: already uploading.");const o=Ki();return this.emit("upload",o,this.getFilesByIds(e)),this.setState({allowNewUpload:this.opts.allowMultipleUploadBatches!==!1&&this.opts.allowMultipleUploads!==!1,currentUploads:{...s,[o]:{fileIDs:e,step:0,result:{}}}}),o}[Symbol.for("uppy test: createUpload")](...e){return this.#b(...e)}#C(e){const{currentUploads:t}=this.getState();return t[e]}addResultData(e,t){if(!this.#C(e)){this.log(`Not setting result for an upload that has been removed: ${e}`);return}const{currentUploads:n}=this.getState(),r={...n[e],result:{...n[e].result,...t}};this.setState({currentUploads:{...n,[e]:r}})}#w(e){const t={...this.getState().currentUploads};delete t[e],this.setState({currentUploads:t})}async#v(e){const t=()=>{const{currentUploads:o}=this.getState();return o[e]};let n=t();const r=[...this.#r,...this.#o,...this.#a];try{for(let o=n.step||0;o<r.length&&n;o++){const a=r[o];this.setState({currentUploads:{...this.getState().currentUploads,[e]:{...n,step:o}}});const{fileIDs:l}=n;await a(l,e),n=t()}}catch(o){throw this.#w(e),o}if(n){n.fileIDs.forEach(u=>{const c=this.getFile(u);c?.progress.postprocess&&this.emit("postprocess-complete",c)});const o=n.fileIDs.map(u=>this.getFile(u)),a=o.filter(u=>!u.error),l=o.filter(u=>u.error);this.addResultData(e,{successful:a,failed:l,uploadID:e}),n=t()}let s;return n&&(s=n.result,this.#w(e)),s==null&&(this.log(`Not setting result for an upload that has been removed: ${e}`),s={successful:[],failed:[],uploadID:e}),s}async upload(){this.#e.uploader?.length||this.log("No uploader type plugins are used","warning");let{files:e}=this.getState();if(this.#f().length>0){const r=await this.#m();if(!(this.getFiles().filter(o=>o.progress.uploadStarted==null).length>0))return this.emit("complete",r),r;({files:e}=this.getState())}const n=this.opts.onBeforeUpload(e);return n===!1?Promise.reject(new Error("Not starting the upload because onBeforeUpload returned false")):(n&&typeof n=="object"&&(e=n,this.setState({files:e})),Promise.resolve().then(()=>this.#t.validateMinNumberOfFiles(e)).catch(r=>{throw this.#s([r]),r}).then(()=>{if(!this.#p(e))throw new re(this.i18n("missingRequiredMetaField"))}).catch(r=>{throw r}).then(async()=>{const{currentUploads:r}=this.getState(),s=Object.values(r).flatMap(u=>u.fileIDs),o=[];Object.keys(e).forEach(u=>{const c=this.getFile(u);!c.progress.uploadStarted&&s.indexOf(u)===-1&&o.push(c.id)});const a=this.#b(o),l=await this.#v(a);return this.emit("complete",l),l}).catch(r=>{throw this.emit("error",r),this.log(r,"error"),r}))}}var wl=0;function d(i,e,t,n,r,s){e||(e={});var o,a,l=e;if("ref"in l)for(a in l={},e)a=="ref"?o=e[a]:l[a]=e[a];var u={type:i,props:l,key:t,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--wl,__i:-1,__u:0,__source:r,__self:s};if(typeof i=="function"&&(o=i.defaultProps))for(a in o)l[a]===void 0&&(l[a]=o[a]);return N.vnode&&N.vnode(u),u}const Sl="4.3.2",Fl={version:Sl},Jn=300;class Pl extends ne{ref=ma();componentWillEnter(e){this.ref.current.style.opacity="1",this.ref.current.style.transform="none",setTimeout(e,Jn)}componentWillLeave(e){this.ref.current.style.opacity="0",this.ref.current.style.transform="translateY(350%)",setTimeout(e,Jn)}render(){const{children:e}=this.props;return d("div",{className:"uppy-Informer-animated",ref:this.ref,children:e})}}function Tl(i,e){return Object.assign(i,e)}function Cl(i,e){return i?.key??e}function El(i,e){const t=i._ptgLinkedRefs||(i._ptgLinkedRefs={});return t[e]||(t[e]=n=>{i.refs[e]=n})}function Ie(i){const e={};for(let t=0;t<i.length;t++)if(i[t]!=null){const n=Cl(i[t],t.toString(36));e[n]=i[t]}return e}function kl(i,e){i=i||{},e=e||{};const t=o=>Object.hasOwn(e,o)?e[o]:i[o],n={};let r=[];for(const o in i)Object.hasOwn(e,o)?r.length&&(n[o]=r,r=[]):r.push(o);const s={};for(const o in e){if(Object.hasOwn(n,o))for(let a=0;a<n[o].length;a++){const l=n[o][a];s[n[o][a]]=t(l)}s[o]=t(o)}for(let o=0;o<r.length;o++)s[r[o]]=t(r[o]);return s}const Ul=i=>i;class _s extends ne{constructor(e,t){super(e,t),this.refs={},this.state={children:Ie(oe(oe(this.props.children))||[])},this.performAppear=this.performAppear.bind(this),this.performEnter=this.performEnter.bind(this),this.performLeave=this.performLeave.bind(this)}componentWillMount(){this.currentlyTransitioningKeys={},this.keysToAbortLeave=[],this.keysToEnter=[],this.keysToLeave=[]}componentDidMount(){const e=this.state.children;for(const t in e)e[t]&&this.performAppear(t)}componentWillReceiveProps(e){const t=Ie(oe(e.children)||[]),n=this.state.children;this.setState(s=>({children:kl(s.children,t)}));let r;for(r in t)if(Object.hasOwn(t,r)){const s=n&&Object.hasOwn(n,r);t[r]&&s&&this.currentlyTransitioningKeys[r]?(this.keysToEnter.push(r),this.keysToAbortLeave.push(r)):t[r]&&!s&&!this.currentlyTransitioningKeys[r]&&this.keysToEnter.push(r)}for(r in n)if(Object.hasOwn(n,r)){const s=t&&Object.hasOwn(t,r);n[r]&&!s&&!this.currentlyTransitioningKeys[r]&&this.keysToLeave.push(r)}}componentDidUpdate(){const{keysToEnter:e}=this;this.keysToEnter=[],e.forEach(this.performEnter);const{keysToLeave:t}=this;this.keysToLeave=[],t.forEach(this.performLeave)}_finishAbort(e){const t=this.keysToAbortLeave.indexOf(e);t!==-1&&this.keysToAbortLeave.splice(t,1)}performAppear(e){this.currentlyTransitioningKeys[e]=!0;const t=this.refs[e];t?.componentWillAppear?t.componentWillAppear(this._handleDoneAppearing.bind(this,e)):this._handleDoneAppearing(e)}_handleDoneAppearing(e){const t=this.refs[e];t?.componentDidAppear&&t.componentDidAppear(),delete this.currentlyTransitioningKeys[e],this._finishAbort(e);const n=Ie(oe(this.props.children)||[]);(!n||!Object.hasOwn(n,e))&&this.performLeave(e)}performEnter(e){this.currentlyTransitioningKeys[e]=!0;const t=this.refs[e];t?.componentWillEnter?t.componentWillEnter(this._handleDoneEntering.bind(this,e)):this._handleDoneEntering(e)}_handleDoneEntering(e){const t=this.refs[e];t?.componentDidEnter&&t.componentDidEnter(),delete this.currentlyTransitioningKeys[e],this._finishAbort(e);const n=Ie(oe(this.props.children)||[]);(!n||!Object.hasOwn(n,e))&&this.performLeave(e)}performLeave(e){if(this.keysToAbortLeave.indexOf(e)!==-1)return;this.currentlyTransitioningKeys[e]=!0;const n=this.refs[e];n?.componentWillLeave?n.componentWillLeave(this._handleDoneLeaving.bind(this,e)):this._handleDoneLeaving(e)}_handleDoneLeaving(e){if(this.keysToAbortLeave.indexOf(e)!==-1)return;const n=this.refs[e];n?.componentDidLeave&&n.componentDidLeave(),delete this.currentlyTransitioningKeys[e];const r=Ie(oe(this.props.children)||[]);if(r&&Object.hasOwn(r,e))this.performEnter(e);else{const s=Tl({},this.state.children);delete s[e],this.setState({children:s})}}render({childFactory:e,transitionLeave:t,transitionName:n,transitionAppear:r,transitionEnter:s,transitionLeaveTimeout:o,transitionEnterTimeout:a,transitionAppearTimeout:l,component:u,...c},{children:h}){const b=Object.entries(h).map(([v,E])=>{if(!E)return;const T=El(this,v);return ls(e(E),{ref:T,key:v})}).filter(Boolean);return qe(u,c,b)}}_s.defaultProps={component:"span",childFactory:Ul};class xl extends ve{static VERSION=Fl.version;constructor(e,t){super(e,t),this.type="progressindicator",this.id=this.opts.id||"Informer",this.title="Informer"}render=e=>d("div",{className:"uppy uppy-Informer",children:d(_s,{children:e.info.map(t=>d(Pl,{children:d("p",{role:"alert",children:[t.message," ",t.details&&d("span",{"aria-label":t.details,"data-microtip-position":"top-left","data-microtip-size":"medium",role:"tooltip",onClick:()=>alert(`${t.message} 

 ${t.details}`),children:"?"})]})},t.message))})});install(){const{target:e}=this.opts;e&&this.mount(e,this)}}var ni={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var er;function Ol(){return er||(er=1,(function(i){(function(){var e={}.hasOwnProperty;function t(){for(var s="",o=0;o<arguments.length;o++){var a=arguments[o];a&&(s=r(s,n(a)))}return s}function n(s){if(typeof s=="string"||typeof s=="number")return s;if(typeof s!="object")return"";if(Array.isArray(s))return t.apply(null,s);if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]"))return s.toString();var o="";for(var a in s)e.call(s,a)&&s[a]&&(o=r(o,a));return o}function r(s,o){return o?s?s+" "+o:s+o:s}i.exports?(t.default=t,i.exports=t):window.classNames=t})()})(ni)),ni.exports}var Al=Ol();const ue=me(Al),Rl={position:"relative",width:"100%",minHeight:"100%"},Il={position:"absolute",top:0,left:0,width:"100%",overflow:"visible"};class Dl extends ne{constructor(e){super(e),this.focusElement=null,this.state={offset:0,height:0}}componentDidMount(){this.resize(),window.addEventListener("resize",this.handleResize)}componentWillUpdate(){this.base.contains(document.activeElement)&&(this.focusElement=document.activeElement)}componentDidUpdate(){this.focusElement?.parentNode&&document.activeElement!==this.focusElement&&this.focusElement.focus(),this.focusElement=null,this.resize()}componentWillUnmount(){window.removeEventListener("resize",this.handleResize)}handleScroll=()=>{this.setState({offset:this.base.scrollTop})};handleResize=()=>{this.resize()};resize(){const{height:e}=this.state;e!==this.base.offsetHeight&&this.setState({height:this.base.offsetHeight})}render({data:e,rowHeight:t,renderRow:n,overscanCount:r=10,...s}){const{offset:o,height:a}=this.state;let l=Math.floor(o/t),u=Math.floor(a/t);r&&(l=Math.max(0,l-l%r),u+=r);const c=l+u+4,h=e.slice(l,c),b={...Rl,height:e.length*t},v={...Il,top:l*t};return d("div",{onScroll:this.handleScroll,...s,children:d("div",{role:"presentation",style:b,children:d("div",{role:"presentation",style:v,children:h.map(n)})})})}}function Nl(){return d("svg",{"aria-hidden":"true",focusable:"false",width:"30",height:"30",viewBox:"0 0 30 30",children:d("path",{d:"M15 30c8.284 0 15-6.716 15-15 0-8.284-6.716-15-15-15C6.716 0 0 6.716 0 15c0 8.284 6.716 15 15 15zm4.258-12.676v6.846h-8.426v-6.846H5.204l9.82-12.364 9.82 12.364H19.26z"})})}function tr(i,e,t,n){return i===e?i:n===0?e:i+(e-i)*2**(-n/t)}const Bl="4.2.3",Ll={version:Bl},Ml={strings:{uploading:"Uploading",complete:"Complete",uploadFailed:"Upload failed",paused:"Paused",retry:"Retry",cancel:"Cancel",pause:"Pause",resume:"Resume",done:"Done",filesUploadedOfTotal:{0:"%{complete} of %{smart_count} file uploaded",1:"%{complete} of %{smart_count} files uploaded"},dataUploadedOfTotal:"%{complete} of %{total}",dataUploadedOfUnknown:"%{complete} of unknown",xTimeLeft:"%{time} left",uploadXFiles:{0:"Upload %{smart_count} file",1:"Upload %{smart_count} files"},uploadXNewFiles:{0:"Upload +%{smart_count} file",1:"Upload +%{smart_count} files"},upload:"Upload",retryUpload:"Retry upload",xMoreFilesAdded:{0:"%{smart_count} more file added",1:"%{smart_count} more files added"},showErrorDetails:"Show error details"}},ce={STATE_ERROR:"error",STATE_WAITING:"waiting",STATE_PREPROCESSING:"preprocessing",STATE_UPLOADING:"uploading",STATE_POSTPROCESSING:"postprocessing",STATE_COMPLETE:"complete"};function $l(i){const e=Math.floor(i/3600)%24,t=Math.floor(i/60)%60,n=Math.floor(i%60);return{hours:e,minutes:t,seconds:n}}function zl(i){const e=$l(i),t=e.hours===0?"":`${e.hours}h`,n=e.minutes===0?"":`${e.hours===0?e.minutes:` ${e.minutes.toString(10).padStart(2,"0")}`}m`,r=e.hours!==0?"":`${e.minutes===0?e.seconds:` ${e.seconds.toString(10).padStart(2,"0")}`}s`;return`${t}${n}${r}`}const jl="·",ir=()=>` ${jl} `;function ql(i){const{newFiles:e,isUploadStarted:t,recoveredState:n,i18n:r,uploadState:s,isSomeGhost:o,startUpload:a}=i,l=ue("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--upload",{"uppy-c-btn-primary":s===ce.STATE_WAITING},{"uppy-StatusBar-actionBtn--disabled":o}),u=e&&t&&!n?r("uploadXNewFiles",{smart_count:e}):r("uploadXFiles",{smart_count:e});return d("button",{type:"button",className:l,"aria-label":r("uploadXFiles",{smart_count:e}),onClick:a,disabled:o,"data-uppy-super-focusable":!0,children:u})}function Hl(i){const{i18n:e,uppy:t}=i;return d("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--retry","aria-label":e("retryUpload"),onClick:()=>t.retryAll().catch(()=>{}),"data-uppy-super-focusable":!0,"data-cy":"retry",children:[d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"8",height:"10",viewBox:"0 0 8 10",children:d("path",{d:"M4 2.408a2.75 2.75 0 1 0 2.75 2.75.626.626 0 0 1 1.25.018v.023a4 4 0 1 1-4-4.041V.25a.25.25 0 0 1 .389-.208l2.299 1.533a.25.25 0 0 1 0 .416l-2.3 1.533A.25.25 0 0 1 4 3.316v-.908z"})}),e("retry")]})}function Vl(i){const{i18n:e,uppy:t}=i;return d("button",{type:"button",className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",title:e("cancel"),"aria-label":e("cancel"),onClick:()=>t.cancelAll(),"data-cy":"cancel","data-uppy-super-focusable":!0,children:d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16",children:d("g",{fill:"none",fillRule:"evenodd",children:[d("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),d("path",{fill:"#FFF",d:"M9.283 8l2.567 2.567-1.283 1.283L8 9.283 5.433 11.85 4.15 10.567 6.717 8 4.15 5.433 5.433 4.15 8 6.717l2.567-2.567 1.283 1.283z"})]})})})}function Wl(i){const{isAllPaused:e,i18n:t,isAllComplete:n,resumableUploads:r,uppy:s}=i,o=t(e?"resume":"pause");function a(){if(!n){if(!r){s.cancelAll();return}if(e){s.resumeAll();return}s.pauseAll()}}return d("button",{title:o,"aria-label":o,className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",type:"button",onClick:a,"data-cy":"togglePauseResume","data-uppy-super-focusable":!0,children:d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16",children:d("g",{fill:"none",fillRule:"evenodd",children:[d("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),d("path",{fill:"#FFF",d:e?"M6 4.25L11.5 8 6 11.75z":"M5 4.5h2v7H5v-7zm4 0h2v7H9v-7z"})]})})})}function Gl(i){const{i18n:e,doneButtonHandler:t}=i;return d("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--done",onClick:t,"data-uppy-super-focusable":!0,children:e("done")})}function ws(){return d("svg",{className:"uppy-StatusBar-spinner","aria-hidden":"true",focusable:"false",width:"14",height:"14",children:d("path",{d:"M13.983 6.547c-.12-2.509-1.64-4.893-3.939-5.936-2.48-1.127-5.488-.656-7.556 1.094C.524 3.367-.398 6.048.162 8.562c.556 2.495 2.46 4.52 4.94 5.183 2.932.784 5.61-.602 7.256-3.015-1.493 1.993-3.745 3.309-6.298 2.868-2.514-.434-4.578-2.349-5.153-4.84a6.226 6.226 0 0 1 2.98-6.778C6.34.586 9.74 1.1 11.373 3.493c.407.596.693 1.282.842 1.988.127.598.073 1.197.161 1.794.078.525.543 1.257 1.15.864.525-.341.49-1.05.456-1.592-.007-.15.02.3 0 0",fillRule:"evenodd"})})}function Kl(i){const{progress:e}=i,{value:t,mode:n,message:r}=e;return d("div",{className:"uppy-StatusBar-content",children:[d(ws,{}),n==="determinate"?`${Math.round(t*100)}% · `:"",r]})}function Xl(i){const{numUploads:e,complete:t,totalUploadedSize:n,totalSize:r,totalETA:s,i18n:o}=i,a=e>1,l=ye(n);return d("div",{className:"uppy-StatusBar-statusSecondary",children:[a&&o("filesUploadedOfTotal",{complete:t,smart_count:e}),d("span",{className:"uppy-StatusBar-additionalInfo",children:[a&&ir(),r!=null?o("dataUploadedOfTotal",{complete:l,total:ye(r)}):o("dataUploadedOfUnknown",{complete:l}),ir(),s!=null&&o("xTimeLeft",{time:zl(s)})]})]})}function Ss(i){const{i18n:e,complete:t,numUploads:n}=i;return d("div",{className:"uppy-StatusBar-statusSecondary",children:e("filesUploadedOfTotal",{complete:t,smart_count:n})})}function Yl(i){const{i18n:e,newFiles:t,startUpload:n}=i,r=ue("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--uploadNewlyAdded");return d("div",{className:"uppy-StatusBar-statusSecondary",children:[d("div",{className:"uppy-StatusBar-statusSecondaryHint",children:e("xMoreFilesAdded",{smart_count:t})}),d("button",{type:"button",className:r,"aria-label":e("uploadXFiles",{smart_count:t}),onClick:n,children:e("upload")})]})}function Ql(i){const{i18n:e,supportsUploadProgress:t,totalProgress:n,showProgressDetails:r,isUploadStarted:s,isAllComplete:o,isAllPaused:a,newFiles:l,numUploads:u,complete:c,totalUploadedSize:h,totalSize:b,totalETA:v,startUpload:E}=i,T=l&&s;if(!s||o)return null;const U=e(a?"paused":"uploading");function S(){return!a&&!T&&r?t?d(Xl,{numUploads:u,complete:c,totalUploadedSize:h,totalSize:b,totalETA:v,i18n:e}):d(Ss,{i18n:e,complete:c,numUploads:u}):null}return d("div",{className:"uppy-StatusBar-content",title:U,children:[a?null:d(ws,{}),d("div",{className:"uppy-StatusBar-status",children:[d("div",{className:"uppy-StatusBar-statusPrimary",children:t&&n!==0?`${U}: ${n}%`:U}),S(),T?d(Yl,{i18n:e,newFiles:l,startUpload:E}):null]})]})}function Zl(i){const{i18n:e}=i;return d("div",{className:"uppy-StatusBar-content",role:"status",title:e("complete"),children:d("div",{className:"uppy-StatusBar-status",children:d("div",{className:"uppy-StatusBar-statusPrimary",children:[d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"15",height:"11",viewBox:"0 0 15 11",children:d("path",{d:"M.414 5.843L1.627 4.63l3.472 3.472L13.202 0l1.212 1.213L5.1 10.528z"})}),e("complete")]})})})}function Jl(i){const{error:e,i18n:t,complete:n,numUploads:r}=i;function s(){const o=`${t("uploadFailed")} 

 ${e}`;alert(o)}return d("div",{className:"uppy-StatusBar-content",title:t("uploadFailed"),children:[d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"11",height:"11",viewBox:"0 0 11 11",children:d("path",{d:"M4.278 5.5L0 1.222 1.222 0 5.5 4.278 9.778 0 11 1.222 6.722 5.5 11 9.778 9.778 11 5.5 6.722 1.222 11 0 9.778z"})}),d("div",{className:"uppy-StatusBar-status",children:[d("div",{className:"uppy-StatusBar-statusPrimary",children:[t("uploadFailed"),d("button",{className:"uppy-u-reset uppy-StatusBar-details","aria-label":t("showErrorDetails"),"data-microtip-position":"top-right","data-microtip-size":"medium",onClick:s,type:"button",children:"?"})]}),d(Ss,{i18n:t,complete:n,numUploads:r})]})]})}function ri(i){const e=[];let t="indeterminate",n;for(const{progress:s}of Object.values(i)){const{preprocess:o,postprocess:a}=s;n==null&&(o||a)&&({mode:t,message:n}=o||a),o?.mode==="determinate"&&e.push(o.value),a?.mode==="determinate"&&e.push(a.value)}const r=e.reduce((s,o)=>s+o/e.length,0);return{mode:t,message:n,value:r}}const{STATE_ERROR:nr,STATE_WAITING:eu,STATE_PREPROCESSING:si,STATE_UPLOADING:lt,STATE_POSTPROCESSING:oi,STATE_COMPLETE:ut}=ce;function tu({newFiles:i,allowNewUpload:e,isUploadInProgress:t,isAllPaused:n,resumableUploads:r,error:s,hideUploadButton:o=void 0,hidePauseResumeButton:a=!1,hideCancelButton:l=!1,hideRetryButton:u=!1,recoveredState:c,uploadState:h,totalProgress:b,files:v,supportsUploadProgress:E,hideAfterFinish:T=!1,isSomeGhost:U,doneButtonHandler:S=void 0,isUploadStarted:m,i18n:y,startUpload:_,uppy:w,isAllComplete:x,showProgressDetails:O=void 0,numUploads:R,complete:A,totalSize:z,totalETA:M,totalUploadedSize:V}){function k(){switch(h){case oi:case si:{const it=ri(v);return it.mode==="determinate"?it.value*100:b}case nr:return null;case lt:return E?b:null;default:return b}}function q(){switch(h){case oi:case si:{const{mode:it}=ri(v);return it==="indeterminate"}case lt:return!E;default:return!1}}const J=k(),g=J??100,p=!s&&i&&(!t&&!n||c)&&e&&!o,f=!l&&h!==eu&&h!==ut,F=r&&!a&&h===lt,C=s&&!x&&!u,P=S&&h===ut,I=ue("uppy-StatusBar-progress",{"is-indeterminate":q()}),B=ue("uppy-StatusBar",`is-${h}`,{"has-ghosts":U}),L=(()=>{switch(h){case si:case oi:return d(Kl,{progress:ri(v)});case ut:return d(Zl,{i18n:y});case nr:return d(Jl,{error:s,i18n:y,numUploads:R,complete:A});case lt:return d(Ql,{i18n:y,supportsUploadProgress:E,totalProgress:b,showProgressDetails:O,isUploadStarted:m,isAllComplete:x,isAllPaused:n,newFiles:i,numUploads:R,complete:A,totalUploadedSize:V,totalSize:z,totalETA:M,startUpload:_});default:return null}})();return!(p||C||F||f||P)&&!L||h===ut&&T?null:d("div",{className:B,children:[d("div",{className:I,style:{width:`${g}%`},role:"progressbar","aria-label":`${g}%`,"aria-valuetext":`${g}%`,"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":J}),L,d("div",{className:"uppy-StatusBar-actions",children:[p?d(ql,{newFiles:i,isUploadStarted:m,recoveredState:c,i18n:y,isSomeGhost:U,startUpload:_,uploadState:h}):null,C?d(Hl,{i18n:y,uppy:w}):null,F?d(Wl,{isAllPaused:n,i18n:y,isAllComplete:x,resumableUploads:r,uppy:w}):null,f?d(Vl,{i18n:y,uppy:w}):null,P?d(Gl,{i18n:y,doneButtonHandler:S}):null]})]})}const iu=2e3,nu=2e3;function ru(i,e,t,n){if(i)return ce.STATE_ERROR;if(e)return ce.STATE_COMPLETE;if(t)return ce.STATE_WAITING;let r=ce.STATE_WAITING;const s=Object.keys(n);for(let o=0;o<s.length;o++){const{progress:a}=n[s[o]];if(a.uploadStarted&&!a.uploadComplete)return ce.STATE_UPLOADING;a.preprocess&&(r=ce.STATE_PREPROCESSING),a.postprocess&&r!==ce.STATE_PREPROCESSING&&(r=ce.STATE_POSTPROCESSING)}return r}const su={hideUploadButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideCancelButton:!1,showProgressDetails:!1,hideAfterFinish:!0,doneButtonHandler:null};class ou extends ve{static VERSION=Ll.version;#e;#t;#n;#i;constructor(e,t){super(e,{...su,...t}),this.id=this.opts.id||"StatusBar",this.title="StatusBar",this.type="progressindicator",this.defaultLocale=Ml,this.i18nInit(),this.render=this.render.bind(this),this.install=this.install.bind(this)}#r(e){if(e.total==null||e.total===0)return null;const t=e.total-e.uploaded;if(t<=0)return null;this.#e??=performance.now();const n=performance.now()-this.#e;if(n===0)return Math.round((this.#i??0)/100)/10;const r=e.uploaded-this.#t;if(this.#t=e.uploaded,r<=0)return Math.round((this.#i??0)/100)/10;const s=r/n,o=this.#n==null?s:tr(s,this.#n,iu,n);this.#n=o;const a=t/o,l=Math.max(this.#i-n,0),u=this.#i==null?a:tr(a,l,nu,n);return this.#i=u,this.#e=performance.now(),Math.round(u/100)/10}startUpload=()=>this.uppy.upload().catch((()=>{}));render(e){const{capabilities:t,files:n,allowNewUpload:r,totalProgress:s,error:o,recoveredState:a}=e,{newFiles:l,startedFiles:u,completeFiles:c,isUploadStarted:h,isAllComplete:b,isAllPaused:v,isUploadInProgress:E,isSomeGhost:T}=this.uppy.getObjectOfFilesPerState(),U=a?Object.values(n):l,S=!!t.resumableUploads,m=t.uploadProgress!==!1;let y=null,_=0;u.every(x=>x.progress.bytesTotal!=null&&x.progress.bytesTotal!==0)?(y=0,u.forEach(x=>{y+=x.progress.bytesTotal||0,_+=x.progress.bytesUploaded||0})):u.forEach(x=>{_+=x.progress.bytesUploaded||0});const w=this.#r({uploaded:_,total:y});return tu({error:o,uploadState:ru(o,b,a,e.files||{}),allowNewUpload:r,totalProgress:s,totalSize:y,totalUploadedSize:_,isAllComplete:!1,isAllPaused:v,isUploadStarted:h,isUploadInProgress:E,isSomeGhost:T,recoveredState:a,complete:c.length,newFiles:U.length,numUploads:u.length,totalETA:w,files:n,i18n:this.i18n,uppy:this.uppy,startUpload:this.startUpload,doneButtonHandler:this.opts.doneButtonHandler,resumableUploads:S,supportsUploadProgress:m,showProgressDetails:this.opts.showProgressDetails,hideUploadButton:this.opts.hideUploadButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,hideCancelButton:this.opts.hideCancelButton,hideAfterFinish:this.opts.hideAfterFinish})}onMount(){const e=this.el;Yr(e)||(e.dir="ltr")}#o=()=>{const{recoveredState:e}=this.uppy.getState();if(this.#n=null,this.#i=null,e){this.#t=Object.values(e.files).reduce((t,{progress:n})=>t+n.bytesUploaded,0),this.uppy.emit("restore-confirmed");return}this.#e=performance.now(),this.#t=0};install(){const{target:e}=this.opts;e&&this.mount(e,this),this.uppy.on("upload",this.#o),this.#e=performance.now(),this.#t=this.uppy.getFiles().reduce((t,n)=>t+n.progress.bytesUploaded,0)}uninstall(){this.unmount(),this.uppy.off("upload",this.#o)}}const au=/^data:([^/]+\/[^,;]+(?:[^,]*?))(;base64)?,([\s\S]*)$/;function lu(i,e,t){const n=au.exec(i),r=e.mimeType??n?.[1]??"plain/text";let s;if(n?.[2]!=null){const o=atob(decodeURIComponent(n[3])),a=new Uint8Array(o.length);for(let l=0;l<o.length;l++)a[l]=o.charCodeAt(l);s=[a]}else n?.[3]!=null&&(s=[decodeURIComponent(n[3])]);return new Blob(s,{type:r})}function rr(i){return i.startsWith("blob:")}function sr(i){return i?/^[^/]+\/(jpe?g|gif|png|svg|svg\+xml|bmp|webp|avif)$/.test(i):!1}function $(i,e,t){return e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}var Fs=typeof self<"u"?self:global;const We=typeof navigator<"u",uu=We&&typeof HTMLImageElement>"u",or=!(typeof global>"u"||typeof process>"u"||!process.versions||!process.versions.node),Ps=Fs.Buffer,Ts=!!Ps,du=i=>i!==void 0;function Cs(i){return i===void 0||(i instanceof Map?i.size===0:Object.values(i).filter(du).length===0)}function Q(i){let e=new Error(i);throw delete e.stack,e}function ar(i){let e=(function(t){let n=0;return t.ifd0.enabled&&(n+=1024),t.exif.enabled&&(n+=2048),t.makerNote&&(n+=2048),t.userComment&&(n+=1024),t.gps.enabled&&(n+=512),t.interop.enabled&&(n+=100),t.ifd1.enabled&&(n+=1024),n+2048})(i);return i.jfif.enabled&&(e+=50),i.xmp.enabled&&(e+=2e4),i.iptc.enabled&&(e+=14e3),i.icc.enabled&&(e+=6e3),e}const ai=i=>String.fromCharCode.apply(null,i),lr=typeof TextDecoder<"u"?new TextDecoder("utf-8"):void 0;class ae{static from(e,t){return e instanceof this&&e.le===t?e:new ae(e,void 0,void 0,t)}constructor(e,t=0,n,r){if(typeof r=="boolean"&&(this.le=r),Array.isArray(e)&&(e=new Uint8Array(e)),e===0)this.byteOffset=0,this.byteLength=0;else if(e instanceof ArrayBuffer){n===void 0&&(n=e.byteLength-t);let s=new DataView(e,t,n);this._swapDataView(s)}else if(e instanceof Uint8Array||e instanceof DataView||e instanceof ae){n===void 0&&(n=e.byteLength-t),(t+=e.byteOffset)+n>e.byteOffset+e.byteLength&&Q("Creating view outside of available memory in ArrayBuffer");let s=new DataView(e.buffer,t,n);this._swapDataView(s)}else if(typeof e=="number"){let s=new DataView(new ArrayBuffer(e));this._swapDataView(s)}else Q("Invalid input argument for BufferView: "+e)}_swapArrayBuffer(e){this._swapDataView(new DataView(e))}_swapBuffer(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}_swapDataView(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}_lengthToEnd(e){return this.byteLength-e}set(e,t,n=ae){return e instanceof DataView||e instanceof ae?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e instanceof Uint8Array||Q("BufferView.set(): Invalid data argument."),this.toUint8().set(e,t),new n(this,t,e.byteLength)}subarray(e,t){return t=t||this._lengthToEnd(e),new ae(this,e,t)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}getString(e=0,t=this.byteLength){return r=this.getUint8Array(e,t),lr?lr.decode(r):Ts?Buffer.from(r).toString("utf8"):decodeURIComponent(escape(ai(r)));var r}getLatin1String(e=0,t=this.byteLength){let n=this.getUint8Array(e,t);return ai(n)}getUnicodeString(e=0,t=this.byteLength){const n=[];for(let r=0;r<t&&e+r<this.byteLength;r+=2)n.push(this.getUint16(e+r));return ai(n)}getInt8(e){return this.dataView.getInt8(e)}getUint8(e){return this.dataView.getUint8(e)}getInt16(e,t=this.le){return this.dataView.getInt16(e,t)}getInt32(e,t=this.le){return this.dataView.getInt32(e,t)}getUint16(e,t=this.le){return this.dataView.getUint16(e,t)}getUint32(e,t=this.le){return this.dataView.getUint32(e,t)}getFloat32(e,t=this.le){return this.dataView.getFloat32(e,t)}getFloat64(e,t=this.le){return this.dataView.getFloat64(e,t)}getFloat(e,t=this.le){return this.dataView.getFloat32(e,t)}getDouble(e,t=this.le){return this.dataView.getFloat64(e,t)}getUintBytes(e,t,n){switch(t){case 1:return this.getUint8(e,n);case 2:return this.getUint16(e,n);case 4:return this.getUint32(e,n);case 8:return this.getUint64&&this.getUint64(e,n)}}getUint(e,t,n){switch(t){case 8:return this.getUint8(e,n);case 16:return this.getUint16(e,n);case 32:return this.getUint32(e,n);case 64:return this.getUint64&&this.getUint64(e,n)}}toString(e){return this.dataView.toString(e,this.constructor.name)}ensureChunk(){}}function Pi(i,e){Q(`${i} '${e}' was not loaded, try using full build of exifr.`)}class Yi extends Map{constructor(e){super(),this.kind=e}get(e,t){return this.has(e)||Pi(this.kind,e),t&&(e in t||(function(n,r){Q(`Unknown ${n} '${r}'.`)})(this.kind,e),t[e].enabled||Pi(this.kind,e)),super.get(e)}keyList(){return Array.from(this.keys())}}var Es=new Yi("file parser"),se=new Yi("segment parser"),Qi=new Yi("file reader");let cu=Fs.fetch;function ur(i,e){return(t=i).startsWith("data:")||t.length>1e4?Ci(i,e,"base64"):or&&i.includes("://")?Ti(i,e,"url",dr):or?Ci(i,e,"fs"):We?Ti(i,e,"url",dr):void Q("Invalid input argument");var t}async function Ti(i,e,t,n){return Qi.has(t)?Ci(i,e,t):n?(async function(r,s){let o=await s(r);return new ae(o)})(i,n):void Q(`Parser ${t} is not loaded`)}async function Ci(i,e,t){let n=new(Qi.get(t))(i,e);return await n.read(),n}const dr=i=>cu(i).then((e=>e.arrayBuffer())),Ei=i=>new Promise(((e,t)=>{let n=new FileReader;n.onloadend=()=>e(n.result||new ArrayBuffer),n.onerror=t,n.readAsArrayBuffer(i)})),Zi=new Map,hu=new Map,pu=new Map,dt=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],ks=["jfif","xmp","icc","iptc","ihdr"],ki=["tiff",...ks],Y=["ifd0","ifd1","exif","gps","interop"],ct=[...ki,...Y],ht=["makerNote","userComment"],Us=["translateKeys","translateValues","reviveValues","multiSegment"],pt=[...Us,"sanitize","mergeOutput","silentErrors"];class xs{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}}class De extends xs{get needed(){return this.enabled||this.deps.size>0}constructor(e,t,n,r){if(super(),$(this,"enabled",!1),$(this,"skip",new Set),$(this,"pick",new Set),$(this,"deps",new Set),$(this,"translateKeys",!1),$(this,"translateValues",!1),$(this,"reviveValues",!1),this.key=e,this.enabled=t,this.parse=this.enabled,this.applyInheritables(r),this.canBeFiltered=Y.includes(e),this.canBeFiltered&&(this.dict=Zi.get(e)),n!==void 0)if(Array.isArray(n))this.parse=this.enabled=!0,this.canBeFiltered&&n.length>0&&this.translateTagSet(n,this.pick);else if(typeof n=="object"){if(this.enabled=!0,this.parse=n.parse!==!1,this.canBeFiltered){let{pick:s,skip:o}=n;s&&s.length>0&&this.translateTagSet(s,this.pick),o&&o.length>0&&this.translateTagSet(o,this.skip)}this.applyInheritables(n)}else n===!0||n===!1?this.parse=this.enabled=n:Q(`Invalid options argument: ${n}`)}applyInheritables(e){let t,n;for(t of Us)n=e[t],n!==void 0&&(this[t]=n)}translateTagSet(e,t){if(this.dict){let n,r,{tagKeys:s,tagValues:o}=this.dict;for(n of e)typeof n=="string"?(r=o.indexOf(n),r===-1&&(r=s.indexOf(Number(n))),r!==-1&&t.add(Number(s[r]))):t.add(n)}else for(let n of e)t.add(n)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,xt(this.pick,this.deps)):this.enabled&&this.pick.size>0&&xt(this.pick,this.deps)}}var ie={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},cr=new Map;class Ji extends xs{static useCached(e){let t=cr.get(e);return t!==void 0||(t=new this(e),cr.set(e,t)),t}constructor(e){super(),e===!0?this.setupFromTrue():e===void 0?this.setupFromUndefined():Array.isArray(e)?this.setupFromArray(e):typeof e=="object"?this.setupFromObject(e):Q(`Invalid options argument ${e}`),this.firstChunkSize===void 0&&(this.firstChunkSize=We?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let e;for(e of dt)this[e]=ie[e];for(e of pt)this[e]=ie[e];for(e of ht)this[e]=ie[e];for(e of ct)this[e]=new De(e,ie[e],void 0,this)}setupFromTrue(){let e;for(e of dt)this[e]=ie[e];for(e of pt)this[e]=ie[e];for(e of ht)this[e]=!0;for(e of ct)this[e]=new De(e,!0,void 0,this)}setupFromArray(e){let t;for(t of dt)this[t]=ie[t];for(t of pt)this[t]=ie[t];for(t of ht)this[t]=ie[t];for(t of ct)this[t]=new De(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,Y)}setupFromObject(e){let t;for(t of(Y.ifd0=Y.ifd0||Y.image,Y.ifd1=Y.ifd1||Y.thumbnail,Object.assign(this,e),dt))this[t]=li(e[t],ie[t]);for(t of pt)this[t]=li(e[t],ie[t]);for(t of ht)this[t]=li(e[t],ie[t]);for(t of ki)this[t]=new De(t,ie[t],e[t],this);for(t of Y)this[t]=new De(t,ie[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,Y,ct),e.tiff===!0?this.batchEnableWithBool(Y,!0):e.tiff===!1?this.batchEnableWithUserValue(Y,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,Y):typeof e.tiff=="object"&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,Y)}batchEnableWithBool(e,t){for(let n of e)this[n].enabled=t}batchEnableWithUserValue(e,t){for(let n of e){let r=t[n];this[n].enabled=r!==!1&&r!==void 0}}setupGlobalFilters(e,t,n,r=n){if(e&&e.length){for(let o of r)this[o].enabled=!1;let s=hr(e,n);for(let[o,a]of s)xt(this[o].pick,a),this[o].enabled=!0}else if(t&&t.length){let s=hr(t,n);for(let[o,a]of s)xt(this[o].skip,a)}}filterNestedSegmentTags(){let{ifd0:e,exif:t,xmp:n,iptc:r,icc:s}=this;this.makerNote?t.deps.add(37500):t.skip.add(37500),this.userComment?t.deps.add(37510):t.skip.add(37510),n.enabled||e.skip.add(700),r.enabled||e.skip.add(33723),s.enabled||e.skip.add(34675)}traverseTiffDependencyTree(){let{ifd0:e,exif:t,gps:n,interop:r}=this;r.needed&&(t.deps.add(40965),e.deps.add(40965)),t.needed&&e.deps.add(34665),n.needed&&e.deps.add(34853),this.tiff.enabled=Y.some((s=>this[s].enabled===!0))||this.makerNote||this.userComment;for(let s of Y)this[s].finalizeFilters()}get onlyTiff(){return!ks.map((e=>this[e].enabled)).some((e=>e===!0))&&this.tiff.enabled}checkLoadedPlugins(){for(let e of ki)this[e].enabled&&!se.has(e)&&Pi("segment parser",e)}}function hr(i,e){let t,n,r,s,o=[];for(r of e){for(s of(t=Zi.get(r),n=[],t))(i.includes(s[0])||i.includes(s[1]))&&n.push(s[0]);n.length&&o.push([r,n])}return o}function li(i,e){return i!==void 0?i:e!==void 0?e:void 0}function xt(i,e){for(let t of e)i.add(t)}$(Ji,"default",ie);class fu{constructor(e){$(this,"parsers",{}),$(this,"output",{}),$(this,"errors",[]),$(this,"pushToErrors",(t=>this.errors.push(t))),this.options=Ji.useCached(e)}async read(e){this.file=await(function(t,n){return typeof t=="string"?ur(t,n):We&&!uu&&t instanceof HTMLImageElement?ur(t.src,n):t instanceof Uint8Array||t instanceof ArrayBuffer||t instanceof DataView?new ae(t):We&&t instanceof Blob?Ti(t,n,"blob",Ei):void Q("Invalid input argument")})(e,this.options)}setup(){if(this.fileParser)return;let{file:e}=this,t=e.getUint16(0);for(let[n,r]of Es)if(r.canHandle(e,t))return this.fileParser=new r(this.options,this.file,this.parsers),e[n]=!0;this.file.close&&this.file.close(),Q("Unknown file format")}async parse(){let{output:e,errors:t}=this;return this.setup(),this.options.silentErrors?(await this.executeParsers().catch(this.pushToErrors),t.push(...this.fileParser.errors)):await this.executeParsers(),this.file.close&&this.file.close(),this.options.silentErrors&&t.length>0&&(e.errors=t),Cs(n=e)?void 0:n;var n}async executeParsers(){let{output:e}=this;await this.fileParser.parse();let t=Object.values(this.parsers).map((async n=>{let r=await n.parse();n.assignToOutput(e,r)}));this.options.silentErrors&&(t=t.map((n=>n.catch(this.pushToErrors)))),await Promise.all(t)}async extractThumbnail(){this.setup();let{options:e,file:t}=this,n=se.get("tiff",e);var r;if(t.tiff?r={start:0,type:"tiff"}:t.jpeg&&(r=await this.fileParser.getOrFindSegment("tiff")),r===void 0)return;let s=await this.fileParser.ensureSegmentChunk(r),o=this.parsers.tiff=new n(s,e,t),a=await o.extractThumbnail();return t.close&&t.close(),a}}class Ce{static findPosition(e,t){let n=e.getUint16(t+2)+2,r=typeof this.headerLength=="function"?this.headerLength(e,t,n):this.headerLength,s=t+r,o=n-r;return{offset:t,length:n,headerLength:r,start:s,size:o,end:s+o}}static parse(e,t={}){return new this(e,new Ji({[this.type]:t}),e).parse()}normalizeInput(e){return e instanceof ae?e:new ae(e)}constructor(e,t={},n){$(this,"errors",[]),$(this,"raw",new Map),$(this,"handleError",(r=>{if(!this.options.silentErrors)throw r;this.errors.push(r.message)})),this.chunk=this.normalizeInput(e),this.file=n,this.type=this.constructor.type,this.globalOptions=this.options=t,this.localOptions=t[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(e,t){let n=pu.get(t),r=hu.get(t),s=Zi.get(t),o=this.options[t],a=o.reviveValues&&!!n,l=o.translateValues&&!!r,u=o.translateKeys&&!!s,c={};for(let[h,b]of e)a&&n.has(h)?b=n.get(h)(b):l&&r.has(h)&&(b=this.translateValue(b,r.get(h))),u&&s.has(h)&&(h=s.get(h)||h),c[h]=b;return c}translateValue(e,t){return t[e]||t.DEFAULT||e}assignToOutput(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}assignObjectToOutput(e,t,n){if(this.globalOptions.mergeOutput)return Object.assign(e,n);e[t]?Object.assign(e[t],n):e[t]=n}}$(Ce,"headerLength",4),$(Ce,"type",void 0),$(Ce,"multiSegment",!1),$(Ce,"canHandle",(()=>!1));function mu(i){return i===192||i===194||i===196||i===219||i===221||i===218||i===254}function gu(i){return i>=224&&i<=239}function yu(i,e,t){for(let[n,r]of se)if(r.canHandle(i,e,t))return n}class pr extends class{constructor(e,t,n){$(this,"errors",[]),$(this,"ensureSegmentChunk",(async r=>{let s=r.start,o=r.size||65536;if(this.file.chunked)if(this.file.available(s,o))r.chunk=this.file.subarray(s,o);else try{r.chunk=await this.file.readChunk(s,o)}catch(a){Q(`Couldn't read segment: ${JSON.stringify(r)}. ${a.message}`)}else this.file.byteLength>s+o?r.chunk=this.file.subarray(s,o):r.size===void 0?r.chunk=this.file.subarray(s):Q("Segment unreachable: "+JSON.stringify(r));return r.chunk})),this.extendOptions&&this.extendOptions(e),this.options=e,this.file=t,this.parsers=n}injectSegment(e,t){this.options[e].enabled&&this.createParser(e,t)}createParser(e,t){let n=new(se.get(e))(t,this.options,this.file);return this.parsers[e]=n}createParsers(e){for(let t of e){let{type:n,chunk:r}=t,s=this.options[n];if(s&&s.enabled){let o=this.parsers[n];o&&o.append||o||this.createParser(n,r)}}}async readSegments(e){let t=e.map(this.ensureSegmentChunk);await Promise.all(t)}}{constructor(...e){super(...e),$(this,"appSegments",[]),$(this,"jpegSegments",[]),$(this,"unknownSegments",[])}static canHandle(e,t){return t===65496}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(e){e===!0?(this.findAll=!0,this.wanted=new Set(se.keyList())):(e=e===void 0?se.keyList().filter((t=>this.options[t].enabled)):e.filter((t=>this.options[t].enabled&&se.has(t))),this.findAll=!1,this.remaining=new Set(e),this.wanted=new Set(e)),this.unfinishedMultiSegment=!1}async findAppSegments(e=0,t){this.setupSegmentFinderArgs(t);let{file:n,findAll:r,wanted:s,remaining:o}=this;if(!r&&this.file.chunked&&(r=Array.from(s).some((a=>{let l=se.get(a),u=this.options[a];return l.multiSegment&&u.multiSegment})),r&&await this.file.readWhole()),e=this.findAppSegmentsInRange(e,n.byteLength),!this.options.onlyTiff&&n.chunked){let a=!1;for(;o.size>0&&!a&&(n.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:l}=n,u=this.appSegments.some((c=>!this.file.available(c.offset||c.start,c.length||c.size)));if(a=e>l&&!u?!await n.readNextChunk(e):!await n.readNextChunk(l),(e=this.findAppSegmentsInRange(e,n.byteLength))===void 0)return}}}findAppSegmentsInRange(e,t){t-=2;let n,r,s,o,a,l,{file:u,findAll:c,wanted:h,remaining:b,options:v}=this;for(;e<t;e++)if(u.getUint8(e)===255){if(n=u.getUint8(e+1),gu(n)){if(r=u.getUint16(e+2),s=yu(u,e,r),s&&h.has(s)&&(o=se.get(s),a=o.findPosition(u,e),l=v[s],a.type=s,this.appSegments.push(a),!c&&(o.multiSegment&&l.multiSegment?(this.unfinishedMultiSegment=a.chunkNumber<a.chunkCount,this.unfinishedMultiSegment||b.delete(s)):b.delete(s),b.size===0)))break;v.recordUnknownSegments&&(a=Ce.findPosition(u,e),a.marker=n,this.unknownSegments.push(a)),e+=r+1}else if(mu(n)){if(r=u.getUint16(e+2),n===218&&v.stopAfterSos!==!1)return;v.recordJpegSegments&&this.jpegSegments.push({offset:e,length:r,marker:n}),e+=r+1}}return e}mergeMultiSegments(){if(!this.appSegments.some((t=>t.multiSegment)))return;let e=(function(t,n){let r,s,o,a=new Map;for(let l=0;l<t.length;l++)r=t[l],s=r[n],a.has(s)?o=a.get(s):a.set(s,o=[]),o.push(r);return Array.from(a)})(this.appSegments,"type");this.mergedAppSegments=e.map((([t,n])=>{let r=se.get(t,this.options);return r.handleMultiSegments?{type:t,chunk:r.handleMultiSegments(n)}:n[0]}))}getSegment(e){return this.appSegments.find((t=>t.type===e))}async getOrFindSegment(e){let t=this.getSegment(e);return t===void 0&&(await this.findAppSegments(0,[e]),t=this.getSegment(e)),t}}$(pr,"type","jpeg"),Es.set("jpeg",pr);const bu=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4];class vu extends Ce{parseHeader(){var e=this.chunk.getUint16();e===18761?this.le=!0:e===19789&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(e,t,n=new Map){let{pick:r,skip:s}=this.options[t];r=new Set(r);let o=r.size>0,a=s.size===0,l=this.chunk.getUint16(e);e+=2;for(let u=0;u<l;u++){let c=this.chunk.getUint16(e);if(o){if(r.has(c)&&(n.set(c,this.parseTag(e,c,t)),r.delete(c),r.size===0))break}else!a&&s.has(c)||n.set(c,this.parseTag(e,c,t));e+=12}return n}parseTag(e,t,n){let{chunk:r}=this,s=r.getUint16(e+2),o=r.getUint32(e+4),a=bu[s];if(a*o<=4?e+=8:e=r.getUint32(e+8),(s<1||s>13)&&Q(`Invalid TIFF value type. block: ${n.toUpperCase()}, tag: ${t.toString(16)}, type: ${s}, offset ${e}`),e>r.byteLength&&Q(`Invalid TIFF value offset. block: ${n.toUpperCase()}, tag: ${t.toString(16)}, type: ${s}, offset ${e} is outside of chunk size ${r.byteLength}`),s===1)return r.getUint8Array(e,o);if(s===2)return(l=(function(u){for(;u.endsWith("\0");)u=u.slice(0,-1);return u})(l=r.getString(e,o)).trim())===""?void 0:l;var l;if(s===7)return r.getUint8Array(e,o);if(o===1)return this.parseTagValue(s,e);{let u=new((function(h){switch(h){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 10:return Array;case 11:return Float32Array;case 12:return Float64Array;default:return Array}})(s))(o),c=a;for(let h=0;h<o;h++)u[h]=this.parseTagValue(s,e),e+=c;return u}}parseTagValue(e,t){let{chunk:n}=this;switch(e){case 1:return n.getUint8(t);case 3:return n.getUint16(t);case 4:return n.getUint32(t);case 5:return n.getUint32(t)/n.getUint32(t+4);case 6:return n.getInt8(t);case 8:return n.getInt16(t);case 9:return n.getInt32(t);case 10:return n.getInt32(t)/n.getInt32(t+4);case 11:return n.getFloat(t);case 12:return n.getDouble(t);case 13:return n.getUint32(t);default:Q(`Invalid tiff type ${e}`)}}}class ui extends vu{static canHandle(e,t){return e.getUint8(t+1)===225&&e.getUint32(t+4)===1165519206&&e.getUint16(t+8)===0}async parse(){this.parseHeader();let{options:e}=this;return e.ifd0.enabled&&await this.parseIfd0Block(),e.exif.enabled&&await this.safeParse("parseExifBlock"),e.gps.enabled&&await this.safeParse("parseGpsBlock"),e.interop.enabled&&await this.safeParse("parseInteropBlock"),e.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(e){let t=this[e]();return t.catch!==void 0&&(t=t.catch(this.handleError)),t}findIfd0Offset(){this.ifd0Offset===void 0&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(this.ifd1Offset===void 0){this.findIfd0Offset();let e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}parseBlock(e,t){let n=new Map;return this[t]=n,this.parseTags(e,t,n),n}async parseIfd0Block(){if(this.ifd0)return;let{file:e}=this;this.findIfd0Offset(),this.ifd0Offset<8&&Q("Malformed EXIF data"),!e.chunked&&this.ifd0Offset>e.byteLength&&Q(`IFD0 offset points to outside of file.
this.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${e.byteLength}`),e.tiff&&await e.ensureChunk(this.ifd0Offset,ar(this.options));let t=this.parseBlock(this.ifd0Offset,"ifd0");return t.size!==0?(this.exifOffset=t.get(34665),this.interopOffset=t.get(40965),this.gpsOffset=t.get(34853),this.xmp=t.get(700),this.iptc=t.get(33723),this.icc=t.get(34675),this.options.sanitize&&(t.delete(34665),t.delete(40965),t.delete(34853),t.delete(700),t.delete(33723),t.delete(34675)),t):void 0}async parseExifBlock(){if(this.exif||(this.ifd0||await this.parseIfd0Block(),this.exifOffset===void 0))return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,ar(this.options));let e=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=e.get(40965)),this.makerNote=e.get(37500),this.userComment=e.get(37510),this.options.sanitize&&(e.delete(40965),e.delete(37500),e.delete(37510)),this.unpack(e,41728),this.unpack(e,41729),e}unpack(e,t){let n=e.get(t);n&&n.length===1&&e.set(t,n[0])}async parseGpsBlock(){if(this.gps||(this.ifd0||await this.parseIfd0Block(),this.gpsOffset===void 0))return;let e=this.parseBlock(this.gpsOffset,"gps");return e&&e.has(2)&&e.has(4)&&(e.set("latitude",fr(...e.get(2),e.get(1))),e.set("longitude",fr(...e.get(4),e.get(3)))),e}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),this.interopOffset!==void 0||this.exif||await this.parseExifBlock(),this.interopOffset!==void 0))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(e=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||e))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),this.ifd1===void 0)return;let e=this.ifd1.get(513),t=this.ifd1.get(514);return this.chunk.getUint8Array(e,t)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let e,t,n,r={};for(t of Y)if(e=this[t],!Cs(e))if(n=this.canTranslate?this.translateBlock(e,t):Object.fromEntries(e),this.options.mergeOutput){if(t==="ifd1")continue;Object.assign(r,n)}else r[t]=n;return this.makerNote&&(r.makerNote=this.makerNote),this.userComment&&(r.userComment=this.userComment),r}assignToOutput(e,t){if(this.globalOptions.mergeOutput)Object.assign(e,t);else for(let[n,r]of Object.entries(t))this.assignObjectToOutput(e,n,r)}}function fr(i,e,t,n){var r=i+e/60+t/3600;return n!=="S"&&n!=="W"||(r*=-1),r}$(ui,"type","tiff"),$(ui,"headerLength",10),se.set("tiff",ui);const en={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1};Object.assign({},en,{firstChunkSize:4e4,gps:[1,2,3,4]});Object.assign({},en,{tiff:!1,ifd1:!0,mergeOutput:!1});const _u=Object.assign({},en,{firstChunkSize:4e4,ifd0:[274]});async function wu(i){let e=new fu(_u);await e.read(i);let t=await e.parse();if(t&&t.ifd0)return t.ifd0[274]}const Su=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}});let Ne=!0,Be=!0;if(typeof navigator=="object"){let i=navigator.userAgent;if(i.includes("iPad")||i.includes("iPhone")){let e=i.match(/OS (\d+)_(\d+)/);if(e){let[,t,n]=e;Ne=Number(t)+.1*Number(n)<13.4,Be=!1}}else if(i.includes("OS X 10")){let[,e]=i.match(/OS X 10[_.](\d+)/);Ne=Be=Number(e)<15}if(i.includes("Chrome/")){let[,e]=i.match(/Chrome\/(\d+)/);Ne=Be=Number(e)<81}else if(i.includes("Firefox/")){let[,e]=i.match(/Firefox\/(\d+)/);Ne=Be=Number(e)<77}}async function Fu(i){let e=await wu(i);return Object.assign({canvas:Ne,css:Be},Su[e])}class Pu extends ae{constructor(...e){super(...e),$(this,"ranges",new Tu),this.byteLength!==0&&this.ranges.add(0,this.byteLength)}_tryExtend(e,t,n){if(e===0&&this.byteLength===0&&n){let r=new DataView(n.buffer||n,n.byteOffset,n.byteLength);this._swapDataView(r)}else{let r=e+t;if(r>this.byteLength){let{dataView:s}=this._extend(r);this._swapDataView(s)}}}_extend(e){let t;t=Ts?Ps.allocUnsafe(e):new Uint8Array(e);let n=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:n}}subarray(e,t,n=!1){return t=t||this._lengthToEnd(e),n&&this._tryExtend(e,t),this.ranges.add(e,t),super.subarray(e,t)}set(e,t,n=!1){n&&this._tryExtend(t,e.byteLength,e);let r=super.set(e,t);return this.ranges.add(t,r.byteLength),r}async ensureChunk(e,t){this.chunked&&(this.ranges.available(e,t)||await this.readChunk(e,t))}available(e,t){return this.ranges.available(e,t)}}class Tu{constructor(){$(this,"list",[])}get length(){return this.list.length}add(e,t,n=0){let r=e+t,s=this.list.filter((o=>mr(e,o.offset,r)||mr(e,o.end,r)));if(s.length>0){e=Math.min(e,...s.map((a=>a.offset))),r=Math.max(r,...s.map((a=>a.end))),t=r-e;let o=s.shift();o.offset=e,o.length=t,o.end=r,this.list=this.list.filter((a=>!s.includes(a)))}else this.list.push({offset:e,length:t,end:r})}available(e,t){let n=e+t;return this.list.some((r=>r.offset<=e&&n<=r.end))}}function mr(i,e,t){return i<=e&&e<=t}class Cu extends Pu{constructor(e,t){super(0),$(this,"chunksRead",0),this.input=e,this.options=t}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(e=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let t=this.options.chunkSize,n=await this.readChunk(e,t);return!!n&&n.byteLength===t}async readChunk(e,t){if(this.chunksRead++,(t=this.safeWrapAddress(e,t))!==0)return this._readChunk(e,t)}safeWrapAddress(e,t){return this.size!==void 0&&e+t>this.size?Math.max(0,this.size-e):t}get nextChunkOffset(){if(this.ranges.list.length!==0)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return this.size!==void 0&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}}Qi.set("blob",class extends Cu{async readWhole(){this.chunked=!1;let i=await Ei(this.input);this._swapArrayBuffer(i)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(i,e){let t=e?i+e:void 0,n=this.input.slice(i,t),r=await Ei(n);return this.set(r,i,!0)}});const Eu="4.2.3",ku={version:Eu},Uu={strings:{generatingThumbnails:"Generating thumbnails..."}};function xu(i,e,t){try{i.getContext("2d").getImageData(0,0,1,1)}catch(n){if(n.code===18)return Promise.reject(new Error("cannot read image, probably an svg with external resources"))}return i.toBlob?new Promise(n=>{i.toBlob(n,e,t)}).then(n=>{if(n===null)throw new Error("cannot read image, probably an svg with external resources");return n}):Promise.resolve().then(()=>lu(i.toDataURL(e,t),{})).then(n=>{if(n===null)throw new Error("could not extract blob, probably an old browser");return n})}function Ou(i,e){let t=i.width,n=i.height;(e.deg===90||e.deg===270)&&(t=i.height,n=i.width);const r=document.createElement("canvas");r.width=t,r.height=n;const s=r.getContext("2d");return s.translate(t/2,n/2),e.canvas&&(s.rotate(e.rad),s.scale(e.scaleX,e.scaleY)),s.drawImage(i,-i.width/2,-i.height/2,i.width,i.height),r}function Au(i){const e=i.width/i.height,t=5e6,n=4096;let r=Math.floor(Math.sqrt(t*e)),s=Math.floor(t/Math.sqrt(t*e));if(r>n&&(r=n,s=Math.round(r/e)),s>n&&(s=n,r=Math.round(e*s)),i.width>r){const o=document.createElement("canvas");return o.width=r,o.height=s,o.getContext("2d").drawImage(i,0,0,r,s),o}return i}const Ru={thumbnailWidth:null,thumbnailHeight:null,thumbnailType:"image/jpeg",waitForThumbnailsBeforeUpload:!1,lazy:!1};class Iu extends ve{static VERSION=ku.version;queue;queueProcessing;defaultThumbnailDimension;thumbnailType;constructor(e,t){if(super(e,{...Ru,...t}),this.type="modifier",this.id=this.opts.id||"ThumbnailGenerator",this.title="Thumbnail Generator",this.queue=[],this.queueProcessing=!1,this.defaultThumbnailDimension=200,this.thumbnailType=this.opts.thumbnailType,this.defaultLocale=Uu,this.i18nInit(),this.opts.lazy&&this.opts.waitForThumbnailsBeforeUpload)throw new Error("ThumbnailGenerator: The `lazy` and `waitForThumbnailsBeforeUpload` options are mutually exclusive. Please ensure at most one of them is set to `true`.")}createThumbnail(e,t,n){const r=URL.createObjectURL(e.data),s=new Promise((a,l)=>{const u=new Image;u.src=r,u.addEventListener("load",()=>{URL.revokeObjectURL(r),a(u)}),u.addEventListener("error",c=>{URL.revokeObjectURL(r),l(c.error||new Error("Could not create thumbnail"))})}),o=Fu(e.data).catch(()=>1);return Promise.all([s,o]).then(([a,l])=>{const u=this.getProportionalDimensions(a,t,n,l.deg),c=Ou(a,l),h=this.resizeImage(c,u.width,u.height);return xu(h,this.thumbnailType,80)}).then(a=>URL.createObjectURL(a))}getProportionalDimensions(e,t,n,r){let s=e.width/e.height;if((r===90||r===270)&&(s=e.height/e.width),t!=null){let o=t;return e.width<t&&(o=e.width),{width:o,height:Math.round(o/s)}}if(n!=null){let o=n;return e.height<n&&(o=e.height),{width:Math.round(o*s),height:o}}return{width:this.defaultThumbnailDimension,height:Math.round(this.defaultThumbnailDimension/s)}}resizeImage(e,t,n){let r=Au(e),s=Math.ceil(Math.log2(r.width/t));s<1&&(s=1);let o=t*2**(s-1),a=n*2**(s-1);const l=2;for(;s--;){const u=document.createElement("canvas");u.width=o,u.height=a,u.getContext("2d").drawImage(r,0,0,o,a),r=u,o=Math.round(o/l),a=Math.round(a/l)}return r}setPreviewURL(e,t){this.uppy.setFileState(e,{preview:t})}addToQueue(e){this.queue.push(e),this.queueProcessing===!1&&this.processQueue()}processQueue(){if(this.queueProcessing=!0,this.queue.length>0){const e=this.uppy.getFile(this.queue.shift());return e?this.requestThumbnail(e).catch(()=>{}).then(()=>this.processQueue()):(this.uppy.log("[ThumbnailGenerator] file was removed before a thumbnail could be generated, but not removed from the queue. This is probably a bug","error"),Promise.resolve())}return this.queueProcessing=!1,this.uppy.log("[ThumbnailGenerator] Emptied thumbnail queue"),this.uppy.emit("thumbnail:all-generated"),Promise.resolve()}requestThumbnail(e){return sr(e.type)&&!e.isRemote?this.createThumbnail(e,this.opts.thumbnailWidth,this.opts.thumbnailHeight).then(t=>{this.setPreviewURL(e.id,t),this.uppy.log(`[ThumbnailGenerator] Generated thumbnail for ${e.id}`),this.uppy.emit("thumbnail:generated",this.uppy.getFile(e.id),t)}).catch(t=>{this.uppy.log(`[ThumbnailGenerator] Failed thumbnail for ${e.id}:`,"warning"),this.uppy.log(t,"warning"),this.uppy.emit("thumbnail:error",this.uppy.getFile(e.id),t)}):Promise.resolve()}onFileAdded=e=>{!e.preview&&e.data&&sr(e.type)&&!e.isRemote&&this.addToQueue(e.id)};onCancelRequest=e=>{const t=this.queue.indexOf(e.id);t!==-1&&this.queue.splice(t,1)};onFileRemoved=e=>{const t=this.queue.indexOf(e.id);t!==-1&&this.queue.splice(t,1),e.preview&&rr(e.preview)&&URL.revokeObjectURL(e.preview)};onRestored=()=>{this.uppy.getFiles().filter(t=>t.isRestored).forEach(t=>{(!t.preview||rr(t.preview))&&this.addToQueue(t.id)})};onAllFilesRemoved=()=>{this.queue=[]};waitUntilAllProcessed=e=>{e.forEach(n=>{const r=this.uppy.getFile(n);this.uppy.emit("preprocess-progress",r,{mode:"indeterminate",message:this.i18n("generatingThumbnails")})});const t=()=>{e.forEach(n=>{const r=this.uppy.getFile(n);this.uppy.emit("preprocess-complete",r)})};return new Promise(n=>{this.queueProcessing?this.uppy.once("thumbnail:all-generated",()=>{t(),n()}):(t(),n())})};install(){this.uppy.on("file-removed",this.onFileRemoved),this.uppy.on("cancel-all",this.onAllFilesRemoved),this.opts.lazy?(this.uppy.on("thumbnail:request",this.onFileAdded),this.uppy.on("thumbnail:cancel",this.onCancelRequest)):(this.uppy.on("thumbnail:request",this.onFileAdded),this.uppy.on("file-added",this.onFileAdded),this.uppy.on("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.addPreProcessor(this.waitUntilAllProcessed)}uninstall(){this.uppy.off("file-removed",this.onFileRemoved),this.uppy.off("cancel-all",this.onAllFilesRemoved),this.opts.lazy?(this.uppy.off("thumbnail:request",this.onFileAdded),this.uppy.off("thumbnail:cancel",this.onCancelRequest)):(this.uppy.off("thumbnail:request",this.onFileAdded),this.uppy.off("file-added",this.onFileAdded),this.uppy.off("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.removePreProcessor(this.waitUntilAllProcessed)}}function gr(i){if(typeof i=="string"){const e=document.querySelectorAll(i);return e.length===0?null:Array.from(e)}return typeof i=="object"&&Xr(i)?[i]:null}const ze=Array.from;function Du(i){const e=ze(i.files);return Promise.resolve(e)}function Os(i,e,t,{onSuccess:n}){i.readEntries(r=>{const s=[...e,...r];r.length?queueMicrotask(()=>{Os(i,s,t,{onSuccess:n})}):n(s)},r=>{t(r),n(e)})}function As(i,e){return i==null?i:{kind:i.isFile?"file":i.isDirectory?"directory":void 0,name:i.name,getFile(){return new Promise((t,n)=>i.file(t,n))},async*values(){const t=i.createReader();yield*await new Promise(r=>{Os(t,[],e,{onSuccess:s=>r(s.map(o=>As(o,e)))})})},isSameEntry:void 0}}async function*Rs(i,e,t=void 0){const n=()=>`${e}/${i.name}`;if(i.kind==="file"){const r=await i.getFile();r!=null?(r.relativePath=e?n():null,yield r):t!=null&&(yield t)}else if(i.kind==="directory")for await(const r of i.values())yield*Rs(r,e?n():i.name);else t!=null&&(yield t)}async function*Nu(i,e){const t=await Promise.all(Array.from(i.items,async n=>{let r;return r??=As(typeof n.getAsEntry=="function"?n.getAsEntry():n.webkitGetAsEntry(),e),{fileSystemHandle:r,lastResortFile:n.getAsFile()}}));for(const{lastResortFile:n,fileSystemHandle:r}of t)if(r!=null)try{yield*Rs(r,"",n)}catch(s){n!=null?yield n:e(s)}else n!=null&&(yield n)}async function Bu(i,e){const t=e?.logDropError??Function.prototype;try{const n=[];for await(const r of Nu(i,t))n.push(r);return n}catch{return Du(i)}}const Lu="4.4.3",Mu={version:Lu};function $u(){const i=document.body;return!(!("draggable"in i)||!("ondragstart"in i&&"ondrop"in i)||!("FormData"in window)||!("FileReader"in window))}class Is extends ne{fileInput=null;folderInput=null;mobilePhotoFileInput=null;mobileVideoFileInput=null;triggerFileInputClick=()=>{this.fileInput?.click()};triggerFolderInputClick=()=>{this.folderInput?.click()};triggerVideoCameraInputClick=()=>{this.mobileVideoFileInput?.click()};triggerPhotoCameraInputClick=()=>{this.mobilePhotoFileInput?.click()};onFileInputChange=e=>{this.props.handleInputChange(e),e.currentTarget.value=""};renderHiddenInput=(e,t)=>d("input",{className:"uppy-Dashboard-input",hidden:!0,"aria-hidden":"true",tabIndex:-1,webkitdirectory:e,type:"file",name:"files[]",multiple:this.props.maxNumberOfFiles!==1,onChange:this.onFileInputChange,accept:this.props.allowedFileTypes?.join(", "),ref:t});renderHiddenCameraInput=(e,t,n)=>{const s={photo:"image/*",video:"video/*"}[e];return d("input",{className:"uppy-Dashboard-input",hidden:!0,"aria-hidden":"true",tabIndex:-1,type:"file",name:`camera-${e}`,onChange:this.onFileInputChange,capture:t===""?"environment":t,accept:s,ref:n})};renderMyDeviceAcquirer=()=>d("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MyDevice",children:d("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerFileInputClick,children:[d("div",{className:"uppy-DashboardTab-inner",children:d("svg",{className:"uppy-DashboardTab-iconMyDevice","aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:d("path",{d:"M8.45 22.087l-1.305-6.674h17.678l-1.572 6.674H8.45zm4.975-12.412l1.083 1.765a.823.823 0 00.715.386h7.951V13.5H8.587V9.675h4.838zM26.043 13.5h-1.195v-2.598c0-.463-.336-.75-.798-.75h-8.356l-1.082-1.766A.823.823 0 0013.897 8H7.728c-.462 0-.815.256-.815.718V13.5h-.956a.97.97 0 00-.746.37.972.972 0 00-.19.81l1.724 8.565c.095.44.484.755.933.755H24c.44 0 .824-.3.929-.727l2.043-8.568a.972.972 0 00-.176-.825.967.967 0 00-.753-.38z",fill:"currentcolor","fill-rule":"evenodd"})})}),d("div",{className:"uppy-DashboardTab-name",children:this.props.i18n("myDevice")})]})});renderPhotoCamera=()=>d("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MobilePhotoCamera",children:d("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerPhotoCameraInputClick,children:[d("div",{className:"uppy-DashboardTab-inner",children:d("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:d("path",{d:"M23.5 9.5c1.417 0 2.5 1.083 2.5 2.5v9.167c0 1.416-1.083 2.5-2.5 2.5h-15c-1.417 0-2.5-1.084-2.5-2.5V12c0-1.417 1.083-2.5 2.5-2.5h2.917l1.416-2.167C13 7.167 13.25 7 13.5 7h5c.25 0 .5.167.667.333L20.583 9.5H23.5zM16 11.417a4.706 4.706 0 00-4.75 4.75 4.704 4.704 0 004.75 4.75 4.703 4.703 0 004.75-4.75c0-2.663-2.09-4.75-4.75-4.75zm0 7.825c-1.744 0-3.076-1.332-3.076-3.074 0-1.745 1.333-3.077 3.076-3.077 1.744 0 3.074 1.333 3.074 3.076s-1.33 3.075-3.074 3.075z",fill:"#02B383","fill-rule":"nonzero"})})}),d("div",{className:"uppy-DashboardTab-name",children:this.props.i18n("takePictureBtn")})]})});renderVideoCamera=()=>d("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MobileVideoCamera",children:d("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerVideoCameraInputClick,children:[d("div",{className:"uppy-DashboardTab-inner",children:d("svg",{"aria-hidden":"true",width:"32",height:"32",viewBox:"0 0 32 32",children:d("path",{fill:"#FF675E",fillRule:"nonzero",d:"m21.254 14.277 2.941-2.588c.797-.313 1.243.818 1.09 1.554-.01 2.094.02 4.189-.017 6.282-.126.915-1.145 1.08-1.58.34l-2.434-2.142c-.192.287-.504 1.305-.738.468-.104-1.293-.028-2.596-.05-3.894.047-.312.381.823.426 1.069.063-.384.206-.744.362-1.09zm-12.939-3.73c3.858.013 7.717-.025 11.574.02.912.129 1.492 1.237 1.351 2.217-.019 2.412.04 4.83-.03 7.239-.17 1.025-1.166 1.59-2.029 1.429-3.705-.012-7.41.025-11.114-.019-.913-.129-1.492-1.237-1.352-2.217.018-2.404-.036-4.813.029-7.214.136-.82.83-1.473 1.571-1.454z "})})}),d("div",{className:"uppy-DashboardTab-name",children:this.props.i18n("recordVideoBtn")})]})});renderBrowseButton=(e,t)=>{const n=this.props.acquirers.length;return d("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-Dashboard-browse",onClick:t,"data-uppy-super-focusable":n===0,children:e})};renderDropPasteBrowseTagline=e=>{const t=this.renderBrowseButton(this.props.i18n("browseFiles"),this.triggerFileInputClick),n=this.renderBrowseButton(this.props.i18n("browseFolders"),this.triggerFolderInputClick),r=this.props.fileManagerSelectionType,s=r.charAt(0).toUpperCase()+r.slice(1);return d("div",{class:"uppy-Dashboard-AddFiles-title",children:this.props.disableLocalFiles?this.props.i18n("importFiles"):e>0?this.props.i18nArray(`dropPasteImport${s}`,{browseFiles:t,browseFolders:n,browse:t}):this.props.i18nArray(`dropPaste${s}`,{browseFiles:t,browseFolders:n,browse:t})})};[Symbol.for("uppy test: disable unused locale key warning")](){this.props.i18nArray("dropPasteBoth"),this.props.i18nArray("dropPasteFiles"),this.props.i18nArray("dropPasteFolders"),this.props.i18nArray("dropPasteImportBoth"),this.props.i18nArray("dropPasteImportFiles"),this.props.i18nArray("dropPasteImportFolders")}renderAcquirer=e=>d("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":e.id,children:d("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-cy":e.id,"aria-controls":`uppy-DashboardContent-panel--${e.id}`,"aria-selected":this.props.activePickerPanel?.id===e.id,"data-uppy-super-focusable":!0,onClick:()=>this.props.showPanel(e.id),children:[d("div",{className:"uppy-DashboardTab-inner",children:e.icon()}),d("div",{className:"uppy-DashboardTab-name",children:e.name})]})});renderAcquirers=e=>{const t=[...e],n=t.splice(e.length-2,e.length);return d(le,{children:[t.map(r=>this.renderAcquirer(r)),d("span",{role:"presentation",style:{"white-space":"nowrap"},children:n.map(r=>this.renderAcquirer(r))})]})};renderSourcesList=(e,t)=>{const{showNativePhotoCameraButton:n,showNativeVideoCameraButton:r}=this.props;let s=[];const o="myDevice";t||s.push({key:o,elements:this.renderMyDeviceAcquirer()}),n&&s.push({key:"nativePhotoCameraButton",elements:this.renderPhotoCamera()}),r&&s.push({key:"nativePhotoCameraButton",elements:this.renderVideoCamera()}),s.push(...e.map(c=>({key:c.id,elements:this.renderAcquirer(c)}))),s.length===1&&s[0].key===o&&(s=[]);const l=[...s],u=l.splice(s.length-2,s.length);return d(le,{children:[this.renderDropPasteBrowseTagline(s.length),d("div",{className:"uppy-Dashboard-AddFiles-list",role:"tablist",children:[l.map(({key:c,elements:h})=>d(le,{children:h},c)),d("span",{role:"presentation",style:{"white-space":"nowrap"},children:u.map(({key:c,elements:h})=>d(le,{children:h},c))})]})]})};renderPoweredByUppy(){const{i18nArray:e}=this.props,t=d("span",{children:[d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-Dashboard-poweredByIcon",width:"11",height:"11",viewBox:"0 0 11 11",children:d("path",{d:"M7.365 10.5l-.01-4.045h2.612L5.5.806l-4.467 5.65h2.604l.01 4.044h3.718z",fillRule:"evenodd"})}),d("span",{className:"uppy-Dashboard-poweredByUppy",children:"Uppy"})]}),n=e("poweredBy",{uppy:t});return d("a",{tabIndex:-1,href:"https://uppy.io",rel:"noreferrer noopener",target:"_blank",className:"uppy-Dashboard-poweredBy",children:n})}render(){const{showNativePhotoCameraButton:e,showNativeVideoCameraButton:t,nativeCameraFacingMode:n}=this.props;return d("div",{className:"uppy-Dashboard-AddFiles",children:[this.renderHiddenInput(!1,r=>{this.fileInput=r}),this.renderHiddenInput(!0,r=>{this.folderInput=r}),e&&this.renderHiddenCameraInput("photo",n,r=>{this.mobilePhotoFileInput=r}),t&&this.renderHiddenCameraInput("video",n,r=>{this.mobileVideoFileInput=r}),this.renderSourcesList(this.props.acquirers,this.props.disableLocalFiles),d("div",{className:"uppy-Dashboard-AddFiles-info",children:[this.props.note&&d("div",{className:"uppy-Dashboard-note",children:this.props.note}),this.props.proudlyDisplayPoweredByUppy&&this.renderPoweredByUppy()]})]})}}const zu=i=>d("div",{className:ue("uppy-Dashboard-AddFilesPanel",i.className),"data-uppy-panelType":"AddFiles","aria-hidden":!i.showAddFilesPanel,children:[d("div",{className:"uppy-DashboardContent-bar",children:[d("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:i.i18n("addingMoreFiles")}),d("button",{className:"uppy-DashboardContent-back",type:"button",onClick:()=>i.toggleAddFilesPanel(!1),children:i.i18n("back")})]}),d(Is,{...i})]});function ju(i){const e=i.files[i.fileCardFor],t=()=>{i.uppy.emit("file-editor:cancel",e),i.closeFileEditor()};return d("div",{className:ue("uppy-DashboardContent-panel",i.className),role:"tabpanel","data-uppy-panelType":"FileEditor",id:"uppy-DashboardContent-panel--editor",children:[d("div",{className:"uppy-DashboardContent-bar",children:[d("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:i.i18nArray("editing",{file:d("span",{className:"uppy-DashboardContent-titleFile",children:e.meta?e.meta.name:e.name})})}),d("button",{className:"uppy-DashboardContent-back",type:"button",onClick:t,children:i.i18n("cancel")}),d("button",{className:"uppy-DashboardContent-save",type:"button",onClick:i.saveFileEditor,children:i.i18n("save")})]}),d("div",{className:"uppy-DashboardContent-panelBody",children:i.editors.map(n=>i.uppy.getPlugin(n.id).render(i.state))})]})}function qu(){return d("svg",{"aria-hidden":"true",focusable:"false",width:"25",height:"25",viewBox:"0 0 25 25",children:d("g",{fill:"#686DE0",fillRule:"evenodd",children:[d("path",{d:"M5 7v10h15V7H5zm0-1h15a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1z",fillRule:"nonzero"}),d("path",{d:"M6.35 17.172l4.994-5.026a.5.5 0 0 1 .707 0l2.16 2.16 3.505-3.505a.5.5 0 0 1 .707 0l2.336 2.31-.707.72-1.983-1.97-3.505 3.505a.5.5 0 0 1-.707 0l-2.16-2.159-3.938 3.939-1.409.026z",fillRule:"nonzero"}),d("circle",{cx:"7.5",cy:"9.5",r:"1.5"})]})})}function Hu(){return d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:d("path",{d:"M9.5 18.64c0 1.14-1.145 2-2.5 2s-2.5-.86-2.5-2c0-1.14 1.145-2 2.5-2 .557 0 1.079.145 1.5.396V7.25a.5.5 0 0 1 .379-.485l9-2.25A.5.5 0 0 1 18.5 5v11.64c0 1.14-1.145 2-2.5 2s-2.5-.86-2.5-2c0-1.14 1.145-2 2.5-2 .557 0 1.079.145 1.5.396V8.67l-8 2v7.97zm8-11v-2l-8 2v2l8-2zM7 19.64c.855 0 1.5-.484 1.5-1s-.645-1-1.5-1-1.5.484-1.5 1 .645 1 1.5 1zm9-2c.855 0 1.5-.484 1.5-1s-.645-1-1.5-1-1.5.484-1.5 1 .645 1 1.5 1z",fill:"#049BCF",fillRule:"nonzero"})})}function Vu(){return d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:d("path",{d:"M16 11.834l4.486-2.691A1 1 0 0 1 22 10v6a1 1 0 0 1-1.514.857L16 14.167V17a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V9a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v2.834zM15 9H5v8h10V9zm1 4l5 3v-6l-5 3z",fill:"#19AF67",fillRule:"nonzero"})})}function Wu(){return d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:d("path",{d:"M9.766 8.295c-.691-1.843-.539-3.401.747-3.726 1.643-.414 2.505.938 2.39 3.299-.039.79-.194 1.662-.537 3.148.324.49.66.967 1.055 1.51.17.231.382.488.629.757 1.866-.128 3.653.114 4.918.655 1.487.635 2.192 1.685 1.614 2.84-.566 1.133-1.839 1.084-3.416.249-1.141-.604-2.457-1.634-3.51-2.707a13.467 13.467 0 0 0-2.238.426c-1.392 4.051-4.534 6.453-5.707 4.572-.986-1.58 1.38-4.206 4.914-5.375.097-.322.185-.656.264-1.001.08-.353.306-1.31.407-1.737-.678-1.059-1.2-2.031-1.53-2.91zm2.098 4.87c-.033.144-.068.287-.104.427l.033-.01-.012.038a14.065 14.065 0 0 1 1.02-.197l-.032-.033.052-.004a7.902 7.902 0 0 1-.208-.271c-.197-.27-.38-.526-.555-.775l-.006.028-.002-.003c-.076.323-.148.632-.186.8zm5.77 2.978c1.143.605 1.832.632 2.054.187.26-.519-.087-1.034-1.113-1.473-.911-.39-2.175-.608-3.55-.608.845.766 1.787 1.459 2.609 1.894zM6.559 18.789c.14.223.693.16 1.425-.413.827-.648 1.61-1.747 2.208-3.206-2.563 1.064-4.102 2.867-3.633 3.62zm5.345-10.97c.088-1.793-.351-2.48-1.146-2.28-.473.119-.564 1.05-.056 2.405.213.566.52 1.188.908 1.859.18-.858.268-1.453.294-1.984z",fill:"#E2514A",fillRule:"nonzero"})})}function Gu(){return d("svg",{"aria-hidden":"true",focusable:"false",width:"25",height:"25",viewBox:"0 0 25 25",children:d("path",{d:"M10.45 2.05h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5V2.55a.5.5 0 0 1 .5-.5zm2.05 1.024h1.05a.5.5 0 0 1 .5.5V3.6a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5v-.001zM10.45 0h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5V.5a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-2.05 3.074h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-2.05 1.024h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm-2.05 1.025h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-1.656 3.074l-.82 5.946c.52.302 1.174.458 1.976.458.803 0 1.455-.156 1.975-.458l-.82-5.946h-2.311zm0-1.025h2.312c.512 0 .946.378 1.015.885l.82 5.946c.056.412-.142.817-.501 1.026-.686.398-1.515.597-2.49.597-.974 0-1.804-.199-2.49-.597a1.025 1.025 0 0 1-.5-1.026l.819-5.946c.07-.507.503-.885 1.015-.885zm.545 6.6a.5.5 0 0 1-.397-.561l.143-.999a.5.5 0 0 1 .495-.429h.74a.5.5 0 0 1 .495.43l.143.998a.5.5 0 0 1-.397.561c-.404.08-.819.08-1.222 0z",fill:"#00C469",fillRule:"nonzero"})})}function Ku(){return d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:d("g",{fill:"#A7AFB7",fillRule:"nonzero",children:[d("path",{d:"M5.5 22a.5.5 0 0 1-.5-.5v-18a.5.5 0 0 1 .5-.5h10.719a.5.5 0 0 1 .367.16l3.281 3.556a.5.5 0 0 1 .133.339V21.5a.5.5 0 0 1-.5.5h-14zm.5-1h13V7.25L16 4H6v17z"}),d("path",{d:"M15 4v3a1 1 0 0 0 1 1h3V7h-3V4h-1z"})]})})}function Xu(){return d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:d("path",{d:"M4.5 7h13a.5.5 0 1 1 0 1h-13a.5.5 0 0 1 0-1zm0 3h15a.5.5 0 1 1 0 1h-15a.5.5 0 1 1 0-1zm0 3h15a.5.5 0 1 1 0 1h-15a.5.5 0 1 1 0-1zm0 3h10a.5.5 0 1 1 0 1h-10a.5.5 0 1 1 0-1z",fill:"#5A5E69",fillRule:"nonzero"})})}function tn(i){const e={color:"#838999",icon:Ku()};if(!i)return e;const t=i.split("/")[0],n=i.split("/")[1];return t==="text"?{color:"#5a5e69",icon:Xu()}:t==="image"?{color:"#686de0",icon:qu()}:t==="audio"?{color:"#068dbb",icon:Hu()}:t==="video"?{color:"#19af67",icon:Vu()}:t==="application"&&n==="pdf"?{color:"#e25149",icon:Wu()}:t==="application"&&["zip","x-7z-compressed","x-zip-compressed","x-rar-compressed","x-tar","x-gzip","x-apple-diskimage"].indexOf(n)!==-1?{color:"#00C469",icon:Gu()}:e}function fe(i){const{tagName:e}=i.target;if(e==="INPUT"||e==="TEXTAREA"){i.stopPropagation();return}i.preventDefault(),i.stopPropagation()}function Ds(i){const{file:e}=i;if(e.preview)return d("img",{draggable:!1,className:"uppy-Dashboard-Item-previewImg",alt:e.name,src:e.preview});const{color:t,icon:n}=tn(e.type);return d("div",{className:"uppy-Dashboard-Item-previewIconWrap",children:[d("span",{className:"uppy-Dashboard-Item-previewIcon",style:{color:t},children:n}),d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-Dashboard-Item-previewIconBg",width:"58",height:"76",viewBox:"0 0 58 76",children:d("rect",{fill:"#FFF",width:"58",height:"76",rx:"3",fillRule:"evenodd"})})]})}function Yu(i){const{computedMetaFields:e,requiredMetaFields:t,updateMeta:n,form:r,formState:s}=i,o={text:"uppy-u-reset uppy-c-textInput uppy-Dashboard-FileCard-input"};return e.map(a=>{const l=`uppy-Dashboard-FileCard-input-${a.id}`,u=t.includes(a.id);return d("fieldset",{className:"uppy-Dashboard-FileCard-fieldset",children:[d("label",{className:"uppy-Dashboard-FileCard-label",htmlFor:l,children:a.name}),a.render!==void 0?a.render({value:s[a.id],onChange:c=>n(c,a.id),fieldCSSClasses:o,required:u,form:r.id},qe):d("input",{className:o.text,id:l,form:r.id,type:a.type||"text",required:u,value:s[a.id],placeholder:a.placeholder,onInput:c=>n(c.target.value,a.id),"data-uppy-super-focusable":!0})]},a.id)})}function Qu(i){const{files:e,fileCardFor:t,toggleFileCard:n,saveFileCard:r,metaFields:s,requiredMetaFields:o,openFileEditor:a,i18n:l,i18nArray:u,className:c,canEditFile:h}=i,b=()=>typeof s=="function"?s(e[t]):s,v=e[t],E=b()??[],T=h(v),U={};E.forEach(O=>{U[O.id]=v.meta[O.id]??""});const[S,m]=Ut(U),y=Sa(O=>{O.preventDefault(),r(S,t)},[r,S,t]),_=(O,R)=>{m({...S,[R]:O})},w=()=>{n(!1)},[x]=Ut(()=>{const O=document.createElement("form");return O.setAttribute("tabindex","-1"),O.id=Ki(),O});return Si(()=>(document.body.appendChild(x),x.addEventListener("submit",y),()=>{x.removeEventListener("submit",y),document.body.removeChild(x)}),[x,y]),d("div",{className:ue("uppy-Dashboard-FileCard",c),"data-uppy-panelType":"FileCard",onDragOver:fe,onDragLeave:fe,onDrop:fe,onPaste:fe,children:[d("div",{className:"uppy-DashboardContent-bar",children:[d("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:u("editing",{file:d("span",{className:"uppy-DashboardContent-titleFile",children:v.meta?v.meta.name:v.name})})}),d("button",{className:"uppy-DashboardContent-back",type:"button",form:x.id,title:l("finishEditingFile"),onClick:w,children:l("cancel")})]}),d("div",{className:"uppy-Dashboard-FileCard-inner",children:[d("div",{className:"uppy-Dashboard-FileCard-preview",style:{backgroundColor:tn(v.type).color},children:[d(Ds,{file:v}),T&&d("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-Dashboard-FileCard-edit",onClick:O=>{y(O),a(v)},children:l("editImage")})]}),d("div",{className:"uppy-Dashboard-FileCard-info",children:d(Yu,{computedMetaFields:E,requiredMetaFields:o,updateMeta:_,form:x,formState:S})}),d("div",{className:"uppy-Dashboard-FileCard-actions",children:[d("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Dashboard-FileCard-actionsBtn",type:"submit",form:x.id,children:l("saveChanges")}),d("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-link uppy-Dashboard-FileCard-actionsBtn",type:"button",onClick:w,form:x.id,children:l("cancel")})]})]})]})}function Zu(i,e){if(i===e)return!0;if(!i||!e)return!1;const t=Object.keys(i),n=Object.keys(e),r=t.length;if(n.length!==r)return!1;for(let s=0;s<r;s++){const o=t[s];if(i[o]!==e[o]||!Object.prototype.hasOwnProperty.call(e,o))return!1}return!0}function Ju(i,e="Copy the URL below"){return new Promise(t=>{const n=document.createElement("textarea");n.setAttribute("style",{position:"fixed",top:0,left:0,width:"2em",height:"2em",padding:0,border:"none",outline:"none",boxShadow:"none",background:"transparent"}),n.value=i,document.body.appendChild(n),n.select();const r=()=>{document.body.removeChild(n),window.prompt(e,i),t()};try{return document.execCommand("copy")?(document.body.removeChild(n),t()):r()}catch{return document.body.removeChild(n),r()}})}function ed({file:i,uploadInProgressOrComplete:e,metaFields:t,canEditFile:n,i18n:r,onClick:s}){return!e&&t&&t.length>0||!e&&n(i)?d("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-action uppy-Dashboard-Item-action--edit",type:"button","aria-label":r("editFileWithFilename",{file:i.meta.name}),title:r("editFileWithFilename",{file:i.meta.name}),onClick:()=>s(),children:d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"14",height:"14",viewBox:"0 0 14 14",children:d("g",{fillRule:"evenodd",children:[d("path",{d:"M1.5 10.793h2.793A1 1 0 0 0 5 10.5L11.5 4a1 1 0 0 0 0-1.414L9.707.793a1 1 0 0 0-1.414 0l-6.5 6.5A1 1 0 0 0 1.5 8v2.793zm1-1V8L9 1.5l1.793 1.793-6.5 6.5H2.5z",fillRule:"nonzero"}),d("rect",{x:"1",y:"12.293",width:"11",height:"1",rx:".5"}),d("path",{fillRule:"nonzero",d:"M6.793 2.5L9.5 5.207l.707-.707L7.5 1.793z"})]})})}):null}function td({i18n:i,onClick:e,file:t}){return d("button",{className:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--remove",type:"button","aria-label":i("removeFile",{file:t.meta.name}),title:i("removeFile",{file:t.meta.name}),onClick:()=>e(),children:d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"18",height:"18",viewBox:"0 0 18 18",children:[d("path",{d:"M9 0C4.034 0 0 4.034 0 9s4.034 9 9 9 9-4.034 9-9-4.034-9-9-9z"}),d("path",{fill:"#FFF",d:"M13 12.222l-.778.778L9 9.778 5.778 13 5 12.222 8.222 9 5 5.778 5.778 5 9 8.222 12.222 5l.778.778L9.778 9z"})]})})}function id({file:i,uppy:e,i18n:t}){const n=r=>{Ju(i.uploadURL,t("copyLinkToClipboardFallback")).then(()=>{e.log("Link copied to clipboard."),e.info(t("copyLinkToClipboardSuccess"),"info",3e3)}).catch(e.log).then(()=>r.target.focus({preventScroll:!0}))};return d("button",{className:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--copyLink",type:"button","aria-label":t("copyLink"),title:t("copyLink"),onClick:r=>n(r),children:d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"14",height:"14",viewBox:"0 0 14 12",children:d("path",{d:"M7.94 7.703a2.613 2.613 0 0 1-.626 2.681l-.852.851a2.597 2.597 0 0 1-1.849.766A2.616 2.616 0 0 1 2.764 7.54l.852-.852a2.596 2.596 0 0 1 2.69-.625L5.267 7.099a1.44 1.44 0 0 0-.833.407l-.852.851a1.458 1.458 0 0 0 1.03 2.486c.39 0 .755-.152 1.03-.426l.852-.852c.231-.231.363-.522.406-.824l1.04-1.038zm4.295-5.937A2.596 2.596 0 0 0 10.387 1c-.698 0-1.355.272-1.849.766l-.852.851a2.614 2.614 0 0 0-.624 2.688l1.036-1.036c.041-.304.173-.6.407-.833l.852-.852c.275-.275.64-.426 1.03-.426a1.458 1.458 0 0 1 1.03 2.486l-.852.851a1.442 1.442 0 0 1-.824.406l-1.04 1.04a2.596 2.596 0 0 0 2.683-.628l.851-.85a2.616 2.616 0 0 0 0-3.697zm-6.88 6.883a.577.577 0 0 0 .82 0l3.474-3.474a.579.579 0 1 0-.819-.82L5.355 7.83a.579.579 0 0 0 0 .819z"})})})}function nd(i){const{uppy:e,file:t,uploadInProgressOrComplete:n,canEditFile:r,metaFields:s,showLinkToFileUploadResult:o,showRemoveButton:a,i18n:l,toggleFileCard:u,openFileEditor:c}=i;return d("div",{className:"uppy-Dashboard-Item-actionWrapper",children:[d(ed,{i18n:l,file:t,uploadInProgressOrComplete:n,canEditFile:r,metaFields:s,onClick:()=>{s&&s.length>0?u(!0,t.id):c(t)}}),o&&t.uploadURL?d(id,{file:t,uppy:e,i18n:l}):null,a?d(td,{i18n:l,file:t,onClick:()=>e.removeFile(t.id)}):null]})}const di="...";function Ns(i,e){if(e===0)return"";if(i.length<=e)return i;if(e<=di.length+1)return`${i.slice(0,e-1)}…`;const t=e-di.length,n=Math.ceil(t/2),r=Math.floor(t/2);return i.slice(0,n)+di+i.slice(-r)}const rd=(i,e)=>(typeof e=="function"?e():e).filter(r=>r.id===i)[0].name;function Bs(i){const{file:e,toggleFileCard:t,i18n:n,metaFields:r}=i,{missingRequiredMetaFields:s}=e;if(!s?.length)return null;const o=s.map(a=>rd(a,r)).join(", ");return d("div",{className:"uppy-Dashboard-Item-errorMessage",children:[n("missingRequiredMetaFields",{smart_count:s.length,fields:o})," ",d("button",{type:"button",class:"uppy-u-reset uppy-Dashboard-Item-errorMessageBtn",onClick:()=>t(!0,e.id),children:n("editFile")})]})}const sd=i=>{const{author:e,name:t}=i.file.meta;function n(){return i.isSingleFile&&i.containerHeight>=350?90:i.containerWidth<=352?35:i.containerWidth<=576?60:e?20:30}return d("div",{className:"uppy-Dashboard-Item-name",title:t,children:Ns(t,n())})},od=i=>{const{author:e}=i.file.meta,t=i.file.remote?.providerName,n="·";return e?d("div",{className:"uppy-Dashboard-Item-author",children:[d("a",{href:`${e.url}?utm_source=Companion&utm_medium=referral`,target:"_blank",rel:"noopener noreferrer",children:Ns(e.name,13)}),t?d(le,{children:[` ${n} `,t,` ${n} `]}):null]}):null},ad=i=>i.file.size&&d("div",{className:"uppy-Dashboard-Item-statusSize",children:ye(i.file.size)}),ld=i=>i.file.isGhost&&d("span",{children:[" • ",d("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-reSelect",type:"button",onClick:()=>i.toggleAddFilesPanel(!0),children:i.i18n("reSelect")})]}),ud=({file:i,onClick:e})=>i.error?d("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-errorDetails","aria-label":i.error,"data-microtip-position":"bottom","data-microtip-size":"medium",onClick:e,type:"button",children:"?"}):null;function dd(i){const{file:e,i18n:t,toggleFileCard:n,metaFields:r,toggleAddFilesPanel:s,isSingleFile:o,containerHeight:a,containerWidth:l}=i;return d("div",{className:"uppy-Dashboard-Item-fileInfo","data-uppy-file-source":e.source,children:[d("div",{className:"uppy-Dashboard-Item-fileName",children:[sd({file:e,isSingleFile:o,containerHeight:a,containerWidth:l}),d(ud,{file:e,onClick:()=>alert(e.error)})]}),d("div",{className:"uppy-Dashboard-Item-status",children:[od({file:e}),ad({file:e}),ld({file:e,toggleAddFilesPanel:s,i18n:t})]}),d(Bs,{file:e,i18n:t,toggleFileCard:n,metaFields:r})]})}function cd(i){const{file:e,i18n:t,toggleFileCard:n,metaFields:r,showLinkToFileUploadResult:s}=i,a=e.preview?"rgba(255, 255, 255, 0.5)":tn(e.type).color;return d("div",{className:"uppy-Dashboard-Item-previewInnerWrap",style:{backgroundColor:a},children:[s&&e.uploadURL&&d("a",{className:"uppy-Dashboard-Item-previewLink",href:e.uploadURL,rel:"noreferrer noopener",target:"_blank","aria-label":e.meta.name,children:d("span",{hidden:!0,children:e.meta.name})}),d(Ds,{file:e}),d(Bs,{file:e,i18n:t,toggleFileCard:n,metaFields:r})]})}function hd(i){if(!i.isUploaded){if(i.error&&!i.hideRetryButton){i.uppy.retryUpload(i.file.id);return}i.resumableUploads&&!i.hidePauseResumeButton?i.uppy.pauseResume(i.file.id):i.individualCancellation&&!i.hideCancelButton&&i.uppy.removeFile(i.file.id)}}function yr(i){return i.isUploaded?i.i18n("uploadComplete"):i.error?i.i18n("retryUpload"):i.resumableUploads?i.file.isPaused?i.i18n("resumeUpload"):i.i18n("pauseUpload"):i.individualCancellation?i.i18n("cancelUpload"):""}function ci(i){return d("div",{className:"uppy-Dashboard-Item-progress",children:d("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-progressIndicator",type:"button","aria-label":yr(i),title:yr(i),onClick:()=>hd(i),children:i.children})})}function ft({children:i}){return d("svg",{"aria-hidden":"true",focusable:"false",width:"70",height:"70",viewBox:"0 0 36 36",className:"uppy-c-icon uppy-Dashboard-Item-progressIcon--circle",children:i})}function hi({progress:i}){const e=2*Math.PI*15;return d("g",{children:[d("circle",{className:"uppy-Dashboard-Item-progressIcon--bg",r:"15",cx:"18",cy:"18","stroke-width":"2",fill:"none"}),d("circle",{className:"uppy-Dashboard-Item-progressIcon--progress",r:"15",cx:"18",cy:"18",transform:"rotate(-90, 18, 18)",fill:"none","stroke-width":"2","stroke-dasharray":e,"stroke-dashoffset":e-e/100*i})]})}function pd(i){return!i.file.progress.uploadStarted||i.file.progress.percentage===void 0?null:i.isUploaded?d("div",{className:"uppy-Dashboard-Item-progress",children:d("div",{className:"uppy-Dashboard-Item-progressIndicator",children:d(ft,{children:[d("circle",{r:"15",cx:"18",cy:"18",fill:"#1bb240"}),d("polygon",{className:"uppy-Dashboard-Item-progressIcon--check",transform:"translate(2, 3)",points:"14 22.5 7 15.2457065 8.99985857 13.1732815 14 18.3547104 22.9729883 9 25 11.1005634"})]})})}):i.recoveredState?null:i.error&&!i.hideRetryButton?d(ci,{...i,children:d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-Dashboard-Item-progressIcon--retry",width:"28",height:"31",viewBox:"0 0 16 19",children:[d("path",{d:"M16 11a8 8 0 1 1-8-8v2a6 6 0 1 0 6 6h2z"}),d("path",{d:"M7.9 3H10v2H7.9z"}),d("path",{d:"M8.536.5l3.535 3.536-1.414 1.414L7.12 1.914z"}),d("path",{d:"M10.657 2.621l1.414 1.415L8.536 7.57 7.12 6.157z"})]})}):i.resumableUploads&&!i.hidePauseResumeButton?d(ci,{...i,children:d(ft,{children:[d(hi,{progress:i.file.progress.percentage}),i.file.isPaused?d("polygon",{className:"uppy-Dashboard-Item-progressIcon--play",transform:"translate(3, 3)",points:"12 20 12 10 20 15"}):d("g",{className:"uppy-Dashboard-Item-progressIcon--pause",transform:"translate(14.5, 13)",children:[d("rect",{x:"0",y:"0",width:"2",height:"10",rx:"0"}),d("rect",{x:"5",y:"0",width:"2",height:"10",rx:"0"})]})]})}):!i.resumableUploads&&i.individualCancellation&&!i.hideCancelButton?d(ci,{...i,children:d(ft,{children:[d(hi,{progress:i.file.progress.percentage}),d("polygon",{className:"cancel",transform:"translate(2, 2)",points:"19.8856516 11.0625 16 14.9481516 12.1019737 11.0625 11.0625 12.1143484 14.9481516 16 11.0625 19.8980263 12.1019737 20.9375 16 17.0518484 19.8856516 20.9375 20.9375 19.8980263 17.0518484 16 20.9375 12"})]})}):d("div",{className:"uppy-Dashboard-Item-progress",children:d("div",{className:"uppy-Dashboard-Item-progressIndicator",children:d(ft,{children:d(hi,{progress:i.file.progress.percentage})})})})}class fd extends ne{componentDidMount(){const{file:e}=this.props;e.preview||this.props.handleRequestThumbnail(e)}shouldComponentUpdate(e){return!Zu(this.props,e)}componentDidUpdate(){const{file:e}=this.props;e.preview||this.props.handleRequestThumbnail(e)}componentWillUnmount(){const{file:e}=this.props;e.preview||this.props.handleCancelThumbnail(e)}render(){const{file:e}=this.props,t=e.progress.preprocess||e.progress.postprocess,n=!!e.progress.uploadComplete&&!t&&!e.error,r=!!e.progress.uploadStarted||!!t,s=e.progress.uploadStarted&&!e.progress.uploadComplete||t,o=e.error||!1,{isGhost:a}=e;let l=(this.props.individualCancellation||!s)&&!n;n&&this.props.showRemoveButtonAfterComplete&&(l=!0);const u=ue({"uppy-Dashboard-Item":!0,"is-inprogress":s&&!this.props.recoveredState,"is-processing":t,"is-complete":n,"is-error":!!o,"is-resumable":this.props.resumableUploads,"is-noIndividualCancellation":!this.props.individualCancellation,"is-ghost":a});return d("div",{className:u,id:`uppy_${e.id}`,role:this.props.role,children:[d("div",{className:"uppy-Dashboard-Item-preview",children:[d(cd,{file:e,showLinkToFileUploadResult:this.props.showLinkToFileUploadResult,i18n:this.props.i18n,toggleFileCard:this.props.toggleFileCard,metaFields:this.props.metaFields}),d(pd,{uppy:this.props.uppy,file:e,error:o,isUploaded:n,hideRetryButton:this.props.hideRetryButton,hideCancelButton:this.props.hideCancelButton,hidePauseResumeButton:this.props.hidePauseResumeButton,recoveredState:this.props.recoveredState,resumableUploads:this.props.resumableUploads,individualCancellation:this.props.individualCancellation,i18n:this.props.i18n})]}),d("div",{className:"uppy-Dashboard-Item-fileInfoAndButtons",children:[d(dd,{file:e,containerWidth:this.props.containerWidth,containerHeight:this.props.containerHeight,i18n:this.props.i18n,toggleAddFilesPanel:this.props.toggleAddFilesPanel,toggleFileCard:this.props.toggleFileCard,metaFields:this.props.metaFields,isSingleFile:this.props.isSingleFile}),d(nd,{file:e,metaFields:this.props.metaFields,showLinkToFileUploadResult:this.props.showLinkToFileUploadResult,showRemoveButton:l,canEditFile:this.props.canEditFile,uploadInProgressOrComplete:r,toggleFileCard:this.props.toggleFileCard,openFileEditor:this.props.openFileEditor,uppy:this.props.uppy,i18n:this.props.i18n})]})]})}}function md(i,e){const t=[];let n=[];return i.forEach(r=>{n.length<e?n.push(r):(t.push(n),n=[r])}),n.length&&t.push(n),t}function gd({id:i,i18n:e,uppy:t,files:n,resumableUploads:r,hideRetryButton:s,hidePauseResumeButton:o,hideCancelButton:a,showLinkToFileUploadResult:l,showRemoveButtonAfterComplete:u,metaFields:c,isSingleFile:h,toggleFileCard:b,handleRequestThumbnail:v,handleCancelThumbnail:E,recoveredState:T,individualCancellation:U,itemsPerRow:S,openFileEditor:m,canEditFile:y,toggleAddFilesPanel:_,containerWidth:w,containerHeight:x}){const O=S===1?71:200,R=Wi(()=>{const z=(V,k)=>Number(n[k].isGhost)-Number(n[V].isGhost),M=Object.keys(n);return T&&M.sort(z),md(M,S)},[n,S,T]),A=z=>d("div",{class:"uppy-Dashboard-filesInner",role:"presentation",children:z.map(M=>d(fd,{uppy:t,id:i,i18n:e,resumableUploads:r,individualCancellation:U,hideRetryButton:s,hidePauseResumeButton:o,hideCancelButton:a,showLinkToFileUploadResult:l,showRemoveButtonAfterComplete:u,metaFields:c,recoveredState:T,isSingleFile:h,containerWidth:w,containerHeight:x,toggleFileCard:b,handleRequestThumbnail:v,handleCancelThumbnail:E,role:"listitem",openFileEditor:m,canEditFile:y,toggleAddFilesPanel:_,file:n[M]},M))},z[0]);return h?d("div",{class:"uppy-Dashboard-files",children:A(R[0])}):d(Dl,{class:"uppy-Dashboard-files",role:"list",data:R,renderRow:A,rowHeight:O})}function yd({activePickerPanel:i,className:e,hideAllPanels:t,i18n:n,state:r,uppy:s}){const o=St(null);return d("div",{className:ue("uppy-DashboardContent-panel",e),role:"tabpanel","data-uppy-panelType":"PickerPanel",id:`uppy-DashboardContent-panel--${i.id}`,onDragOver:fe,onDragLeave:fe,onDrop:fe,onPaste:fe,children:[d("div",{className:"uppy-DashboardContent-bar",children:[d("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:n("importFrom",{name:i.name})}),d("button",{className:"uppy-DashboardContent-back",type:"button",onClick:t,children:n("cancel")})]}),d("div",{ref:o,className:"uppy-DashboardContent-panelBody",children:s.getPlugin(i.id).render(r,o.current)})]})}const de={STATE_ERROR:"error",STATE_WAITING:"waiting",STATE_PREPROCESSING:"preprocessing",STATE_UPLOADING:"uploading",STATE_POSTPROCESSING:"postprocessing",STATE_COMPLETE:"complete",STATE_PAUSED:"paused"};function bd(i,e,t,n={}){if(i)return de.STATE_ERROR;if(e)return de.STATE_COMPLETE;if(t)return de.STATE_PAUSED;let r=de.STATE_WAITING;const s=Object.keys(n);for(let o=0;o<s.length;o++){const{progress:a}=n[s[o]];if(a.uploadStarted&&!a.uploadComplete)return de.STATE_UPLOADING;a.preprocess&&r!==de.STATE_UPLOADING&&(r=de.STATE_PREPROCESSING),a.postprocess&&r!==de.STATE_UPLOADING&&r!==de.STATE_PREPROCESSING&&(r=de.STATE_POSTPROCESSING)}return r}function vd({files:i,i18n:e,isAllComplete:t,isAllErrored:n,isAllPaused:r,inProgressNotPausedFiles:s,newFiles:o,processingFiles:a}){switch(bd(n,t,r,i)){case"uploading":return e("uploadingXFiles",{smart_count:s.length});case"preprocessing":case"postprocessing":return e("processingXFiles",{smart_count:a.length});case"paused":return e("uploadPaused");case"waiting":return e("xFilesSelected",{smart_count:o.length});case"complete":return e("uploadComplete");case"error":return e("error")}}function _d(i){const{i18n:e,isAllComplete:t,hideCancelButton:n,maxNumberOfFiles:r,toggleAddFilesPanel:s,uppy:o}=i;let{allowNewUpload:a}=i;return a&&r&&(a=i.totalFileCount<i.maxNumberOfFiles),d("div",{className:"uppy-DashboardContent-bar",children:[!t&&!n?d("button",{className:"uppy-DashboardContent-back",type:"button",onClick:()=>o.cancelAll(),children:e("cancel")}):d("div",{}),d("div",{className:"uppy-DashboardContent-title",children:d(vd,{...i})}),a?d("button",{className:"uppy-DashboardContent-addMore",type:"button","aria-label":e("addMoreFiles"),title:e("addMoreFiles"),onClick:()=>s(!0),children:[d("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"15",height:"15",viewBox:"0 0 15 15",children:d("path",{d:"M8 6.5h6a.5.5 0 0 1 .5.5v.5a.5.5 0 0 1-.5.5H8v6a.5.5 0 0 1-.5.5H7a.5.5 0 0 1-.5-.5V8h-6a.5.5 0 0 1-.5-.5V7a.5.5 0 0 1 .5-.5h6v-6A.5.5 0 0 1 7 0h.5a.5.5 0 0 1 .5.5v6z"})}),d("span",{className:"uppy-DashboardContent-addMoreCaption",children:e("addMore")})]}):d("div",{})]})}const Se="uppy-transition-slideDownUp",br=250;function mt({children:i}){const[e,t]=Ut(null),[n,r]=Ut(""),s=St(),o=St(),a=St(),l=()=>{r(`${Se}-enter`),cancelAnimationFrame(a.current),clearTimeout(o.current),o.current=void 0,a.current=requestAnimationFrame(()=>{r(`${Se}-enter ${Se}-enter-active`),s.current=setTimeout(()=>{r("")},br)})},u=()=>{r(`${Se}-leave`),cancelAnimationFrame(a.current),clearTimeout(s.current),s.current=void 0,a.current=requestAnimationFrame(()=>{r(`${Se}-leave ${Se}-leave-active`),o.current=setTimeout(()=>{t(null),r("")},br)})};return Si(()=>{const c=oe(i)[0];e!==c&&(c&&!e?l():e&&!c&&!o.current&&u(),t(c))},[i,e]),Si(()=>()=>{clearTimeout(s.current),clearTimeout(o.current),cancelAnimationFrame(a.current)},[]),e?ls(e,{className:ue(n,e.props.className)}):null}const vr=900,_r=700,pi=576,wr=330;function wd(i){const e=i.totalFileCount===0,t=i.totalFileCount===1,n=i.containerWidth>pi,r=i.containerHeight>wr,s=ue({"uppy-Dashboard":!0,"uppy-Dashboard--isDisabled":i.disabled,"uppy-Dashboard--animateOpenClose":i.animateOpenClose,"uppy-Dashboard--isClosing":i.isClosing,"uppy-Dashboard--isDraggingOver":i.isDraggingOver,"uppy-Dashboard--modal":!i.inline,"uppy-size--md":i.containerWidth>pi,"uppy-size--lg":i.containerWidth>_r,"uppy-size--xl":i.containerWidth>vr,"uppy-size--height-md":i.containerHeight>wr,"uppy-Dashboard--isAddFilesPanelVisible":i.showAddFilesPanel,"uppy-Dashboard--isInnerWrapVisible":i.areInsidesReadyToBeVisible,"uppy-Dashboard--singleFile":i.singleFileFullScreen&&t&&r});let o=1;i.containerWidth>vr?o=5:i.containerWidth>_r?o=4:i.containerWidth>pi&&(o=3);const a=i.showSelectedFiles&&!e,l=i.recoveredState?Object.keys(i.recoveredState.files).length:null,u=i.files?Object.keys(i.files).filter(b=>i.files[b].isGhost).length:0,c=()=>u>0?i.i18n("recoveredXFiles",{smart_count:u}):i.i18n("recoveredAllFiles");return d("div",{className:s,"data-uppy-theme":i.theme,"data-uppy-num-acquirers":i.acquirers.length,"data-uppy-drag-drop-supported":!i.disableLocalFiles&&$u(),"aria-hidden":i.inline?"false":i.isHidden,"aria-disabled":i.disabled,"aria-label":i.inline?i.i18n("dashboardTitle"):i.i18n("dashboardWindowTitle"),onPaste:i.handlePaste,onDragOver:i.handleDragOver,onDragLeave:i.handleDragLeave,onDrop:i.handleDrop,children:[d("div",{"aria-hidden":"true",className:"uppy-Dashboard-overlay",tabIndex:-1,onClick:i.handleClickOutside}),d("div",{className:"uppy-Dashboard-inner",role:i.inline?void 0:"dialog",style:{width:i.inline&&i.width?i.width:"",height:i.inline&&i.height?i.height:""},children:[i.inline?null:d("button",{className:"uppy-u-reset uppy-Dashboard-close",type:"button","aria-label":i.i18n("closeModal"),title:i.i18n("closeModal"),onClick:i.closeModal,children:d("span",{"aria-hidden":"true",children:"×"})}),d("div",{className:"uppy-Dashboard-innerWrap",children:[d("div",{className:"uppy-Dashboard-dropFilesHereHint",children:i.i18n("dropHint")}),a&&d(_d,{...i}),l&&d("div",{className:"uppy-Dashboard-serviceMsg",children:[d("svg",{className:"uppy-Dashboard-serviceMsg-icon","aria-hidden":"true",focusable:"false",width:"21",height:"16",viewBox:"0 0 24 19",children:d("g",{transform:"translate(0 -1)",fill:"none",fillRule:"evenodd",children:[d("path",{d:"M12.857 1.43l10.234 17.056A1 1 0 0122.234 20H1.766a1 1 0 01-.857-1.514L11.143 1.429a1 1 0 011.714 0z",fill:"#FFD300"}),d("path",{fill:"#000",d:"M11 6h2l-.3 8h-1.4z"}),d("circle",{fill:"#000",cx:"12",cy:"17",r:"1"})]})}),d("strong",{className:"uppy-Dashboard-serviceMsg-title",children:i.i18n("sessionRestored")}),d("div",{className:"uppy-Dashboard-serviceMsg-text",children:c()})]}),a?d(gd,{id:i.id,i18n:i.i18n,uppy:i.uppy,files:i.files,resumableUploads:i.resumableUploads,hideRetryButton:i.hideRetryButton,hidePauseResumeButton:i.hidePauseResumeButton,hideCancelButton:i.hideCancelButton,showLinkToFileUploadResult:i.showLinkToFileUploadResult,showRemoveButtonAfterComplete:i.showRemoveButtonAfterComplete,metaFields:i.metaFields,toggleFileCard:i.toggleFileCard,handleRequestThumbnail:i.handleRequestThumbnail,handleCancelThumbnail:i.handleCancelThumbnail,recoveredState:i.recoveredState,individualCancellation:i.individualCancellation,openFileEditor:i.openFileEditor,canEditFile:i.canEditFile,toggleAddFilesPanel:i.toggleAddFilesPanel,isSingleFile:t,itemsPerRow:o,containerWidth:i.containerWidth,containerHeight:i.containerHeight}):d(Is,{i18n:i.i18n,i18nArray:i.i18nArray,acquirers:i.acquirers,handleInputChange:i.handleInputChange,maxNumberOfFiles:i.maxNumberOfFiles,allowedFileTypes:i.allowedFileTypes,showNativePhotoCameraButton:i.showNativePhotoCameraButton,showNativeVideoCameraButton:i.showNativeVideoCameraButton,nativeCameraFacingMode:i.nativeCameraFacingMode,showPanel:i.showPanel,activePickerPanel:i.activePickerPanel,disableLocalFiles:i.disableLocalFiles,fileManagerSelectionType:i.fileManagerSelectionType,note:i.note,proudlyDisplayPoweredByUppy:i.proudlyDisplayPoweredByUppy}),d(mt,{children:i.showAddFilesPanel?d(zu,{...i,isSizeMD:n},"AddFiles"):null}),d(mt,{children:i.fileCardFor?d(Qu,{...i},"FileCard"):null}),d(mt,{children:i.activePickerPanel?d(yd,{...i},"Picker"):null}),d(mt,{children:i.showFileEditor?d(ju,{...i},"Editor"):null}),d("div",{className:"uppy-Dashboard-progressindicators",children:i.progressindicators.map(b=>i.uppy.getPlugin(b.id).render(i.state))})]})]})]})}const Sd={strings:{closeModal:"Close Modal",addMoreFiles:"Add more files",addingMoreFiles:"Adding more files",importFrom:"Import from %{name}",dashboardWindowTitle:"Uppy Dashboard Window (Press escape to close)",dashboardTitle:"Uppy Dashboard",copyLinkToClipboardSuccess:"Link copied to clipboard.",copyLinkToClipboardFallback:"Copy the URL below",copyLink:"Copy link",back:"Back",removeFile:"Remove file",editFile:"Edit file",editImage:"Edit image",editing:"Editing %{file}",error:"Error",finishEditingFile:"Finish editing file",saveChanges:"Save changes",myDevice:"My Device",dropHint:"Drop your files here",uploadComplete:"Upload complete",uploadPaused:"Upload paused",resumeUpload:"Resume upload",pauseUpload:"Pause upload",retryUpload:"Retry upload",cancelUpload:"Cancel upload",xFilesSelected:{0:"%{smart_count} file selected",1:"%{smart_count} files selected"},uploadingXFiles:{0:"Uploading %{smart_count} file",1:"Uploading %{smart_count} files"},processingXFiles:{0:"Processing %{smart_count} file",1:"Processing %{smart_count} files"},poweredBy:"Powered by %{uppy}",addMore:"Add more",editFileWithFilename:"Edit file %{file}",save:"Save",cancel:"Cancel",dropPasteFiles:"Drop files here or %{browseFiles}",dropPasteFolders:"Drop files here or %{browseFolders}",dropPasteBoth:"Drop files here, %{browseFiles} or %{browseFolders}",dropPasteImportFiles:"Drop files here, %{browseFiles} or import from:",dropPasteImportFolders:"Drop files here, %{browseFolders} or import from:",dropPasteImportBoth:"Drop files here, %{browseFiles}, %{browseFolders} or import from:",importFiles:"Import files from:",browseFiles:"browse files",browseFolders:"browse folders",recoveredXFiles:{0:"We could not fully recover 1 file. Please re-select it and resume the upload.",1:"We could not fully recover %{smart_count} files. Please re-select them and resume the upload."},recoveredAllFiles:"We restored all files. You can now resume the upload.",sessionRestored:"Session restored",reSelect:"Re-select",missingRequiredMetaFields:{0:"Missing required meta field: %{fields}.",1:"Missing required meta fields: %{fields}."},takePictureBtn:"Take Picture",recordVideoBtn:"Record Video"}},Ls=['a[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','area[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])',"input:not([disabled]):not([inert]):not([aria-hidden])","select:not([disabled]):not([inert]):not([aria-hidden])","textarea:not([disabled]):not([inert]):not([aria-hidden])","button:not([disabled]):not([inert]):not([aria-hidden])",'iframe:not([tabindex^="-"]):not([inert]):not([aria-hidden])','object:not([tabindex^="-"]):not([inert]):not([aria-hidden])','embed:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[contenteditable]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[tabindex]:not([tabindex^="-"]):not([inert]):not([aria-hidden])'];var Fd=vs();const Pd=me(Fd);function Ms(i,e){if(e){const t=i.querySelector(`[data-uppy-paneltype="${e}"]`);if(t)return t}return i}function Td(){let i=!1;return Pd((t,n)=>{const r=Ms(t,n),s=r.contains(document.activeElement);if(s&&i)return;const o=r.querySelector("[data-uppy-super-focusable]");s&&!o||(o?(o.focus({preventScroll:!0}),i=!0):(r.querySelector(Ls)?.focus({preventScroll:!0}),i=!1))},260)}function Sr(i,e){const t=e[0];t&&(t.focus(),i.preventDefault())}function Cd(i,e){const t=e[e.length-1];t&&(t.focus(),i.preventDefault())}function Ed(i){return i.contains(document.activeElement)}function $s(i,e,t){const n=Ms(t,e),r=ze(n.querySelectorAll(Ls)),s=r.indexOf(document.activeElement);Ed(n)?i.shiftKey&&s===0?Cd(i,r):!i.shiftKey&&s===r.length-1&&Sr(i,r):Sr(i,r)}function kd(i,e,t){e===null||$s(i,e,t)}const Fr=9,Ud=27;function Pr(){const i={};return i.promise=new Promise((e,t)=>{i.resolve=e,i.reject=t}),i}const xd={target:"body",metaFields:[],thumbnailWidth:280,thumbnailType:"image/jpeg",waitForThumbnailsBeforeUpload:!1,defaultPickerIcon:Nl,showLinkToFileUploadResult:!1,showProgressDetails:!1,hideUploadButton:!1,hideCancelButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideProgressAfterFinish:!1,note:null,singleFileFullScreen:!0,disableStatusBar:!1,disableInformer:!1,disableThumbnailGenerator:!1,fileManagerSelectionType:"files",proudlyDisplayPoweredByUppy:!0,showSelectedFiles:!0,showRemoveButtonAfterComplete:!1,showNativePhotoCameraButton:!1,showNativeVideoCameraButton:!1,theme:"light",autoOpen:null,disabled:!1,disableLocalFiles:!1,nativeCameraFacingMode:"",onDragLeave:()=>{},onDragOver:()=>{},onDrop:()=>{},plugins:[],doneButtonHandler:void 0,onRequestCloseModal:null,inline:!1,animateOpenClose:!0,browserBackButtonClose:!1,closeAfterFinish:!1,closeModalOnClickOutside:!1,disablePageScrollWhenModalOpen:!0,trigger:null,width:750,height:550};class Od extends ve{static VERSION=Mu.version;#e;modalName=`uppy-Dashboard-${Ki()}`;superFocus=Td();ifFocusedOnUppyRecently=!1;dashboardIsDisabled;savedScrollPosition;savedActiveElement;resizeObserver;darkModeMediaQuery;makeDashboardInsidesVisibleAnywayTimeout;constructor(e,t){const n=t?.autoOpen??null;super(e,{...xd,...t,autoOpen:n}),this.id=this.opts.id||"Dashboard",this.title="Dashboard",this.type="orchestrator",this.defaultLocale=Sd,this.opts.doneButtonHandler===void 0&&(this.opts.doneButtonHandler=()=>{this.uppy.clear(),this.requestCloseModal()}),this.opts.onRequestCloseModal??=()=>this.closeModal(),this.i18nInit()}removeTarget=e=>{const n=this.getPluginState().targets.filter(r=>r.id!==e.id);this.setPluginState({targets:n})};addTarget=e=>{const t=e.id||e.constructor.name,n=e.title||t,r=e.type;if(r!=="acquirer"&&r!=="progressindicator"&&r!=="editor")return this.uppy.log("Dashboard: can only be targeted by plugins of types: acquirer, progressindicator, editor","error"),null;const s={id:t,name:n,type:r},a=this.getPluginState().targets.slice();return a.push(s),this.setPluginState({targets:a}),this.el};hideAllPanels=()=>{const e=this.getPluginState(),t={activePickerPanel:void 0,showAddFilesPanel:!1,activeOverlayType:null,fileCardFor:null,showFileEditor:!1};e.activePickerPanel===t.activePickerPanel&&e.showAddFilesPanel===t.showAddFilesPanel&&e.showFileEditor===t.showFileEditor&&e.activeOverlayType===t.activeOverlayType||(this.setPluginState(t),this.uppy.emit("dashboard:close-panel",e.activePickerPanel?.id))};showPanel=e=>{const{targets:t}=this.getPluginState(),n=t.find(r=>r.type==="acquirer"&&r.id===e);this.setPluginState({activePickerPanel:n,activeOverlayType:"PickerPanel"}),this.uppy.emit("dashboard:show-panel",e)};canEditFile=e=>{const{targets:t}=this.getPluginState();return this.#s(t).some(r=>this.uppy.getPlugin(r.id).canEditFile(e))};openFileEditor=e=>{const{targets:t}=this.getPluginState(),n=this.#s(t);this.setPluginState({showFileEditor:!0,fileCardFor:e.id||null,activeOverlayType:"FileEditor"}),n.forEach(r=>{this.uppy.getPlugin(r.id).selectFile(e)})};closeFileEditor=()=>{const{metaFields:e}=this.getPluginState();e&&e.length>0?this.setPluginState({showFileEditor:!1,activeOverlayType:"FileCard"}):this.setPluginState({showFileEditor:!1,fileCardFor:null,activeOverlayType:"AddFiles"})};saveFileEditor=()=>{const{targets:e}=this.getPluginState();this.#s(e).forEach(n=>{this.uppy.getPlugin(n.id).save()}),this.closeFileEditor()};openModal=()=>{const{promise:e,resolve:t}=Pr();if(this.savedScrollPosition=window.pageYOffset,this.savedActiveElement=document.activeElement,this.opts.disablePageScrollWhenModalOpen&&document.body.classList.add("uppy-Dashboard-isFixed"),this.opts.animateOpenClose&&this.getPluginState().isClosing){const n=()=>{this.setPluginState({isHidden:!1}),this.el.removeEventListener("animationend",n,!1),t()};this.el.addEventListener("animationend",n,!1)}else this.setPluginState({isHidden:!1}),t();return this.opts.browserBackButtonClose&&this.updateBrowserHistory(),document.addEventListener("keydown",this.handleKeyDownInModal),this.uppy.emit("dashboard:modal-open"),e};closeModal=e=>{const t=e?.manualClose??!0,{isHidden:n,isClosing:r}=this.getPluginState();if(n||r)return;const{promise:s,resolve:o}=Pr();if(this.opts.disablePageScrollWhenModalOpen&&document.body.classList.remove("uppy-Dashboard-isFixed"),this.opts.animateOpenClose){this.setPluginState({isClosing:!0});const a=()=>{this.setPluginState({isHidden:!0,isClosing:!1}),this.superFocus.cancel(),this.savedActiveElement.focus(),this.el.removeEventListener("animationend",a,!1),o()};this.el.addEventListener("animationend",a,!1)}else this.setPluginState({isHidden:!0}),this.superFocus.cancel(),this.savedActiveElement.focus(),o();return document.removeEventListener("keydown",this.handleKeyDownInModal),t&&this.opts.browserBackButtonClose&&history.state?.[this.modalName]&&history.back(),this.uppy.emit("dashboard:modal-closed"),s};isModalOpen=()=>!this.getPluginState().isHidden||!1;requestCloseModal=()=>this.opts.onRequestCloseModal?this.opts.onRequestCloseModal():this.closeModal();setDarkModeCapability=e=>{const{capabilities:t}=this.uppy.getState();this.uppy.setState({capabilities:{...t,darkMode:e}})};handleSystemDarkModeChange=e=>{const t=e.matches;this.uppy.log(`[Dashboard] Dark mode is ${t?"on":"off"}`),this.setDarkModeCapability(t)};toggleFileCard=(e,t)=>{const n=this.uppy.getFile(t);e?this.uppy.emit("dashboard:file-edit-start",n):this.uppy.emit("dashboard:file-edit-complete",n),this.setPluginState({fileCardFor:e?t:null,activeOverlayType:e?"FileCard":null})};toggleAddFilesPanel=e=>{this.setPluginState({showAddFilesPanel:e,activeOverlayType:e?"AddFiles":null})};addFiles=e=>{const t=e.map(n=>({source:this.id,name:n.name,type:n.type,data:n,meta:{relativePath:n.relativePath||n.webkitRelativePath||null}}));try{this.uppy.addFiles(t)}catch(n){this.uppy.log(n)}};startListeningToResize=()=>{this.resizeObserver=new ResizeObserver(e=>{const t=e[0],{width:n,height:r}=t.contentRect;this.setPluginState({containerWidth:n,containerHeight:r,areInsidesReadyToBeVisible:!0})}),this.resizeObserver.observe(this.el.querySelector(".uppy-Dashboard-inner")),this.makeDashboardInsidesVisibleAnywayTimeout=setTimeout(()=>{const e=this.getPluginState(),t=!this.opts.inline&&e.isHidden;!e.areInsidesReadyToBeVisible&&!t&&(this.uppy.log("[Dashboard] resize event didn’t fire on time: defaulted to mobile layout","warning"),this.setPluginState({areInsidesReadyToBeVisible:!0}))},1e3)};stopListeningToResize=()=>{this.resizeObserver.disconnect(),clearTimeout(this.makeDashboardInsidesVisibleAnywayTimeout)};recordIfFocusedOnUppyRecently=e=>{this.el.contains(e.target)?this.ifFocusedOnUppyRecently=!0:(this.ifFocusedOnUppyRecently=!1,this.superFocus.cancel())};disableInteractiveElements=e=>{const t=["a[href]","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])",'[role="button"]:not([disabled])'],n=this.#e??ze(this.el.querySelectorAll(t)).filter(r=>!r.classList.contains("uppy-Dashboard-close"));for(const r of n)r.tagName==="A"?r.setAttribute("aria-disabled",e):r.disabled=e;e?this.#e=n:this.#e=null,this.dashboardIsDisabled=e};updateBrowserHistory=()=>{history.state?.[this.modalName]||history.pushState({...history.state,[this.modalName]:!0},""),window.addEventListener("popstate",this.handlePopState,!1)};handlePopState=e=>{this.isModalOpen()&&(!e.state||!e.state[this.modalName])&&this.closeModal({manualClose:!1}),!this.isModalOpen()&&e.state?.[this.modalName]&&history.back()};handleKeyDownInModal=e=>{e.keyCode===Ud&&this.requestCloseModal(),e.keyCode===Fr&&$s(e,this.getPluginState().activeOverlayType,this.el)};handleClickOutside=()=>{this.opts.closeModalOnClickOutside&&this.requestCloseModal()};handlePaste=e=>{this.uppy.iteratePlugins(n=>{n.type==="acquirer"&&n.handleRootPaste?.(e)});const t=ze(e.clipboardData.files);t.length>0&&(this.uppy.log("[Dashboard] Files pasted"),this.addFiles(t))};handleInputChange=e=>{e.preventDefault();const t=ze(e.currentTarget.files||[]);t.length>0&&(this.uppy.log("[Dashboard] Files selected through input"),this.addFiles(t))};handleDragOver=e=>{e.preventDefault(),e.stopPropagation();const t=()=>{let o=!0;return this.uppy.iteratePlugins(a=>{a.canHandleRootDrop?.(e)&&(o=!0)}),o},n=()=>{const{types:o}=e.dataTransfer;return o.some(a=>a==="Files")},r=t(),s=n();if(!r&&!s||this.opts.disabled||this.opts.disableLocalFiles&&(s||!r)||!this.uppy.getState().allowNewUpload){e.dataTransfer.dropEffect="none";return}e.dataTransfer.dropEffect="copy",this.setPluginState({isDraggingOver:!0}),this.opts.onDragOver(e)};handleDragLeave=e=>{e.preventDefault(),e.stopPropagation(),this.setPluginState({isDraggingOver:!1}),this.opts.onDragLeave(e)};handleDrop=async e=>{e.preventDefault(),e.stopPropagation(),this.setPluginState({isDraggingOver:!1}),this.uppy.iteratePlugins(s=>{s.type==="acquirer"&&s.handleRootDrop?.(e)});let t=!1;const n=s=>{this.uppy.log(s,"error"),t||(this.uppy.info(s.message,"error"),t=!0)};this.uppy.log("[Dashboard] Processing dropped files");const r=await Bu(e.dataTransfer,{logDropError:n});r.length>0&&(this.uppy.log("[Dashboard] Files dropped"),this.addFiles(r)),this.opts.onDrop(e)};handleRequestThumbnail=e=>{this.opts.waitForThumbnailsBeforeUpload||this.uppy.emit("thumbnail:request",e)};handleCancelThumbnail=e=>{this.opts.waitForThumbnailsBeforeUpload||this.uppy.emit("thumbnail:cancel",e)};handleKeyDownInInline=e=>{e.keyCode===Fr&&kd(e,this.getPluginState().activeOverlayType,this.el)};handlePasteOnBody=e=>{this.el.contains(document.activeElement)&&this.handlePaste(e)};handleComplete=({failed:e})=>{this.opts.closeAfterFinish&&!e?.length&&this.requestCloseModal()};handleCancelRestore=()=>{this.uppy.emit("restore-canceled")};#t=()=>{if(this.opts.disableThumbnailGenerator)return;const e=600,t=this.uppy.getFiles();if(t.length===1){const n=this.uppy.getPlugin(`${this.id}:ThumbnailGenerator`);n?.setOptions({thumbnailWidth:e});const r={...t[0],preview:void 0};n?.requestThumbnail(r).then(()=>{n?.setOptions({thumbnailWidth:this.opts.thumbnailWidth})})}};#n=e=>{const t=e[0],{metaFields:n}=this.getPluginState(),r=n&&n.length>0,s=this.canEditFile(t);r&&this.opts.autoOpen==="metaEditor"?this.toggleFileCard(!0,t.id):s&&this.opts.autoOpen==="imageEditor"&&this.openFileEditor(t)};initEvents=()=>{if(this.opts.trigger&&!this.opts.inline){const e=gr(this.opts.trigger);e?e.forEach(t=>t.addEventListener("click",this.openModal)):this.uppy.log("Dashboard modal trigger not found. Make sure `trigger` is set in Dashboard options, unless you are planning to call `dashboard.openModal()` method yourself","warning")}this.startListeningToResize(),document.addEventListener("paste",this.handlePasteOnBody),this.uppy.on("plugin-added",this.#u),this.uppy.on("plugin-remove",this.removeTarget),this.uppy.on("file-added",this.hideAllPanels),this.uppy.on("dashboard:modal-closed",this.hideAllPanels),this.uppy.on("complete",this.handleComplete),this.uppy.on("files-added",this.#t),this.uppy.on("file-removed",this.#t),document.addEventListener("focus",this.recordIfFocusedOnUppyRecently,!0),document.addEventListener("click",this.recordIfFocusedOnUppyRecently,!0),this.opts.inline&&this.el.addEventListener("keydown",this.handleKeyDownInInline),this.opts.autoOpen&&this.uppy.on("files-added",this.#n)};removeEvents=()=>{const e=gr(this.opts.trigger);!this.opts.inline&&e&&e.forEach(t=>t.removeEventListener("click",this.openModal)),this.stopListeningToResize(),document.removeEventListener("paste",this.handlePasteOnBody),window.removeEventListener("popstate",this.handlePopState,!1),this.uppy.off("plugin-added",this.#u),this.uppy.off("plugin-remove",this.removeTarget),this.uppy.off("file-added",this.hideAllPanels),this.uppy.off("dashboard:modal-closed",this.hideAllPanels),this.uppy.off("complete",this.handleComplete),this.uppy.off("files-added",this.#t),this.uppy.off("file-removed",this.#t),document.removeEventListener("focus",this.recordIfFocusedOnUppyRecently),document.removeEventListener("click",this.recordIfFocusedOnUppyRecently),this.opts.inline&&this.el.removeEventListener("keydown",this.handleKeyDownInInline),this.opts.autoOpen&&this.uppy.off("files-added",this.#n)};superFocusOnEachUpdate=()=>{const e=this.el.contains(document.activeElement),t=document.activeElement===document.body||document.activeElement===null,n=this.uppy.getState().info.length===0,r=!this.opts.inline;n&&(r||e||t&&this.ifFocusedOnUppyRecently)?this.superFocus(this.el,this.getPluginState().activeOverlayType):this.superFocus.cancel()};afterUpdate=()=>{if(this.opts.disabled&&!this.dashboardIsDisabled){this.disableInteractiveElements(!0);return}!this.opts.disabled&&this.dashboardIsDisabled&&this.disableInteractiveElements(!1),this.superFocusOnEachUpdate()};saveFileCard=(e,t)=>{this.uppy.setFileMeta(t,e),this.toggleFileCard(!1,t)};#i=e=>{const t=this.uppy.getPlugin(e.id);return{...e,icon:t.icon||this.opts.defaultPickerIcon,render:t.render}};#r=e=>{const t=this.uppy.getPlugin(e.id);return typeof t.isSupported!="function"?!0:t.isSupported()};#o=e=>e.filter(t=>t.type==="acquirer"&&this.#r(t)).map(this.#i);#a=e=>e.filter(t=>t.type==="progressindicator").map(this.#i);#s=e=>e.filter(t=>t.type==="editor").map(this.#i);render=e=>{const t=this.getPluginState(),{files:n,capabilities:r,allowNewUpload:s}=e,{newFiles:o,uploadStartedFiles:a,completeFiles:l,erroredFiles:u,inProgressFiles:c,inProgressNotPausedFiles:h,processingFiles:b,isUploadStarted:v,isAllComplete:E,isAllPaused:T}=this.uppy.getObjectOfFilesPerState(),U=this.#o(t.targets),S=this.#a(t.targets),m=this.#s(t.targets);let y;return this.opts.theme==="auto"?y=r.darkMode?"dark":"light":y=this.opts.theme,["files","folders","both"].indexOf(this.opts.fileManagerSelectionType)<0&&(this.opts.fileManagerSelectionType="files",console.warn(`Unsupported option for "fileManagerSelectionType". Using default of "${this.opts.fileManagerSelectionType}".`)),wd({state:e,isHidden:t.isHidden,files:n,newFiles:o,uploadStartedFiles:a,completeFiles:l,erroredFiles:u,inProgressFiles:c,inProgressNotPausedFiles:h,processingFiles:b,isUploadStarted:v,isAllComplete:E,isAllPaused:T,totalFileCount:Object.keys(n).length,totalProgress:e.totalProgress,allowNewUpload:s,acquirers:U,theme:y,disabled:this.opts.disabled,disableLocalFiles:this.opts.disableLocalFiles,direction:this.opts.direction,activePickerPanel:t.activePickerPanel,showFileEditor:t.showFileEditor,saveFileEditor:this.saveFileEditor,closeFileEditor:this.closeFileEditor,disableInteractiveElements:this.disableInteractiveElements,animateOpenClose:this.opts.animateOpenClose,isClosing:t.isClosing,progressindicators:S,editors:m,autoProceed:this.uppy.opts.autoProceed,id:this.id,closeModal:this.requestCloseModal,handleClickOutside:this.handleClickOutside,handleInputChange:this.handleInputChange,handlePaste:this.handlePaste,inline:this.opts.inline,showPanel:this.showPanel,hideAllPanels:this.hideAllPanels,i18n:this.i18n,i18nArray:this.i18nArray,uppy:this.uppy,note:this.opts.note,recoveredState:e.recoveredState,metaFields:t.metaFields,resumableUploads:r.resumableUploads||!1,individualCancellation:r.individualCancellation,isMobileDevice:r.isMobileDevice,fileCardFor:t.fileCardFor,toggleFileCard:this.toggleFileCard,toggleAddFilesPanel:this.toggleAddFilesPanel,showAddFilesPanel:t.showAddFilesPanel,saveFileCard:this.saveFileCard,openFileEditor:this.openFileEditor,canEditFile:this.canEditFile,width:this.opts.width,height:this.opts.height,showLinkToFileUploadResult:this.opts.showLinkToFileUploadResult,fileManagerSelectionType:this.opts.fileManagerSelectionType,proudlyDisplayPoweredByUppy:this.opts.proudlyDisplayPoweredByUppy,hideCancelButton:this.opts.hideCancelButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,showRemoveButtonAfterComplete:this.opts.showRemoveButtonAfterComplete,containerWidth:t.containerWidth,containerHeight:t.containerHeight,areInsidesReadyToBeVisible:t.areInsidesReadyToBeVisible,parentElement:this.el,allowedFileTypes:this.uppy.opts.restrictions.allowedFileTypes,maxNumberOfFiles:this.uppy.opts.restrictions.maxNumberOfFiles,requiredMetaFields:this.uppy.opts.restrictions.requiredMetaFields,showSelectedFiles:this.opts.showSelectedFiles,showNativePhotoCameraButton:this.opts.showNativePhotoCameraButton,showNativeVideoCameraButton:this.opts.showNativeVideoCameraButton,nativeCameraFacingMode:this.opts.nativeCameraFacingMode,singleFileFullScreen:this.opts.singleFileFullScreen,handleCancelRestore:this.handleCancelRestore,handleRequestThumbnail:this.handleRequestThumbnail,handleCancelThumbnail:this.handleCancelThumbnail,isDraggingOver:t.isDraggingOver,handleDragOver:this.handleDragOver,handleDragLeave:this.handleDragLeave,handleDrop:this.handleDrop})};#l=()=>{const{plugins:e}=this.opts;e.forEach(t=>{const n=this.uppy.getPlugin(t);n?n.mount(this,n):this.uppy.log(`[Uppy] Dashboard could not find plugin '${t}', make sure to uppy.use() the plugins you are specifying`,"warning")})};#p=()=>{this.uppy.iteratePlugins(this.#u)};#u=e=>{const t=["acquirer","editor"];e&&!e.opts?.target&&t.includes(e.type)&&(this.getPluginState().targets.some(r=>e.id===r.id)||e.mount(this,e))};#h(){const{hideUploadButton:e,hideRetryButton:t,hidePauseResumeButton:n,hideCancelButton:r,showProgressDetails:s,hideProgressAfterFinish:o,locale:a,doneButtonHandler:l}=this.opts;return{hideUploadButton:e,hideRetryButton:t,hidePauseResumeButton:n,hideCancelButton:r,showProgressDetails:s,hideAfterFinish:o,locale:a,doneButtonHandler:l}}#c(){const{thumbnailWidth:e,thumbnailHeight:t,thumbnailType:n,waitForThumbnailsBeforeUpload:r}=this.opts;return{thumbnailWidth:e,thumbnailHeight:t,thumbnailType:n,waitForThumbnailsBeforeUpload:r,lazy:!r}}#d(){return{}}setOptions(e){super.setOptions(e),this.uppy.getPlugin(this.#f())?.setOptions(this.#h()),this.uppy.getPlugin(this.#m())?.setOptions(this.#c())}#f(){return`${this.id}:StatusBar`}#m(){return`${this.id}:ThumbnailGenerator`}#_(){return`${this.id}:Informer`}install=()=>{this.setPluginState({isHidden:!0,fileCardFor:null,activeOverlayType:null,showAddFilesPanel:!1,activePickerPanel:void 0,showFileEditor:!1,metaFields:this.opts.metaFields,targets:[],areInsidesReadyToBeVisible:!1,isDraggingOver:!1});const{inline:e,closeAfterFinish:t}=this.opts;if(e&&t)throw new Error("[Dashboard] `closeAfterFinish: true` cannot be used on an inline Dashboard, because an inline Dashboard cannot be closed at all. Either set `inline: false`, or disable the `closeAfterFinish` option.");const{allowMultipleUploads:n,allowMultipleUploadBatches:r}=this.uppy.opts;(n||r)&&t&&this.uppy.log("[Dashboard] When using `closeAfterFinish`, we recommended setting the `allowMultipleUploadBatches` option to `false` in the Uppy constructor. See https://uppy.io/docs/uppy/#allowMultipleUploads-true","warning");const{target:s}=this.opts;s&&this.mount(s,this),this.opts.disableStatusBar||this.uppy.use(ou,{id:this.#f(),target:this,...this.#h()}),this.opts.disableInformer||this.uppy.use(xl,{id:this.#_(),target:this,...this.#d()}),this.opts.disableThumbnailGenerator||this.uppy.use(Iu,{id:this.#m(),...this.#c()}),this.darkModeMediaQuery=typeof window<"u"&&window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)"):null;const o=this.darkModeMediaQuery?this.darkModeMediaQuery.matches:!1;this.uppy.log(`[Dashboard] Dark mode is ${o?"on":"off"}`),this.setDarkModeCapability(o),this.opts.theme==="auto"&&this.darkModeMediaQuery?.addListener(this.handleSystemDarkModeChange),this.#l(),this.#p(),this.initEvents()};uninstall=()=>{if(!this.opts.disableInformer){const t=this.uppy.getPlugin(`${this.id}:Informer`);t&&this.uppy.removePlugin(t)}if(!this.opts.disableStatusBar){const t=this.uppy.getPlugin(`${this.id}:StatusBar`);t&&this.uppy.removePlugin(t)}if(!this.opts.disableThumbnailGenerator){const t=this.uppy.getPlugin(`${this.id}:ThumbnailGenerator`);t&&this.uppy.removePlugin(t)}const{plugins:e}=this.opts;e.forEach(t=>{const n=this.uppy.getPlugin(t);n&&n.unmount()}),this.opts.theme==="auto"&&this.darkModeMediaQuery?.removeListener(this.handleSystemDarkModeChange),this.opts.disablePageScrollWhenModalOpen&&document.body.classList.remove("uppy-Dashboard-isFixed"),this.unmount(),this.removeEvents()}}class Ad{#e;#t=[];constructor(e){this.#e=e}on(e,t){return this.#t.push([e,t]),this.#e.on(e,t)}remove(){for(const[e,t]of this.#t.splice(0))this.#e.off(e,t)}onFilePause(e,t){this.on("upload-pause",(n,r)=>{e===n?.id&&t(r)})}onFileRemove(e,t){this.on("file-removed",n=>{e===n.id&&t(n.id)})}onPause(e,t){this.on("upload-pause",(n,r)=>{e===n?.id&&t(r)})}onRetry(e,t){this.on("upload-retry",n=>{e===n?.id&&t()})}onRetryAll(e,t){this.on("retry-all",()=>{this.#e.getFile(e)&&t()})}onPauseAll(e,t){this.on("pause-all",()=>{this.#e.getFile(e)&&t()})}onCancelAll(e,t){this.on("cancel-all",(...n)=>{this.#e.getFile(e)&&t(...n)})}onResumeAll(e,t){this.on("resume-all",()=>{this.#e.getFile(e)&&t()})}}function Rd(i){const e=t=>"error"in t&&!!t.error;return i.filter(t=>!e(t))}function Id(i){return i.filter(e=>!e.progress?.uploadStarted||!e.isRestored)}function Dd(i,e){return i===!0?Object.keys(e):Array.isArray(i)?i:[]}function fi(i,e){return Object.hasOwn(i,e)}function Nd(i){return i?i.readyState!==0&&i.readyState!==4||i.status===0:!1}class Bd extends Error{cause;isNetworkError;request;constructor(e,t=null){super("This looks like a network error, the endpoint might be blocked by an internet provider or a firewall."),this.cause=e,this.isNetworkError=!0,this.request=t}}function Ld(i){return new Error("Cancelled",{cause:i})}function Tr(i){if(i!=null){const e=()=>this.abort(i.reason);i.addEventListener("abort",e,{once:!0});const t=()=>{i.removeEventListener("abort",e)};this.then?.(t,t)}return this}class Md{#e=0;#t=[];#n=!1;#i;#r=1;#o;#a;limit;constructor(e){typeof e!="number"||e===0?this.limit=1/0:this.limit=e}#s(e){this.#e+=1;let t=!1,n;try{n=e()}catch(r){throw this.#e-=1,r}return{abort:r=>{t||(t=!0,this.#e-=1,n?.(r),this.#l())},done:()=>{t||(t=!0,this.#e-=1,this.#l())}}}#l(){queueMicrotask(()=>this.#p())}#p(){if(this.#n||this.#e>=this.limit||this.#t.length===0)return;const e=this.#t.shift();if(e==null)throw new Error("Invariant violation: next is null");const t=this.#s(e.fn);e.abort=t.abort,e.done=t.done}#u(e,t){const n={fn:e,priority:t?.priority||0,abort:()=>{this.#h(n)},done:()=>{throw new Error("Cannot mark a queued request as done: this indicates a bug")}},r=this.#t.findIndex(s=>n.priority>s.priority);return r===-1?this.#t.push(n):this.#t.splice(r,0,n),n}#h(e){const t=this.#t.indexOf(e);t!==-1&&this.#t.splice(t,1)}run(e,t){return!this.#n&&this.#e<this.limit?this.#s(e):this.#u(e,t)}wrapSyncFunction(e,t){return(...n)=>{const r=this.run(()=>(e(...n),queueMicrotask(()=>r.done()),()=>{}),t);return{abortOn:Tr,abort(){r.abort()}}}}wrapPromiseFunction(e,t){return(...n)=>{let r;const s=new Promise((o,a)=>{r=this.run(()=>{let l,u;try{u=Promise.resolve(e(...n))}catch(c){u=Promise.reject(c)}return u.then(c=>{l?a(l):(r.done(),o(c))},c=>{l?a(l):(r.done(),a(c))}),c=>{l=Ld(c)}},t)});return s.abort=o=>{r.abort(o)},s.abortOn=Tr,s}}resume(){this.#n=!1,clearTimeout(this.#i);for(let e=0;e<this.limit;e++)this.#l()}#c=()=>this.resume();pause(e=null){this.#n=!0,clearTimeout(this.#i),e!=null&&(this.#i=setTimeout(this.#c,e))}rateLimit(e){clearTimeout(this.#a),this.pause(e),this.limit>1&&Number.isFinite(this.limit)&&(this.#o=this.limit-1,this.limit=this.#r,this.#a=setTimeout(this.#d,e))}#d=()=>{if(this.#n){this.#a=setTimeout(this.#d,0);return}this.#r=this.limit,this.limit=Math.ceil((this.#o+this.#r)/2);for(let e=this.#r;e<=this.limit;e++)this.#l();this.#o-this.#r>3?this.#a=setTimeout(this.#d,2e3):this.#r=Math.floor(this.#r/2)};get isPaused(){return this.#n}}function Ui(i){"@babel/helpers - typeof";return Ui=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ui(i)}function $d(i,e,t){return Object.defineProperty(i,"prototype",{writable:!1}),i}function zd(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function jd(i,e,t){return e=Ke(e),qd(i,nn()?Reflect.construct(e,t||[],Ke(i).constructor):e.apply(i,t))}function qd(i,e){if(e&&(Ui(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hd(i)}function Hd(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function Vd(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&Ge(i,e)}function xi(i){var e=typeof Map=="function"?new Map:void 0;return xi=function(n){if(n===null||!Gd(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(n))return e.get(n);e.set(n,r)}function r(){return Wd(n,arguments,Ke(this).constructor)}return r.prototype=Object.create(n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Ge(r,n)},xi(i)}function Wd(i,e,t){if(nn())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var r=new(i.bind.apply(i,n));return t&&Ge(r,t.prototype),r}function nn(){try{var i=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nn=function(){return!!i})()}function Gd(i){try{return Function.toString.call(i).indexOf("[native code]")!==-1}catch{return typeof i=="function"}}function Ge(i,e){return Ge=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Ge(i,e)}function Ke(i){return Ke=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ke(i)}var gt=(function(i){function e(t){var n,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(zd(this,e),n=jd(this,e,[t]),n.originalRequest=s,n.originalResponse=o,n.causingError=r,r!=null&&(t+=", caused by ".concat(r.toString())),s!=null){var a=s.getHeader("X-Request-ID")||"n/a",l=s.getMethod(),u=s.getURL(),c=o?o.getStatus():"n/a",h=o?o.getBody()||"":"n/a";t+=", originated from request (method: ".concat(l,", url: ").concat(u,", response code: ").concat(c,", response text: ").concat(h,", request id: ").concat(a,")")}return n.message=t,n}return Vd(e,i),$d(e)})(xi(Error));function Xe(i){"@babel/helpers - typeof";return Xe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xe(i)}function Kd(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function Xd(i,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,Qd(n.key),n)}}function Yd(i,e,t){return e&&Xd(i.prototype,e),Object.defineProperty(i,"prototype",{writable:!1}),i}function Qd(i){var e=Zd(i,"string");return Xe(e)=="symbol"?e:e+""}function Zd(i,e){if(Xe(i)!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(Xe(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(i)}var Jd=(function(){function i(){Kd(this,i)}return Yd(i,[{key:"listAllUploads",value:function(){return Promise.resolve([])}},{key:"findUploadsByFingerprint",value:function(t){return Promise.resolve([])}},{key:"removeUpload",value:function(t){return Promise.resolve()}},{key:"addUpload",value:function(t,n){return Promise.resolve(null)}}])})();const zs="3.7.8",ec=zs,Re=typeof Buffer=="function",Cr=typeof TextDecoder=="function"?new TextDecoder:void 0,Er=typeof TextEncoder=="function"?new TextEncoder:void 0,tc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Le=Array.prototype.slice.call(tc),yt=(i=>{let e={};return i.forEach((t,n)=>e[t]=n),e})(Le),ic=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,Z=String.fromCharCode.bind(String),kr=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):i=>new Uint8Array(Array.prototype.slice.call(i,0)),js=i=>i.replace(/=/g,"").replace(/[+\/]/g,e=>e=="+"?"-":"_"),qs=i=>i.replace(/[^A-Za-z0-9\+\/]/g,""),Hs=i=>{let e,t,n,r,s="";const o=i.length%3;for(let a=0;a<i.length;){if((t=i.charCodeAt(a++))>255||(n=i.charCodeAt(a++))>255||(r=i.charCodeAt(a++))>255)throw new TypeError("invalid character found");e=t<<16|n<<8|r,s+=Le[e>>18&63]+Le[e>>12&63]+Le[e>>6&63]+Le[e&63]}return o?s.slice(0,o-3)+"===".substring(o):s},rn=typeof btoa=="function"?i=>btoa(i):Re?i=>Buffer.from(i,"binary").toString("base64"):Hs,Oi=Re?i=>Buffer.from(i).toString("base64"):i=>{let t=[];for(let n=0,r=i.length;n<r;n+=4096)t.push(Z.apply(null,i.subarray(n,n+4096)));return rn(t.join(""))},Pt=(i,e=!1)=>e?js(Oi(i)):Oi(i),nc=i=>{if(i.length<2){var e=i.charCodeAt(0);return e<128?i:e<2048?Z(192|e>>>6)+Z(128|e&63):Z(224|e>>>12&15)+Z(128|e>>>6&63)+Z(128|e&63)}else{var e=65536+(i.charCodeAt(0)-55296)*1024+(i.charCodeAt(1)-56320);return Z(240|e>>>18&7)+Z(128|e>>>12&63)+Z(128|e>>>6&63)+Z(128|e&63)}},rc=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,Vs=i=>i.replace(rc,nc),Ur=Re?i=>Buffer.from(i,"utf8").toString("base64"):Er?i=>Oi(Er.encode(i)):i=>rn(Vs(i)),Ue=(i,e=!1)=>e?js(Ur(i)):Ur(i),xr=i=>Ue(i,!0),sc=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,oc=i=>{switch(i.length){case 4:var e=(7&i.charCodeAt(0))<<18|(63&i.charCodeAt(1))<<12|(63&i.charCodeAt(2))<<6|63&i.charCodeAt(3),t=e-65536;return Z((t>>>10)+55296)+Z((t&1023)+56320);case 3:return Z((15&i.charCodeAt(0))<<12|(63&i.charCodeAt(1))<<6|63&i.charCodeAt(2));default:return Z((31&i.charCodeAt(0))<<6|63&i.charCodeAt(1))}},Ws=i=>i.replace(sc,oc),Gs=i=>{if(i=i.replace(/\s+/g,""),!ic.test(i))throw new TypeError("malformed base64.");i+="==".slice(2-(i.length&3));let e,t,n,r=[];for(let s=0;s<i.length;)e=yt[i.charAt(s++)]<<18|yt[i.charAt(s++)]<<12|(t=yt[i.charAt(s++)])<<6|(n=yt[i.charAt(s++)]),t===64?r.push(Z(e>>16&255)):n===64?r.push(Z(e>>16&255,e>>8&255)):r.push(Z(e>>16&255,e>>8&255,e&255));return r.join("")},sn=typeof atob=="function"?i=>atob(qs(i)):Re?i=>Buffer.from(i,"base64").toString("binary"):Gs,Ks=Re?i=>kr(Buffer.from(i,"base64")):i=>kr(sn(i).split("").map(e=>e.charCodeAt(0))),Xs=i=>Ks(Ys(i)),ac=Re?i=>Buffer.from(i,"base64").toString("utf8"):Cr?i=>Cr.decode(Ks(i)):i=>Ws(sn(i)),Ys=i=>qs(i.replace(/[-_]/g,e=>e=="-"?"+":"/")),Ai=i=>ac(Ys(i)),lc=i=>{if(typeof i!="string")return!1;const e=i.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(e)||!/[^\s0-9a-zA-Z\-_]/.test(e)},Qs=i=>({value:i,enumerable:!1,writable:!0,configurable:!0}),Zs=function(){const i=(e,t)=>Object.defineProperty(String.prototype,e,Qs(t));i("fromBase64",function(){return Ai(this)}),i("toBase64",function(e){return Ue(this,e)}),i("toBase64URI",function(){return Ue(this,!0)}),i("toBase64URL",function(){return Ue(this,!0)}),i("toUint8Array",function(){return Xs(this)})},Js=function(){const i=(e,t)=>Object.defineProperty(Uint8Array.prototype,e,Qs(t));i("toBase64",function(e){return Pt(this,e)}),i("toBase64URI",function(){return Pt(this,!0)}),i("toBase64URL",function(){return Pt(this,!0)})},uc=()=>{Zs(),Js()},dc={version:zs,VERSION:ec,atob:sn,atobPolyfill:Gs,btoa:rn,btoaPolyfill:Hs,fromBase64:Ai,toBase64:Ue,encode:Ue,encodeURI:xr,encodeURL:xr,utob:Vs,btou:Ws,decode:Ai,isValid:lc,fromUint8Array:Pt,toUint8Array:Xs,extendString:Zs,extendUint8Array:Js,extendBuiltins:uc};var mi,Or;function cc(){return Or||(Or=1,mi=function(e,t){if(t=t.split(":")[0],e=+e,!e)return!1;switch(t){case"http":case"ws":return e!==80;case"https":case"wss":return e!==443;case"ftp":return e!==21;case"gopher":return e!==70;case"file":return!1}return e!==0}),mi}var bt={},Ar;function hc(){if(Ar)return bt;Ar=1;var i=Object.prototype.hasOwnProperty,e;function t(o){try{return decodeURIComponent(o.replace(/\+/g," "))}catch{return null}}function n(o){try{return encodeURIComponent(o)}catch{return null}}function r(o){for(var a=/([^=?#&]+)=?([^&]*)/g,l={},u;u=a.exec(o);){var c=t(u[1]),h=t(u[2]);c===null||h===null||c in l||(l[c]=h)}return l}function s(o,a){a=a||"";var l=[],u,c;typeof a!="string"&&(a="?");for(c in o)if(i.call(o,c)){if(u=o[c],!u&&(u===null||u===e||isNaN(u))&&(u=""),c=n(c),u=n(u),c===null||u===null)continue;l.push(c+"="+u)}return l.length?a+l.join("&"):""}return bt.stringify=s,bt.parse=r,bt}var gi,Rr;function pc(){if(Rr)return gi;Rr=1;var i=cc(),e=hc(),t=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,n=/[\n\r\t]/g,r=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,s=/:\d+$/,o=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,a=/^[a-zA-Z]:/;function l(m){return(m||"").toString().replace(t,"")}var u=[["#","hash"],["?","query"],function(y,_){return b(_.protocol)?y.replace(/\\/g,"/"):y},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],c={hash:1,query:1};function h(m){var y;typeof window<"u"?y=window:typeof Te<"u"?y=Te:typeof self<"u"?y=self:y={};var _=y.location||{};m=m||_;var w={},x=typeof m,O;if(m.protocol==="blob:")w=new T(unescape(m.pathname),{});else if(x==="string"){w=new T(m,{});for(O in c)delete w[O]}else if(x==="object"){for(O in m)O in c||(w[O]=m[O]);w.slashes===void 0&&(w.slashes=r.test(m.href))}return w}function b(m){return m==="file:"||m==="ftp:"||m==="http:"||m==="https:"||m==="ws:"||m==="wss:"}function v(m,y){m=l(m),m=m.replace(n,""),y=y||{};var _=o.exec(m),w=_[1]?_[1].toLowerCase():"",x=!!_[2],O=!!_[3],R=0,A;return x?O?(A=_[2]+_[3]+_[4],R=_[2].length+_[3].length):(A=_[2]+_[4],R=_[2].length):O?(A=_[3]+_[4],R=_[3].length):A=_[4],w==="file:"?R>=2&&(A=A.slice(2)):b(w)?A=_[4]:w?x&&(A=A.slice(2)):R>=2&&b(y.protocol)&&(A=_[4]),{protocol:w,slashes:x||b(w),slashesCount:R,rest:A}}function E(m,y){if(m==="")return y;for(var _=(y||"/").split("/").slice(0,-1).concat(m.split("/")),w=_.length,x=_[w-1],O=!1,R=0;w--;)_[w]==="."?_.splice(w,1):_[w]===".."?(_.splice(w,1),R++):R&&(w===0&&(O=!0),_.splice(w,1),R--);return O&&_.unshift(""),(x==="."||x==="..")&&_.push(""),_.join("/")}function T(m,y,_){if(m=l(m),m=m.replace(n,""),!(this instanceof T))return new T(m,y,_);var w,x,O,R,A,z,M=u.slice(),V=typeof y,k=this,q=0;for(V!=="object"&&V!=="string"&&(_=y,y=null),_&&typeof _!="function"&&(_=e.parse),y=h(y),x=v(m||"",y),w=!x.protocol&&!x.slashes,k.slashes=x.slashes||w&&y.slashes,k.protocol=x.protocol||y.protocol||"",m=x.rest,(x.protocol==="file:"&&(x.slashesCount!==2||a.test(m))||!x.slashes&&(x.protocol||x.slashesCount<2||!b(k.protocol)))&&(M[3]=[/(.*)/,"pathname"]);q<M.length;q++){if(R=M[q],typeof R=="function"){m=R(m,k);continue}O=R[0],z=R[1],O!==O?k[z]=m:typeof O=="string"?(A=O==="@"?m.lastIndexOf(O):m.indexOf(O),~A&&(typeof R[2]=="number"?(k[z]=m.slice(0,A),m=m.slice(A+R[2])):(k[z]=m.slice(A),m=m.slice(0,A)))):(A=O.exec(m))&&(k[z]=A[1],m=m.slice(0,A.index)),k[z]=k[z]||w&&R[3]&&y[z]||"",R[4]&&(k[z]=k[z].toLowerCase())}_&&(k.query=_(k.query)),w&&y.slashes&&k.pathname.charAt(0)!=="/"&&(k.pathname!==""||y.pathname!=="")&&(k.pathname=E(k.pathname,y.pathname)),k.pathname.charAt(0)!=="/"&&b(k.protocol)&&(k.pathname="/"+k.pathname),i(k.port,k.protocol)||(k.host=k.hostname,k.port=""),k.username=k.password="",k.auth&&(A=k.auth.indexOf(":"),~A?(k.username=k.auth.slice(0,A),k.username=encodeURIComponent(decodeURIComponent(k.username)),k.password=k.auth.slice(A+1),k.password=encodeURIComponent(decodeURIComponent(k.password))):k.username=encodeURIComponent(decodeURIComponent(k.auth)),k.auth=k.password?k.username+":"+k.password:k.username),k.origin=k.protocol!=="file:"&&b(k.protocol)&&k.host?k.protocol+"//"+k.host:"null",k.href=k.toString()}function U(m,y,_){var w=this;switch(m){case"query":typeof y=="string"&&y.length&&(y=(_||e.parse)(y)),w[m]=y;break;case"port":w[m]=y,i(y,w.protocol)?y&&(w.host=w.hostname+":"+y):(w.host=w.hostname,w[m]="");break;case"hostname":w[m]=y,w.port&&(y+=":"+w.port),w.host=y;break;case"host":w[m]=y,s.test(y)?(y=y.split(":"),w.port=y.pop(),w.hostname=y.join(":")):(w.hostname=y,w.port="");break;case"protocol":w.protocol=y.toLowerCase(),w.slashes=!_;break;case"pathname":case"hash":if(y){var x=m==="pathname"?"/":"#";w[m]=y.charAt(0)!==x?x+y:y}else w[m]=y;break;case"username":case"password":w[m]=encodeURIComponent(y);break;case"auth":var O=y.indexOf(":");~O?(w.username=y.slice(0,O),w.username=encodeURIComponent(decodeURIComponent(w.username)),w.password=y.slice(O+1),w.password=encodeURIComponent(decodeURIComponent(w.password))):w.username=encodeURIComponent(decodeURIComponent(y))}for(var R=0;R<u.length;R++){var A=u[R];A[4]&&(w[A[1]]=w[A[1]].toLowerCase())}return w.auth=w.password?w.username+":"+w.password:w.username,w.origin=w.protocol!=="file:"&&b(w.protocol)&&w.host?w.protocol+"//"+w.host:"null",w.href=w.toString(),w}function S(m){(!m||typeof m!="function")&&(m=e.stringify);var y,_=this,w=_.host,x=_.protocol;x&&x.charAt(x.length-1)!==":"&&(x+=":");var O=x+(_.protocol&&_.slashes||b(_.protocol)?"//":"");return _.username?(O+=_.username,_.password&&(O+=":"+_.password),O+="@"):_.password?(O+=":"+_.password,O+="@"):_.protocol!=="file:"&&b(_.protocol)&&!w&&_.pathname!=="/"&&(O+="@"),(w[w.length-1]===":"||s.test(_.hostname)&&!_.port)&&(w+=":"),O+=w+_.pathname,y=typeof _.query=="object"?m(_.query):_.query,y&&(O+=y.charAt(0)!=="?"?"?"+y:y),_.hash&&(O+=_.hash),O}return T.prototype={set:U,toString:S},T.extractProtocol=v,T.location=h,T.trimLeft=l,T.qs=e,gi=T,gi}var fc=pc();const mc=me(fc);function gc(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){var e=Math.random()*16|0,t=i==="x"?e:e&3|8;return t.toString(16)})}function Ri(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Ri=function(){return e};var i,e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(g,p,f){g[p]=f.value},s=typeof Symbol=="function"?Symbol:{},o=s.iterator||"@@iterator",a=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function u(g,p,f){return Object.defineProperty(g,p,{value:f,enumerable:!0,configurable:!0,writable:!0}),g[p]}try{u({},"")}catch{u=function(f,F,C){return f[F]=C}}function c(g,p,f,F){var C=p&&p.prototype instanceof S?p:S,P=Object.create(C.prototype),I=new q(F||[]);return r(P,"_invoke",{value:z(g,f,I)}),P}function h(g,p,f){try{return{type:"normal",arg:g.call(p,f)}}catch(F){return{type:"throw",arg:F}}}e.wrap=c;var b="suspendedStart",v="suspendedYield",E="executing",T="completed",U={};function S(){}function m(){}function y(){}var _={};u(_,o,function(){return this});var w=Object.getPrototypeOf,x=w&&w(w(J([])));x&&x!==t&&n.call(x,o)&&(_=x);var O=y.prototype=S.prototype=Object.create(_);function R(g){["next","throw","return"].forEach(function(p){u(g,p,function(f){return this._invoke(p,f)})})}function A(g,p){function f(C,P,I,B){var L=h(g[C],g,P);if(L.type!=="throw"){var ee=L.arg,X=ee.value;return X&&_e(X)=="object"&&n.call(X,"__await")?p.resolve(X.__await).then(function(te){f("next",te,I,B)},function(te){f("throw",te,I,B)}):p.resolve(X).then(function(te){ee.value=te,I(ee)},function(te){return f("throw",te,I,B)})}B(L.arg)}var F;r(this,"_invoke",{value:function(P,I){function B(){return new p(function(L,ee){f(P,I,L,ee)})}return F=F?F.then(B,B):B()}})}function z(g,p,f){var F=b;return function(C,P){if(F===E)throw Error("Generator is already running");if(F===T){if(C==="throw")throw P;return{value:i,done:!0}}for(f.method=C,f.arg=P;;){var I=f.delegate;if(I){var B=M(I,f);if(B){if(B===U)continue;return B}}if(f.method==="next")f.sent=f._sent=f.arg;else if(f.method==="throw"){if(F===b)throw F=T,f.arg;f.dispatchException(f.arg)}else f.method==="return"&&f.abrupt("return",f.arg);F=E;var L=h(g,p,f);if(L.type==="normal"){if(F=f.done?T:v,L.arg===U)continue;return{value:L.arg,done:f.done}}L.type==="throw"&&(F=T,f.method="throw",f.arg=L.arg)}}}function M(g,p){var f=p.method,F=g.iterator[f];if(F===i)return p.delegate=null,f==="throw"&&g.iterator.return&&(p.method="return",p.arg=i,M(g,p),p.method==="throw")||f!=="return"&&(p.method="throw",p.arg=new TypeError("The iterator does not provide a '"+f+"' method")),U;var C=h(F,g.iterator,p.arg);if(C.type==="throw")return p.method="throw",p.arg=C.arg,p.delegate=null,U;var P=C.arg;return P?P.done?(p[g.resultName]=P.value,p.next=g.nextLoc,p.method!=="return"&&(p.method="next",p.arg=i),p.delegate=null,U):P:(p.method="throw",p.arg=new TypeError("iterator result is not an object"),p.delegate=null,U)}function V(g){var p={tryLoc:g[0]};1 in g&&(p.catchLoc=g[1]),2 in g&&(p.finallyLoc=g[2],p.afterLoc=g[3]),this.tryEntries.push(p)}function k(g){var p=g.completion||{};p.type="normal",delete p.arg,g.completion=p}function q(g){this.tryEntries=[{tryLoc:"root"}],g.forEach(V,this),this.reset(!0)}function J(g){if(g||g===""){var p=g[o];if(p)return p.call(g);if(typeof g.next=="function")return g;if(!isNaN(g.length)){var f=-1,F=function C(){for(;++f<g.length;)if(n.call(g,f))return C.value=g[f],C.done=!1,C;return C.value=i,C.done=!0,C};return F.next=F}}throw new TypeError(_e(g)+" is not iterable")}return m.prototype=y,r(O,"constructor",{value:y,configurable:!0}),r(y,"constructor",{value:m,configurable:!0}),m.displayName=u(y,l,"GeneratorFunction"),e.isGeneratorFunction=function(g){var p=typeof g=="function"&&g.constructor;return!!p&&(p===m||(p.displayName||p.name)==="GeneratorFunction")},e.mark=function(g){return Object.setPrototypeOf?Object.setPrototypeOf(g,y):(g.__proto__=y,u(g,l,"GeneratorFunction")),g.prototype=Object.create(O),g},e.awrap=function(g){return{__await:g}},R(A.prototype),u(A.prototype,a,function(){return this}),e.AsyncIterator=A,e.async=function(g,p,f,F,C){C===void 0&&(C=Promise);var P=new A(c(g,p,f,F),C);return e.isGeneratorFunction(p)?P:P.next().then(function(I){return I.done?I.value:P.next()})},R(O),u(O,l,"Generator"),u(O,o,function(){return this}),u(O,"toString",function(){return"[object Generator]"}),e.keys=function(g){var p=Object(g),f=[];for(var F in p)f.push(F);return f.reverse(),function C(){for(;f.length;){var P=f.pop();if(P in p)return C.value=P,C.done=!1,C}return C.done=!0,C}},e.values=J,q.prototype={constructor:q,reset:function(p){if(this.prev=0,this.next=0,this.sent=this._sent=i,this.done=!1,this.delegate=null,this.method="next",this.arg=i,this.tryEntries.forEach(k),!p)for(var f in this)f.charAt(0)==="t"&&n.call(this,f)&&!isNaN(+f.slice(1))&&(this[f]=i)},stop:function(){this.done=!0;var p=this.tryEntries[0].completion;if(p.type==="throw")throw p.arg;return this.rval},dispatchException:function(p){if(this.done)throw p;var f=this;function F(ee,X){return I.type="throw",I.arg=p,f.next=ee,X&&(f.method="next",f.arg=i),!!X}for(var C=this.tryEntries.length-1;C>=0;--C){var P=this.tryEntries[C],I=P.completion;if(P.tryLoc==="root")return F("end");if(P.tryLoc<=this.prev){var B=n.call(P,"catchLoc"),L=n.call(P,"finallyLoc");if(B&&L){if(this.prev<P.catchLoc)return F(P.catchLoc,!0);if(this.prev<P.finallyLoc)return F(P.finallyLoc)}else if(B){if(this.prev<P.catchLoc)return F(P.catchLoc,!0)}else{if(!L)throw Error("try statement without catch or finally");if(this.prev<P.finallyLoc)return F(P.finallyLoc)}}}},abrupt:function(p,f){for(var F=this.tryEntries.length-1;F>=0;--F){var C=this.tryEntries[F];if(C.tryLoc<=this.prev&&n.call(C,"finallyLoc")&&this.prev<C.finallyLoc){var P=C;break}}P&&(p==="break"||p==="continue")&&P.tryLoc<=f&&f<=P.finallyLoc&&(P=null);var I=P?P.completion:{};return I.type=p,I.arg=f,P?(this.method="next",this.next=P.finallyLoc,U):this.complete(I)},complete:function(p,f){if(p.type==="throw")throw p.arg;return p.type==="break"||p.type==="continue"?this.next=p.arg:p.type==="return"?(this.rval=this.arg=p.arg,this.method="return",this.next="end"):p.type==="normal"&&f&&(this.next=f),U},finish:function(p){for(var f=this.tryEntries.length-1;f>=0;--f){var F=this.tryEntries[f];if(F.finallyLoc===p)return this.complete(F.completion,F.afterLoc),k(F),U}},catch:function(p){for(var f=this.tryEntries.length-1;f>=0;--f){var F=this.tryEntries[f];if(F.tryLoc===p){var C=F.completion;if(C.type==="throw"){var P=C.arg;k(F)}return P}}throw Error("illegal catch attempt")},delegateYield:function(p,f,F){return this.delegate={iterator:J(p),resultName:f,nextLoc:F},this.method==="next"&&(this.arg=i),U}},e}function Ir(i,e,t,n,r,s,o){try{var a=i[s](o),l=a.value}catch(u){t(u);return}a.done?e(l):Promise.resolve(l).then(n,r)}function yc(i){return function(){var e=this,t=arguments;return new Promise(function(n,r){var s=i.apply(e,t);function o(l){Ir(s,n,r,o,a,"next",l)}function a(l){Ir(s,n,r,o,a,"throw",l)}o(void 0)})}}function eo(i,e){return _c(i)||vc(i,e)||to(i,e)||bc()}function bc(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vc(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var n,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(i)).next,e!==0)for(;!(l=(n=s.call(t)).done)&&(a.push(n.value),a.length!==e);l=!0);}catch(c){u=!0,r=c}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function _c(i){if(Array.isArray(i))return i}function _e(i){"@babel/helpers - typeof";return _e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_e(i)}function wc(i,e){var t=typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(!t){if(Array.isArray(i)||(t=to(i))||e){t&&(i=t);var n=0,r=function(){};return{s:r,n:function(){return n>=i.length?{done:!0}:{done:!1,value:i[n++]}},e:function(u){throw u},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,o=!1,a;return{s:function(){t=t.call(i)},n:function(){var u=t.next();return s=u.done,u},e:function(u){o=!0,a=u},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(o)throw a}}}}function to(i,e){if(i){if(typeof i=="string")return Dr(i,e);var t=Object.prototype.toString.call(i).slice(8,-1);if(t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set")return Array.from(i);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Dr(i,e)}}function Dr(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=i[t];return n}function Nr(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function Fe(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Nr(Object(t),!0).forEach(function(n){Sc(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):Nr(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function Sc(i,e,t){return e=io(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Fc(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function Br(i,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,io(n.key),n)}}function Pc(i,e,t){return e&&Br(i.prototype,e),t&&Br(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}function io(i){var e=Tc(i,"string");return _e(e)=="symbol"?e:e+""}function Tc(i,e){if(_e(i)!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(_e(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(i)}var Tt="tus-v1",Ct="ietf-draft-03",Me="ietf-draft-05",Cc={endpoint:null,uploadUrl:null,metadata:{},metadataForPartialUploads:{},fingerprint:null,uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,onUploadUrlAvailable:null,overridePatchMethod:!1,headers:{},addRequestId:!1,onBeforeRequest:null,onAfterResponse:null,onShouldRetry:no,chunkSize:Number.POSITIVE_INFINITY,retryDelays:[0,1e3,3e3,5e3],parallelUploads:1,parallelUploadBoundaries:null,storeFingerprintForResuming:!0,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1,urlStorage:null,fileReader:null,httpStack:null,protocol:Tt},Ot=(function(){function i(e,t){Fc(this,i),"resume"in t&&console.log("tus: The `resume` option has been removed in tus-js-client v2. Please use the URL storage API instead."),this.options=t,this.options.chunkSize=Number(this.options.chunkSize),this._urlStorage=this.options.urlStorage,this.file=e,this.url=null,this._req=null,this._fingerprint=null,this._urlStorageKey=null,this._offset=null,this._aborted=!1,this._size=null,this._source=null,this._retryAttempt=0,this._retryTimeout=null,this._offsetBeforeRetry=0,this._parallelUploads=null,this._parallelUploadUrls=null}return Pc(i,[{key:"findPreviousUploads",value:function(){var t=this;return this.options.fingerprint(this.file,this.options).then(function(n){return t._urlStorage.findUploadsByFingerprint(n)})}},{key:"resumeFromPreviousUpload",value:function(t){this.url=t.uploadUrl||null,this._parallelUploadUrls=t.parallelUploadUrls||null,this._urlStorageKey=t.urlStorageKey}},{key:"start",value:function(){var t=this,n=this.file;if(!n){this._emitError(new Error("tus: no file or stream to upload provided"));return}if(![Tt,Ct,Me].includes(this.options.protocol)){this._emitError(new Error("tus: unsupported protocol ".concat(this.options.protocol)));return}if(!this.options.endpoint&&!this.options.uploadUrl&&!this.url){this._emitError(new Error("tus: neither an endpoint or an upload URL is provided"));return}var r=this.options.retryDelays;if(r!=null&&Object.prototype.toString.call(r)!=="[object Array]"){this._emitError(new Error("tus: the `retryDelays` option must either be an array or null"));return}if(this.options.parallelUploads>1)for(var s=0,o=["uploadUrl","uploadSize","uploadLengthDeferred"];s<o.length;s++){var a=o[s];if(this.options[a]){this._emitError(new Error("tus: cannot use the ".concat(a," option when parallelUploads is enabled")));return}}if(this.options.parallelUploadBoundaries){if(this.options.parallelUploads<=1){this._emitError(new Error("tus: cannot use the `parallelUploadBoundaries` option when `parallelUploads` is disabled"));return}if(this.options.parallelUploads!==this.options.parallelUploadBoundaries.length){this._emitError(new Error("tus: the `parallelUploadBoundaries` must have the same length as the value of `parallelUploads`"));return}}this.options.fingerprint(n,this.options).then(function(l){return t._fingerprint=l,t._source?t._source:t.options.fileReader.openFile(n,t.options.chunkSize)}).then(function(l){if(t._source=l,t.options.uploadLengthDeferred)t._size=null;else if(t.options.uploadSize!=null){if(t._size=Number(t.options.uploadSize),Number.isNaN(t._size)){t._emitError(new Error("tus: cannot convert `uploadSize` option into a number"));return}}else if(t._size=t._source.size,t._size==null){t._emitError(new Error("tus: cannot automatically derive upload's size from input. Specify it manually using the `uploadSize` option or use the `uploadLengthDeferred` option"));return}t.options.parallelUploads>1||t._parallelUploadUrls!=null?t._startParallelUpload():t._startSingleUpload()}).catch(function(l){t._emitError(l)})}},{key:"_startParallelUpload",value:function(){var t,n=this,r=this._size,s=0;this._parallelUploads=[];var o=this._parallelUploadUrls!=null?this._parallelUploadUrls.length:this.options.parallelUploads,a=(t=this.options.parallelUploadBoundaries)!==null&&t!==void 0?t:kc(this._source.size,o);this._parallelUploadUrls&&a.forEach(function(c,h){c.uploadUrl=n._parallelUploadUrls[h]||null}),this._parallelUploadUrls=new Array(a.length);var l=a.map(function(c,h){var b=0;return n._source.slice(c.start,c.end).then(function(v){var E=v.value;return new Promise(function(T,U){var S=Fe(Fe({},n.options),{},{uploadUrl:c.uploadUrl||null,storeFingerprintForResuming:!1,removeFingerprintOnSuccess:!1,parallelUploads:1,parallelUploadBoundaries:null,metadata:n.options.metadataForPartialUploads,headers:Fe(Fe({},n.options.headers),{},{"Upload-Concat":"partial"}),onSuccess:T,onError:U,onProgress:function(_){s=s-b+_,b=_,n._emitProgress(s,r)},onUploadUrlAvailable:function(){n._parallelUploadUrls[h]=m.url,n._parallelUploadUrls.filter(function(_){return!!_}).length===a.length&&n._saveUploadInUrlStorage()}}),m=new i(E,S);m.start(),n._parallelUploads.push(m)})})}),u;Promise.all(l).then(function(){u=n._openRequest("POST",n.options.endpoint),u.setHeader("Upload-Concat","final;".concat(n._parallelUploadUrls.join(" ")));var c=Lr(n.options.metadata);return c!==""&&u.setHeader("Upload-Metadata",c),n._sendRequest(u,null)}).then(function(c){if(!Pe(c.getStatus(),200)){n._emitHttpError(u,c,"tus: unexpected response while creating upload");return}var h=c.getHeader("Location");if(h==null){n._emitHttpError(u,c,"tus: invalid or missing Location header");return}n.url=jr(n.options.endpoint,h),"Created upload at ".concat(n.url),n._emitSuccess(c)}).catch(function(c){n._emitError(c)})}},{key:"_startSingleUpload",value:function(){if(this._aborted=!1,this.url!=null){"Resuming upload from previous URL: ".concat(this.url),this._resumeUpload();return}if(this.options.uploadUrl!=null){"Resuming upload from provided URL: ".concat(this.options.uploadUrl),this.url=this.options.uploadUrl,this._resumeUpload();return}this._createUpload()}},{key:"abort",value:function(t){var n=this;if(this._parallelUploads!=null){var r=wc(this._parallelUploads),s;try{for(r.s();!(s=r.n()).done;){var o=s.value;o.abort(t)}}catch(a){r.e(a)}finally{r.f()}}return this._req!==null&&this._req.abort(),this._aborted=!0,this._retryTimeout!=null&&(clearTimeout(this._retryTimeout),this._retryTimeout=null),!t||this.url==null?Promise.resolve():i.terminate(this.url,this.options).then(function(){return n._removeFromUrlStorage()})}},{key:"_emitHttpError",value:function(t,n,r,s){this._emitError(new gt(r,s,t,n))}},{key:"_emitError",value:function(t){var n=this;if(!this._aborted){if(this.options.retryDelays!=null){var r=this._offset!=null&&this._offset>this._offsetBeforeRetry;if(r&&(this._retryAttempt=0),zr(t,this._retryAttempt,this.options)){var s=this.options.retryDelays[this._retryAttempt++];this._offsetBeforeRetry=this._offset,this._retryTimeout=setTimeout(function(){n.start()},s);return}}if(typeof this.options.onError=="function")this.options.onError(t);else throw t}}},{key:"_emitSuccess",value:function(t){this.options.removeFingerprintOnSuccess&&this._removeFromUrlStorage(),typeof this.options.onSuccess=="function"&&this.options.onSuccess({lastResponse:t})}},{key:"_emitProgress",value:function(t,n){typeof this.options.onProgress=="function"&&this.options.onProgress(t,n)}},{key:"_emitChunkComplete",value:function(t,n,r){typeof this.options.onChunkComplete=="function"&&this.options.onChunkComplete(t,n,r)}},{key:"_createUpload",value:function(){var t=this;if(!this.options.endpoint){this._emitError(new Error("tus: unable to create upload because no endpoint is provided"));return}var n=this._openRequest("POST",this.options.endpoint);this.options.uploadLengthDeferred?n.setHeader("Upload-Defer-Length","1"):n.setHeader("Upload-Length","".concat(this._size));var r=Lr(this.options.metadata);r!==""&&n.setHeader("Upload-Metadata",r);var s;this.options.uploadDataDuringCreation&&!this.options.uploadLengthDeferred?(this._offset=0,s=this._addChunkToRequest(n)):((this.options.protocol===Ct||this.options.protocol===Me)&&n.setHeader("Upload-Complete","?0"),s=this._sendRequest(n,null)),s.then(function(o){if(!Pe(o.getStatus(),200)){t._emitHttpError(n,o,"tus: unexpected response while creating upload");return}var a=o.getHeader("Location");if(a==null){t._emitHttpError(n,o,"tus: invalid or missing Location header");return}if(t.url=jr(t.options.endpoint,a),"Created upload at ".concat(t.url),typeof t.options.onUploadUrlAvailable=="function"&&t.options.onUploadUrlAvailable(),t._size===0){t._emitSuccess(o),t._source.close();return}t._saveUploadInUrlStorage().then(function(){t.options.uploadDataDuringCreation?t._handleUploadResponse(n,o):(t._offset=0,t._performUpload())})}).catch(function(o){t._emitHttpError(n,null,"tus: failed to create upload",o)})}},{key:"_resumeUpload",value:function(){var t=this,n=this._openRequest("HEAD",this.url),r=this._sendRequest(n,null);r.then(function(s){var o=s.getStatus();if(!Pe(o,200)){if(o===423){t._emitHttpError(n,s,"tus: upload is currently locked; retry later");return}if(Pe(o,400)&&t._removeFromUrlStorage(),!t.options.endpoint){t._emitHttpError(n,s,"tus: unable to resume upload (new upload cannot be created without an endpoint)");return}t.url=null,t._createUpload();return}var a=Number.parseInt(s.getHeader("Upload-Offset"),10);if(Number.isNaN(a)){t._emitHttpError(n,s,"tus: invalid or missing offset value");return}var l=Number.parseInt(s.getHeader("Upload-Length"),10);if(Number.isNaN(l)&&!t.options.uploadLengthDeferred&&t.options.protocol===Tt){t._emitHttpError(n,s,"tus: invalid or missing length value");return}typeof t.options.onUploadUrlAvailable=="function"&&t.options.onUploadUrlAvailable(),t._saveUploadInUrlStorage().then(function(){if(a===l){t._emitProgress(l,l),t._emitSuccess(s);return}t._offset=a,t._performUpload()})}).catch(function(s){t._emitHttpError(n,null,"tus: failed to resume upload",s)})}},{key:"_performUpload",value:function(){var t=this;if(!this._aborted){var n;this.options.overridePatchMethod?(n=this._openRequest("POST",this.url),n.setHeader("X-HTTP-Method-Override","PATCH")):n=this._openRequest("PATCH",this.url),n.setHeader("Upload-Offset","".concat(this._offset));var r=this._addChunkToRequest(n);r.then(function(s){if(!Pe(s.getStatus(),200)){t._emitHttpError(n,s,"tus: unexpected response while uploading chunk");return}t._handleUploadResponse(n,s)}).catch(function(s){t._aborted||t._emitHttpError(n,null,"tus: failed to upload chunk at offset ".concat(t._offset),s)})}}},{key:"_addChunkToRequest",value:function(t){var n=this,r=this._offset,s=this._offset+this.options.chunkSize;return t.setProgressHandler(function(o){n._emitProgress(r+o,n._size)}),this.options.protocol===Tt?t.setHeader("Content-Type","application/offset+octet-stream"):this.options.protocol===Me&&t.setHeader("Content-Type","application/partial-upload"),(s===Number.POSITIVE_INFINITY||s>this._size)&&!this.options.uploadLengthDeferred&&(s=this._size),this._source.slice(r,s).then(function(o){var a=o.value,l=o.done,u=a!=null&&a.size?a.size:0;n.options.uploadLengthDeferred&&l&&(n._size=n._offset+u,t.setHeader("Upload-Length","".concat(n._size)));var c=n._offset+u;return!n.options.uploadLengthDeferred&&l&&c!==n._size?Promise.reject(new Error("upload was configured with a size of ".concat(n._size," bytes, but the source is done after ").concat(c," bytes"))):a===null?n._sendRequest(t):((n.options.protocol===Ct||n.options.protocol===Me)&&t.setHeader("Upload-Complete",l?"?1":"?0"),n._emitProgress(n._offset,n._size),n._sendRequest(t,a))})}},{key:"_handleUploadResponse",value:function(t,n){var r=Number.parseInt(n.getHeader("Upload-Offset"),10);if(Number.isNaN(r)){this._emitHttpError(t,n,"tus: invalid or missing offset value");return}if(this._emitProgress(r,this._size),this._emitChunkComplete(r-this._offset,r,this._size),this._offset=r,r===this._size){this._emitSuccess(n),this._source.close();return}this._performUpload()}},{key:"_openRequest",value:function(t,n){var r=Mr(t,n,this.options);return this._req=r,r}},{key:"_removeFromUrlStorage",value:function(){var t=this;this._urlStorageKey&&(this._urlStorage.removeUpload(this._urlStorageKey).catch(function(n){t._emitError(n)}),this._urlStorageKey=null)}},{key:"_saveUploadInUrlStorage",value:function(){var t=this;if(!this.options.storeFingerprintForResuming||!this._fingerprint||this._urlStorageKey!==null)return Promise.resolve();var n={size:this._size,metadata:this.options.metadata,creationTime:new Date().toString()};return this._parallelUploads?n.parallelUploadUrls=this._parallelUploadUrls:n.uploadUrl=this.url,this._urlStorage.addUpload(this._fingerprint,n).then(function(r){t._urlStorageKey=r})}},{key:"_sendRequest",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return $r(t,n,this.options)}}],[{key:"terminate",value:function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=Mr("DELETE",t,n);return $r(r,null,n).then(function(s){if(s.getStatus()!==204)throw new gt("tus: unexpected response while terminating upload",null,r,s)}).catch(function(s){if(s instanceof gt||(s=new gt("tus: failed to terminate upload",s,r,null)),!zr(s,0,n))throw s;var o=n.retryDelays[0],a=n.retryDelays.slice(1),l=Fe(Fe({},n),{},{retryDelays:a});return new Promise(function(u){return setTimeout(u,o)}).then(function(){return i.terminate(t,l)})})}}])})();function Lr(i){return Object.entries(i).map(function(e){var t=eo(e,2),n=t[0],r=t[1];return"".concat(n," ").concat(dc.encode(String(r)))}).join(",")}function Pe(i,e){return i>=e&&i<e+100}function Mr(i,e,t){var n=t.httpStack.createRequest(i,e);t.protocol===Ct?n.setHeader("Upload-Draft-Interop-Version","5"):t.protocol===Me?n.setHeader("Upload-Draft-Interop-Version","6"):n.setHeader("Tus-Resumable","1.0.0");for(var r=t.headers||{},s=0,o=Object.entries(r);s<o.length;s++){var a=eo(o[s],2),l=a[0],u=a[1];n.setHeader(l,u)}if(t.addRequestId){var c=gc();n.setHeader("X-Request-ID",c)}return n}function $r(i,e,t){return Ii.apply(this,arguments)}function Ii(){return Ii=yc(Ri().mark(function i(e,t,n){var r;return Ri().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(typeof n.onBeforeRequest!="function"){o.next=3;break}return o.next=3,n.onBeforeRequest(e);case 3:return o.next=5,e.send(t);case 5:if(r=o.sent,typeof n.onAfterResponse!="function"){o.next=9;break}return o.next=9,n.onAfterResponse(e,r);case 9:return o.abrupt("return",r);case 10:case"end":return o.stop()}},i)})),Ii.apply(this,arguments)}function Ec(){var i=!0;return typeof navigator<"u"&&navigator.onLine===!1&&(i=!1),i}function zr(i,e,t){return t.retryDelays==null||e>=t.retryDelays.length||i.originalRequest==null?!1:t&&typeof t.onShouldRetry=="function"?t.onShouldRetry(i,e,t):no(i)}function no(i){var e=i.originalResponse?i.originalResponse.getStatus():0;return(!Pe(e,400)||e===409||e===423)&&Ec()}function jr(i,e){return new mc(e,i).toString()}function kc(i,e){for(var t=Math.floor(i/e),n=[],r=0;r<e;r++)n.push({start:t*r,end:t*(r+1)});return n[e-1].end=i,n}Ot.defaultOptions=Cc;var ro=function(){return typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative"};function Uc(i){return new Promise(function(e,t){var n=new XMLHttpRequest;n.responseType="blob",n.onload=function(){var r=n.response;e(r)},n.onerror=function(r){t(r)},n.open("GET",i),n.send()})}var xc=function(){return typeof window<"u"&&(typeof window.PhoneGap<"u"||typeof window.Cordova<"u"||typeof window.cordova<"u")};function Oc(i){return new Promise(function(e,t){var n=new FileReader;n.onload=function(){var r=new Uint8Array(n.result);e({value:r})},n.onerror=function(r){t(r)},n.readAsArrayBuffer(i)})}function Ye(i){"@babel/helpers - typeof";return Ye=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ye(i)}function Ac(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function Rc(i,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,Dc(n.key),n)}}function Ic(i,e,t){return e&&Rc(i.prototype,e),Object.defineProperty(i,"prototype",{writable:!1}),i}function Dc(i){var e=Nc(i,"string");return Ye(e)=="symbol"?e:e+""}function Nc(i,e){if(Ye(i)!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(Ye(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(i)}var qr=(function(){function i(e){Ac(this,i),this._file=e,this.size=e.size}return Ic(i,[{key:"slice",value:function(t,n){if(xc())return Oc(this._file.slice(t,n));var r=this._file.slice(t,n),s=n>=this.size;return Promise.resolve({value:r,done:s})}},{key:"close",value:function(){}}])})();function Qe(i){"@babel/helpers - typeof";return Qe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qe(i)}function Bc(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function Lc(i,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,$c(n.key),n)}}function Mc(i,e,t){return e&&Lc(i.prototype,e),Object.defineProperty(i,"prototype",{writable:!1}),i}function $c(i){var e=zc(i,"string");return Qe(e)=="symbol"?e:e+""}function zc(i,e){if(Qe(i)!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(Qe(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(i)}function Hr(i){return i===void 0?0:i.size!==void 0?i.size:i.length}function jc(i,e){if(i.concat)return i.concat(e);if(i instanceof Blob)return new Blob([i,e],{type:i.type});if(i.set){var t=new i.constructor(i.length+e.length);return t.set(i),t.set(e,i.length),t}throw new Error("Unknown data type")}var qc=(function(){function i(e){Bc(this,i),this._buffer=void 0,this._bufferOffset=0,this._reader=e,this._done=!1}return Mc(i,[{key:"slice",value:function(t,n){return t<this._bufferOffset?Promise.reject(new Error("Requested data is before the reader's current offset")):this._readUntilEnoughDataOrDone(t,n)}},{key:"_readUntilEnoughDataOrDone",value:function(t,n){var r=this,s=n<=this._bufferOffset+Hr(this._buffer);if(this._done||s){var o=this._getDataFromBuffer(t,n),a=o==null?this._done:!1;return Promise.resolve({value:o,done:a})}return this._reader.read().then(function(l){var u=l.value,c=l.done;return c?r._done=!0:r._buffer===void 0?r._buffer=u:r._buffer=jc(r._buffer,u),r._readUntilEnoughDataOrDone(t,n)})}},{key:"_getDataFromBuffer",value:function(t,n){t>this._bufferOffset&&(this._buffer=this._buffer.slice(t-this._bufferOffset),this._bufferOffset=t);var r=Hr(this._buffer)===0;return this._done&&r?null:this._buffer.slice(0,n-t)}},{key:"close",value:function(){this._reader.cancel&&this._reader.cancel()}}])})();function we(i){"@babel/helpers - typeof";return we=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},we(i)}function Di(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Di=function(){return e};var i,e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(g,p,f){g[p]=f.value},s=typeof Symbol=="function"?Symbol:{},o=s.iterator||"@@iterator",a=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function u(g,p,f){return Object.defineProperty(g,p,{value:f,enumerable:!0,configurable:!0,writable:!0}),g[p]}try{u({},"")}catch{u=function(f,F,C){return f[F]=C}}function c(g,p,f,F){var C=p&&p.prototype instanceof S?p:S,P=Object.create(C.prototype),I=new q(F||[]);return r(P,"_invoke",{value:z(g,f,I)}),P}function h(g,p,f){try{return{type:"normal",arg:g.call(p,f)}}catch(F){return{type:"throw",arg:F}}}e.wrap=c;var b="suspendedStart",v="suspendedYield",E="executing",T="completed",U={};function S(){}function m(){}function y(){}var _={};u(_,o,function(){return this});var w=Object.getPrototypeOf,x=w&&w(w(J([])));x&&x!==t&&n.call(x,o)&&(_=x);var O=y.prototype=S.prototype=Object.create(_);function R(g){["next","throw","return"].forEach(function(p){u(g,p,function(f){return this._invoke(p,f)})})}function A(g,p){function f(C,P,I,B){var L=h(g[C],g,P);if(L.type!=="throw"){var ee=L.arg,X=ee.value;return X&&we(X)=="object"&&n.call(X,"__await")?p.resolve(X.__await).then(function(te){f("next",te,I,B)},function(te){f("throw",te,I,B)}):p.resolve(X).then(function(te){ee.value=te,I(ee)},function(te){return f("throw",te,I,B)})}B(L.arg)}var F;r(this,"_invoke",{value:function(P,I){function B(){return new p(function(L,ee){f(P,I,L,ee)})}return F=F?F.then(B,B):B()}})}function z(g,p,f){var F=b;return function(C,P){if(F===E)throw Error("Generator is already running");if(F===T){if(C==="throw")throw P;return{value:i,done:!0}}for(f.method=C,f.arg=P;;){var I=f.delegate;if(I){var B=M(I,f);if(B){if(B===U)continue;return B}}if(f.method==="next")f.sent=f._sent=f.arg;else if(f.method==="throw"){if(F===b)throw F=T,f.arg;f.dispatchException(f.arg)}else f.method==="return"&&f.abrupt("return",f.arg);F=E;var L=h(g,p,f);if(L.type==="normal"){if(F=f.done?T:v,L.arg===U)continue;return{value:L.arg,done:f.done}}L.type==="throw"&&(F=T,f.method="throw",f.arg=L.arg)}}}function M(g,p){var f=p.method,F=g.iterator[f];if(F===i)return p.delegate=null,f==="throw"&&g.iterator.return&&(p.method="return",p.arg=i,M(g,p),p.method==="throw")||f!=="return"&&(p.method="throw",p.arg=new TypeError("The iterator does not provide a '"+f+"' method")),U;var C=h(F,g.iterator,p.arg);if(C.type==="throw")return p.method="throw",p.arg=C.arg,p.delegate=null,U;var P=C.arg;return P?P.done?(p[g.resultName]=P.value,p.next=g.nextLoc,p.method!=="return"&&(p.method="next",p.arg=i),p.delegate=null,U):P:(p.method="throw",p.arg=new TypeError("iterator result is not an object"),p.delegate=null,U)}function V(g){var p={tryLoc:g[0]};1 in g&&(p.catchLoc=g[1]),2 in g&&(p.finallyLoc=g[2],p.afterLoc=g[3]),this.tryEntries.push(p)}function k(g){var p=g.completion||{};p.type="normal",delete p.arg,g.completion=p}function q(g){this.tryEntries=[{tryLoc:"root"}],g.forEach(V,this),this.reset(!0)}function J(g){if(g||g===""){var p=g[o];if(p)return p.call(g);if(typeof g.next=="function")return g;if(!isNaN(g.length)){var f=-1,F=function C(){for(;++f<g.length;)if(n.call(g,f))return C.value=g[f],C.done=!1,C;return C.value=i,C.done=!0,C};return F.next=F}}throw new TypeError(we(g)+" is not iterable")}return m.prototype=y,r(O,"constructor",{value:y,configurable:!0}),r(y,"constructor",{value:m,configurable:!0}),m.displayName=u(y,l,"GeneratorFunction"),e.isGeneratorFunction=function(g){var p=typeof g=="function"&&g.constructor;return!!p&&(p===m||(p.displayName||p.name)==="GeneratorFunction")},e.mark=function(g){return Object.setPrototypeOf?Object.setPrototypeOf(g,y):(g.__proto__=y,u(g,l,"GeneratorFunction")),g.prototype=Object.create(O),g},e.awrap=function(g){return{__await:g}},R(A.prototype),u(A.prototype,a,function(){return this}),e.AsyncIterator=A,e.async=function(g,p,f,F,C){C===void 0&&(C=Promise);var P=new A(c(g,p,f,F),C);return e.isGeneratorFunction(p)?P:P.next().then(function(I){return I.done?I.value:P.next()})},R(O),u(O,l,"Generator"),u(O,o,function(){return this}),u(O,"toString",function(){return"[object Generator]"}),e.keys=function(g){var p=Object(g),f=[];for(var F in p)f.push(F);return f.reverse(),function C(){for(;f.length;){var P=f.pop();if(P in p)return C.value=P,C.done=!1,C}return C.done=!0,C}},e.values=J,q.prototype={constructor:q,reset:function(p){if(this.prev=0,this.next=0,this.sent=this._sent=i,this.done=!1,this.delegate=null,this.method="next",this.arg=i,this.tryEntries.forEach(k),!p)for(var f in this)f.charAt(0)==="t"&&n.call(this,f)&&!isNaN(+f.slice(1))&&(this[f]=i)},stop:function(){this.done=!0;var p=this.tryEntries[0].completion;if(p.type==="throw")throw p.arg;return this.rval},dispatchException:function(p){if(this.done)throw p;var f=this;function F(ee,X){return I.type="throw",I.arg=p,f.next=ee,X&&(f.method="next",f.arg=i),!!X}for(var C=this.tryEntries.length-1;C>=0;--C){var P=this.tryEntries[C],I=P.completion;if(P.tryLoc==="root")return F("end");if(P.tryLoc<=this.prev){var B=n.call(P,"catchLoc"),L=n.call(P,"finallyLoc");if(B&&L){if(this.prev<P.catchLoc)return F(P.catchLoc,!0);if(this.prev<P.finallyLoc)return F(P.finallyLoc)}else if(B){if(this.prev<P.catchLoc)return F(P.catchLoc,!0)}else{if(!L)throw Error("try statement without catch or finally");if(this.prev<P.finallyLoc)return F(P.finallyLoc)}}}},abrupt:function(p,f){for(var F=this.tryEntries.length-1;F>=0;--F){var C=this.tryEntries[F];if(C.tryLoc<=this.prev&&n.call(C,"finallyLoc")&&this.prev<C.finallyLoc){var P=C;break}}P&&(p==="break"||p==="continue")&&P.tryLoc<=f&&f<=P.finallyLoc&&(P=null);var I=P?P.completion:{};return I.type=p,I.arg=f,P?(this.method="next",this.next=P.finallyLoc,U):this.complete(I)},complete:function(p,f){if(p.type==="throw")throw p.arg;return p.type==="break"||p.type==="continue"?this.next=p.arg:p.type==="return"?(this.rval=this.arg=p.arg,this.method="return",this.next="end"):p.type==="normal"&&f&&(this.next=f),U},finish:function(p){for(var f=this.tryEntries.length-1;f>=0;--f){var F=this.tryEntries[f];if(F.finallyLoc===p)return this.complete(F.completion,F.afterLoc),k(F),U}},catch:function(p){for(var f=this.tryEntries.length-1;f>=0;--f){var F=this.tryEntries[f];if(F.tryLoc===p){var C=F.completion;if(C.type==="throw"){var P=C.arg;k(F)}return P}}throw Error("illegal catch attempt")},delegateYield:function(p,f,F){return this.delegate={iterator:J(p),resultName:f,nextLoc:F},this.method==="next"&&(this.arg=i),U}},e}function Vr(i,e,t,n,r,s,o){try{var a=i[s](o),l=a.value}catch(u){t(u);return}a.done?e(l):Promise.resolve(l).then(n,r)}function Hc(i){return function(){var e=this,t=arguments;return new Promise(function(n,r){var s=i.apply(e,t);function o(l){Vr(s,n,r,o,a,"next",l)}function a(l){Vr(s,n,r,o,a,"throw",l)}o(void 0)})}}function Vc(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function Wc(i,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,Kc(n.key),n)}}function Gc(i,e,t){return e&&Wc(i.prototype,e),Object.defineProperty(i,"prototype",{writable:!1}),i}function Kc(i){var e=Xc(i,"string");return we(e)=="symbol"?e:e+""}function Xc(i,e){if(we(i)!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(we(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(i)}var Yc=(function(){function i(){Vc(this,i)}return Gc(i,[{key:"openFile",value:(function(){var e=Hc(Di().mark(function n(r,s){var o;return Di().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(!(ro()&&r&&typeof r.uri<"u")){l.next=11;break}return l.prev=1,l.next=4,Uc(r.uri);case 4:return o=l.sent,l.abrupt("return",new qr(o));case 8:throw l.prev=8,l.t0=l.catch(1),new Error("tus: cannot fetch `file.uri` as Blob, make sure the uri is correct and accessible. ".concat(l.t0));case 11:if(!(typeof r.slice=="function"&&typeof r.size<"u")){l.next=13;break}return l.abrupt("return",Promise.resolve(new qr(r)));case 13:if(typeof r.read!="function"){l.next=18;break}if(s=Number(s),Number.isFinite(s)){l.next=17;break}return l.abrupt("return",Promise.reject(new Error("cannot create source for stream without a finite value for the `chunkSize` option")));case 17:return l.abrupt("return",Promise.resolve(new qc(r,s)));case 18:return l.abrupt("return",Promise.reject(new Error("source object may only be an instance of File, Blob, or Reader in this environment")));case 19:case"end":return l.stop()}},n,null,[[1,8]])}));function t(n,r){return e.apply(this,arguments)}return t})()}])})();function Qc(i,e){return ro()?Promise.resolve(Zc(i,e)):Promise.resolve(["tus-br",i.name,i.type,i.size,i.lastModified,e.endpoint].join("-"))}function Zc(i,e){var t=i.exif?Jc(JSON.stringify(i.exif)):"noexif";return["tus-rn",i.name||"noname",i.size||"nosize",t,e.endpoint].join("/")}function Jc(i){var e=0;if(i.length===0)return e;for(var t=0;t<i.length;t++){var n=i.charCodeAt(t);e=(e<<5)-e+n,e&=e}return e}function Ze(i){"@babel/helpers - typeof";return Ze=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ze(i)}function on(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function eh(i,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,th(n.key),n)}}function an(i,e,t){return e&&eh(i.prototype,e),Object.defineProperty(i,"prototype",{writable:!1}),i}function th(i){var e=ih(i,"string");return Ze(e)=="symbol"?e:e+""}function ih(i,e){if(Ze(i)!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(Ze(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(i)}var nh=(function(){function i(){on(this,i)}return an(i,[{key:"createRequest",value:function(t,n){return new rh(t,n)}},{key:"getName",value:function(){return"XHRHttpStack"}}])})(),rh=(function(){function i(e,t){on(this,i),this._xhr=new XMLHttpRequest,this._xhr.open(e,t,!0),this._method=e,this._url=t,this._headers={}}return an(i,[{key:"getMethod",value:function(){return this._method}},{key:"getURL",value:function(){return this._url}},{key:"setHeader",value:function(t,n){this._xhr.setRequestHeader(t,n),this._headers[t]=n}},{key:"getHeader",value:function(t){return this._headers[t]}},{key:"setProgressHandler",value:function(t){"upload"in this._xhr&&(this._xhr.upload.onprogress=function(n){n.lengthComputable&&t(n.loaded)})}},{key:"send",value:function(){var t=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return new Promise(function(r,s){t._xhr.onload=function(){r(new sh(t._xhr))},t._xhr.onerror=function(o){s(o)},t._xhr.send(n)})}},{key:"abort",value:function(){return this._xhr.abort(),Promise.resolve()}},{key:"getUnderlyingObject",value:function(){return this._xhr}}])})(),sh=(function(){function i(e){on(this,i),this._xhr=e}return an(i,[{key:"getStatus",value:function(){return this._xhr.status}},{key:"getHeader",value:function(t){return this._xhr.getResponseHeader(t)}},{key:"getBody",value:function(){return this._xhr.responseText}},{key:"getUnderlyingObject",value:function(){return this._xhr}}])})();function Je(i){"@babel/helpers - typeof";return Je=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Je(i)}function oh(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function ah(i,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,uh(n.key),n)}}function lh(i,e,t){return e&&ah(i.prototype,e),Object.defineProperty(i,"prototype",{writable:!1}),i}function uh(i){var e=dh(i,"string");return Je(e)=="symbol"?e:e+""}function dh(i,e){if(Je(i)!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(Je(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(i)}var Ni=!1;try{Ni="localStorage"in window;var yi="tusSupport",Wr=localStorage.getItem(yi);localStorage.setItem(yi,Wr),Wr===null&&localStorage.removeItem(yi)}catch(i){if(i.code===i.SECURITY_ERR||i.code===i.QUOTA_EXCEEDED_ERR)Ni=!1;else throw i}var ch=Ni,hh=(function(){function i(){oh(this,i)}return lh(i,[{key:"findAllUploads",value:function(){var t=this._findEntries("tus::");return Promise.resolve(t)}},{key:"findUploadsByFingerprint",value:function(t){var n=this._findEntries("tus::".concat(t,"::"));return Promise.resolve(n)}},{key:"removeUpload",value:function(t){return localStorage.removeItem(t),Promise.resolve()}},{key:"addUpload",value:function(t,n){var r=Math.round(Math.random()*1e12),s="tus::".concat(t,"::").concat(r);return localStorage.setItem(s,JSON.stringify(n)),Promise.resolve(s)}},{key:"_findEntries",value:function(t){for(var n=[],r=0;r<localStorage.length;r++){var s=localStorage.key(r);if(s.indexOf(t)===0)try{var o=JSON.parse(localStorage.getItem(s));o.urlStorageKey=s,n.push(o)}catch{}}return n}}])})();function Oe(i){"@babel/helpers - typeof";return Oe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oe(i)}function ph(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function fh(i,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,oo(n.key),n)}}function mh(i,e,t){return t&&fh(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}function gh(i,e,t){return e=At(e),yh(i,so()?Reflect.construct(e,t||[],At(i).constructor):e.apply(i,t))}function yh(i,e){if(e&&(Oe(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bh(i)}function bh(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function so(){try{var i=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(so=function(){return!!i})()}function At(i){return At=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},At(i)}function vh(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&Bi(i,e)}function Bi(i,e){return Bi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Bi(i,e)}function Gr(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function Ee(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Gr(Object(t),!0).forEach(function(n){_h(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):Gr(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function _h(i,e,t){return e=oo(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function oo(i){var e=wh(i,"string");return Oe(e)=="symbol"?e:e+""}function wh(i,e){if(Oe(i)!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(Oe(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}var Li=Ee(Ee({},Ot.defaultOptions),{},{httpStack:new nh,fileReader:new Yc,urlStorage:ch?new hh:new Jd,fingerprint:Qc}),Sh=(function(i){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ph(this,e),n=Ee(Ee({},Li),n),gh(this,e,[t,n])}return vh(e,i),mh(e,null,[{key:"terminate",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return r=Ee(Ee({},Li),r),Ot.terminate(n,r)}}])})(Ot);const Fh="4.3.2",Ph={version:Fh};function Th(){return typeof window<"u"&&(typeof window.PhoneGap<"u"||typeof window.Cordova<"u"||typeof window.cordova<"u")}function Ch(){return typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative"}function Eh(i){return(e,t)=>{if(Th()||Ch())return Li.fingerprint(e,t);const n=["tus",i.id,t.endpoint].join("-");return Promise.resolve(n)}}const ao={endpoint:"",uploadUrl:null,metadata:{},uploadSize:null,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,overridePatchMethod:!1,headers:{},addRequestId:!1,chunkSize:1/0,retryDelays:[100,1e3,3e3,5e3],parallelUploads:1,removeFingerprintOnSuccess:!1,uploadLengthDeferred:!1,uploadDataDuringCreation:!1},kh={limit:20,retryDelays:ao.retryDelays,withCredentials:!1,allowedMetaFields:!0};class Uh extends $i{static VERSION=Ph.version;#e;requests;uploaders;uploaderEvents;constructor(e,t){if(super(e,{...kh,...t}),this.type="uploader",this.id=this.opts.id||"Tus",t?.allowedMetaFields===void 0&&"metaFields"in this.opts)throw new Error("The `metaFields` option has been renamed to `allowedMetaFields`.");if("autoRetry"in t)throw new Error("The `autoRetry` option was deprecated and has been removed.");this.requests=this.opts.rateLimitedQueue??new Md(this.opts.limit),this.#e=this.opts.retryDelays?.values(),this.uploaders=Object.create(null),this.uploaderEvents=Object.create(null)}resetUploaderReferences(e,t){const n=this.uploaders[e];n&&(n.abort(),t?.abort&&n.abort(!0),this.uploaders[e]=null),this.uploaderEvents[e]&&(this.uploaderEvents[e].remove(),this.uploaderEvents[e]=null)}#t(e){return this.resetUploaderReferences(e.id),new Promise((t,n)=>{let r,s,o;const a={...this.opts,...e.tus||{}};typeof a.headers=="function"&&(a.headers=a.headers(e));const{onShouldRetry:l,onBeforeRequest:u,...c}=a,h={...ao,...c};h.fingerprint=Eh(e),h.onBeforeRequest=async S=>{const m=S.getUnderlyingObject();m.withCredentials=!!a.withCredentials;let y;if(typeof u=="function"&&(y=u(S,e)),fi(r,"shouldBeRequeued")){if(!r.shouldBeRequeued)return Promise.reject();let _;const w=new Promise(x=>{_=x});r=this.requests.run(()=>(e.isPaused&&r.abort(),_(),()=>{})),await Promise.all([w,y]);return}return y},h.onError=S=>{this.uppy.log(S);const m=S.originalRequest!=null?S.originalRequest.getUnderlyingObject():null;Nd(m)&&(S=new Bd(S,m)),this.resetUploaderReferences(e.id),r?.abort(),typeof a.onError=="function"&&a.onError(S),n(S)},h.onProgress=(S,m)=>{this.onReceiveUploadUrl(e,o.url),typeof a.onProgress=="function"&&a.onProgress(S,m);const y=this.uppy.getFile(e.id);this.uppy.emit("upload-progress",y,{uploadStarted:y.progress.uploadStarted??0,bytesUploaded:S,bytesTotal:m})},h.onSuccess=S=>{const m={uploadURL:o.url??void 0,status:200,body:{xhr:S.lastResponse.getUnderlyingObject()}};if(this.uppy.emit("upload-success",this.uppy.getFile(e.id),m),this.resetUploaderReferences(e.id),r.done(),o.url){const{name:y}=o.file;this.uppy.log(`Download ${y} from ${o.url}`)}typeof a.onSuccess=="function"&&a.onSuccess(S),t(o)};const b=S=>{const m=S?.originalResponse?.getStatus();if(m===429){if(!this.requests.isPaused){const y=this.#e?.next();if(y==null||y.done)return!1;this.requests.rateLimit(y.value)}}else{if(m!=null&&m>=400&&m<500&&m!==409&&m!==423)return!1;typeof navigator<"u"&&navigator.onLine===!1&&(this.requests.isPaused||(this.requests.pause(),window.addEventListener("online",()=>{this.requests.resume()},{once:!0})))}return r.abort(),r={shouldBeRequeued:!0,abort(){this.shouldBeRequeued=!1},done(){throw new Error("Cannot mark a queued request as done: this indicates a bug")},fn(){throw new Error("Cannot run a queued request: this indicates a bug")}},!0};l!=null?h.onShouldRetry=(S,m)=>l(S,m,a,b):h.onShouldRetry=b;const v=(S,m,y)=>{fi(S,m)&&!fi(S,y)&&(S[y]=S[m])},E={};Dd(a.allowedMetaFields,e.meta).forEach(S=>{E[S]=String(e.meta[S])}),v(E,"type","filetype"),v(E,"name","filename"),h.metadata=E,o=new Sh(e.data,h),this.uploaders[e.id]=o;const U=new Ad(this.uppy);this.uploaderEvents[e.id]=U,s=()=>(e.isPaused||o.start(),()=>{}),o.findPreviousUploads().then(S=>{const m=S[0];m&&(this.uppy.log(`[Tus] Resuming upload of ${e.id} started at ${m.creationTime}`),o.resumeFromPreviousUpload(m)),r=this.requests.run(s)}),U.onFileRemove(e.id,S=>{r.abort(),this.resetUploaderReferences(e.id,{abort:!!o.url}),t(`upload ${S} was removed`)}),U.onPause(e.id,S=>{r.abort(),S?o.abort():r=this.requests.run(s)}),U.onPauseAll(e.id,()=>{r.abort(),o.abort()}),U.onCancelAll(e.id,()=>{r.abort(),this.resetUploaderReferences(e.id,{abort:!!o.url}),t(`upload ${e.id} was canceled`)}),U.onResumeAll(e.id,()=>{r.abort(),e.error&&o.abort(),r=this.requests.run(s)})}).catch(t=>{throw this.uppy.emit("upload-error",e,t),t})}onReceiveUploadUrl(e,t){const n=this.uppy.getFile(e.id);n&&(!n.tus||n.tus.uploadUrl!==t)&&(this.uppy.log("[Tus] Storing upload url"),this.uppy.setFileState(n.id,{tus:{...n.tus,uploadUrl:t}}))}#n(e){const t={...this.opts};return e.tus&&Object.assign(t,e.tus),typeof t.headers=="function"&&(t.headers=t.headers(e)),{...e.remote?.body,endpoint:t.endpoint,uploadUrl:t.uploadUrl,protocol:"tus",size:e.data.size,headers:t.headers,metadata:e.meta}}async#i(e){const t=Rd(e),n=Id(t);this.uppy.emit("upload-start",n),await Promise.allSettled(t.map(r=>{if(r.isRemote){const s=()=>this.requests,o=new AbortController,a=u=>{u.id===r.id&&o.abort()};this.uppy.on("file-removed",a);const l=this.uppy.getRequestClientForFile(r).uploadRemoteFile(r,this.#n(r),{signal:o.signal,getQueue:s});return this.requests.wrapSyncFunction(()=>{this.uppy.off("file-removed",a)},{priority:-1})(),l}return this.#t(r)}))}#r=async e=>{if(e.length===0){this.uppy.log("[Tus] No files to upload");return}this.opts.limit===0&&this.uppy.log("[Tus] When uploading multiple files at once, consider setting the `limit` option (to `10` for example), to limit the number of concurrent uploads, which helps prevent memory and network issues: https://uppy.io/docs/tus/#limit-0","warning"),this.uppy.log("[Tus] Uploading...");const t=this.uppy.getFilesByIds(e);await this.#i(t)};install(){this.uppy.setState({capabilities:{...this.uppy.getState().capabilities,resumableUploads:!0}}),this.uppy.addUploader(this.#r)}uninstall(){this.uppy.setState({capabilities:{...this.uppy.getState().capabilities,resumableUploads:!1}}),this.uppy.removeUploader(this.#r)}}class xh extends $i{constructor(e,t){super(e,t),this.id=this.opts.id||"UppyBunnyCreator",this.type="modifier"}async create(e){const t=await fetch(`https://video.bunnycdn.com/library/${this.opts.library}/videos`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/*+json",AccessKey:this.opts.access},body:JSON.stringify({title:e.meta.name,thumbnailTime:this.getMsFromTime(e.meta.thumbTime)})});if(!t.ok)throw new Error(`Failed to create video: ${t.status}`);return(await t.json()).guid}prepareUpload=async e=>{const t=e.map(r=>{const s=this.uppy.getFile(r);return this.create(s).then(o=>{this.uppy.setFileMeta(r,{bunnyId:o})}).catch(o=>{this.uppy.log(o,"warning")})}),n=()=>{e.forEach(r=>{const s=this.uppy.getFile(r);this.uppy.emit("preprocess-complete",s)})};return await Promise.all(t),n()};install(){this.uppy.addPreProcessor(this.prepareUpload)}uninstall(){this.uppy.removePreProcessor(this.prepareUpload)}getMsFromTime(e){if(typeof e>"u"||e==null||e=="")return 0;if(!this.validateTime(e))throw this.uppy.info("Falsches Zeitformat für die Thumbnailerstellung.","error",3e3),new Error("Wrong timestamp format for thumbnail creation.");let t=e.split(":");return(+t[0]*60*60+ +t[1]*60+ +t[2])*1e3}validateTime(e){if(!/^(?:[01]\d|2[0-3]):[0-5]\d:[0-5]\d$/.test(e))return!1;const[n,r,s]=e.split(":").map(Number);return!(n<0||n>23||r<0||r>59||s<0||s>59)}}const Oh={components:{PlusIcon:la},inject:["bunnyApiKey","bunnyHostname","bunnyLibrary"],data(){return{expirationTime:0,uploader:null}},methods:{getExpirationTime(){const i=new Date;return i.setDate(i.getDate()+1),i.getTime()},async getAuthorizationSignature(i){const e=this.bunnyLibrary+this.bunnyApiKey+this.expirationTime+i,t=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map(r=>r.toString(16).padStart(2,"0")).join("")},initializeUppy(){this.expirationTime=this.getExpirationTime(),this.uploader=po(new Xi().use(Od,{inline:!1,trigger:"#bunny-upload",width:"auto",proudlyDisplayPoweredByUppy:!1,closeModalOnClickOutside:!0,closeAfterFinish:!0,metaFields:[{id:"name",name:__("Name"),placeholder:__("Filename")},{id:"thumbTime",name:__("Timestamp"),placeholder:__("hh:mm:ss e.g. 00:01:04 for minute 1, second 4")},{id:"bunnyId",name:__("Bunny ID"),render:({value:i},e)=>e("input",{type:"text",class:"uppy-u-reset uppy-c-textInput uppy-Dashboard-FileCard-input bg-gray-300",value:i,placeholder:__("Bunny ID"),disabled:!0},[])}]}).use(xh,{access:this.bunnyApiKey,library:this.bunnyLibrary}).use(Uh,{endpoint:"https://video.bunnycdn.com/tusupload",retryDelays:[0,30,50,3e3,5e3,1e4,6e4],onBeforeRequest:async(i,e)=>{const t=this.uploader.getFile(e.id).meta;if(t.bunnyId){const n=await this.getAuthorizationSignature(t.bunnyId);i.setHeader("AuthorizationSignature",n),i.setHeader("AuthorizationExpire",this.expirationTime),i.setHeader("VideoId",t.bunnyId),i.setHeader("LibraryId",this.bunnyLibrary)}else throw new Error("Missing Bunny video ID")}})),this.uploader.on("complete",i=>{if(i.successful.length>0){const e=i.successful.length===1?__("1 video uploaded successfully."):__(":count videos successfully uploaded.",{count:i.successful.length});console.log(e)}i.failed.length>0&&console.log("Failed files: ",i.failed),be.emit("load")})}},created(){be.on("upload",()=>document.getElementById("bunny-upload").click())},mounted(){this.initializeUppy()}},Ah={class:"btn-primary",id:"bunny-upload"};function Rh(i,e,t,n,r,s){const o=Et("PlusIcon");return H(),K("button",Ah,[pe(o,{class:"h-6 w-6"}),bi(" "+j(i.__("Upload Video")),1)])}const Ih=Ae(Oh,[["render",Rh]]),Dh={},Nh={class:"container w-full lg:w-4/5 mx-auto"},Bh={class:"flex flex-col items-center justify-center gap-2"},Lh={class:"mb-2"},Mh={class:"text-sm"},$h={class:"text-sm"},zh={href:"https://bunny.net?ref=uhvsqhaw0n",target:"_blank",class:"btn-primary my-2"},jh={class:"text-sm"},qh={class:"text-sm"};function Hh(i,e){return H(),K("div",Nh,[D("div",Bh,[D("h1",Lh,j(i.__("Bunny Account Required")),1),D("p",Mh,j(i.__("To use this addon, you'll need a Bunny.net account. Make sure to add your credentials to the .env file.")),1),D("p",$h,j(i.__("If you don't have one yet, you can sign up using our affiliate link.")),1),D("a",zh,j(i.__("Sign Up Now")),1),D("p",jh,j(i.__("By doing so, you'll be supporting the development of this addon at no extra cost to you.")),1),D("p",qh,[D("b",null,j(i.__("Thank you for your support!")),1)])])])}const Vh=Ae(Dh,[["render",Hh]]),Wh={__name:"Overview",props:{title:String,addon:Object,bunny:Object},setup(i){const e=i;return Rt("bunnyApiKey",e.bunny.apiKey),Rt("bunnyHostname",e.bunny.hostname),Rt("bunnyLibrary",e.bunny.library),(t,n)=>(H(),K(ke,null,[pe(vt(Fo),{title:i.title},null,8,["title"]),i.bunny.apiKey&&i.bunny.hostname&&i.bunny.library?(H(),K(ke,{key:0},[pe(vt(_o),{title:i.title},{default:_t(()=>[pe(Ih)]),_:1},8,["title"]),pe(ra)],64)):(H(),Mi(Vh,{key:1})),pe(vt(vo),{topic:i.addon.name,url:i.addon.url},null,8,["topic","url"])],64))}};Statamic.booting(()=>{Statamic.$inertia.register("BunnyOverview",Wh),Statamic.$components.register("bunny-fieldtype",So)});
